---
title: "Results Study 2: Personality Change Through Self-Improvement or Self-Acceptance"
author: "[blinded]"
toc: true
toc-depth: 5
toc-title: Contents
number-sections: true
execute:
  cache: true
format:
#  docx:
#    highlight-style: github
  html:
    link-external-icon: true
    link-external-newwindow: true
    code-block-bg: true
    code-block-border-left: "#31BAE9"
    embed-resources: true
#comments:
#  hypothesis: true
editor: source
#bibliography: references-zotero.bib
#csl: apa.csl
---
<!--
You can find the preregistration for Study 1 [here](https://osf.io/4syhg).
For Study 2 (separate script and results report), you can find the preregistration [here](https://osf.io/cdazs/?view_only=0ad7b53627c44510a99e8fda42af6502).
-->

## Load packages

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: false
library(renv)
library(tidyverse)
library(broom)
library(labelled)
library(psych)
library(GPArotation)
#library(devtools)
#install_github("cran/multicon") # not on CRAN atm
library(multicon)
library(correlation)
library(careless)
library(corrplot)
library(lavaan)
library(semTools)
library(semPlot)
library(knitr)
library(ggdist)
library(ggforce)
library(cowplot)
library(nortest)
library(lmerTest)
library(effectsize)
library(wordcloud) # these 3 for the word clouds
library(RColorBrewer)
library(tm)
```

------------------------------------------------------------------------

## Data cleaning

```{r}
#| echo: true
#| warning: false
#| output: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: false
# source("clean_data_st2.R") 
# for data protection reasons, we provide the cleaned data sets here where potentially sensitive variables were dropped (see "clean_data_st2.R" for details)
base::load("data/df_sbsa2.rda")
```

Also need this list of the Big Five traits:
```{r}
#| echo: true
#| warning: false
#| output: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: false

### BFI-2 - Traits
b5t_extraversion = c("_01", "_06", "_11", "_16", "_21", "_26", 
                     "_31", "_36", "_41", "_46", "_51", "_56")
b5t_agreeableness = c("_02", "_07", "_12", "_17", "_22", "_27", 
                      "_32", "_37", "_42", "_47", "_52", "_57")
b5t_conscientiousness = c("_03", "_08", "_13", "_18", "_23", "_28", 
                          "_33", "_38", "_43", "_48", "_53", "_58")
b5t_neuroticism = c("_04", "_09", "_14", "_19", "_24", "_29", 
                    "_34", "_39", "_44", "_49", "_54", "_59")
b5t_openness = c("_05", "_10", "_15", "_20", "_25", "_30", 
                 "_35", "_40", "_45", "_50", "_55", "_60")
### BFI-2 - Facets
# facets of extraversion
b5f_sociability = c("_01", "_16", "_31", "_46") 
b5f_assertiveness = c("_06", "_21", "_36", "_51")
b5f_energy = c("_11", "_26", "_41", "_56")
# facets of agreeableness
b5f_compassion = c("_02", "_17", "_32", "_47")
b5f_respectfulness = c("_07", "_22", "_37", "_52")
b5f_trust = c("_12", "_27", "_42", "_57")
# facets of conscientiousness
b5f_organization = c("_03", "_18", "_33", "_48")
b5f_productiveness = c("_08", "_23", "_38", "_53")
b5f_responsibility = c("_13", "_28", "_43", "_58")
# facets of neuroticism
b5f_anxiety = c("_04", "_19", "_34", "_49")
b5f_depression = c("_09", "_24", "_39", "_54")
b5f_volatility = c("_14", "_29", "_44", "_59")
# facets of openness
b5f_curiosity = c("_10", "_25", "_40", "_55")
b5f_aesthetic = c("_05", "_20", "_35", "_50")
b5f_imagination = c("_15", "_30", "_45", "_60")

# add keys list (to indicate reverse scoring) - unfortunately this does not work (for the facets) automatically with psych function
keys_extraversion = c("+", "+", "-", "-", "+", "-", "-", "-", "+", "+", "-", "+")
keys_agreeableness = c("+", "+", "-", "-", "-", "+", "+", "-", "-", "-", "+", "+")
keys_conscientiousness = c("-", "-", "+", "+", "-", "-", "+", "+", "+", "-", "+", "-")
keys_neuroticism = c("-", "-", "+", "+", "-", "-", "+", "+", "-", "-", "+", "+")
keys_openness = c("-", "+", "+", "+", "-", "-", "+", "+", "-", "-", "-", "+")
# facets of extraversion
keys_sociability = c("+", "-", "-", "+") 
keys_assertiveness = c("+", "+", "-", "-")
keys_energy = c("-", "-", "+", "+")
# facets of agreeableness
keys_compassion = c("+", "-", "+", "-")
keys_respectfulness = c("+", "-", "-", "+")
keys_trust = c("-", "+", "-", "+")
# facets of conscientiousness
keys_organization = c("-", "+", "+", "-")
keys_productiveness = c("-", "-", "+", "+")
keys_responsibility = c("+", "-", "+", "-")
# facets of neuroticism
keys_anxiety = c("-", "+", "+", "-")
keys_depression = c("-", "-", "+", "+")
keys_volatility = c("+", "-", "-", "+")
# facets of openness
keys_curiosity = c("+", "-", "+", "-")
keys_aesthetic = c("-", "+", "+", "-")
keys_imagination = c("+", "-", "-", "+")

b5_vars <- list(list(b5t_extraversion, keys_extraversion), 
                list(b5t_agreeableness, keys_agreeableness), 
                list(b5t_conscientiousness, keys_conscientiousness), 
                list(b5t_neuroticism, keys_neuroticism), 
                list(b5t_openness, keys_openness),
                list(b5f_sociability, keys_sociability), 
                list(b5f_assertiveness, keys_assertiveness), 
                list(b5f_energy, keys_energy), 
                list(b5f_compassion, keys_compassion), 
                list(b5f_respectfulness, keys_respectfulness), 
                list(b5f_trust, keys_trust),
                list(b5f_organization, keys_organization), 
                list(b5f_productiveness, keys_productiveness), 
                list(b5f_responsibility, keys_responsibility),
                list(b5f_anxiety, keys_anxiety), 
                list(b5f_depression, keys_depression), 
                list(b5f_volatility, keys_volatility),
                list(b5f_curiosity, keys_curiosity), 
                list(b5f_aesthetic, keys_aesthetic), 
                list(b5f_imagination, keys_imagination))
names(b5_vars) = c("extraversion", "agreeableness", "conscientiousness", "neuroticism", "openness",
                   "sociability", "assertiveness", "energy", 
                   "compassion", "respectfulness", "trust",
                   "organization", "productiveness", "responsibility",
                   "anxiety", "depression", "volatility",
                   "curiosity", "aesthetic", "imagination")

bfi_versions <- list("bf01", "bf02", "bf03", "bf04",
                     "bf05", "bf06")
names(bfi_versions) <- c("pre_curr", "pre_ideal", "post_curr", "post_ideal",
                         "comb_curr", "comb_ideal")
```

------------------------------------------------------------------------

## Create item parcels

### Well-being measures

Reshape data
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

df_sbsa2_wide_wb <- df_sbsa2 %>% 
  arrange(pid, time) %>% 
  select(pid, time, rando, starts_with(c("sw06", "ml01", "rs01", "sc01"))) %>% 
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = starts_with(c("sw06", "ml01", "rs01", "sc01")))
# colnames(df_sbsa2_wide_wb)
```

#### Meaning in life

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false
cfa_meaning <- '
# Define the latent factors
meaning1 =~ NA*ml01_01_t1 + lambda1*ml01_01_t1 + lambda2*ml01_02_t1 + lambda3*ml01_03_t1 + lambda4*ml01_04_t1 + lambda5*ml01_05_t1 + lambda6*ml01_06_t1 + lambda7*ml01_07_t1 + lambda8*ml01_08_t1 + lambda9*ml01_09_t1 + lambda10*ml01_10_t1

# Intercepts
ml01_01_t1 ~ i1*1
ml01_02_t1 ~ 1
ml01_03_t1 ~ 1
ml01_04_t1 ~ 1
ml01_05_t1 ~ 1
ml01_06_t1 ~ 1
ml01_07_t1 ~ 1
ml01_08_t1 ~ 1
ml01_09_t1 ~ 1
ml01_10_t1 ~ 1

# Unique Variances
ml01_01_t1 ~~ ml01_01_t1
ml01_02_t1 ~~ ml01_02_t1
ml01_03_t1 ~~ ml01_03_t1
ml01_04_t1 ~~ ml01_04_t1
ml01_05_t1 ~~ ml01_05_t1
ml01_06_t1 ~~ ml01_06_t1
ml01_07_t1 ~~ ml01_07_t1
ml01_08_t1 ~~ ml01_08_t1
ml01_09_t1 ~~ ml01_09_t1
ml01_10_t1 ~~ ml01_10_t1

# Latent Variable Means
meaning1 ~ 0*1

# Latent Variable Variances and Covariance
meaning1 ~~ 1*meaning1
'
fit_cfa_meaning <- cfa(cfa_meaning, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_cfa_meaning, fit.measures = TRUE)
tidy(fit_cfa_meaning) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_wb <- df_sbsa2_wide_wb %>% 
  mutate(ml01_09_t1_r = ml01_09_t1,
         ml01_10_t1_r = ml01_10_t1,
         ml01_02_t1_r = ml01_02_t1,
         ml01_08_t1_r = ml01_08_t1,
         ml01_07_t1_r = ml01_07_t1,
         ml01_03_t1_r = ml01_03_t1,
         ml01_09_t2_r = ml01_09_t2,
         ml01_10_t2_r = ml01_10_t2,
         ml01_02_t2_r = ml01_02_t2,
         ml01_08_t2_r = ml01_08_t2,
         ml01_07_t2_r = ml01_07_t2,
         ml01_03_t2_r = ml01_03_t2,
         ml01_09_t3_r = ml01_09_t3,
         ml01_10_t3_r = ml01_10_t3,
         ml01_02_t3_r = ml01_02_t3,
         ml01_08_t3_r = ml01_08_t3,
         ml01_07_t3_r = ml01_07_t3,
         ml01_03_t3_r = ml01_03_t3) %>% 
  mutate(across(intersect(starts_with("ml01"), ends_with("_r")), 
                ~ recode(.x, `1` = 7L, `2` = 6L, `3` = 5L, `4` = 4L, `5` = 3L, `6` = 2L, `7` = 1L, .default = NA_integer_))) %>% 
  mutate(meaning_par1_t1 = rowMeans(across(c(ml01_04_t1, ml01_10_t1_r, ml01_03_t1_r, ml01_07_t1_r)), na.rm=T),
         meaning_par2_t1 = rowMeans(across(c(ml01_06_t1, ml01_05_t1, ml01_08_t1_r)), na.rm=T),
         meaning_par3_t1 = rowMeans(across(c(ml01_01_t1, ml01_09_t1_r, ml01_02_t1_r)), na.rm=T),
         meaning_par1_t2 = rowMeans(across(c(ml01_04_t2, ml01_10_t2_r, ml01_03_t2_r, ml01_07_t2_r)), na.rm=T),
         meaning_par2_t2 = rowMeans(across(c(ml01_06_t2, ml01_05_t2, ml01_08_t2_r)), na.rm=T),
         meaning_par3_t2 = rowMeans(across(c(ml01_01_t2, ml01_09_t2_r, ml01_02_t2_r)), na.rm=T),
         meaning_par1_t3 = rowMeans(across(c(ml01_04_t3, ml01_10_t3_r, ml01_03_t3_r, ml01_07_t3_r)), na.rm=T),
         meaning_par2_t3 = rowMeans(across(c(ml01_06_t3, ml01_05_t3, ml01_08_t3_r)), na.rm=T),
         meaning_par3_t3 = rowMeans(across(c(ml01_01_t3, ml01_09_t3_r, ml01_02_t3_r)), na.rm=T))
```

#### Self-esteem

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_selfes <- '
# Define the latent factors
selfes1 =~ NA*rs01_01_t1 + lambda1*rs01_01_t1 + lambda2*rs01_02_t1 + lambda3*rs01_03_t1 + lambda4*rs01_04_t1 + lambda5*rs01_05_t1 + lambda6*rs01_06_t1 + lambda7*rs01_07_t1 + lambda8*rs01_08_t1 + lambda9*rs01_09_t1 + lambda10*rs01_10_t1

# Intercepts
rs01_01_t1 ~ i1*1
rs01_02_t1 ~ 1
rs01_03_t1 ~ 1
rs01_04_t1 ~ 1
rs01_05_t1 ~ 1
rs01_06_t1 ~ 1
rs01_07_t1 ~ 1
rs01_08_t1 ~ 1
rs01_09_t1 ~ 1
rs01_10_t1 ~ 1

# Unique Variances
rs01_01_t1 ~~ rs01_01_t1
rs01_02_t1 ~~ rs01_02_t1
rs01_03_t1 ~~ rs01_03_t1
rs01_04_t1 ~~ rs01_04_t1
rs01_05_t1 ~~ rs01_05_t1
rs01_06_t1 ~~ rs01_06_t1
rs01_07_t1 ~~ rs01_07_t1
rs01_08_t1 ~~ rs01_08_t1
rs01_09_t1 ~~ rs01_09_t1
rs01_10_t1 ~~ rs01_10_t1

# Latent Variable Means
selfes1 ~ 0*1

# Latent Variable Variances and Covariance
selfes1 ~~ 1*selfes1
'
fit_cfa_selfes <- cfa(cfa_selfes, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_cfa_selfes, fit.measures = TRUE)
tidy(fit_cfa_selfes) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_wb <- df_sbsa2_wide_wb %>% 
  mutate(rs01_09_t1_r = rs01_09_t1,
         rs01_06_t1_r = rs01_06_t1,
         rs01_02_t1_r = rs01_02_t1,
         rs01_05_t1_r = rs01_05_t1,
         rs01_08_t1_r = rs01_08_t1,
         rs01_09_t2_r = rs01_09_t2,
         rs01_06_t2_r = rs01_06_t2,
         rs01_02_t2_r = rs01_02_t2,
         rs01_05_t2_r = rs01_05_t2,
         rs01_08_t2_r = rs01_08_t2,
         rs01_09_t3_r = rs01_09_t3,
         rs01_06_t3_r = rs01_06_t3,
         rs01_02_t3_r = rs01_02_t3,
         rs01_05_t3_r = rs01_05_t3,
         rs01_08_t3_r = rs01_08_t3) %>% 
  mutate(across(intersect(starts_with("rs01"), ends_with("_r")), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(selfes_par1_t1 = rowMeans(across(c(rs01_09_t1_r, rs01_01_t1, rs01_04_t1, rs01_03_t1)), na.rm=T),
         selfes_par2_t1 = rowMeans(across(c(rs01_06_t1_r, rs01_05_t1_r, rs01_08_t1_r)), na.rm=T),
         selfes_par3_t1 = rowMeans(across(c(rs01_02_t1_r, rs01_10_t1, rs01_07_t1)), na.rm=T),
         selfes_par1_t2 = rowMeans(across(c(rs01_09_t2_r, rs01_01_t2, rs01_04_t2, rs01_03_t2)), na.rm=T),
         selfes_par2_t2 = rowMeans(across(c(rs01_06_t2_r, rs01_05_t2_r, rs01_08_t2_r)), na.rm=T),
         selfes_par3_t2 = rowMeans(across(c(rs01_02_t2_r, rs01_10_t2, rs01_07_t2)), na.rm=T),
         selfes_par1_t3 = rowMeans(across(c(rs01_09_t3_r, rs01_01_t3, rs01_04_t3, rs01_03_t3)), na.rm=T),
         selfes_par2_t3 = rowMeans(across(c(rs01_06_t3_r, rs01_05_t3_r, rs01_08_t3_r)), na.rm=T),
         selfes_par3_t3 = rowMeans(across(c(rs01_02_t3_r, rs01_10_t3, rs01_07_t3)), na.rm=T))
```

#### Self-concept clarity

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_concept <- '
# Define the latent factors
concept1 =~ NA*sc01_01_t1 + lambda1*sc01_01_t1 + lambda2*sc01_02_t1 + lambda3*sc01_03_t1 + lambda4*sc01_04_t1 + lambda5*sc01_05_t1 + lambda6*sc01_06_t1 + lambda7*sc01_07_t1 + lambda8*sc01_08_t1 + lambda9*sc01_09_t1 + lambda10*sc01_10_t1 + lambda11*sc01_11_t1 + lambda12*sc01_12_t1

# Intercepts
sc01_01_t1 ~ i1*1
sc01_02_t1 ~ 1
sc01_03_t1 ~ 1
sc01_04_t1 ~ 1
sc01_05_t1 ~ 1
sc01_06_t1 ~ 1
sc01_07_t1 ~ 1
sc01_08_t1 ~ 1
sc01_09_t1 ~ 1
sc01_10_t1 ~ 1
sc01_11_t1 ~ 1
sc01_12_t1 ~ 1

# Unique Variances
sc01_01_t1 ~~ sc01_01_t1
sc01_02_t1 ~~ sc01_02_t1
sc01_03_t1 ~~ sc01_03_t1
sc01_04_t1 ~~ sc01_04_t1
sc01_05_t1 ~~ sc01_05_t1
sc01_06_t1 ~~ sc01_06_t1
sc01_07_t1 ~~ sc01_07_t1
sc01_08_t1 ~~ sc01_08_t1
sc01_09_t1 ~~ sc01_09_t1
sc01_10_t1 ~~ sc01_10_t1
sc01_11_t1 ~~ sc01_11_t1
sc01_12_t1 ~~ sc01_12_t1

# Latent Variable Means
concept1 ~ 0*1

# Latent Variable Variances and Covariance
concept1 ~~ 1*concept1
'
fit_cfa_concept <- cfa(cfa_concept, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_cfa_concept, fit.measures = TRUE)
tidy(fit_cfa_concept) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_wb <- df_sbsa2_wide_wb %>% # based on the item content, it makes more sense here to recode all except sc01_11
  mutate(sc01_01_t1_r = sc01_01_t1,
         sc01_02_t1_r = sc01_02_t1,
         sc01_03_t1_r = sc01_03_t1,
         sc01_04_t1_r = sc01_04_t1,
         sc01_05_t1_r = sc01_05_t1,
         sc01_06_t1_r = sc01_06_t1,
         sc01_07_t1_r = sc01_07_t1,
         sc01_08_t1_r = sc01_08_t1,
         sc01_09_t1_r = sc01_09_t1,
         sc01_10_t1_r = sc01_10_t1,
         sc01_12_t1_r = sc01_12_t1,
         sc01_01_t2_r = sc01_01_t2,
         sc01_02_t2_r = sc01_02_t2,
         sc01_03_t2_r = sc01_03_t2,
         sc01_04_t2_r = sc01_04_t2,
         sc01_05_t2_r = sc01_05_t2,
         sc01_06_t2_r = sc01_06_t2,
         sc01_07_t2_r = sc01_07_t2,
         sc01_08_t2_r = sc01_08_t2,
         sc01_09_t2_r = sc01_09_t2,
         sc01_10_t2_r = sc01_10_t2,
         sc01_12_t2_r = sc01_12_t2,
         sc01_01_t3_r = sc01_01_t3,
         sc01_02_t3_r = sc01_02_t3,
         sc01_03_t3_r = sc01_03_t3,
         sc01_04_t3_r = sc01_04_t3,
         sc01_05_t3_r = sc01_05_t3,
         sc01_06_t3_r = sc01_06_t3,
         sc01_07_t3_r = sc01_07_t3,
         sc01_08_t3_r = sc01_08_t3,
         sc01_09_t3_r = sc01_09_t3,
         sc01_10_t3_r = sc01_10_t3,
         sc01_12_t3_r = sc01_12_t3) %>% 
  mutate(across(intersect(starts_with("sc01"), ends_with("_r")), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(concept_par1_t1 = rowMeans(across(c(sc01_08_t1_r, sc01_01_t1_r, sc01_05_t1_r, sc01_06_t1_r)), na.rm=T),
         concept_par2_t1 = rowMeans(across(c(sc01_09_t1_r, sc01_03_t1_r, sc01_12_t1_r, sc01_11_t1)), na.rm=T),
         concept_par3_t1 = rowMeans(across(c(sc01_04_t1_r, sc01_02_t1_r, sc01_10_t1_r, sc01_07_t1_r)), na.rm=T),
         concept_par1_t2 = rowMeans(across(c(sc01_08_t2_r, sc01_01_t2_r, sc01_05_t2_r, sc01_06_t2_r)), na.rm=T),
         concept_par2_t2 = rowMeans(across(c(sc01_09_t2_r, sc01_03_t2_r, sc01_12_t2_r, sc01_11_t2)), na.rm=T),
         concept_par3_t2 = rowMeans(across(c(sc01_04_t2_r, sc01_02_t2_r, sc01_10_t2_r, sc01_07_t2_r)), na.rm=T),
         concept_par1_t3 = rowMeans(across(c(sc01_08_t3_r, sc01_01_t3_r, sc01_05_t3_r, sc01_06_t3_r)), na.rm=T),
         concept_par2_t3 = rowMeans(across(c(sc01_09_t3_r, sc01_03_t3_r, sc01_12_t3_r, sc01_11_t3)), na.rm=T),
         concept_par3_t3 = rowMeans(across(c(sc01_04_t3_r, sc01_02_t3_r, sc01_10_t3_r, sc01_07_t3_r)), na.rm=T))

# replace NaN with regular NA
df_sbsa2_wide_wb <- df_sbsa2_wide_wb %>% 
  mutate_all(~ifelse(is.nan(.), NA, .))
```

### Big Five 
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

# all time points
df_sbsa2_wide_pers <- df_sbsa2 %>% 
  arrange(pid, time) %>% 
  select(pid, rando, time, starts_with(c("bf05", "bf06"))) %>% 
  mutate(valid=1) %>% 
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(valid, starts_with(c("bf05", "bf06"))))
# colnames(df_sbsa2_wide_pers)
```

#### Extraversion - current personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*bf05_01_t1 + lambda1*bf05_01_t1 + lambda2*bf05_06_t1 + lambda3*bf05_11_t1 + lambda4*bf05_16_t1 + lambda5*bf05_21_t1 + lambda6*bf05_26_t1 + lambda7*bf05_31_t1 + lambda8*bf05_36_t1 + lambda9*bf05_41_t1 + lambda10*bf05_46_t1 + lambda11*bf05_51_t1 + lambda12*bf05_56_t1

# Intercepts
bf05_01_t1 ~ i1*1
bf05_06_t1 ~ 1
bf05_11_t1 ~ 1
bf05_16_t1 ~ 1
bf05_21_t1 ~ 1
bf05_26_t1 ~ 1
bf05_31_t1 ~ 1
bf05_36_t1 ~ 1
bf05_41_t1 ~ 1
bf05_46_t1 ~ 1
bf05_51_t1 ~ 1
bf05_56_t1 ~ 1

# Unique Variances
bf05_01_t1 ~~ bf05_01_t1
bf05_06_t1 ~~ bf05_06_t1
bf05_11_t1 ~~ bf05_11_t1
bf05_16_t1 ~~ bf05_16_t1
bf05_21_t1 ~~ bf05_21_t1
bf05_26_t1 ~~ bf05_26_t1
bf05_31_t1 ~~ bf05_31_t1
bf05_36_t1 ~~ bf05_36_t1
bf05_41_t1 ~~ bf05_41_t1
bf05_46_t1 ~~ bf05_46_t1
bf05_51_t1 ~~ bf05_51_t1
bf05_56_t1 ~~ bf05_56_t1

# Latent Variable Means
extra_curr1 ~ 0*1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
'
fit_cfa_extra_curr <- cfa(cfa_extra_curr, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_extra_curr, fit.measures = TRUE)
tidy(fit_cfa_extra_curr) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf05_31_t1_r = bf05_31_t1,
         bf05_16_t1_r = bf05_16_t1,
         bf05_26_t1_r = bf05_26_t1,
         bf05_51_t1_r = bf05_51_t1,
         bf05_36_t1_r = bf05_36_t1,
         bf05_11_t1_r = bf05_11_t1,
         bf05_31_t2_r = bf05_31_t2,
         bf05_16_t2_r = bf05_16_t2,
         bf05_26_t2_r = bf05_26_t2,
         bf05_51_t2_r = bf05_51_t2,
         bf05_36_t2_r = bf05_36_t2,
         bf05_11_t2_r = bf05_11_t2,
         bf05_31_t3_r = bf05_31_t3,
         bf05_16_t3_r = bf05_16_t3,
         bf05_26_t3_r = bf05_26_t3,
         bf05_51_t3_r = bf05_51_t3,
         bf05_36_t3_r = bf05_36_t3,
         bf05_11_t3_r = bf05_11_t3) %>% 
  mutate(across(c(bf05_31_t1_r, bf05_16_t1_r, bf05_26_t1_r, bf05_51_t1_r, bf05_36_t1_r, bf05_11_t1_r, 
                  bf05_31_t2_r, bf05_16_t2_r, bf05_26_t2_r, bf05_51_t2_r, bf05_36_t2_r, bf05_11_t2_r, 
                  bf05_31_t3_r, bf05_16_t3_r, bf05_26_t3_r, bf05_51_t3_r, bf05_36_t3_r, bf05_11_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(extra_curr_par1_t1 = rowMeans(across(c(bf05_01_t1, bf05_41_t1, bf05_26_t1_r, bf05_11_t1_r)), na.rm=T),
         extra_curr_par2_t1 = rowMeans(across(c(bf05_46_t1, bf05_21_t1, bf05_51_t1_r, bf05_36_t1_r)), na.rm=T),
         extra_curr_par3_t1 = rowMeans(across(c(bf05_16_t1_r, bf05_31_t1_r, bf05_56_t1, bf05_06_t1)), na.rm=T),
         extra_curr_par1_t2 = rowMeans(across(c(bf05_01_t2, bf05_41_t2, bf05_26_t2_r, bf05_11_t2_r)), na.rm=T),
         extra_curr_par2_t2 = rowMeans(across(c(bf05_46_t2, bf05_21_t2, bf05_51_t2_r, bf05_36_t2_r)), na.rm=T),
         extra_curr_par3_t2 = rowMeans(across(c(bf05_16_t2_r, bf05_31_t2_r, bf05_56_t2, bf05_06_t2)), na.rm=T),
         extra_curr_par1_t3 = rowMeans(across(c(bf05_01_t3, bf05_41_t3, bf05_26_t3_r, bf05_11_t3_r)), na.rm=T),
         extra_curr_par2_t3 = rowMeans(across(c(bf05_46_t3, bf05_21_t3, bf05_51_t3_r, bf05_36_t3_r)), na.rm=T),
         extra_curr_par3_t3 = rowMeans(across(c(bf05_16_t3_r, bf05_31_t3_r, bf05_56_t3, bf05_06_t3)), na.rm=T))
```

#### Extraversion - ideal personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*bf06_01_t1 + lambda1*bf06_01_t1 + lambda2*bf06_06_t1 + lambda3*bf06_11_t1 + lambda4*bf06_16_t1 + lambda5*bf06_21_t1 + lambda6*bf06_26_t1 + lambda7*bf06_31_t1 + lambda8*bf06_36_t1 + lambda9*bf06_41_t1 + lambda10*bf06_46_t1 + lambda11*bf06_51_t1 + lambda12*bf06_56_t1

# Intercepts
bf06_01_t1 ~ i1*1
bf06_06_t1 ~ 1
bf06_11_t1 ~ 1
bf06_16_t1 ~ 1
bf06_21_t1 ~ 1
bf06_26_t1 ~ 1
bf06_31_t1 ~ 1
bf06_36_t1 ~ 1
bf06_41_t1 ~ 1
bf06_46_t1 ~ 1
bf06_51_t1 ~ 1
bf06_56_t1 ~ 1

# Unique Variances
bf06_01_t1 ~~ bf06_01_t1
bf06_06_t1 ~~ bf06_06_t1
bf06_11_t1 ~~ bf06_11_t1
bf06_16_t1 ~~ bf06_16_t1
bf06_21_t1 ~~ bf06_21_t1
bf06_26_t1 ~~ bf06_26_t1
bf06_31_t1 ~~ bf06_31_t1
bf06_36_t1 ~~ bf06_36_t1
bf06_41_t1 ~~ bf06_41_t1
bf06_46_t1 ~~ bf06_46_t1
bf06_51_t1 ~~ bf06_51_t1
bf06_56_t1 ~~ bf06_56_t1

# Latent Variable Means
extra_ideal1 ~ 0*1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
'
fit_cfa_extra_ideal <- cfa(cfa_extra_ideal, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_extra_ideal, fit.measures = TRUE)
tidy(fit_cfa_extra_ideal) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf06_31_t1_r = bf06_31_t1,
         bf06_16_t1_r = bf06_16_t1,
         bf06_26_t1_r = bf06_26_t1,
         bf06_51_t1_r = bf06_51_t1,
         bf06_36_t1_r = bf06_36_t1,
         bf06_11_t1_r = bf06_11_t1,
         bf06_31_t2_r = bf06_31_t2,
         bf06_16_t2_r = bf06_16_t2,
         bf06_26_t2_r = bf06_26_t2,
         bf06_51_t2_r = bf06_51_t2,
         bf06_36_t2_r = bf06_36_t2,
         bf06_11_t2_r = bf06_11_t2,
         bf06_31_t3_r = bf06_31_t3,
         bf06_16_t3_r = bf06_16_t3,
         bf06_26_t3_r = bf06_26_t3,
         bf06_51_t3_r = bf06_51_t3,
         bf06_36_t3_r = bf06_36_t3,
         bf06_11_t3_r = bf06_11_t3) %>% 
  mutate(across(c(bf06_31_t1_r, bf06_16_t1_r, bf06_26_t1_r, bf06_51_t1_r, bf06_36_t1_r, bf06_11_t1_r, 
                  bf06_31_t2_r, bf06_16_t2_r, bf06_26_t2_r, bf06_51_t2_r, bf06_36_t2_r, bf06_11_t2_r, 
                  bf06_31_t3_r, bf06_16_t3_r, bf06_26_t3_r, bf06_51_t3_r, bf06_36_t3_r, bf06_11_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(extra_ideal_par1_t1 = rowMeans(across(c(bf06_31_t1_r, bf06_16_t1_r, bf06_46_t1, bf06_06_t1)), na.rm=T),
         extra_ideal_par2_t1 = rowMeans(across(c(bf06_21_t1, bf06_26_t1_r, bf06_01_t1, bf06_11_t1_r)), na.rm=T),
         extra_ideal_par3_t1 = rowMeans(across(c(bf06_51_t1_r, bf06_56_t1, bf06_36_t1_r, bf06_41_t1)), na.rm=T),
         extra_ideal_par1_t2 = rowMeans(across(c(bf06_31_t2_r, bf06_16_t2_r, bf06_46_t2, bf06_06_t2)), na.rm=T),
         extra_ideal_par2_t2 = rowMeans(across(c(bf06_21_t2, bf06_26_t2_r, bf06_01_t2, bf06_11_t2_r)), na.rm=T),
         extra_ideal_par3_t2 = rowMeans(across(c(bf06_51_t2_r, bf06_56_t2, bf06_36_t2_r, bf06_41_t2)), na.rm=T),
         extra_ideal_par1_t3 = rowMeans(across(c(bf06_31_t3_r, bf06_16_t3_r, bf06_46_t3, bf06_06_t3)), na.rm=T),
         extra_ideal_par2_t3 = rowMeans(across(c(bf06_21_t3, bf06_26_t3_r, bf06_01_t3, bf06_11_t3_r)), na.rm=T),
         extra_ideal_par3_t3 = rowMeans(across(c(bf06_51_t3_r, bf06_56_t3, bf06_36_t3_r, bf06_41_t3)), na.rm=T))
```

#### Agreeableness - current personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*bf05_02_t1 + lambda1*bf05_02_t1 + lambda2*bf05_07_t1 + lambda3*bf05_12_t1 + lambda4*bf05_17_t1 + lambda5*bf05_22_t1 + lambda6*bf05_27_t1 + lambda7*bf05_32_t1 + lambda8*bf05_37_t1 + lambda9*bf05_42_t1 + lambda10*bf05_47_t1 + lambda11*bf05_52_t1 + lambda12*bf05_57_t1

# Intercepts
bf05_02_t1 ~ i1*1
bf05_07_t1 ~ 1
bf05_12_t1 ~ 1
bf05_17_t1 ~ 1
bf05_22_t1 ~ 1
bf05_27_t1 ~ 1
bf05_32_t1 ~ 1
bf05_37_t1 ~ 1
bf05_42_t1 ~ 1
bf05_47_t1 ~ 1
bf05_52_t1 ~ 1
bf05_57_t1 ~ 1

# Unique Variances
bf05_02_t1 ~~ bf05_02_t1
bf05_07_t1 ~~ bf05_07_t1
bf05_12_t1 ~~ bf05_12_t1
bf05_17_t1 ~~ bf05_17_t1
bf05_22_t1 ~~ bf05_22_t1
bf05_27_t1 ~~ bf05_27_t1
bf05_32_t1 ~~ bf05_32_t1
bf05_37_t1 ~~ bf05_37_t1
bf05_42_t1 ~~ bf05_42_t1
bf05_47_t1 ~~ bf05_47_t1
bf05_52_t1 ~~ bf05_52_t1
bf05_57_t1 ~~ bf05_57_t1

# Latent Variable Means
agree_curr1 ~ 0*1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
'
fit_cfa_agree_curr <- cfa(cfa_agree_curr, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_agree_curr, fit.measures = TRUE)
tidy(fit_cfa_agree_curr) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf05_47_t1_r = bf05_47_t1,
         bf05_37_t1_r = bf05_37_t1,
         bf05_22_t1_r = bf05_22_t1,
         bf05_12_t1_r = bf05_12_t1,
         bf05_42_t1_r = bf05_42_t1,
         bf05_17_t1_r = bf05_17_t1,
         bf05_47_t2_r = bf05_47_t2,
         bf05_37_t2_r = bf05_37_t2,
         bf05_22_t2_r = bf05_22_t2,
         bf05_12_t2_r = bf05_12_t2,
         bf05_42_t2_r = bf05_42_t2,
         bf05_17_t2_r = bf05_17_t2,
         bf05_47_t3_r = bf05_47_t3,
         bf05_37_t3_r = bf05_37_t3,
         bf05_22_t3_r = bf05_22_t3,
         bf05_12_t3_r = bf05_12_t3,
         bf05_42_t3_r = bf05_42_t3,
         bf05_17_t3_r = bf05_17_t3) %>% 
  mutate(across(c(bf05_47_t1_r, bf05_37_t1_r, bf05_22_t1_r, bf05_12_t1_r, bf05_42_t1_r, bf05_17_t1_r, 
                  bf05_47_t2_r, bf05_37_t2_r, bf05_22_t2_r, bf05_12_t2_r, bf05_42_t2_r, bf05_17_t2_r, 
                  bf05_47_t3_r, bf05_37_t3_r, bf05_22_t3_r, bf05_12_t3_r, bf05_42_t3_r, bf05_17_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(agree_curr_par1_t1 = rowMeans(across(c(bf05_47_t1_r, bf05_57_t1, bf05_07_t1, bf05_17_t1)), na.rm=T),
         agree_curr_par2_t1 = rowMeans(across(c(bf05_37_t1_r, bf05_27_t1, bf05_02_t1, bf05_52_t1)), na.rm=T),
         agree_curr_par3_t1 = rowMeans(across(c(bf05_22_t1_r, bf05_12_t1_r, bf05_32_t1, bf05_42_t1)), na.rm=T),
         agree_curr_par1_t2 = rowMeans(across(c(bf05_47_t2_r, bf05_57_t2, bf05_07_t2, bf05_17_t2)), na.rm=T),
         agree_curr_par2_t2 = rowMeans(across(c(bf05_37_t2_r, bf05_27_t2, bf05_02_t2, bf05_52_t2)), na.rm=T),
         agree_curr_par3_t2 = rowMeans(across(c(bf05_22_t2_r, bf05_12_t2_r, bf05_32_t2, bf05_42_t2)), na.rm=T),
         agree_curr_par1_t3 = rowMeans(across(c(bf05_47_t3_r, bf05_57_t3, bf05_07_t3, bf05_17_t3)), na.rm=T),
         agree_curr_par2_t3 = rowMeans(across(c(bf05_37_t3_r, bf05_27_t3, bf05_02_t3, bf05_52_t3)), na.rm=T),
         agree_curr_par3_t3 = rowMeans(across(c(bf05_22_t3_r, bf05_12_t3_r, bf05_32_t3, bf05_42_t3)), na.rm=T))
```

#### Agreeableness - ideal personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*bf06_02_t1 + lambda1*bf06_02_t1 + lambda2*bf06_07_t1 + lambda3*bf06_12_t1 + lambda4*bf06_17_t1 + lambda5*bf06_22_t1 + lambda6*bf06_27_t1 + lambda7*bf06_32_t1 + lambda8*bf06_37_t1 + lambda9*bf06_42_t1 + lambda10*bf06_47_t1 + lambda11*bf06_52_t1 + lambda12*bf06_57_t1

# Intercepts
bf06_02_t1 ~ i1*1
bf06_07_t1 ~ 1
bf06_12_t1 ~ 1
bf06_17_t1 ~ 1
bf06_22_t1 ~ 1
bf06_27_t1 ~ 1
bf06_32_t1 ~ 1
bf06_37_t1 ~ 1
bf06_42_t1 ~ 1
bf06_47_t1 ~ 1
bf06_52_t1 ~ 1
bf06_57_t1 ~ 1

# Unique Variances
bf06_02_t1 ~~ bf06_02_t1
bf06_07_t1 ~~ bf06_07_t1
bf06_12_t1 ~~ bf06_12_t1
bf06_17_t1 ~~ bf06_17_t1
bf06_22_t1 ~~ bf06_22_t1
bf06_27_t1 ~~ bf06_27_t1
bf06_32_t1 ~~ bf06_32_t1
bf06_37_t1 ~~ bf06_37_t1
bf06_42_t1 ~~ bf06_42_t1
bf06_47_t1 ~~ bf06_47_t1
bf06_52_t1 ~~ bf06_52_t1
bf06_57_t1 ~~ bf06_57_t1

# Latent Variable Means
agree_ideal1 ~ 0*1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
'
fit_cfa_agree_ideal <- cfa(cfa_agree_ideal, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_agree_ideal, fit.measures = TRUE)
tidy(fit_cfa_agree_ideal) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf06_47_t1_r = bf06_47_t1,
         bf06_37_t1_r = bf06_37_t1,
         bf06_22_t1_r = bf06_22_t1,
         bf06_12_t1_r = bf06_12_t1,
         bf06_42_t1_r = bf06_42_t1,
         bf06_17_t1_r = bf06_17_t1,
         bf06_47_t2_r = bf06_47_t2,
         bf06_37_t2_r = bf06_37_t2,
         bf06_22_t2_r = bf06_22_t2,
         bf06_12_t2_r = bf06_12_t2,
         bf06_42_t2_r = bf06_42_t2,
         bf06_17_t2_r = bf06_17_t2,
         bf06_47_t3_r = bf06_47_t3,
         bf06_37_t3_r = bf06_37_t3,
         bf06_22_t3_r = bf06_22_t3,
         bf06_12_t3_r = bf06_12_t3,
         bf06_42_t3_r = bf06_42_t3,
         bf06_17_t3_r = bf06_17_t3) %>% 
  mutate(across(c(bf06_47_t1_r, bf06_37_t1_r, bf06_22_t1_r, bf06_12_t1_r, bf06_42_t1_r, bf06_17_t1_r, 
                  bf06_47_t2_r, bf06_37_t2_r, bf06_22_t2_r, bf06_12_t2_r, bf06_42_t2_r, bf06_17_t2_r, 
                  bf06_47_t3_r, bf06_37_t3_r, bf06_22_t3_r, bf06_12_t3_r, bf06_42_t3_r, bf06_17_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(agree_ideal_par1_t1 = rowMeans(across(c(bf06_47_t1_r, bf06_32_t1, bf06_42_t1_r, bf06_17_t1_r)), na.rm=T),
         agree_ideal_par2_t1 = rowMeans(across(c(bf06_27_t1, bf06_37_t1_r, bf06_22_t1_r, bf06_07_t1)), na.rm=T),
         agree_ideal_par3_t1 = rowMeans(across(c(bf06_02_t1, bf06_12_t1_r, bf06_57_t1, bf06_52_t1)), na.rm=T),
         agree_ideal_par1_t2 = rowMeans(across(c(bf06_47_t2_r, bf06_32_t2, bf06_42_t2_r, bf06_17_t2_r)), na.rm=T),
         agree_ideal_par2_t2 = rowMeans(across(c(bf06_27_t2, bf06_37_t2_r, bf06_22_t2_r, bf06_07_t2)), na.rm=T),
         agree_ideal_par3_t2 = rowMeans(across(c(bf06_02_t2, bf06_12_t2_r, bf06_57_t2, bf06_52_t2)), na.rm=T),
         agree_ideal_par1_t3 = rowMeans(across(c(bf06_47_t3_r, bf06_32_t3, bf06_42_t3_r, bf06_17_t3_r)), na.rm=T),
         agree_ideal_par2_t3 = rowMeans(across(c(bf06_27_t3, bf06_37_t3_r, bf06_22_t3_r, bf06_07_t3)), na.rm=T),
         agree_ideal_par3_t3 = rowMeans(across(c(bf06_02_t3, bf06_12_t3_r, bf06_57_t3, bf06_52_t3)), na.rm=T))
```

#### Conscientiousness - current personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*bf05_03_t1 + lambda1*bf05_03_t1 + lambda2*bf05_08_t1 + lambda3*bf05_13_t1 + lambda4*bf05_18_t1 + lambda5*bf05_23_t1 + lambda6*bf05_28_t1 + lambda7*bf05_33_t1 + lambda8*bf05_38_t1 + lambda9*bf05_43_t1 + lambda10*bf05_48_t1 + lambda11*bf05_53_t1 + lambda12*bf05_58_t1
# Intercepts
bf05_03_t1 ~ i1*1
bf05_08_t1 ~ 1
bf05_13_t1 ~ 1
bf05_18_t1 ~ 1
bf05_23_t1 ~ 1
bf05_28_t1 ~ 1
bf05_33_t1 ~ 1
bf05_38_t1 ~ 1
bf05_43_t1 ~ 1
bf05_48_t1 ~ 1
bf05_53_t1 ~ 1
bf05_58_t1 ~ 1

# Unique Variances
bf05_03_t1 ~~ bf05_03_t1
bf05_08_t1 ~~ bf05_08_t1
bf05_13_t1 ~~ bf05_13_t1
bf05_18_t1 ~~ bf05_18_t1
bf05_23_t1 ~~ bf05_23_t1
bf05_28_t1 ~~ bf05_28_t1
bf05_33_t1 ~~ bf05_33_t1
bf05_38_t1 ~~ bf05_38_t1
bf05_43_t1 ~~ bf05_43_t1
bf05_48_t1 ~~ bf05_48_t1
bf05_53_t1 ~~ bf05_53_t1
bf05_58_t1 ~~ bf05_58_t1

# Latent Variable Means
consc_curr1 ~ 0*1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
'
fit_cfa_consc_curr <- cfa(cfa_consc_curr, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_consc_curr, fit.measures = TRUE)
tidy(fit_cfa_consc_curr) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf05_03_t1_r = bf05_03_t1,
         bf05_23_t1_r = bf05_23_t1,
         bf05_48_t1_r = bf05_48_t1,
         bf05_08_t1_r = bf05_08_t1,
         bf05_28_t1_r = bf05_28_t1,
         bf05_58_t1_r = bf05_58_t1,
         bf05_03_t2_r = bf05_03_t2,
         bf05_23_t2_r = bf05_23_t2,
         bf05_48_t2_r = bf05_48_t2,
         bf05_08_t2_r = bf05_08_t2,
         bf05_28_t2_r = bf05_28_t2,
         bf05_58_t2_r = bf05_58_t2,
         bf05_03_t3_r = bf05_03_t3,
         bf05_23_t3_r = bf05_23_t3,
         bf05_48_t3_r = bf05_48_t3,
         bf05_08_t3_r = bf05_08_t3,
         bf05_28_t3_r = bf05_28_t3,
         bf05_58_t3_r = bf05_58_t3) %>% 
  mutate(across(c(bf05_03_t1_r, bf05_23_t1_r, bf05_48_t1_r, bf05_08_t1_r, bf05_28_t1_r, bf05_58_t1_r,
                  bf05_03_t2_r, bf05_23_t2_r, bf05_48_t2_r, bf05_08_t2_r, bf05_28_t2_r, bf05_58_t2_r,
                  bf05_03_t3_r, bf05_23_t3_r, bf05_48_t3_r, bf05_08_t3_r, bf05_28_t3_r, bf05_58_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(consc_curr_par1_t1 = rowMeans(across(c(bf05_03_t1_r, bf05_28_t1_r, bf05_38_t1, bf05_13_t1)), na.rm=T),
         consc_curr_par2_t1 = rowMeans(across(c(bf05_08_t1_r, bf05_18_t1, bf05_58_t1_r, bf05_43_t1)), na.rm=T),
         consc_curr_par3_t1 = rowMeans(across(c(bf05_23_t1_r, bf05_33_t1, bf05_48_t1_r, bf05_53_t1)), na.rm=T),
         consc_curr_par1_t2 = rowMeans(across(c(bf05_03_t2_r, bf05_28_t2_r, bf05_38_t2, bf05_13_t2)), na.rm=T),
         consc_curr_par2_t2 = rowMeans(across(c(bf05_08_t2_r, bf05_18_t2, bf05_58_t2_r, bf05_43_t2)), na.rm=T),
         consc_curr_par3_t2 = rowMeans(across(c(bf05_23_t2_r, bf05_33_t2, bf05_48_t2_r, bf05_53_t2)), na.rm=T),
         consc_curr_par1_t3 = rowMeans(across(c(bf05_03_t3_r, bf05_28_t3_r, bf05_38_t3, bf05_13_t3)), na.rm=T),
         consc_curr_par2_t3 = rowMeans(across(c(bf05_08_t3_r, bf05_18_t3, bf05_58_t3_r, bf05_43_t3)), na.rm=T),
         consc_curr_par3_t3 = rowMeans(across(c(bf05_23_t3_r, bf05_33_t3, bf05_48_t3_r, bf05_53_t3)), na.rm=T))
```

#### Conscientiousness - ideal personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*bf06_03_t1 + lambda1*bf06_03_t1 + lambda2*bf06_08_t1 + lambda3*bf06_13_t1 + lambda4*bf06_18_t1 + lambda5*bf06_23_t1 + lambda6*bf06_28_t1 + lambda7*bf06_33_t1 + lambda8*bf06_38_t1 + lambda9*bf06_43_t1 + lambda10*bf06_48_t1 + lambda11*bf06_53_t1 + lambda12*bf06_58_t1
# Intercepts
bf06_03_t1 ~ i1*1
bf06_08_t1 ~ 1
bf06_13_t1 ~ 1
bf06_18_t1 ~ 1
bf06_23_t1 ~ 1
bf06_28_t1 ~ 1
bf06_33_t1 ~ 1
bf06_38_t1 ~ 1
bf06_43_t1 ~ 1
bf06_48_t1 ~ 1
bf06_53_t1 ~ 1
bf06_58_t1 ~ 1

# Unique Variances
bf06_03_t1 ~~ bf06_03_t1
bf06_08_t1 ~~ bf06_08_t1
bf06_13_t1 ~~ bf06_13_t1
bf06_18_t1 ~~ bf06_18_t1
bf06_23_t1 ~~ bf06_23_t1
bf06_28_t1 ~~ bf06_28_t1
bf06_33_t1 ~~ bf06_33_t1
bf06_38_t1 ~~ bf06_38_t1
bf06_43_t1 ~~ bf06_43_t1
bf06_48_t1 ~~ bf06_48_t1
bf06_53_t1 ~~ bf06_53_t1
bf06_58_t1 ~~ bf06_58_t1

# Latent Variable Means
consc_ideal1 ~ 0*1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
'
fit_cfa_consc_ideal <- cfa(cfa_consc_ideal, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_consc_ideal, fit.measures = TRUE)
tidy(fit_cfa_consc_ideal) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf06_03_t1_r = bf06_03_t1,
         bf06_23_t1_r = bf06_23_t1,
         bf06_48_t1_r = bf06_48_t1,
         bf06_08_t1_r = bf06_08_t1,
         bf06_28_t1_r = bf06_28_t1,
         bf06_58_t1_r = bf06_58_t1,
         bf06_03_t2_r = bf06_03_t2,
         bf06_23_t2_r = bf06_23_t2,
         bf06_48_t2_r = bf06_48_t2,
         bf06_08_t2_r = bf06_08_t2,
         bf06_28_t2_r = bf06_28_t2,
         bf06_58_t2_r = bf06_58_t2,
         bf06_03_t3_r = bf06_03_t3,
         bf06_23_t3_r = bf06_23_t3,
         bf06_48_t3_r = bf06_48_t3,
         bf06_08_t3_r = bf06_08_t3,
         bf06_28_t3_r = bf06_28_t3,
         bf06_58_t3_r = bf06_58_t3) %>% 
  mutate(across(c(bf06_03_t1_r, bf06_23_t1_r, bf06_48_t1_r, bf06_08_t1_r, bf06_28_t1_r, bf06_58_t1_r,
                  bf06_03_t2_r, bf06_23_t2_r, bf06_48_t2_r, bf06_08_t2_r, bf06_28_t2_r, bf06_58_t2_r,
                  bf06_03_t3_r, bf06_23_t3_r, bf06_48_t3_r, bf06_08_t3_r, bf06_28_t3_r, bf06_58_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(consc_ideal_par1_t1 = rowMeans(across(c(bf06_28_t1_r, bf06_53_t1, bf06_18_t1, bf06_13_t1)), na.rm=T),
         consc_ideal_par2_t1 = rowMeans(across(c(bf06_58_t1_r, bf06_03_t1_r, bf06_48_t1_r, bf06_33_t1)), na.rm=T),
         consc_ideal_par3_t1 = rowMeans(across(c(bf06_23_t1_r, bf06_38_t1, bf06_43_t1, bf06_08_t1_r)), na.rm=T),
         consc_ideal_par1_t2 = rowMeans(across(c(bf06_28_t2_r, bf06_53_t2, bf06_18_t2, bf06_13_t2)), na.rm=T),
         consc_ideal_par2_t2 = rowMeans(across(c(bf06_58_t2_r, bf06_03_t2_r, bf06_48_t2_r, bf06_33_t2)), na.rm=T),
         consc_ideal_par3_t2 = rowMeans(across(c(bf06_23_t2_r, bf06_38_t2, bf06_43_t2, bf06_08_t2_r)), na.rm=T),
         consc_ideal_par1_t3 = rowMeans(across(c(bf06_28_t3_r, bf06_53_t3, bf06_18_t3, bf06_13_t3)), na.rm=T),
         consc_ideal_par2_t3 = rowMeans(across(c(bf06_58_t3_r, bf06_03_t3_r, bf06_48_t3_r, bf06_33_t3)), na.rm=T),
         consc_ideal_par3_t3 = rowMeans(across(c(bf06_23_t3_r, bf06_38_t3, bf06_43_t3, bf06_08_t3_r)), na.rm=T))
```

#### Neuroticism - current personality

Check CFA item loadings at T1
```{r}
#| echo: true
cfa_neuro_curr <- '
#| warning: false

# Define the latent factors
neuro_curr1 =~ NA*bf05_04_t1 + lambda1*bf05_04_t1 + lambda2*bf05_09_t1 + lambda3*bf05_14_t1 + lambda4*bf05_19_t1 + lambda5*bf05_24_t1 + lambda6*bf05_29_t1 + lambda7*bf05_34_t1 + lambda8*bf05_39_t1 + lambda9*bf05_44_t1 + lambda10*bf05_49_t1 + lambda11*bf05_54_t1 + lambda12*bf05_59_t1

# Intercepts
bf05_04_t1 ~ i1*1
bf05_09_t1 ~ 1
bf05_14_t1 ~ 1
bf05_19_t1 ~ 1
bf05_24_t1 ~ 1
bf05_29_t1 ~ 1
bf05_34_t1 ~ 1
bf05_39_t1 ~ 1
bf05_44_t1 ~ 1
bf05_49_t1 ~ 1
bf05_54_t1 ~ 1
bf05_59_t1 ~ 1

# Unique Variances
bf05_04_t1 ~~ bf05_04_t1
bf05_09_t1 ~~ bf05_09_t1
bf05_14_t1 ~~ bf05_14_t1
bf05_19_t1 ~~ bf05_19_t1
bf05_24_t1 ~~ bf05_24_t1
bf05_29_t1 ~~ bf05_29_t1
bf05_34_t1 ~~ bf05_34_t1
bf05_39_t1 ~~ bf05_39_t1
bf05_44_t1 ~~ bf05_44_t1
bf05_49_t1 ~~ bf05_49_t1
bf05_54_t1 ~~ bf05_54_t1
bf05_59_t1 ~~ bf05_59_t1

# Latent Variable Means
neuro_curr1 ~ 0*1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
'
fit_cfa_neuro_curr <- cfa(cfa_neuro_curr, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_neuro_curr, fit.measures = TRUE)
tidy(fit_cfa_neuro_curr) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf05_29_t1_r = bf05_29_t1,
         bf05_04_t1_r = bf05_04_t1,
         bf05_24_t1_r = bf05_24_t1,
         bf05_44_t1_r = bf05_44_t1,
         bf05_09_t1_r = bf05_09_t1,
         bf05_49_t1_r = bf05_49_t1,
         bf05_29_t2_r = bf05_29_t2,
         bf05_04_t2_r = bf05_04_t2,
         bf05_24_t2_r = bf05_24_t2,
         bf05_44_t2_r = bf05_44_t2,
         bf05_09_t2_r = bf05_09_t2,
         bf05_49_t2_r = bf05_49_t2,
         bf05_29_t3_r = bf05_29_t3,
         bf05_04_t3_r = bf05_04_t3,
         bf05_24_t3_r = bf05_24_t3,
         bf05_44_t3_r = bf05_44_t3,
         bf05_09_t3_r = bf05_09_t3,
         bf05_49_t3_r = bf05_49_t3) %>% 
  mutate(across(c(bf05_29_t1_r, bf05_04_t1_r, bf05_24_t1_r, bf05_44_t1_r, bf05_09_t1_r, bf05_49_t1_r, 
                  bf05_29_t2_r, bf05_04_t2_r, bf05_24_t2_r, bf05_44_t2_r, bf05_09_t2_r, bf05_49_t2_r, 
                  bf05_29_t3_r, bf05_04_t3_r, bf05_24_t3_r, bf05_44_t3_r, bf05_09_t3_r, bf05_49_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(neuro_curr_par1_t1 = rowMeans(across(c(bf05_54_t1, bf05_59_t1, bf05_09_t1_r, bf05_49_t1_r)), na.rm=T),
         neuro_curr_par2_t1 = rowMeans(across(c(bf05_39_t1, bf05_14_t1, bf05_44_t1_r, bf05_19_t1)), na.rm=T),
         neuro_curr_par3_t1 = rowMeans(across(c(bf05_29_t1_r, bf05_04_t1_r, bf05_34_t1, bf05_24_t1_r)), na.rm=T),
         neuro_curr_par1_t2 = rowMeans(across(c(bf05_54_t2, bf05_59_t2, bf05_09_t2_r, bf05_49_t2_r)), na.rm=T),
         neuro_curr_par2_t2 = rowMeans(across(c(bf05_39_t2, bf05_14_t2, bf05_44_t2_r, bf05_19_t2)), na.rm=T),
         neuro_curr_par3_t2 = rowMeans(across(c(bf05_29_t2_r, bf05_04_t2_r, bf05_34_t2, bf05_24_t2_r)), na.rm=T),
         neuro_curr_par1_t3 = rowMeans(across(c(bf05_54_t3, bf05_59_t3, bf05_09_t3_r, bf05_49_t3_r)), na.rm=T),
         neuro_curr_par2_t3 = rowMeans(across(c(bf05_39_t3, bf05_14_t3, bf05_44_t3_r, bf05_19_t3)), na.rm=T),
         neuro_curr_par3_t3 = rowMeans(across(c(bf05_29_t3_r, bf05_04_t3_r, bf05_34_t3, bf05_24_t3_r)), na.rm=T))
```

#### Neuroticism - ideal personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*bf06_04_t1 + lambda1*bf06_04_t1 + lambda2*bf06_09_t1 + lambda3*bf06_14_t1 + lambda4*bf06_19_t1 + lambda5*bf06_24_t1 + lambda6*bf06_29_t1 + lambda7*bf06_34_t1 + lambda8*bf06_39_t1 + lambda9*bf06_44_t1 + lambda10*bf06_49_t1 + lambda11*bf06_54_t1 + lambda12*bf06_59_t1

# Intercepts
bf06_04_t1 ~ i1*1
bf06_09_t1 ~ 1
bf06_14_t1 ~ 1
bf06_19_t1 ~ 1
bf06_24_t1 ~ 1
bf06_29_t1 ~ 1
bf06_34_t1 ~ 1
bf06_39_t1 ~ 1
bf06_44_t1 ~ 1
bf06_49_t1 ~ 1
bf06_54_t1 ~ 1
bf06_59_t1 ~ 1

# Unique Variances
bf06_04_t1 ~~ bf06_04_t1
bf06_09_t1 ~~ bf06_09_t1
bf06_14_t1 ~~ bf06_14_t1
bf06_19_t1 ~~ bf06_19_t1
bf06_24_t1 ~~ bf06_24_t1
bf06_29_t1 ~~ bf06_29_t1
bf06_34_t1 ~~ bf06_34_t1
bf06_39_t1 ~~ bf06_39_t1
bf06_44_t1 ~~ bf06_44_t1
bf06_49_t1 ~~ bf06_49_t1
bf06_54_t1 ~~ bf06_54_t1
bf06_59_t1 ~~ bf06_59_t1

# Latent Variable Means
neuro_ideal1 ~ 0*1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
'
fit_cfa_neuro_ideal <- cfa(cfa_neuro_ideal, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_neuro_ideal, fit.measures = TRUE)
tidy(fit_cfa_neuro_ideal) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf06_29_t1_r = bf06_29_t1,
         bf06_04_t1_r = bf06_04_t1,
         bf06_24_t1_r = bf06_24_t1,
         bf06_44_t1_r = bf06_44_t1,
         bf06_09_t1_r = bf06_09_t1,
         bf06_49_t1_r = bf06_49_t1,
         bf06_29_t2_r = bf06_29_t2,
         bf06_04_t2_r = bf06_04_t2,
         bf06_24_t2_r = bf06_24_t2,
         bf06_44_t2_r = bf06_44_t2,
         bf06_09_t2_r = bf06_09_t2,
         bf06_49_t2_r = bf06_49_t2,
         bf06_29_t3_r = bf06_29_t3,
         bf06_04_t3_r = bf06_04_t3,
         bf06_24_t3_r = bf06_24_t3,
         bf06_44_t3_r = bf06_44_t3,
         bf06_09_t3_r = bf06_09_t3,
         bf06_49_t3_r = bf06_49_t3) %>% 
  mutate(across(c(bf06_29_t1_r, bf06_04_t1_r, bf06_24_t1_r, bf06_44_t1_r, bf06_09_t1_r, bf06_49_t1_r, 
                  bf06_29_t2_r, bf06_04_t2_r, bf06_24_t2_r, bf06_44_t2_r, bf06_09_t2_r, bf06_49_t2_r, 
                  bf06_29_t3_r, bf06_04_t3_r, bf06_24_t3_r, bf06_44_t3_r, bf06_09_t3_r, bf06_49_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(neuro_ideal_par1_t1 = rowMeans(across(c(bf06_34_t1, bf06_59_t1, bf06_29_t1_r, bf06_04_t1_r)), na.rm=T),
         neuro_ideal_par2_t1 = rowMeans(across(c(bf06_54_t1, bf06_14_t1, bf06_09_t1_r, bf06_49_t1_r)), na.rm=T),
         neuro_ideal_par3_t1 = rowMeans(across(c(bf06_19_t1, bf06_39_t1, bf06_44_t1_r, bf06_24_t1_r)), na.rm=T),
         neuro_ideal_par1_t2 = rowMeans(across(c(bf06_34_t2, bf06_59_t2, bf06_29_t2_r, bf06_04_t2_r)), na.rm=T),
         neuro_ideal_par2_t2 = rowMeans(across(c(bf06_54_t2, bf06_14_t2, bf06_09_t2_r, bf06_49_t2_r)), na.rm=T),
         neuro_ideal_par3_t2 = rowMeans(across(c(bf06_19_t2, bf06_39_t2, bf06_44_t2_r, bf06_24_t2_r)), na.rm=T),
         neuro_ideal_par1_t3 = rowMeans(across(c(bf06_34_t3, bf06_59_t3, bf06_29_t3_r, bf06_04_t3_r)), na.rm=T),
         neuro_ideal_par2_t3 = rowMeans(across(c(bf06_54_t3, bf06_14_t3, bf06_09_t3_r, bf06_49_t3_r)), na.rm=T),
         neuro_ideal_par3_t3 = rowMeans(across(c(bf06_19_t3, bf06_39_t3, bf06_44_t3_r, bf06_24_t3_r)), na.rm=T))
```

#### Openness - current personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*bf05_05_t1 + lambda1*bf05_05_t1 + lambda2*bf05_10_t1 + lambda3*bf05_15_t1 + lambda4*bf05_20_t1 + lambda5*bf05_25_t1 + lambda6*bf05_30_t1 + lambda7*bf05_35_t1 + lambda8*bf05_40_t1 + lambda9*bf05_45_t1 + lambda10*bf05_50_t1 + lambda11*bf05_55_t1 + lambda12*bf05_60_t1

# Intercepts
bf05_05_t1 ~ i1*1
bf05_10_t1 ~ 1
bf05_15_t1 ~ 1
bf05_20_t1 ~ 1
bf05_25_t1 ~ 1
bf05_30_t1 ~ 1
bf05_35_t1 ~ 1
bf05_40_t1 ~ 1
bf05_45_t1 ~ 1
bf05_50_t1 ~ 1
bf05_55_t1 ~ 1
bf05_60_t1 ~ 1

# Unique Variances
bf05_05_t1 ~~ bf05_05_t1
bf05_10_t1 ~~ bf05_10_t1
bf05_15_t1 ~~ bf05_15_t1
bf05_20_t1 ~~ bf05_20_t1
bf05_25_t1 ~~ bf05_25_t1
bf05_30_t1 ~~ bf05_30_t1
bf05_35_t1 ~~ bf05_35_t1
bf05_40_t1 ~~ bf05_40_t1
bf05_45_t1 ~~ bf05_45_t1
bf05_50_t1 ~~ bf05_50_t1
bf05_55_t1 ~~ bf05_55_t1
bf05_60_t1 ~~ bf05_60_t1

# Latent Variable Means
openn_curr1 ~ 0*1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
'
fit_cfa_openn_curr <- cfa(cfa_openn_curr, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_openn_curr, fit.measures = TRUE)
tidy(fit_cfa_openn_curr) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf05_50_t1_r = bf05_50_t1,
         bf05_55_t1_r = bf05_55_t1,
         bf05_30_t1_r = bf05_30_t1,
         bf05_25_t1_r = bf05_25_t1,
         bf05_45_t1_r = bf05_45_t1,
         bf05_05_t1_r = bf05_05_t1,
         bf05_50_t2_r = bf05_50_t2,
         bf05_55_t2_r = bf05_55_t2,
         bf05_30_t2_r = bf05_30_t2,
         bf05_25_t2_r = bf05_25_t2,
         bf05_45_t2_r = bf05_45_t2,
         bf05_05_t2_r = bf05_05_t2,
         bf05_50_t3_r = bf05_50_t3,
         bf05_55_t3_r = bf05_55_t3,
         bf05_30_t3_r = bf05_30_t3,
         bf05_25_t3_r = bf05_25_t3,
         bf05_45_t3_r = bf05_45_t3,
         bf05_05_t3_r = bf05_05_t3) %>% 
  mutate(across(c(bf05_50_t1_r, bf05_55_t1_r, bf05_30_t1_r, bf05_25_t1_r, bf05_45_t1_r, bf05_05_t1_r,
                  bf05_50_t2_r, bf05_55_t2_r, bf05_30_t2_r, bf05_25_t2_r, bf05_45_t2_r, bf05_05_t2_r,
                  bf05_50_t3_r, bf05_55_t3_r, bf05_30_t3_r, bf05_25_t3_r, bf05_45_t3_r, bf05_05_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(openn_curr_par1_t1 = rowMeans(across(c(bf05_20_t1, bf05_60_t1, bf05_25_t1_r, bf05_05_t1_r)), na.rm=T),
         openn_curr_par2_t1 = rowMeans(across(c(bf05_50_t1_r, bf05_30_t1_r, bf05_45_t1_r, bf05_10_t1)), na.rm=T),
         openn_curr_par3_t1 = rowMeans(across(c(bf05_35_t1, bf05_55_t1_r, bf05_40_t1, bf05_15_t1)), na.rm=T),
         openn_curr_par1_t2 = rowMeans(across(c(bf05_20_t2, bf05_60_t2, bf05_25_t2_r, bf05_05_t2_r)), na.rm=T),
         openn_curr_par2_t2 = rowMeans(across(c(bf05_50_t2_r, bf05_30_t2_r, bf05_45_t2_r, bf05_10_t2)), na.rm=T),
         openn_curr_par3_t2 = rowMeans(across(c(bf05_35_t2, bf05_55_t2_r, bf05_40_t2, bf05_15_t2)), na.rm=T),
         openn_curr_par1_t3 = rowMeans(across(c(bf05_20_t3, bf05_60_t3, bf05_25_t3_r, bf05_05_t3_r)), na.rm=T),
         openn_curr_par2_t3 = rowMeans(across(c(bf05_50_t3_r, bf05_30_t3_r, bf05_45_t3_r, bf05_10_t3)), na.rm=T),
         openn_curr_par3_t3 = rowMeans(across(c(bf05_35_t3, bf05_55_t3_r, bf05_40_t3, bf05_15_t3)), na.rm=T))
```

#### Openness - ideal personality

Check CFA item loadings at T1
```{r}
#| echo: true
#| warning: false

cfa_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*bf06_05_t1 + lambda1*bf06_05_t1 + lambda2*bf06_10_t1 + lambda3*bf06_15_t1 + lambda4*bf06_20_t1 + lambda5*bf06_25_t1 + lambda6*bf06_30_t1 + lambda7*bf06_35_t1 + lambda8*bf06_40_t1 + lambda9*bf06_45_t1 + lambda10*bf06_50_t1 + lambda11*bf06_55_t1 + lambda12*bf06_60_t1

# Intercepts
bf06_05_t1 ~ i1*1
bf06_10_t1 ~ 1
bf06_15_t1 ~ 1
bf06_20_t1 ~ 1
bf06_25_t1 ~ 1
bf06_30_t1 ~ 1
bf06_35_t1 ~ 1
bf06_40_t1 ~ 1
bf06_45_t1 ~ 1
bf06_50_t1 ~ 1
bf06_55_t1 ~ 1
bf06_60_t1 ~ 1

# Unique Variances
bf06_05_t1 ~~ bf06_05_t1
bf06_10_t1 ~~ bf06_10_t1
bf06_15_t1 ~~ bf06_15_t1
bf06_20_t1 ~~ bf06_20_t1
bf06_25_t1 ~~ bf06_25_t1
bf06_30_t1 ~~ bf06_30_t1
bf06_35_t1 ~~ bf06_35_t1
bf06_40_t1 ~~ bf06_40_t1
bf06_45_t1 ~~ bf06_45_t1
bf06_50_t1 ~~ bf06_50_t1
bf06_55_t1 ~~ bf06_55_t1
bf06_60_t1 ~~ bf06_60_t1

# Latent Variable Means
openn_ideal1 ~ 0*1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
'
fit_cfa_openn_ideal <- cfa(cfa_openn_ideal, data = df_sbsa2_wide_pers, mimic = "mplus", missing="ML")
summary(fit_cfa_openn_ideal, fit.measures = TRUE)
tidy(fit_cfa_openn_ideal) %>% filter(str_detect(label, "lambda")) %>% mutate(abs_loading = abs(estimate)) %>% arrange(desc(abs_loading)) %>% select(1:5, std.all)
```

Reverse-code and form parcels:
```{r}
#| echo: true
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
  mutate(bf06_50_t1_r = bf06_50_t1,
         bf06_55_t1_r = bf06_55_t1,
         bf06_30_t1_r = bf06_30_t1,
         bf06_25_t1_r = bf06_25_t1,
         bf06_45_t1_r = bf06_45_t1,
         bf06_05_t1_r = bf06_05_t1,
         bf06_50_t2_r = bf06_50_t2,
         bf06_55_t2_r = bf06_55_t2,
         bf06_30_t2_r = bf06_30_t2,
         bf06_25_t2_r = bf06_25_t2,
         bf06_45_t2_r = bf06_45_t2,
         bf06_05_t2_r = bf06_05_t2,
         bf06_50_t3_r = bf06_50_t3,
         bf06_55_t3_r = bf06_55_t3,
         bf06_30_t3_r = bf06_30_t3,
         bf06_25_t3_r = bf06_25_t3,
         bf06_45_t3_r = bf06_45_t3,
         bf06_05_t3_r = bf06_05_t3) %>% 
  mutate(across(c(bf06_50_t1_r, bf06_55_t1_r, bf06_30_t1_r, bf06_25_t1_r, bf06_45_t1_r, bf06_05_t1_r,
                  bf06_50_t2_r, bf06_55_t2_r, bf06_30_t2_r, bf06_25_t2_r, bf06_45_t2_r, bf06_05_t2_r,
                  bf06_50_t3_r, bf06_55_t3_r, bf06_30_t3_r, bf06_25_t3_r, bf06_45_t3_r, bf06_05_t3_r), 
                ~ recode(.x, `1` = 5L, `2` = 4L, `3` = 3L, `4` = 2L, `5` = 1L, .default = NA_integer_))) %>% 
  mutate(openn_ideal_par1_t1 = rowMeans(across(c(bf06_50_t1_r, bf06_25_t1_r, bf06_60_t1, bf06_05_t1)), na.rm=T),
         openn_ideal_par2_t1 = rowMeans(across(c(bf06_30_t1_r, bf06_35_t1, bf06_40_t1, bf06_15_t1)), na.rm=T),
         openn_ideal_par3_t1 = rowMeans(across(c(bf06_55_t1_r, bf06_20_t1, bf06_45_t1_r, bf06_10_t1)), na.rm=T),
         openn_ideal_par1_t2 = rowMeans(across(c(bf06_50_t2_r, bf06_25_t2_r, bf06_60_t2, bf06_05_t2)), na.rm=T),
         openn_ideal_par2_t2 = rowMeans(across(c(bf06_30_t2_r, bf06_35_t2, bf06_40_t2, bf06_15_t2)), na.rm=T),
         openn_ideal_par3_t2 = rowMeans(across(c(bf06_55_t2_r, bf06_20_t2, bf06_45_t2_r, bf06_10_t2)), na.rm=T),
         openn_ideal_par1_t3 = rowMeans(across(c(bf06_50_t3_r, bf06_25_t3_r, bf06_60_t3, bf06_05_t3)), na.rm=T),
         openn_ideal_par2_t3 = rowMeans(across(c(bf06_30_t3_r, bf06_35_t3, bf06_40_t3, bf06_15_t3)), na.rm=T),
         openn_ideal_par3_t3 = rowMeans(across(c(bf06_55_t3_r, bf06_20_t3, bf06_45_t3_r, bf06_10_t3)), na.rm=T))

# replace NaN with regular NA
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% 
    mutate_all(~ifelse(is.nan(.), NA, .))
```

### Recode all reverse-keyed items

This is only relevant for the facet-level models. All trait-level models rely on the parcels created above. However, the facet-level models pick the first item as the anchor indicator which is sometimes reverse-keyed for the latent factor. For analyses below I want to use just positively keyed variables (for neuroticism facets higher values should indicate higher neuroticism). 

```{r}
#| echo: true
#| warning: false

# save all relevant variable names
names_rev_scored <- df_sbsa2_wide_pers %>% select(ends_with("_r")) %>% colnames()
names_rev_scored_orig <- gsub("_r", "", names_rev_scored) # variable names without the "_r" -> these are the original variables

# drop original variables
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% select(-all_of(names_rev_scored_orig))
# recreate original variable names -> these are the recoded variables now!
df_sbsa2_wide_pers <- df_sbsa2_wide_pers %>% rename_with(~ gsub("_r", "", .x))
```

------------------------------------------------------------------------

## Measurement invariance

### Well-being outcomes

Testing for measurement invariance of the latent traits across time. Only doing this for the two (original) intervention groups for now, not for the waitlist control group, because they had different intervention schedules and our main focus lies on testing changes in the intervention groups.  

#### Life satisfaction

Satisfaction with life scale (only the first four items - last one taps into a somewhat different construct)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_swls <- '
# Define the latent factors
swls1 =~ NA*sw06_01_t1 + lambda1*sw06_01_t1 + sw06_02_t1 + sw06_03_t1 + sw06_04_t1
swls2 =~ NA*sw06_01_t2 + lambda1*sw06_01_t2 + sw06_02_t2 + sw06_03_t2 + sw06_04_t2
swls3 =~ NA*sw06_01_t3 + lambda1*sw06_01_t3 + sw06_02_t3 + sw06_03_t3 + sw06_04_t3

# Intercepts
sw06_01_t1 ~ i1*1
sw06_02_t1 ~ 1
sw06_03_t1 ~ 1
sw06_04_t1 ~ 1

sw06_01_t2 ~ i1*1
sw06_02_t2 ~ 1
sw06_03_t2 ~ 1
sw06_04_t2 ~ 1

sw06_01_t3 ~ i1*1
sw06_02_t3 ~ 1
sw06_03_t3 ~ 1
sw06_04_t3 ~ 1

# Unique Variances
sw06_01_t1 ~~ sw06_01_t1
sw06_02_t1 ~~ sw06_02_t1
sw06_03_t1 ~~ sw06_03_t1
sw06_04_t1 ~~ sw06_04_t1

sw06_01_t2 ~~ sw06_01_t2
sw06_02_t2 ~~ sw06_02_t2
sw06_03_t2 ~~ sw06_03_t2
sw06_04_t2 ~~ sw06_04_t2

sw06_01_t3 ~~ sw06_01_t3
sw06_02_t3 ~~ sw06_02_t3
sw06_03_t3 ~~ sw06_03_t3
sw06_04_t3 ~~ sw06_04_t3

# Latent Variable Means
swls1 ~ 0*1
swls2 ~ 1
swls3 ~ 1

# Latent Variable Variances and Covariance
swls1 ~~ 1*swls1
swls2 ~~ swls2
swls3 ~~ swls3
swls1 ~~ swls2
swls1 ~~ swls3
swls2 ~~ swls3
'
fit_configural_swls <- cfa(configural_swls, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_configural_swls, fit.measures = TRUE)

# Weak invariance model
weak_swls <- '
# Define the latent factors
swls1 =~ NA*sw06_01_t1 + lambda1*sw06_01_t1 + lambda2*sw06_02_t1 + lambda3*sw06_03_t1 + lambda4*sw06_04_t1
swls2 =~ NA*sw06_01_t2 + lambda1*sw06_01_t2 + lambda2*sw06_02_t2 + lambda3*sw06_03_t2 + lambda4*sw06_04_t2
swls3 =~ NA*sw06_01_t3 + lambda1*sw06_01_t3 + lambda2*sw06_02_t3 + lambda3*sw06_03_t3 + lambda4*sw06_04_t3

# Intercepts
sw06_01_t1 ~ i1*1
sw06_02_t1 ~ 1
sw06_03_t1 ~ 1
sw06_04_t1 ~ 1

sw06_01_t2 ~ i1*1
sw06_02_t2 ~ 1
sw06_03_t2 ~ 1
sw06_04_t2 ~ 1

sw06_01_t3 ~ i1*1
sw06_02_t3 ~ 1
sw06_03_t3 ~ 1
sw06_04_t3 ~ 1

# Unique Variances
sw06_01_t1 ~~ sw06_01_t1
sw06_02_t1 ~~ sw06_02_t1
sw06_03_t1 ~~ sw06_03_t1
sw06_04_t1 ~~ sw06_04_t1

sw06_01_t2 ~~ sw06_01_t2
sw06_02_t2 ~~ sw06_02_t2
sw06_03_t2 ~~ sw06_03_t2
sw06_04_t2 ~~ sw06_04_t2

sw06_01_t3 ~~ sw06_01_t3
sw06_02_t3 ~~ sw06_02_t3
sw06_03_t3 ~~ sw06_03_t3
sw06_04_t3 ~~ sw06_04_t3

# Latent Variable Means
swls1 ~ 0*1
swls2 ~ 1
swls3 ~ 1

# Latent Variable Variances and Covariance
swls1 ~~ 1*swls1
swls2 ~~ swls2
swls3 ~~ swls3
swls1 ~~ swls2
swls1 ~~ swls3
swls2 ~~ swls3
'
fit_weak_swls <- cfa(weak_swls, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_weak_swls, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_swls <- '
# Define the latent factors
swls1 =~ NA*sw06_01_t1 + lambda1*sw06_01_t1 + lambda2*sw06_02_t1 + lambda3*sw06_03_t1 + lambda4*sw06_04_t1
swls2 =~ NA*sw06_01_t2 + lambda1*sw06_01_t2 + lambda2*sw06_02_t2 + lambda3*sw06_03_t2 + lambda4*sw06_04_t2
swls3 =~ NA*sw06_01_t3 + lambda1*sw06_01_t3 + lambda2*sw06_02_t3 + lambda3*sw06_03_t3 + lambda4*sw06_04_t3

# Intercepts
sw06_01_t1 ~ i1*1
sw06_02_t1 ~ i2*1
sw06_03_t1 ~ i3*1
sw06_04_t1 ~ i4*1

sw06_01_t2 ~ i1*1
sw06_02_t2 ~ i2*1
sw06_03_t2 ~ i3*1
sw06_04_t2 ~ i4*1

sw06_01_t3 ~ i1*1
sw06_02_t3 ~ i2*1
sw06_03_t3 ~ i3*1
sw06_04_t3 ~ i4*1

# Unique Variances
sw06_01_t1 ~~ sw06_01_t1
sw06_02_t1 ~~ sw06_02_t1
sw06_03_t1 ~~ sw06_03_t1
sw06_04_t1 ~~ sw06_04_t1

sw06_01_t2 ~~ sw06_01_t2
sw06_02_t2 ~~ sw06_02_t2
sw06_03_t2 ~~ sw06_03_t2
sw06_04_t2 ~~ sw06_04_t2

sw06_01_t3 ~~ sw06_01_t3
sw06_02_t3 ~~ sw06_02_t3
sw06_03_t3 ~~ sw06_03_t3
sw06_04_t3 ~~ sw06_04_t3

# Latent Variable Means
swls1 ~ 0*1
swls2 ~ 1
swls3 ~ 1

# Latent Variable Variances and Covariance
swls1 ~~ 1*swls1
swls2 ~~ swls2
swls3 ~~ swls3
swls1 ~~ swls2
swls1 ~~ swls3
swls2 ~~ swls3
'
fit_strong_swls <- cfa(strong_swls, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strong_swls, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_swls <- '
# Define the latent factors
swls1 =~ NA*sw06_01_t1 + lambda1*sw06_01_t1 + lambda2*sw06_02_t1 + lambda3*sw06_03_t1 + lambda4*sw06_04_t1
swls2 =~ NA*sw06_01_t2 + lambda1*sw06_01_t2 + lambda2*sw06_02_t2 + lambda3*sw06_03_t2 + lambda4*sw06_04_t2
swls3 =~ NA*sw06_01_t3 + lambda1*sw06_01_t3 + lambda2*sw06_02_t3 + lambda3*sw06_03_t3 + lambda4*sw06_04_t3

# Intercepts
sw06_01_t1 ~ i1*1
sw06_02_t1 ~ i2*1
sw06_03_t1 ~ i3*1
sw06_04_t1 ~ i4*1

sw06_01_t2 ~ i1*1
sw06_02_t2 ~ i2*1
sw06_03_t2 ~ i3*1
sw06_04_t2 ~ i4*1

sw06_01_t3 ~ i1*1
sw06_02_t3 ~ i2*1
sw06_03_t3 ~ i3*1
sw06_04_t3 ~ i4*1

# Unique Variances
sw06_01_t1 ~~ u1*sw06_01_t1
sw06_02_t1 ~~ u2*sw06_02_t1
sw06_03_t1 ~~ u3*sw06_03_t1
sw06_04_t1 ~~ u4*sw06_04_t1

sw06_01_t2 ~~ u1*sw06_01_t2
sw06_02_t2 ~~ u2*sw06_02_t2
sw06_03_t2 ~~ u3*sw06_03_t2
sw06_04_t2 ~~ u4*sw06_04_t2

sw06_01_t3 ~~ u1*sw06_01_t3
sw06_02_t3 ~~ u2*sw06_02_t3
sw06_03_t3 ~~ u3*sw06_03_t3
sw06_04_t3 ~~ u4*sw06_04_t3

# Latent Variable Means
swls1 ~ 0*1
swls2 ~ 1
swls3 ~ 1

# Latent Variable Variances and Covariance
swls1 ~~ 1*swls1
swls2 ~~ swls2
swls3 ~~ swls3
swls1 ~~ swls2
swls2 ~~ swls3
swls1 ~~ swls3
'
fit_strict_swls <- cfa(strict_swls, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strict_swls, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_swls) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_swls) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_swls) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_swls) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_swls, fit_weak_swls)

anova(fit_weak_swls, fit_strong_swls)

anova(fit_strong_swls, fit_strict_swls)
```

::: {.callout-note appearance="minimal"}
Model fit relatively similar across model specifications. Chi^2 tests indicate that strong measurement invariance is given.
:::

#### Meaning in life

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_meaning <- '
# Define the latent factors
meaning1 =~ NA*meaning_par1_t1 + lambda1*meaning_par1_t1 + meaning_par2_t1 + meaning_par3_t1
meaning2 =~ NA*meaning_par1_t2 + lambda1*meaning_par1_t2 + meaning_par2_t2 + meaning_par3_t2
meaning3 =~ NA*meaning_par1_t3 + lambda1*meaning_par1_t3 + meaning_par2_t3 + meaning_par3_t3

# Intercepts
meaning_par1_t1 ~ i1*1
meaning_par2_t1 ~ 1
meaning_par3_t1 ~ 1

meaning_par1_t2 ~ i1*1
meaning_par2_t2 ~ 1
meaning_par3_t2 ~ 1

meaning_par1_t3 ~ i1*1
meaning_par2_t3 ~ 1
meaning_par3_t3 ~ 1

# Unique Variances
meaning_par1_t1 ~~ meaning_par1_t1
meaning_par2_t1 ~~ meaning_par2_t1
meaning_par3_t1 ~~ meaning_par3_t1

meaning_par1_t2 ~~ meaning_par1_t2
meaning_par2_t2 ~~ meaning_par2_t2
meaning_par3_t2 ~~ meaning_par3_t2

meaning_par1_t3 ~~ meaning_par1_t3
meaning_par2_t3 ~~ meaning_par2_t3
meaning_par3_t3 ~~ meaning_par3_t3

# Latent Variable Means
meaning1 ~ 0*1
meaning2 ~ 1
meaning3 ~ 1

# Latent Variable Variances and Covariance
meaning1 ~~ 1*meaning1
meaning2 ~~ meaning2
meaning3 ~~ meaning3
meaning1 ~~ meaning2
meaning2 ~~ meaning3
meaning1 ~~ meaning3
'
fit_configural_meaning <- cfa(configural_meaning, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_configural_meaning, fit.measures = TRUE)

# Weak invariance model
weak_meaning <- '
# Define the latent factors
meaning1 =~ NA*meaning_par1_t1 + lambda1*meaning_par1_t1 + lambda2*meaning_par2_t1 + lambda3*meaning_par3_t1
meaning2 =~ NA*meaning_par1_t2 + lambda1*meaning_par1_t2 + lambda2*meaning_par2_t2 + lambda3*meaning_par3_t2
meaning3 =~ NA*meaning_par1_t3 + lambda1*meaning_par1_t3 + lambda2*meaning_par2_t3 + lambda3*meaning_par3_t3

# Intercepts
meaning_par1_t1 ~ i1*1
meaning_par2_t1 ~ 1
meaning_par3_t1 ~ 1

meaning_par1_t2 ~ i1*1
meaning_par2_t2 ~ 1
meaning_par3_t2 ~ 1

meaning_par1_t3 ~ i1*1
meaning_par2_t3 ~ 1
meaning_par3_t3 ~ 1

# Unique Variances
meaning_par1_t1 ~~ meaning_par1_t1
meaning_par2_t1 ~~ meaning_par2_t1
meaning_par3_t1 ~~ meaning_par3_t1

meaning_par1_t2 ~~ meaning_par1_t2
meaning_par2_t2 ~~ meaning_par2_t2
meaning_par3_t2 ~~ meaning_par3_t2

meaning_par1_t3 ~~ meaning_par1_t3
meaning_par2_t3 ~~ meaning_par2_t3
meaning_par3_t3 ~~ meaning_par3_t3

# Latent Variable Means
meaning1 ~ 0*1
meaning2 ~ 1
meaning3 ~ 1

# Latent Variable Variances and Covariance
meaning1 ~~ 1*meaning1
meaning2 ~~ meaning2
meaning3 ~~ meaning3
meaning1 ~~ meaning2
meaning2 ~~ meaning3
meaning1 ~~ meaning3
'
fit_weak_meaning <- cfa(weak_meaning, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_weak_meaning, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_meaning <- '
# Define the latent factors
meaning1 =~ NA*meaning_par1_t1 + lambda1*meaning_par1_t1 + lambda2*meaning_par2_t1 + lambda3*meaning_par3_t1
meaning2 =~ NA*meaning_par1_t2 + lambda1*meaning_par1_t2 + lambda2*meaning_par2_t2 + lambda3*meaning_par3_t2
meaning3 =~ NA*meaning_par1_t3 + lambda1*meaning_par1_t3 + lambda2*meaning_par2_t3 + lambda3*meaning_par3_t3

# Intercepts
meaning_par1_t1 ~ i1*1
meaning_par2_t1 ~ i2*1
meaning_par3_t1 ~ i3*1

meaning_par1_t2 ~ i1*1
meaning_par2_t2 ~ i2*1
meaning_par3_t2 ~ i3*1

meaning_par1_t3 ~ i1*1
meaning_par2_t3 ~ i2*1
meaning_par3_t3 ~ i3*1

# Unique Variances
meaning_par1_t1 ~~ meaning_par1_t1
meaning_par2_t1 ~~ meaning_par2_t1
meaning_par3_t1 ~~ meaning_par3_t1

meaning_par1_t2 ~~ meaning_par1_t2
meaning_par2_t2 ~~ meaning_par2_t2
meaning_par3_t2 ~~ meaning_par3_t2

meaning_par1_t3 ~~ meaning_par1_t3
meaning_par2_t3 ~~ meaning_par2_t3
meaning_par3_t3 ~~ meaning_par3_t3

# Latent Variable Means
meaning1 ~ 0*1
meaning2 ~ 1
meaning3 ~ 1

# Latent Variable Variances and Covariance
meaning1 ~~ 1*meaning1
meaning2 ~~ meaning2
meaning3 ~~ meaning3
meaning1 ~~ meaning2
meaning1 ~~ meaning3
meaning2 ~~ meaning3
'
fit_strong_meaning <- cfa(strong_meaning, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strong_meaning, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_meaning <- '
# Define the latent factors
meaning1 =~ NA*meaning_par1_t1 + lambda1*meaning_par1_t1 + lambda2*meaning_par2_t1 + lambda3*meaning_par3_t1
meaning2 =~ NA*meaning_par1_t2 + lambda1*meaning_par1_t2 + lambda2*meaning_par2_t2 + lambda3*meaning_par3_t2
meaning3 =~ NA*meaning_par1_t3 + lambda1*meaning_par1_t3 + lambda2*meaning_par2_t3 + lambda3*meaning_par3_t3

# Intercepts
meaning_par1_t1 ~ i1*1
meaning_par2_t1 ~ i2*1
meaning_par3_t1 ~ i3*1

meaning_par1_t2 ~ i1*1
meaning_par2_t2 ~ i2*1
meaning_par3_t2 ~ i3*1

meaning_par1_t3 ~ i1*1
meaning_par2_t3 ~ i2*1
meaning_par3_t3 ~ i3*1

# Unique Variances
meaning_par1_t1 ~~ u1*meaning_par1_t1
meaning_par2_t1 ~~ u2*meaning_par2_t1
meaning_par3_t1 ~~ u3*meaning_par3_t1

meaning_par1_t2 ~~ u1*meaning_par1_t2
meaning_par2_t2 ~~ u2*meaning_par2_t2
meaning_par3_t2 ~~ u3*meaning_par3_t2

meaning_par1_t3 ~~ u1*meaning_par1_t3
meaning_par2_t3 ~~ u2*meaning_par2_t3
meaning_par3_t3 ~~ u3*meaning_par3_t3

# Latent Variable Means
meaning1 ~ 0*1
meaning2 ~ 1
meaning3 ~ 1

# Latent Variable Variances and Covariance
meaning1 ~~ 1*meaning1
meaning2 ~~ meaning2
meaning3 ~~ meaning3
meaning1 ~~ meaning2
meaning1 ~~ meaning3
meaning2 ~~ meaning3
'
fit_strict_meaning <- cfa(strict_meaning, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strict_meaning, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_meaning) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_meaning) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_meaning) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_meaning) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_meaning, fit_weak_meaning)

anova(fit_weak_meaning, fit_strong_meaning)

anova(fit_strong_meaning, fit_strict_meaning)
```

::: {.callout-note appearance="minimal"}
Good model fit across all model specifications (except for RMSEA). Chi^2 tests indicate that strong measurement invariance is given.
:::

#### Self-esteem

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_selfes <- '
# Define the latent factors
selfes1 =~ NA*selfes_par1_t1 + lambda1*selfes_par1_t1 + selfes_par2_t1 + selfes_par3_t1
selfes2 =~ NA*selfes_par1_t2 + lambda1*selfes_par1_t2 + selfes_par2_t2 + selfes_par3_t2
selfes3 =~ NA*selfes_par1_t3 + lambda1*selfes_par1_t3 + selfes_par2_t3 + selfes_par3_t3

# Intercepts
selfes_par1_t1 ~ i1*1
selfes_par2_t1 ~ 1
selfes_par3_t1 ~ 1

selfes_par1_t2 ~ i1*1
selfes_par2_t2 ~ 1
selfes_par3_t2 ~ 1

selfes_par1_t3 ~ i1*1
selfes_par2_t3 ~ 1
selfes_par3_t3 ~ 1

# Unique Variances
selfes_par1_t1 ~~ selfes_par1_t1
selfes_par2_t1 ~~ selfes_par2_t1
selfes_par3_t1 ~~ selfes_par3_t1

selfes_par1_t2 ~~ selfes_par1_t2
selfes_par2_t2 ~~ selfes_par2_t2
selfes_par3_t2 ~~ selfes_par3_t2

selfes_par1_t3 ~~ selfes_par1_t3
selfes_par2_t3 ~~ selfes_par2_t3
selfes_par3_t3 ~~ selfes_par3_t3

# Latent Variable Means
selfes1 ~ 0*1
selfes2 ~ 1
selfes3 ~ 1

# Latent Variable Variances and Covariance
selfes1 ~~ 1*selfes1
selfes2 ~~ selfes2
selfes3 ~~ selfes3
selfes1 ~~ selfes2
selfes1 ~~ selfes3
selfes2 ~~ selfes3
'
fit_configural_selfes <- cfa(configural_selfes, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_configural_selfes, fit.measures = TRUE)

# Weak invariance model
weak_selfes <- '
# Define the latent factors
selfes1 =~ NA*selfes_par1_t1 + lambda1*selfes_par1_t1 + lambda2*selfes_par2_t1 + lambda3*selfes_par3_t1
selfes2 =~ NA*selfes_par1_t2 + lambda1*selfes_par1_t2 + lambda2*selfes_par2_t2 + lambda3*selfes_par3_t2
selfes3 =~ NA*selfes_par1_t3 + lambda1*selfes_par1_t3 + lambda2*selfes_par2_t3 + lambda3*selfes_par3_t3

# Intercepts
selfes_par1_t1 ~ i1*1
selfes_par2_t1 ~ 1
selfes_par3_t1 ~ 1

selfes_par1_t2 ~ i1*1
selfes_par2_t2 ~ 1
selfes_par3_t2 ~ 1

selfes_par1_t3 ~ i1*1
selfes_par2_t3 ~ 1
selfes_par3_t3 ~ 1

# Unique Variances
selfes_par1_t1 ~~ selfes_par1_t1
selfes_par2_t1 ~~ selfes_par2_t1
selfes_par3_t1 ~~ selfes_par3_t1

selfes_par1_t2 ~~ selfes_par1_t2
selfes_par2_t2 ~~ selfes_par2_t2
selfes_par3_t2 ~~ selfes_par3_t2

selfes_par1_t3 ~~ selfes_par1_t3
selfes_par2_t3 ~~ selfes_par2_t3
selfes_par3_t3 ~~ selfes_par3_t3

# Latent Variable Means
selfes1 ~ 0*1
selfes2 ~ 1
selfes3 ~ 1

# Latent Variable Variances and Covariance
selfes1 ~~ 1*selfes1
selfes2 ~~ selfes2
selfes3 ~~ selfes3
selfes1 ~~ selfes2
selfes1 ~~ selfes3
selfes2 ~~ selfes3
'
fit_weak_selfes <- cfa(weak_selfes, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_weak_selfes, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_selfes <- '
# Define the latent factors
selfes1 =~ NA*selfes_par1_t1 + lambda1*selfes_par1_t1 + lambda2*selfes_par2_t1 + lambda3*selfes_par3_t1
selfes2 =~ NA*selfes_par1_t2 + lambda1*selfes_par1_t2 + lambda2*selfes_par2_t2 + lambda3*selfes_par3_t2
selfes3 =~ NA*selfes_par1_t3 + lambda1*selfes_par1_t3 + lambda2*selfes_par2_t3 + lambda3*selfes_par3_t3

# Intercepts
selfes_par1_t1 ~ i1*1
selfes_par2_t1 ~ i2*1
selfes_par3_t1 ~ i3*1

selfes_par1_t2 ~ i1*1
selfes_par2_t2 ~ i2*1
selfes_par3_t2 ~ i3*1

selfes_par1_t3 ~ i1*1
selfes_par2_t3 ~ i2*1
selfes_par3_t3 ~ i3*1

# Unique Variances
selfes_par1_t1 ~~ selfes_par1_t1
selfes_par2_t1 ~~ selfes_par2_t1
selfes_par3_t1 ~~ selfes_par3_t1

selfes_par1_t2 ~~ selfes_par1_t2
selfes_par2_t2 ~~ selfes_par2_t2
selfes_par3_t2 ~~ selfes_par3_t2

selfes_par1_t3 ~~ selfes_par1_t3
selfes_par2_t3 ~~ selfes_par2_t3
selfes_par3_t3 ~~ selfes_par3_t3

# Latent Variable Means
selfes1 ~ 0*1
selfes2 ~ 1
selfes3 ~ 1

# Latent Variable Variances and Covariance
selfes1 ~~ 1*selfes1
selfes2 ~~ selfes2
selfes3 ~~ selfes3
selfes1 ~~ selfes2
selfes1 ~~ selfes3
selfes2 ~~ selfes3
'
fit_strong_selfes <- cfa(strong_selfes, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strong_selfes, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_selfes <- '
# Define the latent factors
selfes1 =~ NA*selfes_par1_t1 + lambda1*selfes_par1_t1 + lambda2*selfes_par2_t1 + lambda3*selfes_par3_t1
selfes2 =~ NA*selfes_par1_t2 + lambda1*selfes_par1_t2 + lambda2*selfes_par2_t2 + lambda3*selfes_par3_t2
selfes3 =~ NA*selfes_par1_t3 + lambda1*selfes_par1_t3 + lambda2*selfes_par2_t3 + lambda3*selfes_par3_t3

# Intercepts
selfes_par1_t1 ~ i1*1
selfes_par2_t1 ~ i2*1
selfes_par3_t1 ~ i3*1

selfes_par1_t2 ~ i1*1
selfes_par2_t2 ~ i2*1
selfes_par3_t2 ~ i3*1

selfes_par1_t3 ~ i1*1
selfes_par2_t3 ~ i2*1
selfes_par3_t3 ~ i3*1

# Unique Variances
selfes_par1_t1 ~~ u1*selfes_par1_t1
selfes_par2_t1 ~~ u2*selfes_par2_t1
selfes_par3_t1 ~~ u3*selfes_par3_t1

selfes_par1_t2 ~~ u1*selfes_par1_t2
selfes_par2_t2 ~~ u2*selfes_par2_t2
selfes_par3_t2 ~~ u3*selfes_par3_t2

selfes_par1_t3 ~~ u1*selfes_par1_t3
selfes_par2_t3 ~~ u2*selfes_par2_t3
selfes_par3_t3 ~~ u3*selfes_par3_t3

# Latent Variable Means
selfes1 ~ 0*1
selfes2 ~ 1
selfes3 ~ 1

# Latent Variable Variances and Covariance
selfes1 ~~ 1*selfes1
selfes2 ~~ selfes2
selfes3 ~~ selfes3
selfes1 ~~ selfes2
selfes1 ~~ selfes3
selfes2 ~~ selfes3
'
fit_strict_selfes <- cfa(strict_selfes, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strict_selfes, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_selfes) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_selfes) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_selfes) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_selfes) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_selfes, fit_weak_selfes)

anova(fit_weak_selfes, fit_strong_selfes)

anova(fit_strong_selfes, fit_strict_selfes)
```

::: {.callout-note appearance="minimal"}
Good model fit across all model specifications (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Self concept clarity

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_concept <- '
# Define the latent factors
concept1 =~ NA*concept_par1_t1 + lambda1*concept_par1_t1 + concept_par2_t1 + concept_par3_t1
concept2 =~ NA*concept_par1_t2 + lambda1*concept_par1_t2 + concept_par2_t2 + concept_par3_t2
concept3 =~ NA*concept_par1_t3 + lambda1*concept_par1_t3 + concept_par2_t3 + concept_par3_t3

# Intercepts
concept_par1_t1 ~ i1*1
concept_par2_t1 ~ 1
concept_par3_t1 ~ 1

concept_par1_t2 ~ i1*1
concept_par2_t2 ~ 1
concept_par3_t2 ~ 1

concept_par1_t3 ~ i1*1
concept_par2_t3 ~ 1
concept_par3_t3 ~ 1

# Unique Variances
concept_par1_t1 ~~ concept_par1_t1
concept_par2_t1 ~~ concept_par2_t1
concept_par3_t1 ~~ concept_par3_t1

concept_par1_t2 ~~ concept_par1_t2
concept_par2_t2 ~~ concept_par2_t2
concept_par3_t2 ~~ concept_par3_t2

concept_par1_t3 ~~ concept_par1_t3
concept_par2_t3 ~~ concept_par2_t3
concept_par3_t3 ~~ concept_par3_t3

# Latent Variable Means
concept1 ~ 0*1
concept2 ~ 1
concept3 ~ 1

# Latent Variable Variances and Covariance
concept1 ~~ 1*concept1
concept2 ~~ concept2
concept3 ~~ concept3
concept1 ~~ concept2
concept1 ~~ concept3
concept2 ~~ concept3
'
fit_configural_concept <- cfa(configural_concept, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_configural_concept, fit.measures = TRUE)

# Weak invariance model
weak_concept <- '
# Define the latent factors
concept1 =~ NA*concept_par1_t1 + lambda1*concept_par1_t1 + lambda2*concept_par2_t1 + lambda3*concept_par3_t1
concept2 =~ NA*concept_par1_t2 + lambda1*concept_par1_t2 + lambda2*concept_par2_t2 + lambda3*concept_par3_t2
concept3 =~ NA*concept_par1_t3 + lambda1*concept_par1_t3 + lambda2*concept_par2_t3 + lambda3*concept_par3_t3

# Intercepts
concept_par1_t1 ~ i1*1
concept_par2_t1 ~ 1
concept_par3_t1 ~ 1

concept_par1_t2 ~ i1*1
concept_par2_t2 ~ 1
concept_par3_t2 ~ 1

concept_par1_t3 ~ i1*1
concept_par2_t3 ~ 1
concept_par3_t3 ~ 1

# Unique Variances
concept_par1_t1 ~~ concept_par1_t1
concept_par2_t1 ~~ concept_par2_t1
concept_par3_t1 ~~ concept_par3_t1

concept_par1_t2 ~~ concept_par1_t2
concept_par2_t2 ~~ concept_par2_t2
concept_par3_t2 ~~ concept_par3_t2

concept_par1_t3 ~~ concept_par1_t3
concept_par2_t3 ~~ concept_par2_t3
concept_par3_t3 ~~ concept_par3_t3

# Latent Variable Means
concept1 ~ 0*1
concept2 ~ 1
concept3 ~ 1

# Latent Variable Variances and Covariance
concept1 ~~ 1*concept1
concept2 ~~ concept2
concept3 ~~ concept3
concept1 ~~ concept2
concept1 ~~ concept3
concept2 ~~ concept3
'
fit_weak_concept <- cfa(weak_concept, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_weak_concept, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_concept <- '
# Define the latent factors
concept1 =~ NA*concept_par1_t1 + lambda1*concept_par1_t1 + lambda2*concept_par2_t1 + lambda3*concept_par3_t1
concept2 =~ NA*concept_par1_t2 + lambda1*concept_par1_t2 + lambda2*concept_par2_t2 + lambda3*concept_par3_t2
concept3 =~ NA*concept_par1_t3 + lambda1*concept_par1_t3 + lambda2*concept_par2_t3 + lambda3*concept_par3_t3

# Intercepts
concept_par1_t1 ~ i1*1
concept_par2_t1 ~ i2*1
concept_par3_t1 ~ i3*1

concept_par1_t2 ~ i1*1
concept_par2_t2 ~ i2*1
concept_par3_t2 ~ i3*1

concept_par1_t3 ~ i1*1
concept_par2_t3 ~ i2*1
concept_par3_t3 ~ i3*1

# Unique Variances
concept_par1_t1 ~~ concept_par1_t1
concept_par2_t1 ~~ concept_par2_t1
concept_par3_t1 ~~ concept_par3_t1

concept_par1_t2 ~~ concept_par1_t2
concept_par2_t2 ~~ concept_par2_t2
concept_par3_t2 ~~ concept_par3_t2

concept_par1_t3 ~~ concept_par1_t3
concept_par2_t3 ~~ concept_par2_t3
concept_par3_t3 ~~ concept_par3_t3

# Latent Variable Means
concept1 ~ 0*1
concept2 ~ 1
concept3 ~ 1

# Latent Variable Variances and Covariance
concept1 ~~ 1*concept1
concept2 ~~ concept2
concept3 ~~ concept3
concept1 ~~ concept2
concept1 ~~ concept3
concept2 ~~ concept3
'
fit_strong_concept <- cfa(strong_concept, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strong_concept, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_concept <- '
# Define the latent factors
concept1 =~ NA*concept_par1_t1 + lambda1*concept_par1_t1 + lambda2*concept_par2_t1 + lambda3*concept_par3_t1
concept2 =~ NA*concept_par1_t2 + lambda1*concept_par1_t2 + lambda2*concept_par2_t2 + lambda3*concept_par3_t2
concept3 =~ NA*concept_par1_t3 + lambda1*concept_par1_t3 + lambda2*concept_par2_t3 + lambda3*concept_par3_t3

# Intercepts
concept_par1_t1 ~ i1*1
concept_par2_t1 ~ i2*1
concept_par3_t1 ~ i3*1

concept_par1_t2 ~ i1*1
concept_par2_t2 ~ i2*1
concept_par3_t2 ~ i3*1

concept_par1_t3 ~ i1*1
concept_par2_t3 ~ i2*1
concept_par3_t3 ~ i3*1

# Unique Variances
concept_par1_t1 ~~ u1*concept_par1_t1
concept_par2_t1 ~~ u2*concept_par2_t1
concept_par3_t1 ~~ u3*concept_par3_t1

concept_par1_t2 ~~ u1*concept_par1_t2
concept_par2_t2 ~~ u2*concept_par2_t2
concept_par3_t2 ~~ u3*concept_par3_t2

concept_par1_t3 ~~ u1*concept_par1_t3
concept_par2_t3 ~~ u2*concept_par2_t3
concept_par3_t3 ~~ u3*concept_par3_t3

# Latent Variable Means
concept1 ~ 0*1
concept2 ~ 1
concept3 ~ 1

# Latent Variable Variances and Covariance
concept1 ~~ 1*concept1
concept2 ~~ concept2
concept3 ~~ concept3
concept1 ~~ concept2
concept1 ~~ concept3
concept2 ~~ concept3
'
fit_strict_concept <- cfa(strict_concept, data = df_sbsa2_wide_wb, mimic = "mplus", missing="ML")
summary(fit_strict_concept, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_concept) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_concept) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_concept) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_concept) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_concept, fit_weak_concept)

anova(fit_weak_concept, fit_strong_concept)

anova(fit_strong_concept, fit_strict_concept)
```

::: {.callout-note appearance="minimal"}
Good model fit across all model specifications (except for RMSEA). Chi^2 tests indicate that strong measurement invariance is given (very close to .05).
:::

### Big Five: from T1 to T2

Testing for measurement invariance of the latent BFI-2 traits across time, from T1 to T2.

#### Extraversion: current-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t1 + lambda1*extra_curr_par1_t1 + extra_curr_par2_t1 + extra_curr_par3_t1
extra_curr2 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + extra_curr_par2_t2 + extra_curr_par3_t2

# Intercepts
extra_curr_par1_t1 ~ i1*1
extra_curr_par2_t1 ~ 1
extra_curr_par3_t1 ~ 1

extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ 1
extra_curr_par3_t2 ~ 1

# Unique Variances
extra_curr_par1_t1 ~~ extra_curr_par1_t1
extra_curr_par2_t1 ~~ extra_curr_par2_t1
extra_curr_par3_t1 ~~ extra_curr_par3_t1

extra_curr_par1_t2 ~~ extra_curr_par1_t2
extra_curr_par2_t2 ~~ extra_curr_par2_t2
extra_curr_par3_t2 ~~ extra_curr_par3_t2

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_configural_extra_curr <- cfa(configural_extra_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_extra_curr, fit.measures = TRUE)

# Weak invariance model
weak_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t1 + lambda1*extra_curr_par1_t1 + lambda2*extra_curr_par2_t1 + lambda3*extra_curr_par3_t1
extra_curr2 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + lambda2*extra_curr_par2_t2 + lambda3*extra_curr_par3_t2

# Intercepts
extra_curr_par1_t1 ~ i1*1
extra_curr_par2_t1 ~ 1
extra_curr_par3_t1 ~ 1

extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ 1
extra_curr_par3_t2 ~ 1

# Unique Variances
extra_curr_par1_t1 ~~ extra_curr_par1_t1
extra_curr_par2_t1 ~~ extra_curr_par2_t1
extra_curr_par3_t1 ~~ extra_curr_par3_t1

extra_curr_par1_t2 ~~ extra_curr_par1_t2
extra_curr_par2_t2 ~~ extra_curr_par2_t2
extra_curr_par3_t2 ~~ extra_curr_par3_t2

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_weak_extra_curr <- cfa(weak_extra_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_extra_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t1 + lambda1*extra_curr_par1_t1 + lambda2*extra_curr_par2_t1 + lambda3*extra_curr_par3_t1
extra_curr2 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + lambda2*extra_curr_par2_t2 + lambda3*extra_curr_par3_t2

# Intercepts
extra_curr_par1_t1 ~ i1*1
extra_curr_par2_t1 ~ i2*1
extra_curr_par3_t1 ~ i3*1

extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ i2*1
extra_curr_par3_t2 ~ i3*1

# Unique Variances
extra_curr_par1_t1 ~~ extra_curr_par1_t1
extra_curr_par2_t1 ~~ extra_curr_par2_t1
extra_curr_par3_t1 ~~ extra_curr_par3_t1

extra_curr_par1_t2 ~~ extra_curr_par1_t2
extra_curr_par2_t2 ~~ extra_curr_par2_t2
extra_curr_par3_t2 ~~ extra_curr_par3_t2

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_strong_extra_curr <- cfa(strong_extra_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_extra_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t1 + lambda1*extra_curr_par1_t1 + lambda2*extra_curr_par2_t1 + lambda3*extra_curr_par3_t1
extra_curr2 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + lambda2*extra_curr_par2_t2 + lambda3*extra_curr_par3_t2

# Intercepts
extra_curr_par1_t1 ~ i1*1
extra_curr_par2_t1 ~ i2*1
extra_curr_par3_t1 ~ i3*1

extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ i2*1
extra_curr_par3_t2 ~ i3*1

# Unique Variances
extra_curr_par1_t1 ~~ u1*extra_curr_par1_t1
extra_curr_par2_t1 ~~ u2*extra_curr_par2_t1
extra_curr_par3_t1 ~~ u3*extra_curr_par3_t1

extra_curr_par1_t2 ~~ u1*extra_curr_par1_t2
extra_curr_par2_t2 ~~ u2*extra_curr_par2_t2
extra_curr_par3_t2 ~~ u3*extra_curr_par3_t2

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_strict_extra_curr <- cfa(strict_extra_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_extra_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_extra_curr, fit_weak_extra_curr)

anova(fit_weak_extra_curr, fit_strong_extra_curr)

anova(fit_strong_extra_curr, fit_strict_extra_curr)
```

::: {.callout-note appearance="minimal"}
Model fit still not satisfactory. Chi^2 tests indicate that weak measurement invariance is given.
:::

#### Extraversion: ideal-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t1 + lambda1*extra_ideal_par1_t1 + extra_ideal_par2_t1 + extra_ideal_par3_t1
extra_ideal2 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + extra_ideal_par2_t2 + extra_ideal_par3_t2

# Intercepts
extra_ideal_par1_t1 ~ i1*1
extra_ideal_par2_t1 ~ 1
extra_ideal_par3_t1 ~ 1

extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ 1
extra_ideal_par3_t2 ~ 1

# Unique Variances
extra_ideal_par1_t1 ~~ extra_ideal_par1_t1
extra_ideal_par2_t1 ~~ extra_ideal_par2_t1
extra_ideal_par3_t1 ~~ extra_ideal_par3_t1

extra_ideal_par1_t2 ~~ extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ extra_ideal_par3_t2

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_configural_extra_ideal <- cfa(configural_extra_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_extra_ideal, fit.measures = TRUE)

# Weak invariance model
weak_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t1 + lambda1*extra_ideal_par1_t1 + lambda2*extra_ideal_par2_t1 + lambda3*extra_ideal_par3_t1
extra_ideal2 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + lambda2*extra_ideal_par2_t2 + lambda3*extra_ideal_par3_t2

# Intercepts
extra_ideal_par1_t1 ~ i1*1
extra_ideal_par2_t1 ~ 1
extra_ideal_par3_t1 ~ 1

extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ 1
extra_ideal_par3_t2 ~ 1

# Unique Variances
extra_ideal_par1_t1 ~~ extra_ideal_par1_t1
extra_ideal_par2_t1 ~~ extra_ideal_par2_t1
extra_ideal_par3_t1 ~~ extra_ideal_par3_t1

extra_ideal_par1_t2 ~~ extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ extra_ideal_par3_t2

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_weak_extra_ideal <- cfa(weak_extra_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_extra_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t1 + lambda1*extra_ideal_par1_t1 + lambda2*extra_ideal_par2_t1 + lambda3*extra_ideal_par3_t1
extra_ideal2 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + lambda2*extra_ideal_par2_t2 + lambda3*extra_ideal_par3_t2

# Intercepts
extra_ideal_par1_t1 ~ i1*1
extra_ideal_par2_t1 ~ i2*1
extra_ideal_par3_t1 ~ i3*1

extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ i2*1
extra_ideal_par3_t2 ~ i3*1

# Unique Variances
extra_ideal_par1_t1 ~~ extra_ideal_par1_t1
extra_ideal_par2_t1 ~~ extra_ideal_par2_t1
extra_ideal_par3_t1 ~~ extra_ideal_par3_t1

extra_ideal_par1_t2 ~~ extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ extra_ideal_par3_t2

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_strong_extra_ideal <- cfa(strong_extra_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_extra_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t1 + lambda1*extra_ideal_par1_t1 + lambda2*extra_ideal_par2_t1 + lambda3*extra_ideal_par3_t1
extra_ideal2 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + lambda2*extra_ideal_par2_t2 + lambda3*extra_ideal_par3_t2

# Intercepts
extra_ideal_par1_t1 ~ i1*1
extra_ideal_par2_t1 ~ i2*1
extra_ideal_par3_t1 ~ i3*1

extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ i2*1
extra_ideal_par3_t2 ~ i3*1

# Unique Variances
extra_ideal_par1_t1 ~~ u1*extra_ideal_par1_t1
extra_ideal_par2_t1 ~~ u2*extra_ideal_par2_t1
extra_ideal_par3_t1 ~~ u3*extra_ideal_par3_t1

extra_ideal_par1_t2 ~~ u1*extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ u2*extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ u3*extra_ideal_par3_t2

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_strict_extra_ideal <- cfa(strict_extra_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_extra_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_extra_ideal, fit_weak_extra_ideal)

anova(fit_weak_extra_ideal, fit_strong_extra_ideal)

anova(fit_strong_extra_ideal, fit_strict_extra_ideal)
```

::: {.callout-note appearance="minimal"}
Model fit still not satisfactory across all stages of measurement invariance. Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Agreeableness: current-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t1 + lambda1*agree_curr_par1_t1 + agree_curr_par2_t1 + agree_curr_par3_t1
agree_curr2 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + agree_curr_par2_t2 + agree_curr_par3_t2

# Intercepts
agree_curr_par1_t1 ~ i1*1
agree_curr_par2_t1 ~ 1
agree_curr_par3_t1 ~ 1

agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ 1
agree_curr_par3_t2 ~ 1

# Unique Variances
agree_curr_par1_t1 ~~ agree_curr_par1_t1
agree_curr_par2_t1 ~~ agree_curr_par2_t1
agree_curr_par3_t1 ~~ agree_curr_par3_t1

agree_curr_par1_t2 ~~ agree_curr_par1_t2
agree_curr_par2_t2 ~~ agree_curr_par2_t2
agree_curr_par3_t2 ~~ agree_curr_par3_t2

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_configural_agree_curr <- cfa(configural_agree_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_agree_curr, fit.measures = TRUE)

# Weak invariance model
weak_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t1 + lambda1*agree_curr_par1_t1 + lambda2*agree_curr_par2_t1 + lambda3*agree_curr_par3_t1
agree_curr2 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + lambda2*agree_curr_par2_t2 + lambda3*agree_curr_par3_t2

# Intercepts
agree_curr_par1_t1 ~ i1*1
agree_curr_par2_t1 ~ 1
agree_curr_par3_t1 ~ 1

agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ 1
agree_curr_par3_t2 ~ 1

# Unique Variances
agree_curr_par1_t1 ~~ agree_curr_par1_t1
agree_curr_par2_t1 ~~ agree_curr_par2_t1
agree_curr_par3_t1 ~~ agree_curr_par3_t1

agree_curr_par1_t2 ~~ agree_curr_par1_t2
agree_curr_par2_t2 ~~ agree_curr_par2_t2
agree_curr_par3_t2 ~~ agree_curr_par3_t2

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_weak_agree_curr <- cfa(weak_agree_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_agree_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t1 + lambda1*agree_curr_par1_t1 + lambda2*agree_curr_par2_t1 + lambda3*agree_curr_par3_t1
agree_curr2 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + lambda2*agree_curr_par2_t2 + lambda3*agree_curr_par3_t2

# Intercepts
agree_curr_par1_t1 ~ i1*1
agree_curr_par2_t1 ~ i2*1
agree_curr_par3_t1 ~ i3*1

agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ i2*1
agree_curr_par3_t2 ~ i3*1

# Unique Variances
agree_curr_par1_t1 ~~ agree_curr_par1_t1
agree_curr_par2_t1 ~~ agree_curr_par2_t1
agree_curr_par3_t1 ~~ agree_curr_par3_t1

agree_curr_par1_t2 ~~ agree_curr_par1_t2
agree_curr_par2_t2 ~~ agree_curr_par2_t2
agree_curr_par3_t2 ~~ agree_curr_par3_t2

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_strong_agree_curr <- cfa(strong_agree_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_agree_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t1 + lambda1*agree_curr_par1_t1 + lambda2*agree_curr_par2_t1 + lambda3*agree_curr_par3_t1
agree_curr2 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + lambda2*agree_curr_par2_t2 + lambda3*agree_curr_par3_t2

# Intercepts
agree_curr_par1_t1 ~ i1*1
agree_curr_par2_t1 ~ i2*1
agree_curr_par3_t1 ~ i3*1

agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ i2*1
agree_curr_par3_t2 ~ i3*1

# Unique Variances
agree_curr_par1_t1 ~~ u1*agree_curr_par1_t1
agree_curr_par2_t1 ~~ u2*agree_curr_par2_t1
agree_curr_par3_t1 ~~ u3*agree_curr_par3_t1

agree_curr_par1_t2 ~~ u1*agree_curr_par1_t2
agree_curr_par2_t2 ~~ u2*agree_curr_par2_t2
agree_curr_par3_t2 ~~ u3*agree_curr_par3_t2

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_strict_agree_curr <- cfa(strict_agree_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_agree_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_agree_curr, fit_weak_agree_curr)

anova(fit_weak_agree_curr, fit_strong_agree_curr)

anova(fit_strong_agree_curr, fit_strict_agree_curr)
```

::: {.callout-note appearance="minimal"}
Model fit still not satisfactory. Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Agreeableness: ideal-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t1 + lambda1*agree_ideal_par1_t1 + agree_ideal_par2_t1 + agree_ideal_par3_t1
agree_ideal2 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + agree_ideal_par2_t2 + agree_ideal_par3_t2

# Intercepts
agree_ideal_par1_t1 ~ i1*1
agree_ideal_par2_t1 ~ 1
agree_ideal_par3_t1 ~ 1

agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ 1
agree_ideal_par3_t2 ~ 1

# Unique Variances
agree_ideal_par1_t1 ~~ agree_ideal_par1_t1
agree_ideal_par2_t1 ~~ agree_ideal_par2_t1
agree_ideal_par3_t1 ~~ agree_ideal_par3_t1

agree_ideal_par1_t2 ~~ agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ agree_ideal_par3_t2

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_configural_agree_ideal <- cfa(configural_agree_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_agree_ideal, fit.measures = TRUE)

# Weak invariance model
weak_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t1 + lambda1*agree_ideal_par1_t1 + lambda2*agree_ideal_par2_t1 + lambda3*agree_ideal_par3_t1
agree_ideal2 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + lambda2*agree_ideal_par2_t2 + lambda3*agree_ideal_par3_t2

# Intercepts
agree_ideal_par1_t1 ~ i1*1
agree_ideal_par2_t1 ~ 1
agree_ideal_par3_t1 ~ 1

agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ 1
agree_ideal_par3_t2 ~ 1

# Unique Variances
agree_ideal_par1_t1 ~~ agree_ideal_par1_t1
agree_ideal_par2_t1 ~~ agree_ideal_par2_t1
agree_ideal_par3_t1 ~~ agree_ideal_par3_t1

agree_ideal_par1_t2 ~~ agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ agree_ideal_par3_t2

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_weak_agree_ideal <- cfa(weak_agree_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_agree_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t1 + lambda1*agree_ideal_par1_t1 + lambda2*agree_ideal_par2_t1 + lambda3*agree_ideal_par3_t1
agree_ideal2 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + lambda2*agree_ideal_par2_t2 + lambda3*agree_ideal_par3_t2

# Intercepts
agree_ideal_par1_t1 ~ i1*1
agree_ideal_par2_t1 ~ i2*1
agree_ideal_par3_t1 ~ i3*1

agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ i2*1
agree_ideal_par3_t2 ~ i3*1

# Unique Variances
agree_ideal_par1_t1 ~~ agree_ideal_par1_t1
agree_ideal_par2_t1 ~~ agree_ideal_par2_t1
agree_ideal_par3_t1 ~~ agree_ideal_par3_t1

agree_ideal_par1_t2 ~~ agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ agree_ideal_par3_t2

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_strong_agree_ideal <- cfa(strong_agree_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_agree_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t1 + lambda1*agree_ideal_par1_t1 + lambda2*agree_ideal_par2_t1 + lambda3*agree_ideal_par3_t1
agree_ideal2 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + lambda2*agree_ideal_par2_t2 + lambda3*agree_ideal_par3_t2

# Intercepts
agree_ideal_par1_t1 ~ i1*1
agree_ideal_par2_t1 ~ i2*1
agree_ideal_par3_t1 ~ i3*1

agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ i2*1
agree_ideal_par3_t2 ~ i3*1

# Unique Variances
agree_ideal_par1_t1 ~~ u1*agree_ideal_par1_t1
agree_ideal_par2_t1 ~~ u2*agree_ideal_par2_t1
agree_ideal_par3_t1 ~~ u3*agree_ideal_par3_t1

agree_ideal_par1_t2 ~~ u1*agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ u2*agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ u3*agree_ideal_par3_t2

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_strict_agree_ideal <- cfa(strict_agree_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_agree_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_agree_ideal, fit_weak_agree_ideal)

anova(fit_weak_agree_ideal, fit_strong_agree_ideal)

anova(fit_strong_agree_ideal, fit_strict_agree_ideal)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strong measurement invariance is given.
:::

#### Conscientiousness: current-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t1 + lambda1*consc_curr_par1_t1 + consc_curr_par2_t1 + consc_curr_par3_t1
consc_curr2 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + consc_curr_par2_t2 + consc_curr_par3_t2

# Intercepts
consc_curr_par1_t1 ~ i1*1
consc_curr_par2_t1 ~ 1
consc_curr_par3_t1 ~ 1

consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ 1
consc_curr_par3_t2 ~ 1

# Unique Variances
consc_curr_par1_t1 ~~ consc_curr_par1_t1
consc_curr_par2_t1 ~~ consc_curr_par2_t1
consc_curr_par3_t1 ~~ consc_curr_par3_t1

consc_curr_par1_t2 ~~ consc_curr_par1_t2
consc_curr_par2_t2 ~~ consc_curr_par2_t2
consc_curr_par3_t2 ~~ consc_curr_par3_t2

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_configural_consc_curr <- cfa(configural_consc_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_consc_curr, fit.measures = TRUE)

# Weak invariance model
weak_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t1 + lambda1*consc_curr_par1_t1 + lambda2*consc_curr_par2_t1 + lambda3*consc_curr_par3_t1
consc_curr2 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + lambda2*consc_curr_par2_t2 + lambda3*consc_curr_par3_t2

# Intercepts
consc_curr_par1_t1 ~ i1*1
consc_curr_par2_t1 ~ 1
consc_curr_par3_t1 ~ 1

consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ 1
consc_curr_par3_t2 ~ 1

# Unique Variances
consc_curr_par1_t1 ~~ consc_curr_par1_t1
consc_curr_par2_t1 ~~ consc_curr_par2_t1
consc_curr_par3_t1 ~~ consc_curr_par3_t1

consc_curr_par1_t2 ~~ consc_curr_par1_t2
consc_curr_par2_t2 ~~ consc_curr_par2_t2
consc_curr_par3_t2 ~~ consc_curr_par3_t2

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_weak_consc_curr <- cfa(weak_consc_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_consc_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t1 + lambda1*consc_curr_par1_t1 + lambda2*consc_curr_par2_t1 + lambda3*consc_curr_par3_t1
consc_curr2 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + lambda2*consc_curr_par2_t2 + lambda3*consc_curr_par3_t2

# Intercepts
consc_curr_par1_t1 ~ i1*1
consc_curr_par2_t1 ~ i2*1
consc_curr_par3_t1 ~ i3*1

consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ i2*1
consc_curr_par3_t2 ~ i3*1

# Unique Variances
consc_curr_par1_t1 ~~ consc_curr_par1_t1
consc_curr_par2_t1 ~~ consc_curr_par2_t1
consc_curr_par3_t1 ~~ consc_curr_par3_t1

consc_curr_par1_t2 ~~ consc_curr_par1_t2
consc_curr_par2_t2 ~~ consc_curr_par2_t2
consc_curr_par3_t2 ~~ consc_curr_par3_t2

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_strong_consc_curr <- cfa(strong_consc_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_consc_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t1 + lambda1*consc_curr_par1_t1 + lambda2*consc_curr_par2_t1 + lambda3*consc_curr_par3_t1
consc_curr2 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + lambda2*consc_curr_par2_t2 + lambda3*consc_curr_par3_t2

# Intercepts
consc_curr_par1_t1 ~ i1*1
consc_curr_par2_t1 ~ i2*1
consc_curr_par3_t1 ~ i3*1

consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ i2*1
consc_curr_par3_t2 ~ i3*1

# Unique Variances
consc_curr_par1_t1 ~~ u1*consc_curr_par1_t1
consc_curr_par2_t1 ~~ u2*consc_curr_par2_t1
consc_curr_par3_t1 ~~ u3*consc_curr_par3_t1

consc_curr_par1_t2 ~~ u1*consc_curr_par1_t2
consc_curr_par2_t2 ~~ u2*consc_curr_par2_t2
consc_curr_par3_t2 ~~ u3*consc_curr_par3_t2

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_strict_consc_curr <- cfa(strict_consc_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_consc_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_consc_curr, fit_weak_consc_curr)

anova(fit_weak_consc_curr, fit_strong_consc_curr)

anova(fit_strong_consc_curr, fit_strict_consc_curr)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Conscientiousness: ideal-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t1 + lambda1*consc_ideal_par1_t1 + consc_ideal_par2_t1 + consc_ideal_par3_t1
consc_ideal2 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + consc_ideal_par2_t2 + consc_ideal_par3_t2

# Intercepts
consc_ideal_par1_t1 ~ i1*1
consc_ideal_par2_t1 ~ 1
consc_ideal_par3_t1 ~ 1

consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ 1
consc_ideal_par3_t2 ~ 1

# Unique Variances
consc_ideal_par1_t1 ~~ consc_ideal_par1_t1
consc_ideal_par2_t1 ~~ consc_ideal_par2_t1
consc_ideal_par3_t1 ~~ consc_ideal_par3_t1

consc_ideal_par1_t2 ~~ consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ consc_ideal_par3_t2

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_configural_consc_ideal <- cfa(configural_consc_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_consc_ideal, fit.measures = TRUE)

# Weak invariance model
weak_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t1 + lambda1*consc_ideal_par1_t1 + lambda2*consc_ideal_par2_t1 + lambda3*consc_ideal_par3_t1
consc_ideal2 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + lambda2*consc_ideal_par2_t2 + lambda3*consc_ideal_par3_t2

# Intercepts
consc_ideal_par1_t1 ~ i1*1
consc_ideal_par2_t1 ~ 1
consc_ideal_par3_t1 ~ 1

consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ 1
consc_ideal_par3_t2 ~ 1

# Unique Variances
consc_ideal_par1_t1 ~~ consc_ideal_par1_t1
consc_ideal_par2_t1 ~~ consc_ideal_par2_t1
consc_ideal_par3_t1 ~~ consc_ideal_par3_t1

consc_ideal_par1_t2 ~~ consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ consc_ideal_par3_t2

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_weak_consc_ideal <- cfa(weak_consc_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_consc_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t1 + lambda1*consc_ideal_par1_t1 + lambda2*consc_ideal_par2_t1 + lambda3*consc_ideal_par3_t1
consc_ideal2 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + lambda2*consc_ideal_par2_t2 + lambda3*consc_ideal_par3_t2

# Intercepts
consc_ideal_par1_t1 ~ i1*1
consc_ideal_par2_t1 ~ i2*1
consc_ideal_par3_t1 ~ i3*1

consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ i2*1
consc_ideal_par3_t2 ~ i3*1

# Unique Variances
consc_ideal_par1_t1 ~~ consc_ideal_par1_t1
consc_ideal_par2_t1 ~~ consc_ideal_par2_t1
consc_ideal_par3_t1 ~~ consc_ideal_par3_t1

consc_ideal_par1_t2 ~~ consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ consc_ideal_par3_t2

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_strong_consc_ideal <- cfa(strong_consc_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_consc_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t1 + lambda1*consc_ideal_par1_t1 + lambda2*consc_ideal_par2_t1 + lambda3*consc_ideal_par3_t1
consc_ideal2 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + lambda2*consc_ideal_par2_t2 + lambda3*consc_ideal_par3_t2

# Intercepts
consc_ideal_par1_t1 ~ i1*1
consc_ideal_par2_t1 ~ i2*1
consc_ideal_par3_t1 ~ i3*1

consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ i2*1
consc_ideal_par3_t2 ~ i3*1

# Unique Variances
consc_ideal_par1_t1 ~~ u1*consc_ideal_par1_t1
consc_ideal_par2_t1 ~~ u2*consc_ideal_par2_t1
consc_ideal_par3_t1 ~~ u3*consc_ideal_par3_t1

consc_ideal_par1_t2 ~~ u1*consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ u2*consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ u3*consc_ideal_par3_t2

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_strict_consc_ideal <- cfa(strict_consc_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_consc_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_consc_ideal, fit_weak_consc_ideal)

anova(fit_weak_consc_ideal, fit_strong_consc_ideal)

anova(fit_strong_consc_ideal, fit_strict_consc_ideal)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Neuroticism: current-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t1 + lambda1*neuro_curr_par1_t1 + neuro_curr_par2_t1 + neuro_curr_par3_t1
neuro_curr2 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + neuro_curr_par2_t2 + neuro_curr_par3_t2

# Intercepts
neuro_curr_par1_t1 ~ i1*1
neuro_curr_par2_t1 ~ 1
neuro_curr_par3_t1 ~ 1

neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ 1
neuro_curr_par3_t2 ~ 1

# Unique Variances
neuro_curr_par1_t1 ~~ neuro_curr_par1_t1
neuro_curr_par2_t1 ~~ neuro_curr_par2_t1
neuro_curr_par3_t1 ~~ neuro_curr_par3_t1

neuro_curr_par1_t2 ~~ neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ neuro_curr_par3_t2

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_configural_neuro_curr <- cfa(configural_neuro_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_neuro_curr, fit.measures = TRUE)

# Weak invariance model
weak_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t1 + lambda1*neuro_curr_par1_t1 + lambda2*neuro_curr_par2_t1 + lambda3*neuro_curr_par3_t1
neuro_curr2 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + lambda2*neuro_curr_par2_t2 + lambda3*neuro_curr_par3_t2

# Intercepts
neuro_curr_par1_t1 ~ i1*1
neuro_curr_par2_t1 ~ 1
neuro_curr_par3_t1 ~ 1

neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ 1
neuro_curr_par3_t2 ~ 1

# Unique Variances
neuro_curr_par1_t1 ~~ neuro_curr_par1_t1
neuro_curr_par2_t1 ~~ neuro_curr_par2_t1
neuro_curr_par3_t1 ~~ neuro_curr_par3_t1

neuro_curr_par1_t2 ~~ neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ neuro_curr_par3_t2

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_weak_neuro_curr <- cfa(weak_neuro_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_neuro_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t1 + lambda1*neuro_curr_par1_t1 + lambda2*neuro_curr_par2_t1 + lambda3*neuro_curr_par3_t1
neuro_curr2 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + lambda2*neuro_curr_par2_t2 + lambda3*neuro_curr_par3_t2

# Intercepts
neuro_curr_par1_t1 ~ i1*1
neuro_curr_par2_t1 ~ i2*1
neuro_curr_par3_t1 ~ i3*1

neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ i2*1
neuro_curr_par3_t2 ~ i3*1

# Unique Variances
neuro_curr_par1_t1 ~~ neuro_curr_par1_t1
neuro_curr_par2_t1 ~~ neuro_curr_par2_t1
neuro_curr_par3_t1 ~~ neuro_curr_par3_t1

neuro_curr_par1_t2 ~~ neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ neuro_curr_par3_t2

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_strong_neuro_curr <- cfa(strong_neuro_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_neuro_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t1 + lambda1*neuro_curr_par1_t1 + lambda2*neuro_curr_par2_t1 + lambda3*neuro_curr_par3_t1
neuro_curr2 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + lambda2*neuro_curr_par2_t2 + lambda3*neuro_curr_par3_t2

# Intercepts
neuro_curr_par1_t1 ~ i1*1
neuro_curr_par2_t1 ~ i2*1
neuro_curr_par3_t1 ~ i3*1

neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ i2*1
neuro_curr_par3_t2 ~ i3*1

# Unique Variances
neuro_curr_par1_t1 ~~ u1*neuro_curr_par1_t1
neuro_curr_par2_t1 ~~ u2*neuro_curr_par2_t1
neuro_curr_par3_t1 ~~ u3*neuro_curr_par3_t1

neuro_curr_par1_t2 ~~ u1*neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ u2*neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ u3*neuro_curr_par3_t2

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_strict_neuro_curr <- cfa(strict_neuro_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_neuro_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_neuro_curr, fit_weak_neuro_curr)

anova(fit_weak_neuro_curr, fit_strong_neuro_curr)

anova(fit_strong_neuro_curr, fit_strict_neuro_curr)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Neuroticism: ideal-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t1 + lambda1*neuro_ideal_par1_t1 + neuro_ideal_par2_t1 + neuro_ideal_par3_t1
neuro_ideal2 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + neuro_ideal_par2_t2 + neuro_ideal_par3_t2

# Intercepts
neuro_ideal_par1_t1 ~ i1*1
neuro_ideal_par2_t1 ~ 1
neuro_ideal_par3_t1 ~ 1

neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ 1
neuro_ideal_par3_t2 ~ 1

# Unique Variances
neuro_ideal_par1_t1 ~~ neuro_ideal_par1_t1
neuro_ideal_par2_t1 ~~ neuro_ideal_par2_t1
neuro_ideal_par3_t1 ~~ neuro_ideal_par3_t1

neuro_ideal_par1_t2 ~~ neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ neuro_ideal_par3_t2

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_configural_neuro_ideal <- cfa(configural_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_neuro_ideal, fit.measures = TRUE)

# Weak invariance model
weak_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t1 + lambda1*neuro_ideal_par1_t1 + lambda2*neuro_ideal_par2_t1 + lambda3*neuro_ideal_par3_t1
neuro_ideal2 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + lambda2*neuro_ideal_par2_t2 + lambda3*neuro_ideal_par3_t2

# Intercepts
neuro_ideal_par1_t1 ~ i1*1
neuro_ideal_par2_t1 ~ 1
neuro_ideal_par3_t1 ~ 1

neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ 1
neuro_ideal_par3_t2 ~ 1

# Unique Variances
neuro_ideal_par1_t1 ~~ neuro_ideal_par1_t1
neuro_ideal_par2_t1 ~~ neuro_ideal_par2_t1
neuro_ideal_par3_t1 ~~ neuro_ideal_par3_t1

neuro_ideal_par1_t2 ~~ neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ neuro_ideal_par3_t2

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_weak_neuro_ideal <- cfa(weak_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_neuro_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t1 + lambda1*neuro_ideal_par1_t1 + lambda2*neuro_ideal_par2_t1 + lambda3*neuro_ideal_par3_t1
neuro_ideal2 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + lambda2*neuro_ideal_par2_t2 + lambda3*neuro_ideal_par3_t2

# Intercepts
neuro_ideal_par1_t1 ~ i1*1
neuro_ideal_par2_t1 ~ i2*1
neuro_ideal_par3_t1 ~ i3*1

neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ i2*1
neuro_ideal_par3_t2 ~ i3*1

# Unique Variances
neuro_ideal_par1_t1 ~~ neuro_ideal_par1_t1
neuro_ideal_par2_t1 ~~ neuro_ideal_par2_t1
neuro_ideal_par3_t1 ~~ neuro_ideal_par3_t1

neuro_ideal_par1_t2 ~~ neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ neuro_ideal_par3_t2

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_strong_neuro_ideal <- cfa(strong_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_neuro_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t1 + lambda1*neuro_ideal_par1_t1 + lambda2*neuro_ideal_par2_t1 + lambda3*neuro_ideal_par3_t1
neuro_ideal2 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + lambda2*neuro_ideal_par2_t2 + lambda3*neuro_ideal_par3_t2

# Intercepts
neuro_ideal_par1_t1 ~ i1*1
neuro_ideal_par2_t1 ~ i2*1
neuro_ideal_par3_t1 ~ i3*1

neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ i2*1
neuro_ideal_par3_t2 ~ i3*1

# Unique Variances
neuro_ideal_par1_t1 ~~ u1*neuro_ideal_par1_t1
neuro_ideal_par2_t1 ~~ u2*neuro_ideal_par2_t1
neuro_ideal_par3_t1 ~~ u3*neuro_ideal_par3_t1

neuro_ideal_par1_t2 ~~ u1*neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ u2*neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ u3*neuro_ideal_par3_t2

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_strict_neuro_ideal <- cfa(strict_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_neuro_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_neuro_ideal, fit_weak_neuro_ideal)

anova(fit_weak_neuro_ideal, fit_strong_neuro_ideal)

anova(fit_strong_neuro_ideal, fit_strict_neuro_ideal)
```

::: {.callout-note appearance="minimal"}
Very good model fit across all stages of measurement invariance. Chi^2 tests indicate that the test for weak measurement invariance is (barely) violated. Tests for strong and strict measurement invariance hold up, though. Probably ok to proceed, anyways.  
:::

#### Openness: current-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t1 + lambda1*openn_curr_par1_t1 + openn_curr_par2_t1 + openn_curr_par3_t1
openn_curr2 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + openn_curr_par2_t2 + openn_curr_par3_t2

# Intercepts
openn_curr_par1_t1 ~ i1*1
openn_curr_par2_t1 ~ 1
openn_curr_par3_t1 ~ 1

openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ 1
openn_curr_par3_t2 ~ 1

# Unique Variances
openn_curr_par1_t1 ~~ openn_curr_par1_t1
openn_curr_par2_t1 ~~ openn_curr_par2_t1
openn_curr_par3_t1 ~~ openn_curr_par3_t1

openn_curr_par1_t2 ~~ openn_curr_par1_t2
openn_curr_par2_t2 ~~ openn_curr_par2_t2
openn_curr_par3_t2 ~~ openn_curr_par3_t2

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_configural_openn_curr <- cfa(configural_openn_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_openn_curr, fit.measures = TRUE)

# Weak invariance model
weak_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t1 + lambda1*openn_curr_par1_t1 + lambda2*openn_curr_par2_t1 + lambda3*openn_curr_par3_t1
openn_curr2 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + lambda2*openn_curr_par2_t2 + lambda3*openn_curr_par3_t2

# Intercepts
openn_curr_par1_t1 ~ i1*1
openn_curr_par2_t1 ~ 1
openn_curr_par3_t1 ~ 1

openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ 1
openn_curr_par3_t2 ~ 1

# Unique Variances
openn_curr_par1_t1 ~~ openn_curr_par1_t1
openn_curr_par2_t1 ~~ openn_curr_par2_t1
openn_curr_par3_t1 ~~ openn_curr_par3_t1

openn_curr_par1_t2 ~~ openn_curr_par1_t2
openn_curr_par2_t2 ~~ openn_curr_par2_t2
openn_curr_par3_t2 ~~ openn_curr_par3_t2

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_weak_openn_curr <- cfa(weak_openn_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_openn_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t1 + lambda1*openn_curr_par1_t1 + lambda2*openn_curr_par2_t1 + lambda3*openn_curr_par3_t1
openn_curr2 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + lambda2*openn_curr_par2_t2 + lambda3*openn_curr_par3_t2

# Intercepts
openn_curr_par1_t1 ~ i1*1
openn_curr_par2_t1 ~ i2*1
openn_curr_par3_t1 ~ i3*1

openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ i2*1
openn_curr_par3_t2 ~ i3*1

# Unique Variances
openn_curr_par1_t1 ~~ openn_curr_par1_t1
openn_curr_par2_t1 ~~ openn_curr_par2_t1
openn_curr_par3_t1 ~~ openn_curr_par3_t1

openn_curr_par1_t2 ~~ openn_curr_par1_t2
openn_curr_par2_t2 ~~ openn_curr_par2_t2
openn_curr_par3_t2 ~~ openn_curr_par3_t2

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_strong_openn_curr <- cfa(strong_openn_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_openn_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t1 + lambda1*openn_curr_par1_t1 + lambda2*openn_curr_par2_t1 + lambda3*openn_curr_par3_t1
openn_curr2 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + lambda2*openn_curr_par2_t2 + lambda3*openn_curr_par3_t2

# Intercepts
openn_curr_par1_t1 ~ i1*1
openn_curr_par2_t1 ~ i2*1
openn_curr_par3_t1 ~ i3*1

openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ i2*1
openn_curr_par3_t2 ~ i3*1

# Unique Variances
openn_curr_par1_t1 ~~ u1*openn_curr_par1_t1
openn_curr_par2_t1 ~~ u2*openn_curr_par2_t1
openn_curr_par3_t1 ~~ u3*openn_curr_par3_t1

openn_curr_par1_t2 ~~ u1*openn_curr_par1_t2
openn_curr_par2_t2 ~~ u2*openn_curr_par2_t2
openn_curr_par3_t2 ~~ u3*openn_curr_par3_t2

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_strict_openn_curr <- cfa(strict_openn_curr, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_openn_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_openn_curr, fit_weak_openn_curr)

anova(fit_weak_openn_curr, fit_strong_openn_curr)

anova(fit_strong_openn_curr, fit_strict_openn_curr)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Openness: ideal-personality (from T1 to T2)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t1 + lambda1*openn_ideal_par1_t1 + openn_ideal_par2_t1 + openn_ideal_par3_t1
openn_ideal2 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + openn_ideal_par2_t2 + openn_ideal_par3_t2

# Intercepts
openn_ideal_par1_t1 ~ i1*1
openn_ideal_par2_t1 ~ 1
openn_ideal_par3_t1 ~ 1

openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ 1
openn_ideal_par3_t2 ~ 1

# Unique Variances
openn_ideal_par1_t1 ~~ openn_ideal_par1_t1
openn_ideal_par2_t1 ~~ openn_ideal_par2_t1
openn_ideal_par3_t1 ~~ openn_ideal_par3_t1

openn_ideal_par1_t2 ~~ openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ openn_ideal_par3_t2

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_configural_openn_ideal <- cfa(configural_openn_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural_openn_ideal, fit.measures = TRUE)

# Weak invariance model
weak_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t1 + lambda1*openn_ideal_par1_t1 + lambda2*openn_ideal_par2_t1 + lambda3*openn_ideal_par3_t1
openn_ideal2 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + lambda2*openn_ideal_par2_t2 + lambda3*openn_ideal_par3_t2

# Intercepts
openn_ideal_par1_t1 ~ i1*1
openn_ideal_par2_t1 ~ 1
openn_ideal_par3_t1 ~ 1

openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ 1
openn_ideal_par3_t2 ~ 1

# Unique Variances
openn_ideal_par1_t1 ~~ openn_ideal_par1_t1
openn_ideal_par2_t1 ~~ openn_ideal_par2_t1
openn_ideal_par3_t1 ~~ openn_ideal_par3_t1

openn_ideal_par1_t2 ~~ openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ openn_ideal_par3_t2

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_weak_openn_ideal <- cfa(weak_openn_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak_openn_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t1 + lambda1*openn_ideal_par1_t1 + lambda2*openn_ideal_par2_t1 + lambda3*openn_ideal_par3_t1
openn_ideal2 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + lambda2*openn_ideal_par2_t2 + lambda3*openn_ideal_par3_t2

# Intercepts
openn_ideal_par1_t1 ~ i1*1
openn_ideal_par2_t1 ~ i2*1
openn_ideal_par3_t1 ~ i3*1

openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ i2*1
openn_ideal_par3_t2 ~ i3*1

# Unique Variances
openn_ideal_par1_t1 ~~ openn_ideal_par1_t1
openn_ideal_par2_t1 ~~ openn_ideal_par2_t1
openn_ideal_par3_t1 ~~ openn_ideal_par3_t1

openn_ideal_par1_t2 ~~ openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ openn_ideal_par3_t2

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_strong_openn_ideal <- cfa(strong_openn_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong_openn_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t1 + lambda1*openn_ideal_par1_t1 + lambda2*openn_ideal_par2_t1 + lambda3*openn_ideal_par3_t1
openn_ideal2 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + lambda2*openn_ideal_par2_t2 + lambda3*openn_ideal_par3_t2

# Intercepts
openn_ideal_par1_t1 ~ i1*1
openn_ideal_par2_t1 ~ i2*1
openn_ideal_par3_t1 ~ i3*1

openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ i2*1
openn_ideal_par3_t2 ~ i3*1

# Unique Variances
openn_ideal_par1_t1 ~~ u1*openn_ideal_par1_t1
openn_ideal_par2_t1 ~~ u2*openn_ideal_par2_t1
openn_ideal_par3_t1 ~~ u3*openn_ideal_par3_t1

openn_ideal_par1_t2 ~~ u1*openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ u2*openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ u3*openn_ideal_par3_t2

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_strict_openn_ideal <- cfa(strict_openn_ideal, data = df_sbsa2_wide_pers %>% filter(rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict_openn_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural_openn_ideal, fit_weak_openn_ideal)

anova(fit_weak_openn_ideal, fit_strong_openn_ideal)

anova(fit_strong_openn_ideal, fit_strict_openn_ideal)
```

::: {.callout-note appearance="minimal"}
Model fit not satisfactory across all stages of measurement invariance. Chi^2 tests indicate that the test for weak measurement invariance is just about violated at (very close to .05, though). Otherwise, strong measurement invariance is given. Probably ok to proceed!
:::


### Big Five: from T2 to T3

Testing for measurement invariance of the latent BFI-2 traits across time, from T2 to T3.

#### Extraversion: current-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + extra_curr_par2_t2 + extra_curr_par3_t2
extra_curr2 =~ NA*extra_curr_par1_t3 + lambda1*extra_curr_par1_t3 + extra_curr_par2_t3 + extra_curr_par3_t3

# Intercepts
extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ 1
extra_curr_par3_t2 ~ 1

extra_curr_par1_t3 ~ i1*1
extra_curr_par2_t3 ~ 1
extra_curr_par3_t3 ~ 1

# Unique Variances
extra_curr_par1_t2 ~~ extra_curr_par1_t2
extra_curr_par2_t2 ~~ extra_curr_par2_t2
extra_curr_par3_t2 ~~ extra_curr_par3_t2

extra_curr_par1_t3 ~~ extra_curr_par1_t3
extra_curr_par2_t3 ~~ extra_curr_par2_t3
extra_curr_par3_t3 ~~ extra_curr_par3_t3

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_configural2_extra_curr <- cfa(configural2_extra_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_extra_curr, fit.measures = TRUE)

# Weak invariance model
weak2_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + lambda2*extra_curr_par2_t2 + lambda3*extra_curr_par3_t2
extra_curr2 =~ NA*extra_curr_par1_t3 + lambda1*extra_curr_par1_t3 + lambda2*extra_curr_par2_t3 + lambda3*extra_curr_par3_t3

# Intercepts
extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ 1
extra_curr_par3_t2 ~ 1

extra_curr_par1_t3 ~ i1*1
extra_curr_par2_t3 ~ 1
extra_curr_par3_t3 ~ 1

# Unique Variances
extra_curr_par1_t2 ~~ extra_curr_par1_t2
extra_curr_par2_t2 ~~ extra_curr_par2_t2
extra_curr_par3_t2 ~~ extra_curr_par3_t2

extra_curr_par1_t3 ~~ extra_curr_par1_t3
extra_curr_par2_t3 ~~ extra_curr_par2_t3
extra_curr_par3_t3 ~~ extra_curr_par3_t3

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_weak2_extra_curr <- cfa(weak2_extra_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_extra_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + lambda2*extra_curr_par2_t2 + lambda3*extra_curr_par3_t2
extra_curr2 =~ NA*extra_curr_par1_t3 + lambda1*extra_curr_par1_t3 + lambda2*extra_curr_par2_t3 + lambda3*extra_curr_par3_t3

# Intercepts
extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ i2*1
extra_curr_par3_t2 ~ i3*1

extra_curr_par1_t3 ~ i1*1
extra_curr_par2_t3 ~ i2*1
extra_curr_par3_t3 ~ i3*1

# Unique Variances
extra_curr_par1_t2 ~~ extra_curr_par1_t2
extra_curr_par2_t2 ~~ extra_curr_par2_t2
extra_curr_par3_t2 ~~ extra_curr_par3_t2

extra_curr_par1_t3 ~~ extra_curr_par1_t3
extra_curr_par2_t3 ~~ extra_curr_par2_t3
extra_curr_par3_t3 ~~ extra_curr_par3_t3

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_strong2_extra_curr <- cfa(strong2_extra_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_extra_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_extra_curr <- '
# Define the latent factors
extra_curr1 =~ NA*extra_curr_par1_t2 + lambda1*extra_curr_par1_t2 + lambda2*extra_curr_par2_t2 + lambda3*extra_curr_par3_t2
extra_curr2 =~ NA*extra_curr_par1_t3 + lambda1*extra_curr_par1_t3 + lambda2*extra_curr_par2_t3 + lambda3*extra_curr_par3_t3

# Intercepts
extra_curr_par1_t2 ~ i1*1
extra_curr_par2_t2 ~ i2*1
extra_curr_par3_t2 ~ i3*1

extra_curr_par1_t3 ~ i1*1
extra_curr_par2_t3 ~ i2*1
extra_curr_par3_t3 ~ i3*1

# Unique Variances
extra_curr_par1_t2 ~~ u1*extra_curr_par1_t2
extra_curr_par2_t2 ~~ u2*extra_curr_par2_t2
extra_curr_par3_t2 ~~ u3*extra_curr_par3_t2

extra_curr_par1_t3 ~~ u1*extra_curr_par1_t3
extra_curr_par2_t3 ~~ u2*extra_curr_par2_t3
extra_curr_par3_t3 ~~ u3*extra_curr_par3_t3

# Latent Variable Means
extra_curr1 ~ 0*1
extra_curr2 ~ 1

# Latent Variable Variances and Covariance
extra_curr1 ~~ 1*extra_curr1
extra_curr2 ~~ extra_curr2
extra_curr1 ~~ extra_curr2
'
fit_strict2_extra_curr <- cfa(strict2_extra_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_extra_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_extra_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_extra_curr, fit_weak2_extra_curr)

anova(fit_weak2_extra_curr, fit_strong2_extra_curr)

anova(fit_strong2_extra_curr, fit_strict2_extra_curr)
```

::: {.callout-note appearance="minimal"}
Model fit still not satisfactory. Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Extraversion: ideal-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + extra_ideal_par2_t2 + extra_ideal_par3_t2
extra_ideal2 =~ NA*extra_ideal_par1_t3 + lambda1*extra_ideal_par1_t3 + extra_ideal_par2_t3 + extra_ideal_par3_t3

# Intercepts
extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ 1
extra_ideal_par3_t2 ~ 1

extra_ideal_par1_t3 ~ i1*1
extra_ideal_par2_t3 ~ 1
extra_ideal_par3_t3 ~ 1

# Unique Variances
extra_ideal_par1_t2 ~~ extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ extra_ideal_par3_t2

extra_ideal_par1_t3 ~~ extra_ideal_par1_t3
extra_ideal_par2_t3 ~~ extra_ideal_par2_t3
extra_ideal_par3_t3 ~~ extra_ideal_par3_t3

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_configural2_extra_ideal <- cfa(configural2_extra_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_extra_ideal, fit.measures = TRUE)

# Weak invariance model
weak2_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + lambda2*extra_ideal_par2_t2 + lambda3*extra_ideal_par3_t2
extra_ideal2 =~ NA*extra_ideal_par1_t3 + lambda1*extra_ideal_par1_t3 + lambda2*extra_ideal_par2_t3 + lambda3*extra_ideal_par3_t3

# Intercepts
extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ 1
extra_ideal_par3_t2 ~ 1

extra_ideal_par1_t3 ~ i1*1
extra_ideal_par2_t3 ~ 1
extra_ideal_par3_t3 ~ 1

# Unique Variances
extra_ideal_par1_t2 ~~ extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ extra_ideal_par3_t2

extra_ideal_par1_t3 ~~ extra_ideal_par1_t3
extra_ideal_par2_t3 ~~ extra_ideal_par2_t3
extra_ideal_par3_t3 ~~ extra_ideal_par3_t3

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_weak2_extra_ideal <- cfa(weak2_extra_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_extra_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + lambda2*extra_ideal_par2_t2 + lambda3*extra_ideal_par3_t2
extra_ideal2 =~ NA*extra_ideal_par1_t3 + lambda1*extra_ideal_par1_t3 + lambda2*extra_ideal_par2_t3 + lambda3*extra_ideal_par3_t3

# Intercepts
extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ i2*1
extra_ideal_par3_t2 ~ i3*1

extra_ideal_par1_t3 ~ i1*1
extra_ideal_par2_t3 ~ i2*1
extra_ideal_par3_t3 ~ i3*1

# Unique Variances
extra_ideal_par1_t2 ~~ extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ extra_ideal_par3_t2

extra_ideal_par1_t3 ~~ extra_ideal_par1_t3
extra_ideal_par2_t3 ~~ extra_ideal_par2_t3
extra_ideal_par3_t3 ~~ extra_ideal_par3_t3

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_strong2_extra_ideal <- cfa(strong2_extra_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_extra_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_extra_ideal <- '
# Define the latent factors
extra_ideal1 =~ NA*extra_ideal_par1_t2 + lambda1*extra_ideal_par1_t2 + lambda2*extra_ideal_par2_t2 + lambda3*extra_ideal_par3_t2
extra_ideal2 =~ NA*extra_ideal_par1_t3 + lambda1*extra_ideal_par1_t3 + lambda2*extra_ideal_par2_t3 + lambda3*extra_ideal_par3_t3

# Intercepts
extra_ideal_par1_t2 ~ i1*1
extra_ideal_par2_t2 ~ i2*1
extra_ideal_par3_t2 ~ i3*1

extra_ideal_par1_t3 ~ i1*1
extra_ideal_par2_t3 ~ i2*1
extra_ideal_par3_t3 ~ i3*1

# Unique Variances
extra_ideal_par1_t2 ~~ u1*extra_ideal_par1_t2
extra_ideal_par2_t2 ~~ u2*extra_ideal_par2_t2
extra_ideal_par3_t2 ~~ u3*extra_ideal_par3_t2

extra_ideal_par1_t3 ~~ u1*extra_ideal_par1_t3
extra_ideal_par2_t3 ~~ u2*extra_ideal_par2_t3
extra_ideal_par3_t3 ~~ u3*extra_ideal_par3_t3

# Latent Variable Means
extra_ideal1 ~ 0*1
extra_ideal2 ~ 1

# Latent Variable Variances and Covariance
extra_ideal1 ~~ 1*extra_ideal1
extra_ideal2 ~~ extra_ideal2
extra_ideal1 ~~ extra_ideal2
'
fit_strict2_extra_ideal <- cfa(strict2_extra_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_extra_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_extra_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_extra_ideal, fit_weak2_extra_ideal)

anova(fit_weak2_extra_ideal, fit_strong2_extra_ideal)

anova(fit_strong2_extra_ideal, fit_strict2_extra_ideal)
```

::: {.callout-note appearance="minimal"}
Model fit still not satisfactory. Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Agreeableness: current-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + agree_curr_par2_t2 + agree_curr_par3_t2
agree_curr2 =~ NA*agree_curr_par1_t3 + lambda1*agree_curr_par1_t3 + agree_curr_par2_t3 + agree_curr_par3_t3

# Intercepts
agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ 1
agree_curr_par3_t2 ~ 1

agree_curr_par1_t3 ~ i1*1
agree_curr_par2_t3 ~ 1
agree_curr_par3_t3 ~ 1

# Unique Variances
agree_curr_par1_t2 ~~ agree_curr_par1_t2
agree_curr_par2_t2 ~~ agree_curr_par2_t2
agree_curr_par3_t2 ~~ agree_curr_par3_t2

agree_curr_par1_t3 ~~ agree_curr_par1_t3
agree_curr_par2_t3 ~~ agree_curr_par2_t3
agree_curr_par3_t3 ~~ agree_curr_par3_t3

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_configural2_agree_curr <- cfa(configural2_agree_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_agree_curr, fit.measures = TRUE)

# Weak invariance model
weak2_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + lambda2*agree_curr_par2_t2 + lambda3*agree_curr_par3_t2
agree_curr2 =~ NA*agree_curr_par1_t3 + lambda1*agree_curr_par1_t3 + lambda2*agree_curr_par2_t3 + lambda3*agree_curr_par3_t3

# Intercepts
agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ 1
agree_curr_par3_t2 ~ 1

agree_curr_par1_t3 ~ i1*1
agree_curr_par2_t3 ~ 1
agree_curr_par3_t3 ~ 1

# Unique Variances
agree_curr_par1_t2 ~~ agree_curr_par1_t2
agree_curr_par2_t2 ~~ agree_curr_par2_t2
agree_curr_par3_t2 ~~ agree_curr_par3_t2

agree_curr_par1_t3 ~~ agree_curr_par1_t3
agree_curr_par2_t3 ~~ agree_curr_par2_t3
agree_curr_par3_t3 ~~ agree_curr_par3_t3

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_weak2_agree_curr <- cfa(weak2_agree_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_agree_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + lambda2*agree_curr_par2_t2 + lambda3*agree_curr_par3_t2
agree_curr2 =~ NA*agree_curr_par1_t3 + lambda1*agree_curr_par1_t3 + lambda2*agree_curr_par2_t3 + lambda3*agree_curr_par3_t3

# Intercepts
agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ i2*1
agree_curr_par3_t2 ~ i3*1

agree_curr_par1_t3 ~ i1*1
agree_curr_par2_t3 ~ i2*1
agree_curr_par3_t3 ~ i3*1

# Unique Variances
agree_curr_par1_t2 ~~ agree_curr_par1_t2
agree_curr_par2_t2 ~~ agree_curr_par2_t2
agree_curr_par3_t2 ~~ agree_curr_par3_t2

agree_curr_par1_t3 ~~ agree_curr_par1_t3
agree_curr_par2_t3 ~~ agree_curr_par2_t3
agree_curr_par3_t3 ~~ agree_curr_par3_t3

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_strong2_agree_curr <- cfa(strong2_agree_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_agree_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_agree_curr <- '
# Define the latent factors
agree_curr1 =~ NA*agree_curr_par1_t2 + lambda1*agree_curr_par1_t2 + lambda2*agree_curr_par2_t2 + lambda3*agree_curr_par3_t2
agree_curr2 =~ NA*agree_curr_par1_t3 + lambda1*agree_curr_par1_t3 + lambda2*agree_curr_par2_t3 + lambda3*agree_curr_par3_t3

# Intercepts
agree_curr_par1_t2 ~ i1*1
agree_curr_par2_t2 ~ i2*1
agree_curr_par3_t2 ~ i3*1

agree_curr_par1_t3 ~ i1*1
agree_curr_par2_t3 ~ i2*1
agree_curr_par3_t3 ~ i3*1

# Unique Variances
agree_curr_par1_t2 ~~ u1*agree_curr_par1_t2
agree_curr_par2_t2 ~~ u2*agree_curr_par2_t2
agree_curr_par3_t2 ~~ u3*agree_curr_par3_t2

agree_curr_par1_t3 ~~ u1*agree_curr_par1_t3
agree_curr_par2_t3 ~~ u2*agree_curr_par2_t3
agree_curr_par3_t3 ~~ u3*agree_curr_par3_t3

# Latent Variable Means
agree_curr1 ~ 0*1
agree_curr2 ~ 1

# Latent Variable Variances and Covariance
agree_curr1 ~~ 1*agree_curr1
agree_curr2 ~~ agree_curr2
agree_curr1 ~~ agree_curr2
'
fit_strict2_agree_curr <- cfa(strict2_agree_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_agree_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_agree_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_agree_curr, fit_weak2_agree_curr)

anova(fit_weak2_agree_curr, fit_strong2_agree_curr)

anova(fit_strong2_agree_curr, fit_strict2_agree_curr)
```

::: {.callout-note appearance="minimal"}
Model fit still not satisfactory. Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Agreeableness: ideal-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + agree_ideal_par2_t2 + agree_ideal_par3_t2
agree_ideal2 =~ NA*agree_ideal_par1_t3 + lambda1*agree_ideal_par1_t3 + agree_ideal_par2_t3 + agree_ideal_par3_t3

# Intercepts
agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ 1
agree_ideal_par3_t2 ~ 1

agree_ideal_par1_t3 ~ i1*1
agree_ideal_par2_t3 ~ 1
agree_ideal_par3_t3 ~ 1

# Unique Variances
agree_ideal_par1_t2 ~~ agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ agree_ideal_par3_t2

agree_ideal_par1_t3 ~~ agree_ideal_par1_t3
agree_ideal_par2_t3 ~~ agree_ideal_par2_t3
agree_ideal_par3_t3 ~~ agree_ideal_par3_t3

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_configural2_agree_ideal <- cfa(configural2_agree_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_agree_ideal, fit.measures = TRUE)

# Weak invariance model
weak2_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + lambda2*agree_ideal_par2_t2 + lambda3*agree_ideal_par3_t2
agree_ideal2 =~ NA*agree_ideal_par1_t3 + lambda1*agree_ideal_par1_t3 + lambda2*agree_ideal_par2_t3 + lambda3*agree_ideal_par3_t3

# Intercepts
agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ 1
agree_ideal_par3_t2 ~ 1

agree_ideal_par1_t3 ~ i1*1
agree_ideal_par2_t3 ~ 1
agree_ideal_par3_t3 ~ 1

# Unique Variances
agree_ideal_par1_t2 ~~ agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ agree_ideal_par3_t2

agree_ideal_par1_t3 ~~ agree_ideal_par1_t3
agree_ideal_par2_t3 ~~ agree_ideal_par2_t3
agree_ideal_par3_t3 ~~ agree_ideal_par3_t3

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_weak2_agree_ideal <- cfa(weak2_agree_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_agree_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + lambda2*agree_ideal_par2_t2 + lambda3*agree_ideal_par3_t2
agree_ideal2 =~ NA*agree_ideal_par1_t3 + lambda1*agree_ideal_par1_t3 + lambda2*agree_ideal_par2_t3 + lambda3*agree_ideal_par3_t3

# Intercepts
agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ i2*1
agree_ideal_par3_t2 ~ i3*1

agree_ideal_par1_t3 ~ i1*1
agree_ideal_par2_t3 ~ i2*1
agree_ideal_par3_t3 ~ i3*1

# Unique Variances
agree_ideal_par1_t2 ~~ agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ agree_ideal_par3_t2

agree_ideal_par1_t3 ~~ agree_ideal_par1_t3
agree_ideal_par2_t3 ~~ agree_ideal_par2_t3
agree_ideal_par3_t3 ~~ agree_ideal_par3_t3

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_strong2_agree_ideal <- cfa(strong2_agree_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_agree_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_agree_ideal <- '
# Define the latent factors
agree_ideal1 =~ NA*agree_ideal_par1_t2 + lambda1*agree_ideal_par1_t2 + lambda2*agree_ideal_par2_t2 + lambda3*agree_ideal_par3_t2
agree_ideal2 =~ NA*agree_ideal_par1_t3 + lambda1*agree_ideal_par1_t3 + lambda2*agree_ideal_par2_t3 + lambda3*agree_ideal_par3_t3

# Intercepts
agree_ideal_par1_t2 ~ i1*1
agree_ideal_par2_t2 ~ i2*1
agree_ideal_par3_t2 ~ i3*1

agree_ideal_par1_t3 ~ i1*1
agree_ideal_par2_t3 ~ i2*1
agree_ideal_par3_t3 ~ i3*1

# Unique Variances
agree_ideal_par1_t2 ~~ u1*agree_ideal_par1_t2
agree_ideal_par2_t2 ~~ u2*agree_ideal_par2_t2
agree_ideal_par3_t2 ~~ u3*agree_ideal_par3_t2

agree_ideal_par1_t3 ~~ u1*agree_ideal_par1_t3
agree_ideal_par2_t3 ~~ u2*agree_ideal_par2_t3
agree_ideal_par3_t3 ~~ u3*agree_ideal_par3_t3

# Latent Variable Means
agree_ideal1 ~ 0*1
agree_ideal2 ~ 1

# Latent Variable Variances and Covariance
agree_ideal1 ~~ 1*agree_ideal1
agree_ideal2 ~~ agree_ideal2
agree_ideal1 ~~ agree_ideal2
'
fit_strict2_agree_ideal <- cfa(strict2_agree_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_agree_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_agree_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_agree_ideal, fit_weak2_agree_ideal)

anova(fit_weak2_agree_ideal, fit_strong2_agree_ideal)

anova(fit_strong2_agree_ideal, fit_strict2_agree_ideal)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Conscientiousness: current-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + consc_curr_par2_t2 + consc_curr_par3_t2
consc_curr2 =~ NA*consc_curr_par1_t3 + lambda1*consc_curr_par1_t3 + consc_curr_par2_t3 + consc_curr_par3_t3

# Intercepts
consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ 1
consc_curr_par3_t2 ~ 1

consc_curr_par1_t3 ~ i1*1
consc_curr_par2_t3 ~ 1
consc_curr_par3_t3 ~ 1

# Unique Variances
consc_curr_par1_t2 ~~ consc_curr_par1_t2
consc_curr_par2_t2 ~~ consc_curr_par2_t2
consc_curr_par3_t2 ~~ consc_curr_par3_t2

consc_curr_par1_t3 ~~ consc_curr_par1_t3
consc_curr_par2_t3 ~~ consc_curr_par2_t3
consc_curr_par3_t3 ~~ consc_curr_par3_t3

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_configural2_consc_curr <- cfa(configural2_consc_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_consc_curr, fit.measures = TRUE)

# Weak invariance model
weak2_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + lambda2*consc_curr_par2_t2 + lambda3*consc_curr_par3_t2
consc_curr2 =~ NA*consc_curr_par1_t3 + lambda1*consc_curr_par1_t3 + lambda2*consc_curr_par2_t3 + lambda3*consc_curr_par3_t3

# Intercepts
consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ 1
consc_curr_par3_t2 ~ 1

consc_curr_par1_t3 ~ i1*1
consc_curr_par2_t3 ~ 1
consc_curr_par3_t3 ~ 1

# Unique Variances
consc_curr_par1_t2 ~~ consc_curr_par1_t2
consc_curr_par2_t2 ~~ consc_curr_par2_t2
consc_curr_par3_t2 ~~ consc_curr_par3_t2

consc_curr_par1_t3 ~~ consc_curr_par1_t3
consc_curr_par2_t3 ~~ consc_curr_par2_t3
consc_curr_par3_t3 ~~ consc_curr_par3_t3

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_weak2_consc_curr <- cfa(weak2_consc_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_consc_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + lambda2*consc_curr_par2_t2 + lambda3*consc_curr_par3_t2
consc_curr2 =~ NA*consc_curr_par1_t3 + lambda1*consc_curr_par1_t3 + lambda2*consc_curr_par2_t3 + lambda3*consc_curr_par3_t3

# Intercepts
consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ i2*1
consc_curr_par3_t2 ~ i3*1

consc_curr_par1_t3 ~ i1*1
consc_curr_par2_t3 ~ i2*1
consc_curr_par3_t3 ~ i3*1

# Unique Variances
consc_curr_par1_t2 ~~ consc_curr_par1_t2
consc_curr_par2_t2 ~~ consc_curr_par2_t2
consc_curr_par3_t2 ~~ consc_curr_par3_t2

consc_curr_par1_t3 ~~ consc_curr_par1_t3
consc_curr_par2_t3 ~~ consc_curr_par2_t3
consc_curr_par3_t3 ~~ consc_curr_par3_t3

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_strong2_consc_curr <- cfa(strong2_consc_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_consc_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_consc_curr <- '
# Define the latent factors
consc_curr1 =~ NA*consc_curr_par1_t2 + lambda1*consc_curr_par1_t2 + lambda2*consc_curr_par2_t2 + lambda3*consc_curr_par3_t2
consc_curr2 =~ NA*consc_curr_par1_t3 + lambda1*consc_curr_par1_t3 + lambda2*consc_curr_par2_t3 + lambda3*consc_curr_par3_t3

# Intercepts
consc_curr_par1_t2 ~ i1*1
consc_curr_par2_t2 ~ i2*1
consc_curr_par3_t2 ~ i3*1

consc_curr_par1_t3 ~ i1*1
consc_curr_par2_t3 ~ i2*1
consc_curr_par3_t3 ~ i3*1

# Unique Variances
consc_curr_par1_t2 ~~ u1*consc_curr_par1_t2
consc_curr_par2_t2 ~~ u2*consc_curr_par2_t2
consc_curr_par3_t2 ~~ u3*consc_curr_par3_t2

consc_curr_par1_t3 ~~ u1*consc_curr_par1_t3
consc_curr_par2_t3 ~~ u2*consc_curr_par2_t3
consc_curr_par3_t3 ~~ u3*consc_curr_par3_t3

# Latent Variable Means
consc_curr1 ~ 0*1
consc_curr2 ~ 1

# Latent Variable Variances and Covariance
consc_curr1 ~~ 1*consc_curr1
consc_curr2 ~~ consc_curr2
consc_curr1 ~~ consc_curr2
'
fit_strict2_consc_curr <- cfa(strict2_consc_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_consc_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_consc_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_consc_curr, fit_weak2_consc_curr)

anova(fit_weak2_consc_curr, fit_strong2_consc_curr)

anova(fit_strong2_consc_curr, fit_strict2_consc_curr)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Conscientiousness: ideal-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + consc_ideal_par2_t2 + consc_ideal_par3_t2
consc_ideal2 =~ NA*consc_ideal_par1_t3 + lambda1*consc_ideal_par1_t3 + consc_ideal_par2_t3 + consc_ideal_par3_t3

# Intercepts
consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ 1
consc_ideal_par3_t2 ~ 1

consc_ideal_par1_t3 ~ i1*1
consc_ideal_par2_t3 ~ 1
consc_ideal_par3_t3 ~ 1

# Unique Variances
consc_ideal_par1_t2 ~~ consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ consc_ideal_par3_t2

consc_ideal_par1_t3 ~~ consc_ideal_par1_t3
consc_ideal_par2_t3 ~~ consc_ideal_par2_t3
consc_ideal_par3_t3 ~~ consc_ideal_par3_t3

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_configural2_consc_ideal <- cfa(configural2_consc_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_consc_ideal, fit.measures = TRUE)

# Weak invariance model
weak2_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + lambda2*consc_ideal_par2_t2 + lambda3*consc_ideal_par3_t2
consc_ideal2 =~ NA*consc_ideal_par1_t3 + lambda1*consc_ideal_par1_t3 + lambda2*consc_ideal_par2_t3 + lambda3*consc_ideal_par3_t3

# Intercepts
consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ 1
consc_ideal_par3_t2 ~ 1

consc_ideal_par1_t3 ~ i1*1
consc_ideal_par2_t3 ~ 1
consc_ideal_par3_t3 ~ 1

# Unique Variances
consc_ideal_par1_t2 ~~ consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ consc_ideal_par3_t2

consc_ideal_par1_t3 ~~ consc_ideal_par1_t3
consc_ideal_par2_t3 ~~ consc_ideal_par2_t3
consc_ideal_par3_t3 ~~ consc_ideal_par3_t3

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_weak2_consc_ideal <- cfa(weak2_consc_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_consc_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + lambda2*consc_ideal_par2_t2 + lambda3*consc_ideal_par3_t2
consc_ideal2 =~ NA*consc_ideal_par1_t3 + lambda1*consc_ideal_par1_t3 + lambda2*consc_ideal_par2_t3 + lambda3*consc_ideal_par3_t3

# Intercepts
consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ i2*1
consc_ideal_par3_t2 ~ i3*1

consc_ideal_par1_t3 ~ i1*1
consc_ideal_par2_t3 ~ i2*1
consc_ideal_par3_t3 ~ i3*1

# Unique Variances
consc_ideal_par1_t2 ~~ consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ consc_ideal_par3_t2

consc_ideal_par1_t3 ~~ consc_ideal_par1_t3
consc_ideal_par2_t3 ~~ consc_ideal_par2_t3
consc_ideal_par3_t3 ~~ consc_ideal_par3_t3

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_strong2_consc_ideal <- cfa(strong2_consc_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_consc_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_consc_ideal <- '
# Define the latent factors
consc_ideal1 =~ NA*consc_ideal_par1_t2 + lambda1*consc_ideal_par1_t2 + lambda2*consc_ideal_par2_t2 + lambda3*consc_ideal_par3_t2
consc_ideal2 =~ NA*consc_ideal_par1_t3 + lambda1*consc_ideal_par1_t3 + lambda2*consc_ideal_par2_t3 + lambda3*consc_ideal_par3_t3

# Intercepts
consc_ideal_par1_t2 ~ i1*1
consc_ideal_par2_t2 ~ i2*1
consc_ideal_par3_t2 ~ i3*1

consc_ideal_par1_t3 ~ i1*1
consc_ideal_par2_t3 ~ i2*1
consc_ideal_par3_t3 ~ i3*1

# Unique Variances
consc_ideal_par1_t2 ~~ u1*consc_ideal_par1_t2
consc_ideal_par2_t2 ~~ u2*consc_ideal_par2_t2
consc_ideal_par3_t2 ~~ u3*consc_ideal_par3_t2

consc_ideal_par1_t3 ~~ u1*consc_ideal_par1_t3
consc_ideal_par2_t3 ~~ u2*consc_ideal_par2_t3
consc_ideal_par3_t3 ~~ u3*consc_ideal_par3_t3

# Latent Variable Means
consc_ideal1 ~ 0*1
consc_ideal2 ~ 1

# Latent Variable Variances and Covariance
consc_ideal1 ~~ 1*consc_ideal1
consc_ideal2 ~~ consc_ideal2
consc_ideal1 ~~ consc_ideal2
'
fit_strict2_consc_ideal <- cfa(strict2_consc_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_consc_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_consc_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_consc_ideal, fit_weak2_consc_ideal)

anova(fit_weak2_consc_ideal, fit_strong2_consc_ideal)

anova(fit_strong2_consc_ideal, fit_strict2_consc_ideal)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strong measurement invariance is given.
:::

#### Neuroticism: current-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + neuro_curr_par2_t2 + neuro_curr_par3_t2
neuro_curr2 =~ NA*neuro_curr_par1_t3 + lambda1*neuro_curr_par1_t3 + neuro_curr_par2_t3 + neuro_curr_par3_t3

# Intercepts
neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ 1
neuro_curr_par3_t2 ~ 1

neuro_curr_par1_t3 ~ i1*1
neuro_curr_par2_t3 ~ 1
neuro_curr_par3_t3 ~ 1

# Unique Variances
neuro_curr_par1_t2 ~~ neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ neuro_curr_par3_t2

neuro_curr_par1_t3 ~~ neuro_curr_par1_t3
neuro_curr_par2_t3 ~~ neuro_curr_par2_t3
neuro_curr_par3_t3 ~~ neuro_curr_par3_t3

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_configural2_neuro_curr <- cfa(configural2_neuro_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_neuro_curr, fit.measures = TRUE)

# Weak invariance model
weak2_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + lambda2*neuro_curr_par2_t2 + lambda3*neuro_curr_par3_t2
neuro_curr2 =~ NA*neuro_curr_par1_t3 + lambda1*neuro_curr_par1_t3 + lambda2*neuro_curr_par2_t3 + lambda3*neuro_curr_par3_t3

# Intercepts
neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ 1
neuro_curr_par3_t2 ~ 1

neuro_curr_par1_t3 ~ i1*1
neuro_curr_par2_t3 ~ 1
neuro_curr_par3_t3 ~ 1

# Unique Variances
neuro_curr_par1_t2 ~~ neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ neuro_curr_par3_t2

neuro_curr_par1_t3 ~~ neuro_curr_par1_t3
neuro_curr_par2_t3 ~~ neuro_curr_par2_t3
neuro_curr_par3_t3 ~~ neuro_curr_par3_t3

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_weak2_neuro_curr <- cfa(weak2_neuro_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_neuro_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + lambda2*neuro_curr_par2_t2 + lambda3*neuro_curr_par3_t2
neuro_curr2 =~ NA*neuro_curr_par1_t3 + lambda1*neuro_curr_par1_t3 + lambda2*neuro_curr_par2_t3 + lambda3*neuro_curr_par3_t3

# Intercepts
neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ i2*1
neuro_curr_par3_t2 ~ i3*1

neuro_curr_par1_t3 ~ i1*1
neuro_curr_par2_t3 ~ i2*1
neuro_curr_par3_t3 ~ i3*1

# Unique Variances
neuro_curr_par1_t2 ~~ neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ neuro_curr_par3_t2

neuro_curr_par1_t3 ~~ neuro_curr_par1_t3
neuro_curr_par2_t3 ~~ neuro_curr_par2_t3
neuro_curr_par3_t3 ~~ neuro_curr_par3_t3

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_strong2_neuro_curr <- cfa(strong2_neuro_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_neuro_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_neuro_curr <- '
# Define the latent factors
neuro_curr1 =~ NA*neuro_curr_par1_t2 + lambda1*neuro_curr_par1_t2 + lambda2*neuro_curr_par2_t2 + lambda3*neuro_curr_par3_t2
neuro_curr2 =~ NA*neuro_curr_par1_t3 + lambda1*neuro_curr_par1_t3 + lambda2*neuro_curr_par2_t3 + lambda3*neuro_curr_par3_t3

# Intercepts
neuro_curr_par1_t2 ~ i1*1
neuro_curr_par2_t2 ~ i2*1
neuro_curr_par3_t2 ~ i3*1

neuro_curr_par1_t3 ~ i1*1
neuro_curr_par2_t3 ~ i2*1
neuro_curr_par3_t3 ~ i3*1

# Unique Variances
neuro_curr_par1_t2 ~~ u1*neuro_curr_par1_t2
neuro_curr_par2_t2 ~~ u2*neuro_curr_par2_t2
neuro_curr_par3_t2 ~~ u3*neuro_curr_par3_t2

neuro_curr_par1_t3 ~~ u1*neuro_curr_par1_t3
neuro_curr_par2_t3 ~~ u2*neuro_curr_par2_t3
neuro_curr_par3_t3 ~~ u3*neuro_curr_par3_t3

# Latent Variable Means
neuro_curr1 ~ 0*1
neuro_curr2 ~ 1

# Latent Variable Variances and Covariance
neuro_curr1 ~~ 1*neuro_curr1
neuro_curr2 ~~ neuro_curr2
neuro_curr1 ~~ neuro_curr2
'
fit_strict2_neuro_curr <- cfa(strict2_neuro_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_neuro_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_neuro_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_neuro_curr, fit_weak2_neuro_curr)

anova(fit_weak2_neuro_curr, fit_strong2_neuro_curr)

anova(fit_strong2_neuro_curr, fit_strict2_neuro_curr)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Neuroticism: ideal-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + neuro_ideal_par2_t2 + neuro_ideal_par3_t2
neuro_ideal2 =~ NA*neuro_ideal_par1_t3 + lambda1*neuro_ideal_par1_t3 + neuro_ideal_par2_t3 + neuro_ideal_par3_t3

# Intercepts
neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ 1
neuro_ideal_par3_t2 ~ 1

neuro_ideal_par1_t3 ~ i1*1
neuro_ideal_par2_t3 ~ 1
neuro_ideal_par3_t3 ~ 1

# Unique Variances
neuro_ideal_par1_t2 ~~ neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ neuro_ideal_par3_t2

neuro_ideal_par1_t3 ~~ neuro_ideal_par1_t3
neuro_ideal_par2_t3 ~~ neuro_ideal_par2_t3
neuro_ideal_par3_t3 ~~ neuro_ideal_par3_t3

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_configural2_neuro_ideal <- cfa(configural2_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_neuro_ideal, fit.measures = TRUE)

# Weak invariance model
weak2_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + lambda2*neuro_ideal_par2_t2 + lambda3*neuro_ideal_par3_t2
neuro_ideal2 =~ NA*neuro_ideal_par1_t3 + lambda1*neuro_ideal_par1_t3 + lambda2*neuro_ideal_par2_t3 + lambda3*neuro_ideal_par3_t3

# Intercepts
neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ 1
neuro_ideal_par3_t2 ~ 1

neuro_ideal_par1_t3 ~ i1*1
neuro_ideal_par2_t3 ~ 1
neuro_ideal_par3_t3 ~ 1

# Unique Variances
neuro_ideal_par1_t2 ~~ neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ neuro_ideal_par3_t2

neuro_ideal_par1_t3 ~~ neuro_ideal_par1_t3
neuro_ideal_par2_t3 ~~ neuro_ideal_par2_t3
neuro_ideal_par3_t3 ~~ neuro_ideal_par3_t3

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_weak2_neuro_ideal <- cfa(weak2_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_neuro_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + lambda2*neuro_ideal_par2_t2 + lambda3*neuro_ideal_par3_t2
neuro_ideal2 =~ NA*neuro_ideal_par1_t3 + lambda1*neuro_ideal_par1_t3 + lambda2*neuro_ideal_par2_t3 + lambda3*neuro_ideal_par3_t3

# Intercepts
neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ i2*1
neuro_ideal_par3_t2 ~ i3*1

neuro_ideal_par1_t3 ~ i1*1
neuro_ideal_par2_t3 ~ i2*1
neuro_ideal_par3_t3 ~ i3*1

# Unique Variances
neuro_ideal_par1_t2 ~~ neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ neuro_ideal_par3_t2

neuro_ideal_par1_t3 ~~ neuro_ideal_par1_t3
neuro_ideal_par2_t3 ~~ neuro_ideal_par2_t3
neuro_ideal_par3_t3 ~~ neuro_ideal_par3_t3

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_strong2_neuro_ideal <- cfa(strong2_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_neuro_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_neuro_ideal <- '
# Define the latent factors
neuro_ideal1 =~ NA*neuro_ideal_par1_t2 + lambda1*neuro_ideal_par1_t2 + lambda2*neuro_ideal_par2_t2 + lambda3*neuro_ideal_par3_t2
neuro_ideal2 =~ NA*neuro_ideal_par1_t3 + lambda1*neuro_ideal_par1_t3 + lambda2*neuro_ideal_par2_t3 + lambda3*neuro_ideal_par3_t3

# Intercepts
neuro_ideal_par1_t2 ~ i1*1
neuro_ideal_par2_t2 ~ i2*1
neuro_ideal_par3_t2 ~ i3*1

neuro_ideal_par1_t3 ~ i1*1
neuro_ideal_par2_t3 ~ i2*1
neuro_ideal_par3_t3 ~ i3*1

# Unique Variances
neuro_ideal_par1_t2 ~~ u1*neuro_ideal_par1_t2
neuro_ideal_par2_t2 ~~ u2*neuro_ideal_par2_t2
neuro_ideal_par3_t2 ~~ u3*neuro_ideal_par3_t2

neuro_ideal_par1_t3 ~~ u1*neuro_ideal_par1_t3
neuro_ideal_par2_t3 ~~ u2*neuro_ideal_par2_t3
neuro_ideal_par3_t3 ~~ u3*neuro_ideal_par3_t3

# Latent Variable Means
neuro_ideal1 ~ 0*1
neuro_ideal2 ~ 1

# Latent Variable Variances and Covariance
neuro_ideal1 ~~ 1*neuro_ideal1
neuro_ideal2 ~~ neuro_ideal2
neuro_ideal1 ~~ neuro_ideal2
'
fit_strict2_neuro_ideal <- cfa(strict2_neuro_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_neuro_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_neuro_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_neuro_ideal, fit_weak2_neuro_ideal)

anova(fit_weak2_neuro_ideal, fit_strong2_neuro_ideal)

anova(fit_strong2_neuro_ideal, fit_strict2_neuro_ideal)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance. Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Openness: current-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + openn_curr_par2_t2 + openn_curr_par3_t2
openn_curr2 =~ NA*openn_curr_par1_t3 + lambda1*openn_curr_par1_t3 + openn_curr_par2_t3 + openn_curr_par3_t3

# Intercepts
openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ 1
openn_curr_par3_t2 ~ 1

openn_curr_par1_t3 ~ i1*1
openn_curr_par2_t3 ~ 1
openn_curr_par3_t3 ~ 1

# Unique Variances
openn_curr_par1_t2 ~~ openn_curr_par1_t2
openn_curr_par2_t2 ~~ openn_curr_par2_t2
openn_curr_par3_t2 ~~ openn_curr_par3_t2

openn_curr_par1_t3 ~~ openn_curr_par1_t3
openn_curr_par2_t3 ~~ openn_curr_par2_t3
openn_curr_par3_t3 ~~ openn_curr_par3_t3

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_configural2_openn_curr <- cfa(configural2_openn_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_openn_curr, fit.measures = TRUE)

# Weak invariance model
weak2_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + lambda2*openn_curr_par2_t2 + lambda3*openn_curr_par3_t2
openn_curr2 =~ NA*openn_curr_par1_t3 + lambda1*openn_curr_par1_t3 + lambda2*openn_curr_par2_t3 + lambda3*openn_curr_par3_t3

# Intercepts
openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ 1
openn_curr_par3_t2 ~ 1

openn_curr_par1_t3 ~ i1*1
openn_curr_par2_t3 ~ 1
openn_curr_par3_t3 ~ 1

# Unique Variances
openn_curr_par1_t2 ~~ openn_curr_par1_t2
openn_curr_par2_t2 ~~ openn_curr_par2_t2
openn_curr_par3_t2 ~~ openn_curr_par3_t2

openn_curr_par1_t3 ~~ openn_curr_par1_t3
openn_curr_par2_t3 ~~ openn_curr_par2_t3
openn_curr_par3_t3 ~~ openn_curr_par3_t3

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_weak2_openn_curr <- cfa(weak2_openn_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_openn_curr, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + lambda2*openn_curr_par2_t2 + lambda3*openn_curr_par3_t2
openn_curr2 =~ NA*openn_curr_par1_t3 + lambda1*openn_curr_par1_t3 + lambda2*openn_curr_par2_t3 + lambda3*openn_curr_par3_t3

# Intercepts
openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ i2*1
openn_curr_par3_t2 ~ i3*1

openn_curr_par1_t3 ~ i1*1
openn_curr_par2_t3 ~ i2*1
openn_curr_par3_t3 ~ i3*1

# Unique Variances
openn_curr_par1_t2 ~~ openn_curr_par1_t2
openn_curr_par2_t2 ~~ openn_curr_par2_t2
openn_curr_par3_t2 ~~ openn_curr_par3_t2

openn_curr_par1_t3 ~~ openn_curr_par1_t3
openn_curr_par2_t3 ~~ openn_curr_par2_t3
openn_curr_par3_t3 ~~ openn_curr_par3_t3

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_strong2_openn_curr <- cfa(strong2_openn_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_openn_curr, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_openn_curr <- '
# Define the latent factors
openn_curr1 =~ NA*openn_curr_par1_t2 + lambda1*openn_curr_par1_t2 + lambda2*openn_curr_par2_t2 + lambda3*openn_curr_par3_t2
openn_curr2 =~ NA*openn_curr_par1_t3 + lambda1*openn_curr_par1_t3 + lambda2*openn_curr_par2_t3 + lambda3*openn_curr_par3_t3

# Intercepts
openn_curr_par1_t2 ~ i1*1
openn_curr_par2_t2 ~ i2*1
openn_curr_par3_t2 ~ i3*1

openn_curr_par1_t3 ~ i1*1
openn_curr_par2_t3 ~ i2*1
openn_curr_par3_t3 ~ i3*1

# Unique Variances
openn_curr_par1_t2 ~~ u1*openn_curr_par1_t2
openn_curr_par2_t2 ~~ u2*openn_curr_par2_t2
openn_curr_par3_t2 ~~ u3*openn_curr_par3_t2

openn_curr_par1_t3 ~~ u1*openn_curr_par1_t3
openn_curr_par2_t3 ~~ u2*openn_curr_par2_t3
openn_curr_par3_t3 ~~ u3*openn_curr_par3_t3

# Latent Variable Means
openn_curr1 ~ 0*1
openn_curr2 ~ 1

# Latent Variable Variances and Covariance
openn_curr1 ~~ 1*openn_curr1
openn_curr2 ~~ openn_curr2
openn_curr1 ~~ openn_curr2
'
fit_strict2_openn_curr <- cfa(strict2_openn_curr, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_openn_curr, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_openn_curr) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_openn_curr, fit_weak2_openn_curr)

anova(fit_weak2_openn_curr, fit_strong2_openn_curr)

anova(fit_strong2_openn_curr, fit_strict2_openn_curr)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

#### Openness: ideal-personality (from T2 to T3)

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from https://quantdev.ssri.psu.edu/sites/qdev/files/LongitudinalMeasurementInvariance_2017_1108.html

# Configural invariance model
configural2_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + openn_ideal_par2_t2 + openn_ideal_par3_t2
openn_ideal2 =~ NA*openn_ideal_par1_t3 + lambda1*openn_ideal_par1_t3 + openn_ideal_par2_t3 + openn_ideal_par3_t3

# Intercepts
openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ 1
openn_ideal_par3_t2 ~ 1

openn_ideal_par1_t3 ~ i1*1
openn_ideal_par2_t3 ~ 1
openn_ideal_par3_t3 ~ 1

# Unique Variances
openn_ideal_par1_t2 ~~ openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ openn_ideal_par3_t2

openn_ideal_par1_t3 ~~ openn_ideal_par1_t3
openn_ideal_par2_t3 ~~ openn_ideal_par2_t3
openn_ideal_par3_t3 ~~ openn_ideal_par3_t3

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_configural2_openn_ideal <- cfa(configural2_openn_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_configural2_openn_ideal, fit.measures = TRUE)

# Weak invariance model
weak2_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + lambda2*openn_ideal_par2_t2 + lambda3*openn_ideal_par3_t2
openn_ideal2 =~ NA*openn_ideal_par1_t3 + lambda1*openn_ideal_par1_t3 + lambda2*openn_ideal_par2_t3 + lambda3*openn_ideal_par3_t3

# Intercepts
openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ 1
openn_ideal_par3_t2 ~ 1

openn_ideal_par1_t3 ~ i1*1
openn_ideal_par2_t3 ~ 1
openn_ideal_par3_t3 ~ 1

# Unique Variances
openn_ideal_par1_t2 ~~ openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ openn_ideal_par3_t2

openn_ideal_par1_t3 ~~ openn_ideal_par1_t3
openn_ideal_par2_t3 ~~ openn_ideal_par2_t3
openn_ideal_par3_t3 ~~ openn_ideal_par3_t3

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_weak2_openn_ideal <- cfa(weak2_openn_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_weak2_openn_ideal, fit.measures = TRUE)

# Strong invariance model (additional constraints on manifest intercepts)
strong2_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + lambda2*openn_ideal_par2_t2 + lambda3*openn_ideal_par3_t2
openn_ideal2 =~ NA*openn_ideal_par1_t3 + lambda1*openn_ideal_par1_t3 + lambda2*openn_ideal_par2_t3 + lambda3*openn_ideal_par3_t3

# Intercepts
openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ i2*1
openn_ideal_par3_t2 ~ i3*1

openn_ideal_par1_t3 ~ i1*1
openn_ideal_par2_t3 ~ i2*1
openn_ideal_par3_t3 ~ i3*1

# Unique Variances
openn_ideal_par1_t2 ~~ openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ openn_ideal_par3_t2

openn_ideal_par1_t3 ~~ openn_ideal_par1_t3
openn_ideal_par2_t3 ~~ openn_ideal_par2_t3
openn_ideal_par3_t3 ~~ openn_ideal_par3_t3

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_strong2_openn_ideal <- cfa(strong2_openn_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strong2_openn_ideal, fit.measures = TRUE)

# Strict invariance model (additional constraints on manifest variances)
strict2_openn_ideal <- '
# Define the latent factors
openn_ideal1 =~ NA*openn_ideal_par1_t2 + lambda1*openn_ideal_par1_t2 + lambda2*openn_ideal_par2_t2 + lambda3*openn_ideal_par3_t2
openn_ideal2 =~ NA*openn_ideal_par1_t3 + lambda1*openn_ideal_par1_t3 + lambda2*openn_ideal_par2_t3 + lambda3*openn_ideal_par3_t3

# Intercepts
openn_ideal_par1_t2 ~ i1*1
openn_ideal_par2_t2 ~ i2*1
openn_ideal_par3_t2 ~ i3*1

openn_ideal_par1_t3 ~ i1*1
openn_ideal_par2_t3 ~ i2*1
openn_ideal_par3_t3 ~ i3*1

# Unique Variances
openn_ideal_par1_t2 ~~ u1*openn_ideal_par1_t2
openn_ideal_par2_t2 ~~ u2*openn_ideal_par2_t2
openn_ideal_par3_t2 ~~ u3*openn_ideal_par3_t2

openn_ideal_par1_t3 ~~ u1*openn_ideal_par1_t3
openn_ideal_par2_t3 ~~ u2*openn_ideal_par2_t3
openn_ideal_par3_t3 ~~ u3*openn_ideal_par3_t3

# Latent Variable Means
openn_ideal1 ~ 0*1
openn_ideal2 ~ 1

# Latent Variable Variances and Covariance
openn_ideal1 ~~ 1*openn_ideal1
openn_ideal2 ~~ openn_ideal2
openn_ideal1 ~~ openn_ideal2
'
fit_strict2_openn_ideal <- cfa(strict2_openn_ideal, data = df_sbsa2_wide_pers %>% filter(valid_t2==1 & rando!="Waitlist-Control"), mimic = "mplus", missing="ML")
summary(fit_strict2_openn_ideal, fit.measures = TRUE)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# compare model fit
bind_rows(broom::glance(fit_configural2_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_weak2_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strong2_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr),
          broom::glance(fit_strict2_openn_ideal) %>% 
            select(nobs, npar, chisq, AIC, BIC, cfi, tli, rmsea, srmr)) %>% 
  mutate(model = c("configural", "weak", "strong", "strict")) %>% 
  select(model, everything())

# chi-square difference test for nested models 
anova(fit_configural2_openn_ideal, fit_weak2_openn_ideal)

anova(fit_weak2_openn_ideal, fit_strong2_openn_ideal)

anova(fit_strong2_openn_ideal, fit_strict2_openn_ideal)
```

::: {.callout-note appearance="minimal"}
Good model fit across all stages of measurement invariance (except for RMSEA). Chi^2 tests indicate that strict measurement invariance is given.
:::

------------------------------------------------------------------------

## Descriptives

### Sample size

How many participants at each time point and in each condition?
```{r}
#| echo: true
#| warning: false

df_sbsa2 %>% group_by(time, rando) %>% tally()
```

### Demographics

Gender and age distribution
```{r}
#| echo: true
#| warning: false

# across all participants
df_sbsa2 %>% group_by(pid) %>% slice_head(n=1) %>% ungroup() %>% 
  mutate(gender_num = ifelse(gender=="Female", 1, 0)) %>% 
  summarise(n = n(), women = sum(gender_num), m_age = mean(age, na.rm=T), 
            sd_age = sd(age, na.rm=T), min_age = min(age, na.rm=T), max_age = max(age, na.rm=T))

df_sbsa2 %>% group_by(time, rando) %>% 
  summarise(n = n(), m_age = mean(age, na.rm=T), sd_age = sd(age, na.rm=T), min_age = min(age, na.rm=T), max_age = max(age, na.rm=T))

df_sbsa2 %>% group_by(time, rando, gender) %>% 
  summarise(n = n(), m_age = mean(age, na.rm=T), sd_age = sd(age, na.rm=T), min_age = min(age, na.rm=T), max_age = max(age, na.rm=T))
```

Other demographics (from Prolific info):

```{r}
#| echo: true
#| warning: false

# across all participants: ethnicity
df_sbsa2 %>% group_by(pid) %>% slice_head(n=1) %>% ungroup() %>% 
  group_by(ethnicity) %>% summarise(n = n()) %>% ungroup() %>% 
  arrange(desc(n)) %>% mutate(prop = round(n / sum(n) * 100, 3))

# across all participants: country of residence
df_sbsa2 %>% group_by(pid) %>% slice_head(n=1) %>% ungroup() %>% 
  group_by(country) %>% summarise(n = n()) %>% ungroup() %>% 
  arrange(desc(n)) %>% mutate(prop = round(n / sum(n) * 100, 3)) %>% print(n=20)

# across all participants: student status
df_sbsa2 %>% group_by(pid) %>% slice_head(n=1) %>% ungroup() %>% 
  group_by(student) %>% summarise(n = n()) %>% ungroup() %>% 
  arrange(desc(n)) %>% mutate(prop = round(n / sum(n) * 100, 3))

# across all participants: employment status
df_sbsa2 %>% group_by(pid) %>% slice_head(n=1) %>% ungroup() %>% 
  group_by(employed) %>% summarise(n = n()) %>% ungroup() %>% 
  arrange(desc(n)) %>% mutate(prop = round(n / sum(n) * 100, 3))
```

### Internal consistencies

On the trait/dimensional level:
```{r}
#| echo: true
#| warning: false

# created in study 2 cleaning script 
base::load("data/int_consist_traits_st2.rda")
kable(int_consist_traits_st2, digits = 3)
```

McDonald's omega only really makes sense for the Big Five dimensions (with their three facets each) but I've added it for the well-being measures as well. Keep in mind that a few of the omega computations for the well-being measures only converged with error messages. These constructs were not neccessarily intended to be tested in this multidimensional manner for internal consistency.  

On the facet level:
```{r}
#| echo: true
#| warning: false

# created in study 2 cleaning script 
base::load("data/int_consist_facets_st2.rda")
kable(int_consist_facets_st2, digits = 3)
```

### General change/acceptance goals

Summary stats:
```{r}
#| echo: true
table(df_sbsa2$sb06_01) # How much do you want to change your personality in general?
summary(df_sbsa2$sb06_01)

table(df_sbsa2$sa06_01) # How much do you want to be better at accepting yourself for who you are?
summary(df_sbsa2$sa06_01)
```

Plot:

```{r}
#| echo: true

cowplot::plot_grid(
  ggplot(df_sbsa2 %>% filter(!is.na(sb06_01)), aes(x=sb06_01)) + geom_histogram(bins=5) + 
  labs(x="General change goal", y="Frequency") + theme_bw(),
  ggplot(df_sbsa2 %>% filter(!is.na(sa06_01)), aes(x=sa06_01)) + geom_histogram(bins=5) + 
  labs(x="General acceptance goal", y="Frequency") + theme_bw(), 
  ncol = 2
)
```

### Facet-specific change/acceptance goals

*Self-Improvement*  

Pre:  
Here is a list of 15 personality traits. You might be high or low on any of these traits. Regardless of how high or low you are on these traits, we want to know how much you [want to] change. Please rate how much you would like to change your level of each of these traits, where 1 = I do not want to change and 5 = I want to change a lot.  

Post:  
Here is a list of 15 personality traits. During the study, you may have tried to change in some of these traits. We want to know how you think you changed in each trait. Please rate how much you changed your level of each of these traits during this study, where 1 = I am completely the same and 5 = I have changed a lot.  

*Self Acceptance*  

Pre:  
Here is a list of 15 personality traits. You might be high or low on any of these traits. Regardless of how high or low you are on these traits, we want to know how much you accept yourself. Please rate how much you accept your level of each of these traits, where 1 = I completely accept myself and 5 = I want to accept myself more.  

Post:  
Here is a list of 15 personality traits. During the study, you may have tried to accept your level on some of these traits more. We want to know how much you think you accept yourself more because of this study. Please rate how much you accept your level of each of these traits more during this study, where 1 = I accept myself the same and 5 = I accept this about myself much more.  


Plot distributions

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| fig-width: 9.5
#| fig-height: 9.5

cowplot::plot_grid(
  ggdraw() + draw_label(names(b5_vars)[5 + 01], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_01)), aes(x=sb07_01)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_01)), aes(x=sb12_01)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_01)), aes(x=sa07_01)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_01)), aes(x=sa14_01)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 02], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_02)), aes(x=sb07_02)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_02)), aes(x=sb12_02)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_02)), aes(x=sa07_02)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_02)), aes(x=sa14_02)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 03], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_03)), aes(x=sb07_03)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_03)), aes(x=sb12_03)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_03)), aes(x=sa07_03)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_03)), aes(x=sa14_03)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ncol = 1,
  rel_heights = c(0.1, 1, 0.1, 1, 0.1, 1)
)
```

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| fig-width: 9.5
#| fig-height: 9.5

cowplot::plot_grid(
  ggdraw() + draw_label(names(b5_vars)[5 + 04], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_04)), aes(x=sb07_04)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_04)), aes(x=sb12_04)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_04)), aes(x=sa07_04)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_04)), aes(x=sa14_04)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 05], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_05)), aes(x=sb07_05)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175, 200), limits = c(0,220)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_05)), aes(x=sb12_05)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175, 200), limits = c(0,220)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_05)), aes(x=sa07_05)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175, 200), limits = c(0,220)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_05)), aes(x=sa14_05)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175, 200), limits = c(0,220)),
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 06], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_06)), aes(x=sb07_06)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_06)), aes(x=sb12_06)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_06)), aes(x=sa07_06)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_06)), aes(x=sa14_06)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ncol = 1,
  rel_heights = c(0.1, 1, 0.1, 1, 0.1, 1)
)
```

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| fig-width: 9.5
#| fig-height: 9.5

cowplot::plot_grid(
  ggdraw() + draw_label(names(b5_vars)[5 + 07], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_07)), aes(x=sb07_07)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_07)), aes(x=sb12_07)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_07)), aes(x=sa07_07)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_07)), aes(x=sa14_07)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 08], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_08)), aes(x=sb07_08)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_08)), aes(x=sb12_08)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_08)), aes(x=sa07_08)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_08)), aes(x=sa14_08)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 09], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_09)), aes(x=sb07_09)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_09)), aes(x=sb12_09)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_09)), aes(x=sa07_09)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_09)), aes(x=sa14_09)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ncol = 1,
  rel_heights = c(0.1, 1, 0.1, 1, 0.1, 1)
)
```

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| fig-width: 9.5
#| fig-height: 9.5

cowplot::plot_grid(
  ggdraw() + draw_label(names(b5_vars)[5 + 10], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_10)), aes(x=sb07_10)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175), limits = c(0,200)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_10)), aes(x=sb12_10)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175), limits = c(0,200)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_10)), aes(x=sa07_10)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175), limits = c(0,200)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_10)), aes(x=sa14_10)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150, 175), limits = c(0,200)), 
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 11], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_11)), aes(x=sb07_11)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_11)), aes(x=sb12_11)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_11)), aes(x=sa07_11)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_11)), aes(x=sa14_11)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 12], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_12)), aes(x=sb07_12)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_12)), aes(x=sb12_12)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_12)), aes(x=sa07_12)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_12)), aes(x=sa14_12)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ncol = 1,
  rel_heights = c(0.1, 1, 0.1, 1, 0.1, 1)
)
```

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| fig-width: 9.5
#| fig-height: 9.5

cowplot::plot_grid(
  ggdraw() + draw_label(names(b5_vars)[5 + 13], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_13)), aes(x=sb07_13)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_13)), aes(x=sb12_13)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_13)), aes(x=sa07_13)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_13)), aes(x=sa14_13)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 14], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_14)), aes(x=sb07_14)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_14)), aes(x=sb12_14)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_14)), aes(x=sa07_14)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_14)), aes(x=sa14_14)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ggdraw() + draw_label(names(b5_vars)[5 + 15], fontface = 'plain', x = 0, hjust = 0) + theme(plot.margin = margin(0, 0, 0, 7)),
  cowplot::plot_grid(
    ggplot(df_sbsa2 %>% filter(!is.na(sb07_15)), aes(x=sb07_15)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Pre", y="Frequency") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sb12_15)), aes(x=sb12_15)) + geom_histogram(bins=5) + 
    labs(x="Change goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)), 
    ggplot(df_sbsa2 %>% filter(!is.na(sa07_15)), aes(x=sa07_15)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Pre", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
    ggplot(df_sbsa2 %>% filter(!is.na(sa14_15)), aes(x=sa14_15)) + geom_histogram(bins=5) + 
    labs(x="Acceptance goal: Post", y="") + theme_bw() + scale_y_continuous(breaks = c(25, 50, 75, 100, 125, 150), limits = c(0,170)),
  ncol = 4), 
  ncol = 1,
  rel_heights = c(0.1, 1, 0.1, 1, 0.1, 1)
)
```

### Attrition analyses

#### From T1 to T2

Do participants who only took part in T1 differ from those taking part in T1 and T2?

Determine groups of "remainers" vs. "drop-outs" and run analyses:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

attrition_sample_1 <- df_sbsa2 %>% 
  filter(time %in% c(1:2)) %>% 
  group_by(pid) %>% mutate(last_time = max(time)) %>% ungroup() %>% 
  filter(time==1) %>% 
  select(pid, last_time, 
         contains("_comb_"), c("swls", "meaning", "selfes", "concept"), # outcomes
         gender, age, ethnicity, student, employed) %>% # demographics
  mutate(remained = last_time - 1,
         female = if_else(gender=="Female", 1, 0, NA_real_),
         white = if_else(ethnicity=="White", 1, 0, NA_real_),
         black = if_else(ethnicity=="Black", 1, 0, NA_real_),
         student = if_else(student=="Yes", 1, 0, NA_real_),
         fulltime = if_else(employed=="Full-Time", 1, 0, NA_real_),
         parttime = if_else(employed=="Part-Time", 1, 0, NA_real_),
         notemployed = if_else(employed=="Unemployed (and job seeking)" | 
                                 employed=="Not in paid work (e.g. homemaker', 'retired or disabled)" | 
                                 employed=="Due to start a new job within the next month", 1, 0, NA_real_),) %>% 
  select(-c(last_time, na_comb_curr, na_comb_ideal, gender, ethnicity, employed))

attrition_analysis_1 <- colnames(attrition_sample_1) %>%                                # Start with all column names
    setdiff( c("pid", "remained" ) ) %>%                 # ...that are not Sepal.Length
    rlang::syms() %>%                             # Convert them to symbols
    map( ~rlang::expr(lm(!!.x ~ remained,
                         data=attrition_sample_1)) ) %>%        # Create expressions
    map( eval.parent ) %>%                        # Evaluate expressions
    map( broom::tidy ) %>%                        # Tidy up the output
    bind_rows() %>%                               # Combine into a single data frame
    filter( term != "(Intercept)" ) %>%                # Drop all (Intercept) entries
    mutate(outcome = colnames(attrition_sample_1) %>% setdiff( c("pid", "remained" ) ))
```

Display significant differences: 
```{r}
#| echo: true
#| warning: false

attrition_analysis_1 %>% filter(p.value < .05) %>% arrange(desc(abs(estimate)))

effectsize::cohens_d(respo_comb_curr ~ remained, data = attrition_sample_1)
effectsize::cohens_d(organ_comb_curr ~ remained, data = attrition_sample_1)
effectsize::cohens_d(consc_comb_curr ~ remained, data = attrition_sample_1)
effectsize::cohens_d(aesth_comb_curr ~ remained, data = attrition_sample_1)
effectsize::cohens_d(respe_comb_curr ~ remained, data = attrition_sample_1)
```

Participants who dropped out at T2 were less responsible, d = -0.28, 95% CI [-0.47; -0.09], p = .004, less organized, d = -0.22, 95% CI [-0.41; -0.02], p = .021, less conscientious, d = -0.25, 95% CI [-0.44; -0.06], p = .010, less aesthetically oriented, d = -0.20, 95% CI [-0.39; -0.01], p = .042, and less respectful, d = -0.19, 95% CI [-0.38; -0.001], p = .046. In addition, participants who dropped out at T3 were younger, d = -0.27, 95% CI [-0.49; -0.04], p = .019, less organized, d = -0.27, 95% CI [-0.50; -0.05], p = .017, and less conscientious, d = -0.25, 95% CI [-0.47; -0.02], p = .031, and also rated their ideal personality as less conscientious, d = -0.31, 95% CI [-0.53; -0.08], p = .007, less organized, d = -0.36, 95% CI [-0.58; -0.13], p = .002, less productive, d = -0.28, 95% CI [-0.50; -0.05], p = .015, and less imaginative, d = -0.24, 95% CI [-0.47; -0.02], p = .035.  

Show all results: 
```{r}
#| echo: true
#| warning: false

attrition_analysis_1 %>% arrange(desc(abs(estimate))) %>% print(n=200)
```

#### From T2 to T3

Do participants who only took part in T1 differ from those taking part in T1 and T2?

Determine groups of "remainers" vs. "drop-outs" and run analyses:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

attrition_sample_2 <- df_sbsa2 %>% 
  filter(time %in% c(2:3)) %>% 
  group_by(pid) %>% mutate(last_time = max(time)) %>% ungroup() %>% 
  filter(time==2) %>% 
  select(pid, last_time, 
         contains("_comb_"), c("swls", "meaning", "selfes", "concept"), # outcomes
         gender, age, ethnicity, student, employed) %>% # demographics
  mutate(remained = last_time - 2,
         female = if_else(gender=="Female", 1, 0, NA_real_),
         white = if_else(ethnicity=="White", 1, 0, NA_real_),
         black = if_else(ethnicity=="Black", 1, 0, NA_real_),
         student = if_else(student=="Yes", 1, 0, NA_real_),
         fulltime = if_else(employed=="Full-Time", 1, 0, NA_real_),
         parttime = if_else(employed=="Part-Time", 1, 0, NA_real_),
         notemployed = if_else(employed=="Unemployed (and job seeking)" | 
                                 employed=="Not in paid work (e.g. homemaker', 'retired or disabled)" | 
                                 employed=="Due to start a new job within the next month", 1, 0, NA_real_),) %>% 
  select(-c(last_time, na_comb_curr, na_comb_ideal, gender, ethnicity, employed))

attrition_analysis_2 <- colnames(attrition_sample_2) %>%                                # Start with all column names
    setdiff( c("pid", "remained" ) ) %>%                 # ...that are not Sepal.Length
    rlang::syms() %>%                             # Convert them to symbols
    map( ~rlang::expr(lm(!!.x ~ remained,
                         data=attrition_sample_2)) ) %>%        # Create expressions
    map( eval.parent ) %>%                        # Evaluate expressions
    map( broom::tidy ) %>%                        # Tidy up the output
    bind_rows() %>%                               # Combine into a single data frame
    filter( term != "(Intercept)" ) %>%                # Drop all (Intercept) entries
    mutate(outcome = colnames(attrition_sample_2) %>% setdiff( c("pid", "remained" ) ))
```

Display significant differences: 
```{r}
#| echo: true
#| warning: false

attrition_analysis_2 %>% filter(p.value < .05) %>% arrange(desc(abs(estimate)))

effectsize::cohens_d(age ~ remained, data = attrition_sample_2)
effectsize::cohens_d(organ_comb_curr ~ remained, data = attrition_sample_2)
effectsize::cohens_d(organ_comb_ideal ~ remained, data = attrition_sample_2)
effectsize::cohens_d(consc_comb_curr ~ remained, data = attrition_sample_2)
effectsize::cohens_d(consc_comb_ideal ~ remained, data = attrition_sample_2)
effectsize::cohens_d(produ_comb_ideal ~ remained, data = attrition_sample_2)
effectsize::cohens_d(imagi_comb_ideal ~ remained, data = attrition_sample_2)
```

Show all results: 
```{r}
#| echo: true
#| warning: false

attrition_analysis_2 %>% arrange(desc(abs(estimate))) %>% print(n=200)
```

### Standard deviations (for later standardization)

Personality
```{r}
#| echo: true
#| warning: false

sd_pers_st2 <- df_sbsa2 %>% 
  select(pid, time, rando, contains("_comb_"), -c(na_comb_curr, na_comb_ideal)) %>% 
  pivot_longer(-c(pid, time, rando), 
               cols_vary = "slowest",
               names_to = c("trait", "reference"),
               names_pattern = "(.*)_(.*)",
               values_to = "score") %>% 
  mutate(trait = gsub("_comb", "", trait),
         reference = ifelse(reference=="curr", "current", reference)) %>% 
  left_join(tibble(long = str_to_title(names(b5_vars)), trait = str_trunc(names(b5_vars), 5, ellipsis = ""))) %>% 
  filter(!is.na(score)) %>% 
  group_by(long, trait, reference, time) %>% 
  summarise(n = n(), m_trait = mean(score), sd_trait = sd(score)) %>% 
  ungroup()
```

Well-being

```{r}
#| echo: true
#| warning: false

sd_wb_st2 <- df_sbsa2 %>% 
  select(pid, time, rando, swls, meaning, selfes, concept) %>% 
  pivot_longer(-c(pid, time, rando), 
               cols_vary = "slowest",
               names_to = c("trait"),
               values_to = "score") %>% 
  mutate(long = case_when(trait=="swls" ~ "Life Satisfaction", trait=="meaning" ~ "Meaning in Life", 
                           trait=="selfes" ~ "Self-Esteem", trait=="concept" ~ "Self-Concept Clarity")) %>% 
  filter(!is.na(score)) %>% 
  group_by(long, trait, time) %>% 
  summarise(n = n(), m_trait = mean(score), sd_trait = sd(score)) %>% 
  ungroup()
```

------------------------------------------------------------------------

## Confirmatory results

### H1: Well-being - similarity correlations (H4 in paper) {#hyp1}

*All four psychological well-being indicators will be positively correlated with a greater similarity between current- and ideal personality-ratings of personality.* 

To examine this at the level of overall profiles, we will compute the correlations between the psychological well-being indicators and the Fisher z transformed correlations between the facet- and item-level real-ideal personality-profiles. To examine this at the level of individual traits, we will compute the correlation between psychological well-being indicators and the squared difference between current- and ideal-personality rating for each Big Five trait and facet. 

#### Profile similarity 

Only in the intervention groups (without the waitlist control group).  

Computations:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

cormat_profile <- cor((df_sbsa2 %>% filter(rando!="Waitlist-Control"))[, c("swls", "meaning", "selfes", "concept",
                                  "profile_corr_item_z", "profile_corr_facet_z")], use = "pairwise.complete.obs")

rownames(cormat_profile) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
colnames(cormat_profile) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
```

```{r}
#| echo: true
corrplot(cormat_profile, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

::: {.callout-note appearance="minimal"}
Positive correlations of well-being indicators with profile similarity between current personality and ideal personality personality. Especially high correlation with self-esteem. High congruence of item-level and facet-level profile similarity.
:::

As a table with confidence intervals - profile similarity:  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

bind_rows(
  bind_cols(
  cormat_profile[5, c(1:4)] %>% as_tibble() %>% 
    mutate(wellbeing = c("swls", "meaning", "selfes", "concept"),
           profile_sim = rep("item-level", 4)) %>% 
    select(profile_sim, wellbeing, corr = value),
  correlation::cor_to_ci(cormat_profile[5, c(1:4)], n = (df_sbsa2 %>% filter(!is.na(swls) & rando!="Waitlist-Control") 
                                        %>% tally() %>% pull()), ci = 0.999) %>% as_tibble(),
  correlation::cor_to_p(cormat_profile[5, c(1:4)], n = (df_sbsa2 %>% filter(!is.na(swls) & rando!="Waitlist-Control") 
                                      %>% tally() %>% pull())) %>% as_tibble() %>% select(p) 
  ),
bind_cols(
  cormat_profile[6, c(1:4)] %>% as_tibble() %>% 
    mutate(wellbeing = c("swls", "meaning", "selfes", "concept"),
           profile_sim = rep("facet-level", 4)) %>% 
    select(profile_sim, wellbeing, corr = value),
  correlation::cor_to_ci(cormat_profile[6, c(1:4)], n = (df_sbsa2 %>% filter(!is.na(swls) & rando!="Waitlist-Control") 
                                        %>% tally() %>% pull()), ci = 0.999) %>% as_tibble(),
  correlation::cor_to_p(cormat_profile[6, c(1:4)], n = (df_sbsa2 %>% filter(!is.na(swls) & rando!="Waitlist-Control") 
                                      %>% tally() %>% pull())) %>% as_tibble() %>% select(p)
  )
) %>% kable(digits = 3)
```

##### Change in this relation over time and across intervention groups

Computations:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

# T1
cormat_profile_sb_t1 <- cor((df_sbsa2 %>% filter(rando=="Self-Improvement" & time==1))[, c("swls", "meaning", "selfes", "concept",                                  "profile_corr_item_z", "profile_corr_facet_z")], use = "pairwise.complete.obs")
rownames(cormat_profile_sb_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
colnames(cormat_profile_sb_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")

cormat_profile_sa_t1 <- cor((df_sbsa2 %>% filter(rando=="Self-Acceptance" & time==1))[, c("swls", "meaning", "selfes", "concept",                                  "profile_corr_item_z", "profile_corr_facet_z")], use = "pairwise.complete.obs")
rownames(cormat_profile_sa_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
colnames(cormat_profile_sa_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")

# T2
cormat_profile_sb_t2 <- cor((df_sbsa2 %>% filter(rando=="Self-Improvement" & time==2))[, c("swls", "meaning", "selfes", "concept",                                  "profile_corr_item_z", "profile_corr_facet_z")], use = "pairwise.complete.obs")
rownames(cormat_profile_sb_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
colnames(cormat_profile_sb_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")

cormat_profile_sa_t2 <- cor((df_sbsa2 %>% filter(rando=="Self-Acceptance" & time==2))[, c("swls", "meaning", "selfes", "concept",                                  "profile_corr_item_z", "profile_corr_facet_z")], use = "pairwise.complete.obs")
rownames(cormat_profile_sa_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
colnames(cormat_profile_sa_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")

# T3
cormat_profile_sb_t3 <- cor((df_sbsa2 %>% filter(rando=="Self-Improvement" & time==3))[, c("swls", "meaning", "selfes", "concept",                                  "profile_corr_item_z", "profile_corr_facet_z")], use = "pairwise.complete.obs")
rownames(cormat_profile_sb_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
colnames(cormat_profile_sb_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")

cormat_profile_sa_t3 <- cor((df_sbsa2 %>% filter(rando=="Self-Acceptance" & time==3))[, c("swls", "meaning", "selfes", "concept",                                  "profile_corr_item_z", "profile_corr_facet_z")], use = "pairwise.complete.obs")
rownames(cormat_profile_sa_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
colnames(cormat_profile_sa_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                              "Item-Level Profile Corr (z)", "Facet-Level Profile Corr (z)")
```

T1  

First assessment: Self-improvement group  
```{r}
#| echo: true
corrplot(cormat_profile_sb_t1, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

First assessment: Self-acceptance group  
```{r}
#| echo: true
corrplot(cormat_profile_sa_t1, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

T2  
Second assessment: Self-improvement group  
```{r}
#| echo: true
corrplot(cormat_profile_sb_t2, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

Second assessment: Self-acceptance group  
```{r}
#| echo: true
corrplot(cormat_profile_sa_t2, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

T3  
Third assessment: Self-improvement group  
```{r}
#| echo: true
corrplot(cormat_profile_sb_t3, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

Third assessment: Self-acceptance group
```{r}
#| echo: true
corrplot(cormat_profile_sa_t3, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

::: {.callout-note appearance="minimal"}
No pronounced differences across time or groups.
:::

#### Individual traits: squared differences

Only in the intervention groups (without the waitlist control group).  

Computations:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

cormat_sqtraits <- cor((df_sbsa2 %>% filter(rando!="Waitlist-Control"))[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[1:5], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")

rownames(cormat_sqtraits) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
colnames(cormat_sqtraits) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))

cormat_sqfacets <- cor(df_sbsa2[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[6:20], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")

rownames(cormat_sqfacets) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[6:20]))
colnames(cormat_sqfacets) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[6:20]))
```

Big Five traits
```{r}
#| echo: true
corrplot(cormat_sqtraits, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
         addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

As a table with confidence intervals - squared differences:  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

cormat_sqtraits[c(5:9), c(1:4)] %>% as_tibble() %>% 
    mutate(personality = names(b5_vars)[1:5]) %>% 
    rename(swls = `Life Satisfaction`, meaning = `Meaning in Life`, 
           selfes = `Self-Esteem`, concept = `Self Concept Clarity`) %>% 
    pivot_longer(1:4, names_to = "wellbeing", values_to = "corr") %>% 
    mutate(CI_low = correlation::cor_to_ci(corr, n = (df_sbsa2 %>% 
                                                        filter(!is.na(swls) & rando!="Waitlist-Control") 
                                        %>% tally() %>% pull()), ci = 0.999) %>% 
             as_tibble() %>% pull(CI_low),
           CI_high = correlation::cor_to_ci(corr, n = (df_sbsa2 %>% 
                                                        filter(!is.na(swls) & rando!="Waitlist-Control") 
                                        %>% tally() %>% pull()), ci = 0.999) %>% 
             as_tibble() %>% pull(CI_high),
           p = correlation::cor_to_p(corr, n = (df_sbsa2 %>% 
                                                        filter(!is.na(swls) & rando!="Waitlist-Control") 
                                        %>% tally() %>% pull())) %>% 
             as_tibble() %>% pull(p)) %>% 
  kable(digits = 3)
```

Big Five facets
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
corrplot(cormat_sqfacets, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
         addCoef.col ='black', number.cex = 0.6, diag = FALSE) # also add numbers
```

::: {.callout-note appearance="minimal"}
Here we see negative correlations of well-being indicators with squared trait- and facet-level mean-score differences between current personality and ideal personality personality. Especially pronounced negative correlations for neuroticism, extraversion, and conscientiousness (in that order). On the facet-level, we see that depression is the facet with the highest correlation of its squared difference with well-being, followed by energy. Within conscientiousness, productiveness has the strongest correlation.
:::

##### Change in this relation over time and across intervention groups

Only looking at the trait level for now!  

Computations:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

# T1
cormat_sqtraits_sb_t1 <- cor((df_sbsa2 %>% filter(rando=="Self-Improvement" & time==1))[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[1:5], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")
rownames(cormat_sqtraits_sb_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
colnames(cormat_sqtraits_sb_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))

cormat_sqtraits_sa_t1 <- cor((df_sbsa2 %>% filter(rando=="Self-Acceptance" & time==1))[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[1:5], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")
rownames(cormat_sqtraits_sa_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
colnames(cormat_sqtraits_sa_t1) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))

# T2
cormat_sqtraits_sb_t2 <- cor((df_sbsa2 %>% filter(rando=="Self-Improvement" & time==2))[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[1:5], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")
rownames(cormat_sqtraits_sb_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
colnames(cormat_sqtraits_sb_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))

cormat_sqtraits_sa_t2 <- cor((df_sbsa2 %>% filter(rando=="Self-Acceptance" & time==2))[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[1:5], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")
rownames(cormat_sqtraits_sa_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
colnames(cormat_sqtraits_sa_t2) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))

# T3
cormat_sqtraits_sb_t3 <- cor((df_sbsa2 %>% filter(rando=="Self-Improvement" & time==3))[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[1:5], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")
rownames(cormat_sqtraits_sb_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
colnames(cormat_sqtraits_sb_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))

cormat_sqtraits_sa_t3 <- cor((df_sbsa2 %>% filter(rando=="Self-Acceptance" & time==3))[, c("swls", "meaning", "selfes", "concept",
                                   paste0(str_trunc(names(b5_vars)[1:5], 5, ellipsis = ""), "_sqdiff"))], 
                       use = "pairwise.complete.obs")
rownames(cormat_sqtraits_sa_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
colnames(cormat_sqtraits_sa_t3) <- c("Life Satisfaction", "Meaning in Life", "Self-Esteem" , "Self Concept Clarity", 
                               str_to_title(names(b5_vars)[1:5]))
```

T1  

First assessment: Self-improvement group  
```{r}
#| echo: true
corrplot(cormat_sqtraits_sb_t1, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

First assessment: Self-acceptance group  
```{r}
#| echo: true
corrplot(cormat_sqtraits_sa_t1, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

::: {.callout-note appearance="minimal"}
High similarity at T1.
:::

T2  
Second assessment: Self-improvement group  
```{r}
#| echo: true
corrplot(cormat_sqtraits_sb_t2, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

Second assessment: Self-acceptance group  
```{r}
#| echo: true
corrplot(cormat_sqtraits_sa_t2, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

::: {.callout-note appearance="minimal"}
At T2, attenuated correlations for agreeableness and (to a lesser degree) conscientiousness in the self-improvement group compared to T1.
:::

T3  
Third assessment: Self-improvement group  
```{r}
#| echo: true
corrplot(cormat_sqtraits_sb_t3, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

Third assessment: Self-acceptance group
```{r}
#| echo: true
corrplot(cormat_sqtraits_sa_t3, type = "lower", order = "original", tl.col = "black", tl.srt = 10,
                      addCoef.col ='black', number.cex = 0.7, diag = FALSE) # also add numbers
```

::: {.callout-note appearance="minimal"}
At T3, slightly lower correlations for neuroticism in the self-acceptance group (compared to the self-improvement group). But only small difference.  
:::

##### Exploratory: Controlling for initial trait levels

Additional, exploratory analysis: Are the relationships of the squared trait differences with well-being similar when we control for initial trait levels (at T1)?

Example with extraversion:
```{r}
#| echo: true
#| warning: false

cor(df_sbsa2 %>% filter(rando!="Waitlist-Control" & time==1) %>% pull(swls), 
    df_sbsa2 %>% filter(rando!="Waitlist-Control" & time==1) %>% pull(extra_sqdiff), 
    use = "pairwise.complete.obs") %>% round(2)

# basic model to replicate the correlation
mod_ex_1 <- lm(swls ~ extra_sqdiff, data = df_sbsa2 %>% filter(rando!="Waitlist-Control" & time==1))
summary(mod_ex_1)$coef
effectsize::standardize_parameters(mod_ex_1)

# adjusted model controlling for initial trait level
mod_ex_2 <- lm(swls ~ extra_sqdiff + extra_comb_curr, 
               data = df_sbsa2 %>% filter(rando!="Waitlist-Control" & time==1))
summary(mod_ex_2)$coef
effectsize::standardize_parameters(mod_ex_2)
```

::: {.callout-note appearance="minimal"}
Reduced correlation (effect size) in the adjusted model but still significant.  
:::

Only T1:  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# prepare df
df_check_adjusted <- df_sbsa2 %>% 
  # reshape with well-being outcomes and current trait levels
  filter(rando!="Waitlist-Control" & time==1) %>% 
  select(pid, rando, 
         swls, meaning, selfes, concept,
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_comb_curr")) %>% 
  pivot_longer(ends_with("_comb_curr"), 
               names_to = "test", names_prefix = "facet", values_to = "initial", values_drop_na = TRUE) %>% 
  mutate(test = sub("_.*", "", test)) %>% 
  left_join(
    df_sbsa2 %>% 
    # reshape with squared differences -> add to previous
      filter(rando!="Waitlist-Control" & time==1) %>% 
      select(pid, rando, ends_with("_sqdiff")) %>% 
      pivot_longer(ends_with("_sqdiff"), 
                   names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
      mutate(test = sub("_.*", "", test))
  )

# run models 
# swls
df_check_adjusted_swls <- df_check_adjusted %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lm(score ~ swls + initial, data = .x))) %>% 
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_swls_unlist <- as.data.frame(summary(df_check_adjusted_swls[[1]])$coefficients) %>% as_tibble() %>% 
  mutate(d = effectsize::standardize_parameters(df_check_adjusted_swls[[1]])$Std_Coefficient) # standardized beta
for (i in 2:length(df_check_adjusted_swls)) {
  df_check_adjusted_swls_unlist <- 
    bind_rows(df_check_adjusted_swls_unlist, 
              as.data.frame(summary(df_check_adjusted_swls[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_swls[[i]])$Std_Coefficient))
}
df_check_adjusted_swls_unlist <- df_check_adjusted_swls_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "swls", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# meaning
df_check_adjusted_meaning <- df_check_adjusted %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lm(score ~ meaning + initial, data = .x))) %>% 
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_meaning_unlist <- as.data.frame(summary(df_check_adjusted_meaning[[1]])$coefficients) %>% as_tibble() %>% 
  mutate(d = effectsize::standardize_parameters(df_check_adjusted_meaning[[1]])$Std_Coefficient) # standardized beta
for (i in 2:length(df_check_adjusted_meaning)) {
  df_check_adjusted_meaning_unlist <- 
    bind_rows(df_check_adjusted_meaning_unlist, 
              as.data.frame(summary(df_check_adjusted_meaning[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_meaning[[i]])$Std_Coefficient))
}
df_check_adjusted_meaning_unlist <- df_check_adjusted_meaning_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "meaning", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# selfes
df_check_adjusted_selfes <- df_check_adjusted %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lm(score ~ selfes + initial, data = .x))) %>% 
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_selfes_unlist <- as.data.frame(summary(df_check_adjusted_selfes[[1]])$coefficients) %>% as_tibble() %>% 
  mutate(d = effectsize::standardize_parameters(df_check_adjusted_selfes[[1]])$Std_Coefficient) # standardized beta
for (i in 2:length(df_check_adjusted_selfes)) {
  df_check_adjusted_selfes_unlist <- 
    bind_rows(df_check_adjusted_selfes_unlist, 
              as.data.frame(summary(df_check_adjusted_selfes[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_selfes[[i]])$Std_Coefficient))
}
df_check_adjusted_selfes_unlist <- df_check_adjusted_selfes_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "selfes", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# concept
df_check_adjusted_concept <- df_check_adjusted %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lm(score ~ concept + initial, data = .x))) %>% 
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_concept_unlist <- as.data.frame(summary(df_check_adjusted_concept[[1]])$coefficients) %>% as_tibble() %>% 
  mutate(d = effectsize::standardize_parameters(df_check_adjusted_concept[[1]])$Std_Coefficient) # standardized beta
for (i in 2:length(df_check_adjusted_concept)) {
  df_check_adjusted_concept_unlist <- 
    bind_rows(df_check_adjusted_concept_unlist, 
              as.data.frame(summary(df_check_adjusted_concept[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_concept[[i]])$Std_Coefficient))
}
df_check_adjusted_concept_unlist <- df_check_adjusted_concept_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "concept", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))
```

Does the relationship between the squared difference in one trait (current vs. ideal) and well-being aspects still hold if we control for the initial trait level?  

Combine as one table:  
```{r}
#| echo: true
#| warning: false

kable(df_check_adjusted_swls_unlist %>% 
        filter(!term %in% c("Intercept", "initial")) %>% 
        select(outcome, d_swls = d, p_ls = p, sig_ls = sig) %>% 
        left_join(
          df_check_adjusted_meaning_unlist %>% 
            filter(!term %in% c("Intercept", "initial")) %>% 
            select(outcome, d_meaning = d, p_m = p, sig_m = sig)
        ) %>% 
          left_join(
            df_check_adjusted_selfes_unlist %>% 
              filter(!term %in% c("Intercept", "initial")) %>% 
              select(outcome, d_selfes = d, p_se = p, sig_se = sig)
          ) %>% 
          left_join(
            df_check_adjusted_concept_unlist %>% 
              filter(!term %in% c("Intercept", "initial")) %>% 
              select(outcome, d_concept = d, p_c = p, sig_c = sig)
          ), 
       digits = 3)
```

::: {.callout-note appearance="minimal"}
Effects mostly still significant but not always at the *p* < .001 level. Correlation is especially stongly reduced for neuroticism and its facets depression and anxiety. Effects are still relatively pronounced for extraversion (strongest for sociability) and conscientiousness (strongest for responsibility). Volatility facet from neuroticism also shows comparatively strong effects.
:::

Across all time points, using a mixed model:  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# prepare df
df_check_adjusted_all <- df_sbsa2 %>% 
  # reshape with well-being outcomes and current trait levels
  filter(rando!="Waitlist-Control") %>% 
  select(pid, rando, time,
         swls, meaning, selfes, concept,
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_sqdiff")) %>% 
  pivot_longer(ends_with("_sqdiff"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  mutate(test = sub("_.*", "", test)) %>% 
  left_join(
    df_sbsa2 %>% 
    # reshape with squared differences -> add to previous
      filter(rando!="Waitlist-Control" & time==1) %>% 
      select(pid, rando, ends_with("_comb_curr")) %>% 
      pivot_longer(ends_with("_comb_curr"), 
                   names_to = "test", names_prefix = "facet", values_to = "initial", values_drop_na = TRUE) %>% 
      mutate(test = sub("_.*", "", test))
  )

# run models 
# swls
df_check_adjusted_swls_all <- df_check_adjusted_all %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lmerTest::lmer(score ~ swls + initial + (1 | pid), data = .x))) %>% # random intercept model
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_swls_all_unlist <- as.data.frame(summary(df_check_adjusted_swls_all[[1]])$coefficients) %>% as_tibble() %>% 
  mutate(d = effectsize::standardize_parameters(df_check_adjusted_swls_all[[1]])$Std_Coefficient) # standardized beta
for (i in 2:length(df_check_adjusted_swls_all)) {
  df_check_adjusted_swls_all_unlist <- 
    bind_rows(df_check_adjusted_swls_all_unlist, 
              as.data.frame(summary(df_check_adjusted_swls_all[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_swls_all[[i]])$Std_Coefficient))
}
df_check_adjusted_swls_all_unlist <- df_check_adjusted_swls_all_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "swls", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# meaning
df_check_adjusted_meaning_all <- df_check_adjusted_all %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lmerTest::lmer(score ~ meaning + initial + (1 | pid), data = .x))) %>% # random intercept model
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_meaning_all_unlist <- as.data.frame(summary(df_check_adjusted_meaning_all[[1]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_meaning_all[[1]])$Std_Coefficient)
for (i in 2:length(df_check_adjusted_meaning_all)) {
  df_check_adjusted_meaning_all_unlist <- 
    bind_rows(df_check_adjusted_meaning_all_unlist, 
              as.data.frame(summary(df_check_adjusted_meaning_all[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_meaning_all[[i]])$Std_Coefficient))
}
df_check_adjusted_meaning_all_unlist <- df_check_adjusted_meaning_all_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "meaning", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# selfes
df_check_adjusted_selfes_all <- df_check_adjusted_all %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lmerTest::lmer(score ~ selfes + initial + (1 | pid), data = .x))) %>% # random intercept model
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_selfes_all_unlist <- as.data.frame(summary(df_check_adjusted_selfes_all[[1]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_selfes_all[[1]])$Std_Coefficient)
for (i in 2:length(df_check_adjusted_selfes_all)) {
  df_check_adjusted_selfes_all_unlist <- 
    bind_rows(df_check_adjusted_selfes_all_unlist, 
              as.data.frame(summary(df_check_adjusted_selfes_all[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_selfes_all[[i]])$Std_Coefficient))
}
df_check_adjusted_selfes_all_unlist <- df_check_adjusted_selfes_all_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "selfes", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# concept
df_check_adjusted_concept_all <- df_check_adjusted_all %>% 
  group_nest(test) %>% 
  mutate(lm_mods = map(data, ~lmerTest::lmer(score ~ concept + initial + (1 | pid), data = .x))) %>% # random intercept model
  pull(lm_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_check_adjusted_concept_all_unlist <- as.data.frame(summary(df_check_adjusted_concept_all[[1]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_concept_all[[1]])$Std_Coefficient)
for (i in 2:length(df_check_adjusted_concept_all)) {
  df_check_adjusted_concept_all_unlist <- 
    bind_rows(df_check_adjusted_concept_all_unlist, 
              as.data.frame(summary(df_check_adjusted_concept_all[[i]])$coefficients) %>% as_tibble() %>% 
                mutate(d = effectsize::standardize_parameters(df_check_adjusted_concept_all[[i]])$Std_Coefficient))
}
df_check_adjusted_concept_all_unlist <- df_check_adjusted_concept_all_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=3), 
               term = c(rep(c("Intercept", "concept", "initial"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, d, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))
```

Does the relationship between the squared difference in one trait (current vs. ideal) and well-being aspects still hold if we control for the initial trait level?  

Combine as one table:  
```{r}
#| echo: true
#| warning: false

kable(df_check_adjusted_swls_all_unlist %>% 
        filter(!term %in% c("Intercept", "initial")) %>% 
        select(outcome, d_swls = d, p_ls = p, sig_ls = sig) %>% 
        left_join(
          df_check_adjusted_meaning_all_unlist %>% 
            filter(!term %in% c("Intercept", "initial")) %>% 
            select(outcome, d_meaning = d, p_m = p, sig_m = sig)
        ) %>% 
          left_join(
            df_check_adjusted_selfes_all_unlist %>% 
              filter(!term %in% c("Intercept", "initial")) %>% 
              select(outcome, d_selfes = d, p_se = p, sig_se = sig)
          ) %>% 
          left_join(
            df_check_adjusted_concept_all_unlist %>% 
              filter(!term %in% c("Intercept", "initial")) %>% 
              select(outcome, d_concept = d, p_c = p, sig_c = sig)
          ), 
       digits = 3)
```

::: {.callout-note appearance="minimal"}
Almost all effects significant at the *p* < .001 level when we include all time points at once. Somewhat stronger effects for neuroticism and extraversion.  
:::

------------------------------------------------------------------------

### H2: Well-being - latent change (H5 in paper) {#hyp2}

*Both intervention groups (but not the control group between T1 and T2) will increase in all four psychological well-being indicators.*  

We will test the mean-level difference between baseline and follow up using latent change models. Our main focus will be changes from T1 to T2 and we will check in a second set of models whether any changes persist from T2 to T3.  

#### Intervention effects (changes from T1 to T2)

##### Life satisfaction

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_swls_hyp2 <- '
swls_t1 =~ 1*sw06_01_t1 + lamb2*sw06_02_t1 + lamb3*sw06_03_t1 + lamb4*sw06_04_t1 # This specifies the measurement model for swls_t1 
swls_t2 =~ 1*sw06_01_t2 + lamb2*sw06_02_t2 + lamb3*sw06_03_t2 + lamb4*sw06_04_t2 # This specifies the measurement model for swls_t2 with the equality constrained factor loadings

swls_t2 ~ 1*swls_t1     # This parameter regresses swls_t2 perfectly on swls_t1
d_swls_1 =~ 1*swls_t2   # This defines the latent change score factor as measured perfectly by scores on swls_t2
swls_t2 ~ 0*1           # This line constrains the intercept of swls_t2 to 0
swls_t2 ~~ 0*swls_t2    # This fixes the variance of swls_t2 to 0

d_swls_1 ~ 1           # This estimates the intercept of the change score 
swls_t1 ~ 1            # This estimates the intercept of swls_t1 
d_swls_1 ~~ d_swls_1   # This estimates the variance of the change scores 
swls_t1 ~~ swls_t1     # This estimates the variance of the swls_t1 
swls_t1 ~~ d_swls_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t1 ~~ sw06_01_t2   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t1 ~~ sw06_02_t2   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t1 ~~ sw06_03_t2   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t1 ~~ sw06_04_t2   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t1 ~~ res1*sw06_01_t1   # This allows residual variance on indicator X1 at T1 
sw06_02_t1 ~~ res2*sw06_02_t1   # This allows residual variance on indicator X2 at T1
sw06_03_t1 ~~ res3*sw06_03_t1   # This allows residual variance on indicator X3 at T1
sw06_04_t1 ~~ res4*sw06_04_t1   # This allows residual variance on indicator X4 at T1

sw06_01_t2 ~~ res1*sw06_01_t2  # This allows residual variance on indicator X1 at T2 
sw06_02_t2 ~~ res2*sw06_02_t2  # This allows residual variance on indicator X2 at T2 
sw06_03_t2 ~~ res3*sw06_03_t2  # This allows residual variance on indicator X3 at T2
sw06_04_t2 ~~ res4*sw06_04_t2  # This allows residual variance on indicator X4 at T2

sw06_01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t1 ~ m2*1     # This estimates the intercept of X2 at T1
sw06_03_t1 ~ m3*1     # This estimates the intercept of X3 at T1
sw06_04_t1 ~ m4*1     # This estimates the intercept of X4 at T1

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
sw06_03_t2 ~ m3*1     # This estimates the intercept of X3 at T2
sw06_04_t2 ~ m4*1     # This estimates the intercept of X4 at T2
'
fit_mi_lcs_swls_hyp2 <- lavaan(mi_lcs_swls_hyp2, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_swls_hyp2, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true

# model fit
kable(broom::glance(fit_mi_lcs_swls_hyp2) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_swls_hyp2 <- broom::tidy(fit_mi_lcs_swls_hyp2, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("swls_t2 ~ swls_t1", "d_swls_1 =~ swls_t2", "swls_t1 ~~ d_swls_1", # change parameters
                           "d_swls_1 ~1 ", "swls_t1 ~1 ", "", # means
                           "d_swls_1 ~~ d_swls_1")) # variances
kable(params_lcs_swls_hyp2, digits = 3)
```

Plot model:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

semPaths(fit_mi_lcs_swls_hyp2, what="est", 
         sizeLat = 7, sizeMan = 7, edge.label.cex = .75, intercepts = T, edge.color="black")
```

::: {.callout-note appearance="minimal"}
Significantly higher life satisfaction at the post test, *b* = `r round(params_lcs_swls_hyp2 %>% filter(term=="d_swls_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_swls_hyp2 %>% filter(term=="d_swls_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="swls" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_swls_hyp2 %>% filter(term=="d_swls_1 ~1 ") %>% pull(p.value), 3)`. Those with initially higher levels of life satisfaction (at T1) change to a lesser degree.
:::

What happens in the waitlist control group during this time?

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

fit_mi_lcs_swls_hyp2_cg <- lavaan(mi_lcs_swls_hyp2, data=df_sbsa2_wide_wb %>% filter(rando=="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_swls_hyp2_cg, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true

# model fit
kable(broom::glance(fit_mi_lcs_swls_hyp2_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_swls_hyp2_cg <- broom::tidy(fit_mi_lcs_swls_hyp2_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("swls_t2 ~ swls_t1", "d_swls_1 =~ swls_t2", "swls_t1 ~~ d_swls_1", # change parameters
                           "d_swls_1 ~1 ", "swls_t1 ~1 ", "", # means
                           "d_swls_1 ~~ d_swls_1")) # variances
kable(params_lcs_swls_hyp2_cg, digits = 3)
```

::: {.callout-note appearance="minimal"}
Life satisfaction changes in the control group significantly at positively (at *p* < .001), *b* = `r round(params_lcs_swls_hyp2_cg %>% filter(term=="d_swls_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_swls_hyp2_cg %>% filter(term=="d_swls_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="swls" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_swls_hyp2_cg %>% filter(term=="d_swls_1 ~1 ") %>% pull(p.value), 3)`. Slightly weaker effect size than in intervention group.  
:::

##### Meaning in life

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_meaning_hyp2 <- '
meaning_t1 =~ 1*meaning_par1_t1 + lamb2*meaning_par2_t1 + lamb3*meaning_par3_t1 # This specifies the measurement model for meaning_t1 
meaning_t2 =~ 1*meaning_par1_t2 + lamb2*meaning_par2_t2 + lamb3*meaning_par3_t2 # This specifies the measurement model for meaning_t2 with the equality constrained factor loadings

meaning_t2 ~ 1*meaning_t1     # This parameter regresses meaning_t2 perfectly on meaning_t1
d_meaning_1 =~ 1*meaning_t2   # This defines the latent change score factor as measured perfectly by scores on meaning_t2
meaning_t2 ~ 0*1              # This line constrains the intercept of meaning_t2 to 0
meaning_t2 ~~ 0*meaning_t2    # This fixes the variance of meaning_t2 to 0

d_meaning_1 ~ 1              # This estimates the intercept of the change score 
meaning_t1 ~ 1               # This estimates the intercept of meaning_t1 
d_meaning_1 ~~ d_meaning_1   # This estimates the variance of the change scores 
meaning_t1 ~~ meaning_t1     # This estimates the variance of the meaning_t1 
meaning_t1 ~~ d_meaning_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t1 ~~ meaning_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t1 ~~ meaning_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t1 ~~ meaning_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t1 ~~ res1*meaning_par1_t1   # This allows residual variance on indicator X1 at T1 
meaning_par2_t1 ~~ res2*meaning_par2_t1   # This allows residual variance on indicator X2 at T1
meaning_par3_t1 ~~ res3*meaning_par3_t1   # This allows residual variance on indicator X3 at T1

meaning_par1_t2 ~~ res1*meaning_par1_t2  # This allows residual variance on indicator X1 at T2 
meaning_par2_t2 ~~ res2*meaning_par2_t2  # This allows residual variance on indicator X2 at T2 
meaning_par3_t2 ~~ res3*meaning_par3_t2  # This allows residual variance on indicator X3 at T2

meaning_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
meaning_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
meaning_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
'
fit_mi_lcs_meaning_hyp2 <- lavaan(mi_lcs_meaning_hyp2, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_meaning_hyp2, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_meaning_hyp2) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_meaning_hyp2 <- broom::tidy(fit_mi_lcs_meaning_hyp2, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("meaning_t2 ~ meaning_t1", "d_meaning_1 =~ meaning_t2", "meaning_t1 ~~ d_meaning_1", # change parameters
                           "d_meaning_1 ~1 ", "meaning_t1 ~1 ", "", # means
                           "d_meaning_1 ~~ d_meaning_1")) # variances

kable(params_lcs_meaning_hyp2, digits = 3)
```

::: {.callout-note appearance="minimal"}
Participants improved significantly in meaning in life across time, *b* = `r round(params_lcs_meaning_hyp2 %>% filter(term=="d_meaning_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_meaning_hyp2 %>% filter(term=="d_meaning_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="meaning" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_meaning_hyp2 %>% filter(term=="d_meaning_1 ~1 ") %>% pull(p.value), 3)`. 
:::

What happens in the waitlist control group during this time?

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

fit_mi_lcs_meaning_hyp2_cg <- lavaan(mi_lcs_meaning_hyp2, data=df_sbsa2_wide_wb %>% filter(rando=="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_meaning_hyp2_cg, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true

# model fit
kable(broom::glance(fit_mi_lcs_meaning_hyp2_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_meaning_hyp2_cg <- broom::tidy(fit_mi_lcs_meaning_hyp2_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("meaning_t2 ~ meaning_t1", "d_meaning_1 =~ meaning_t2", "meaning_t1 ~~ d_meaning_1", # change parameters
                           "d_meaning_1 ~1 ", "meaning_t1 ~1 ", "", # means
                           "d_meaning_1 ~~ d_meaning_1")) # variances
kable(params_lcs_meaning_hyp2_cg, digits = 3)
```

::: {.callout-note appearance="minimal"}
Meaning increases significantly in the control group, *b* = `r round(params_lcs_meaning_hyp2_cg %>% filter(term=="d_meaning_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_meaning_hyp2_cg %>% filter(term=="d_meaning_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="meaning" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_meaning_hyp2_cg %>% filter(term=="d_meaning_1 ~1 ") %>% pull(p.value), 3)`, with an even stronger effect size than in the intervention groups.  
:::

##### Self-esteem

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_selfes_hyp2 <- '
selfes_t1 =~ 1*selfes_par1_t1 + lamb2*selfes_par2_t1 + lamb3*selfes_par3_t1 # This specifies the measurement model for selfes_t1 
selfes_t2 =~ 1*selfes_par1_t2 + lamb2*selfes_par2_t2 + lamb3*selfes_par3_t2 # This specifies the measurement model for selfes_t2 with the equality constrained factor loadings

selfes_t2 ~ 1*selfes_t1     # This parameter regresses selfes_t2 perfectly on selfes_t1
d_selfes_1 =~ 1*selfes_t2   # This defines the latent change score factor as measured perfectly by scores on selfes_t2
selfes_t2 ~ 0*1             # This line constrains the intercept of selfes_t2 to 0
selfes_t2 ~~ 0*selfes_t2    # This fixes the variance of selfes_t2 to 0

d_selfes_1 ~ 1             # This estimates the intercept of the change score 
selfes_t1 ~ 1              # This estimates the intercept of selfes_t1 
d_selfes_1 ~~ d_selfes_1   # This estimates the variance of the change scores 
selfes_t1 ~~ selfes_t1     # This estimates the variance of the selfes_t1 
selfes_t1 ~~ d_selfes_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t1 ~~ selfes_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t1 ~~ selfes_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t1 ~~ selfes_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t1 ~~ res1*selfes_par1_t1   # This allows residual variance on indicator X1 at T1 
selfes_par2_t1 ~~ res2*selfes_par2_t1   # This allows residual variance on indicator X2 at T1
selfes_par3_t1 ~~ res3*selfes_par3_t1   # This allows residual variance on indicator X3 at T1

selfes_par1_t2 ~~ res1*selfes_par1_t2  # This allows residual variance on indicator X1 at T2 
selfes_par2_t2 ~~ res2*selfes_par2_t2  # This allows residual variance on indicator X2 at T2 
selfes_par3_t2 ~~ res3*selfes_par3_t2  # This allows residual variance on indicator X3 at T2

selfes_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
selfes_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
selfes_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
'
fit_mi_lcs_selfes_hyp2 <- lavaan(mi_lcs_selfes_hyp2, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_selfes_hyp2, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_selfes_hyp2) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_selfes_hyp2 <- broom::tidy(fit_mi_lcs_selfes_hyp2, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("selfes_t2 ~ selfes_t1", "d_selfes_1 =~ selfes_t2", "selfes_t1 ~~ d_selfes_1", # change parameters
                           "d_selfes_1 ~1 ", "selfes_t1 ~1 ", "", # means
                           "d_selfes_1 ~~ d_selfes_1")) # variances

kable(params_lcs_selfes_hyp2, digits = 3)
```

::: {.callout-note appearance="minimal"}
Participants increased significantly in self-esteem between the two assessments, *b* = `r round(params_lcs_selfes_hyp2 %>% filter(term=="d_selfes_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_selfes_hyp2 %>% filter(term=="d_selfes_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="selfes" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_selfes_hyp2 %>% filter(term=="d_selfes_1 ~1 ") %>% pull(p.value), 3)`.
:::

What happens in the waitlist control group during this time?

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

fit_mi_lcs_selfes_hyp2_cg <- lavaan(mi_lcs_selfes_hyp2, data=df_sbsa2_wide_wb %>% filter(rando=="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_selfes_hyp2_cg, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true

# model fit
kable(broom::glance(fit_mi_lcs_selfes_hyp2_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_selfes_hyp2_cg <- broom::tidy(fit_mi_lcs_selfes_hyp2_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("selfes_t2 ~ selfes_t1", "d_selfes_1 =~ selfes_t2", "selfes_t1 ~~ d_selfes_1", # change parameters
                           "d_selfes_1 ~1 ", "selfes_t1 ~1 ", "", # means
                           "d_selfes_1 ~~ d_selfes_1")) # variances
kable(params_lcs_selfes_hyp2_cg, digits = 3)
```

::: {.callout-note appearance="minimal"}
Self-esteem changes significantly and positively in the control group, *b* = `r round(params_lcs_selfes_hyp2_cg %>% filter(term=="d_selfes_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_selfes_hyp2_cg %>% filter(term=="d_selfes_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="selfes" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_selfes_hyp2_cg %>% filter(term=="d_selfes_1 ~1 ") %>% pull(p.value), 3)`. Comparable effect size to the intervention groups.  
:::

##### Self concept clarity

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_concept_hyp2 <- '
concept_t1 =~ 1*concept_par1_t1 + lamb2*concept_par2_t1 + lamb3*concept_par3_t1 # This specifies the measurement model for concept_t1 
concept_t2 =~ 1*concept_par1_t2 + lamb2*concept_par2_t2 + lamb3*concept_par3_t2 # This specifies the measurement model for concept_t2 with the equality constrained factor loadings

concept_t2 ~ 1*concept_t1     # This parameter regresses concept_t2 perfectly on concept_t1
d_concept_1 =~ 1*concept_t2   # This defines the latent change score factor as measured perfectly by scores on concept_t2
concept_t2 ~ 0*1              # This line constrains the intercept of concept_t2 to 0
concept_t2 ~~ 0*concept_t2    # This fixes the variance of concept_t2 to 0

d_concept_1 ~ 1              # This estimates the intercept of the change score 
concept_t1 ~ 1               # This estimates the intercept of concept_t1 
d_concept_1 ~~ d_concept_1   # This estimates the variance of the change scores 
concept_t1 ~~ concept_t1     # This estimates the variance of the concept_t1 
concept_t1 ~~ d_concept_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t1 ~~ concept_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t1 ~~ concept_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t1 ~~ concept_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t1 ~~ res1*concept_par1_t1   # This allows residual variance on indicator X1 at T1 
concept_par2_t1 ~~ res2*concept_par2_t1   # This allows residual variance on indicator X2 at T1
concept_par3_t1 ~~ res3*concept_par3_t1   # This allows residual variance on indicator X3 at T1

concept_par1_t2 ~~ res1*concept_par1_t2  # This allows residual variance on indicator X1 at T2 
concept_par2_t2 ~~ res2*concept_par2_t2  # This allows residual variance on indicator X2 at T2 
concept_par3_t2 ~~ res3*concept_par3_t2  # This allows residual variance on indicator X3 at T2

concept_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
concept_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
concept_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
'
fit_mi_lcs_concept_hyp2 <- lavaan(mi_lcs_concept_hyp2, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_concept_hyp2, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_concept_hyp2) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_concept_hyp2 <- broom::tidy(fit_mi_lcs_concept_hyp2, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("concept_t2 ~ concept_t1", "d_concept_1 =~ concept_t2", "concept_t1 ~~ d_concept_1", # change parameters
                           "d_concept_1 ~1 ", "concept_t1 ~1 ", "", # means
                           "d_concept_1 ~~ d_concept_1")) # variances

kable(params_lcs_concept_hyp2, digits = 3)
```

::: {.callout-note appearance="minimal"}
Self concept clarity improved significantly across time, *b* = `r round(params_lcs_concept_hyp2 %>% filter(term=="d_concept_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_concept_hyp2 %>% filter(term=="d_concept_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="concept" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_concept_hyp2 %>% filter(term=="d_concept_1 ~1 ") %>% pull(p.value), 3)`.
:::

What happens in the waitlist control group during this time?

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

fit_mi_lcs_concept_hyp2_cg <- lavaan(mi_lcs_concept_hyp2, data=df_sbsa2_wide_wb %>% filter(rando=="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_concept_hyp2_cg, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true

# model fit
kable(broom::glance(fit_mi_lcs_concept_hyp2_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_concept_hyp2_cg <- broom::tidy(fit_mi_lcs_concept_hyp2_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("concept_t2 ~ concept_t1", "d_concept_1 =~ concept_t2", "concept_t1 ~~ d_concept_1", # change parameters
                           "d_concept_1 ~1 ", "concept_t1 ~1 ", "", # means
                           "d_concept_1 ~~ d_concept_1")) # variances
kable(params_lcs_concept_hyp2_cg, digits = 3)
```

::: {.callout-note appearance="minimal"}
Self concept clarity changes in the control group not significant, *b* = `r round(params_lcs_concept_hyp2_cg %>% filter(term=="d_concept_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_concept_hyp2_cg %>% filter(term=="d_concept_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="concept" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_concept_hyp2_cg %>% filter(term=="d_concept_1 ~1 ") %>% pull(p.value), 3)`. Still a slight positive estimate, but weaker effect size than in intervention group.  
:::

#### Follow-up effects (changes from T2 to T3)

##### Life satisfaction

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_swls_hyp2_fu <- '
swls_t2 =~ 1*sw06_01_t2 + lamb2*sw06_02_t2 + lamb3*sw06_03_t2 + lamb4*sw06_04_t2 # This specifies the measurement model for swls_t2 
swls_t3 =~ 1*sw06_01_t3 + lamb2*sw06_02_t3 + lamb3*sw06_03_t3 + lamb4*sw06_04_t3 # This specifies the measurement model for swls_t3 with the equality constrained factor loadings

swls_t3 ~ 1*swls_t2     # This parameter regresses swls_t3 perfectly on swls_t2
d_swls_1 =~ 1*swls_t3   # This defines the latent change score factor as measured perfectly by scores on swls_t3
swls_t3 ~ 0*1           # This line constrains the intercept of swls_t3 to 0
swls_t3 ~~ 0*swls_t3    # This fixes the variance of swls_t3 to 0

d_swls_1 ~ 1           # This estimates the intercept of the change score 
swls_t2 ~ 1            # This estimates the intercept of swls_t2 
d_swls_1 ~~ d_swls_1   # This estimates the variance of the change scores 
swls_t2 ~~ swls_t2     # This estimates the variance of the swls_t2 
swls_t2 ~~ d_swls_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t2 ~~ sw06_01_t3   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t2 ~~ sw06_02_t3   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t2 ~~ sw06_03_t3   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t2 ~~ sw06_04_t3   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t2 ~~ res1*sw06_01_t2   # This allows residual variance on indicator X1 at T1 
sw06_02_t2 ~~ res2*sw06_02_t2   # This allows residual variance on indicator X2 at T1
sw06_03_t2 ~~ res3*sw06_03_t2   # This allows residual variance on indicator X3 at T1
sw06_04_t2 ~~ res4*sw06_04_t2   # This allows residual variance on indicator X4 at T1

sw06_01_t3 ~~ res1*sw06_01_t3  # This allows residual variance on indicator X1 at T2 
sw06_02_t3 ~~ res2*sw06_02_t3  # This allows residual variance on indicator X2 at T2 
sw06_03_t3 ~~ res3*sw06_03_t3  # This allows residual variance on indicator X3 at T2
sw06_04_t3 ~~ res4*sw06_04_t3  # This allows residual variance on indicator X4 at T2

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t2 ~ m2*1     # This estimates the intercept of X2 at T1
sw06_03_t2 ~ m3*1     # This estimates the intercept of X3 at T1
sw06_04_t2 ~ m4*1     # This estimates the intercept of X4 at T1

sw06_01_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t3 ~ m2*1     # This estimates the intercept of X2 at T2
sw06_03_t3 ~ m3*1     # This estimates the intercept of X3 at T2
sw06_04_t3 ~ m4*1     # This estimates the intercept of X4 at T2
'
fit_mi_lcs_swls_hyp2_fu <- lavaan(mi_lcs_swls_hyp2_fu, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_swls_hyp2_fu, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true

# model fit
kable(broom::glance(fit_mi_lcs_swls_hyp2_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_swls_hyp2_fu <- broom::tidy(fit_mi_lcs_swls_hyp2_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("swls_t3 ~ swls_t2", "d_swls_1 =~ swls_t3", "swls_t2 ~~ d_swls_1", # change parameters
                           "d_swls_1 ~1 ", "swls_t2 ~1 ", "", # means
                           "d_swls_1 ~~ d_swls_1")) # variances
kable(params_lcs_swls_hyp2_fu, digits = 3)
```

::: {.callout-note appearance="minimal"}
Life satisfaction further increased from T2 to the T3 follow up, *b* = `r round(params_lcs_swls_hyp2_fu %>% filter(term=="d_swls_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_swls_hyp2_fu %>% filter(term=="d_swls_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="swls" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_swls_hyp2_fu %>% filter(term=="d_swls_1 ~1 ") %>% pull(p.value), 3)`.  
:::

##### Meaning in life

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_meaning_hyp2_fu <- '
meaning_t2 =~ 1*meaning_par1_t2 + lamb2*meaning_par2_t2 + lamb3*meaning_par3_t2 # This specifies the measurement model for meaning_t2 
meaning_t3 =~ 1*meaning_par1_t3 + lamb2*meaning_par2_t3 + lamb3*meaning_par3_t3 # This specifies the measurement model for meaning_t3 with the equality constrained factor loadings

meaning_t3 ~ 1*meaning_t2     # This parameter regresses meaning_t3 perfectly on meaning_t2
d_meaning_1 =~ 1*meaning_t3   # This defines the latent change score factor as measured perfectly by scores on meaning_t3
meaning_t3 ~ 0*1              # This line constrains the intercept of meaning_t3 to 0
meaning_t3 ~~ 0*meaning_t3    # This fixes the variance of meaning_t3 to 0

d_meaning_1 ~ 1              # This estimates the intercept of the change score 
meaning_t2 ~ 1               # This estimates the intercept of meaning_t2 
d_meaning_1 ~~ d_meaning_1   # This estimates the variance of the change scores 
meaning_t2 ~~ meaning_t2     # This estimates the variance of the meaning_t2 
meaning_t2 ~~ d_meaning_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t2 ~~ meaning_par1_t3   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t2 ~~ meaning_par2_t3   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t2 ~~ meaning_par3_t3   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t2 ~~ res1*meaning_par1_t2   # This allows residual variance on indicator X1 at T1 
meaning_par2_t2 ~~ res2*meaning_par2_t2   # This allows residual variance on indicator X2 at T1
meaning_par3_t2 ~~ res3*meaning_par3_t2   # This allows residual variance on indicator X3 at T1

meaning_par1_t3 ~~ res1*meaning_par1_t3  # This allows residual variance on indicator X1 at T2 
meaning_par2_t3 ~~ res2*meaning_par2_t3  # This allows residual variance on indicator X2 at T2 
meaning_par3_t3 ~~ res3*meaning_par3_t3  # This allows residual variance on indicator X3 at T2

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T1
meaning_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T1

meaning_par1_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t3 ~ m2*1     # This estimates the intercept of X2 at T2
meaning_par3_t3 ~ m3*1     # This estimates the intercept of X3 at T2
'
fit_mi_lcs_meaning_hyp2_fu <- lavaan(mi_lcs_meaning_hyp2_fu, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_meaning_hyp2_fu, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_meaning_hyp2_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_meaning_hyp2_fu <- broom::tidy(fit_mi_lcs_meaning_hyp2_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("meaning_t3 ~ meaning_t2", "d_meaning_1 =~ meaning_t3", "meaning_t2 ~~ d_meaning_1", # change parameters
                           "d_meaning_1 ~1 ", "meaning_t2 ~1 ", "", # means
                           "d_meaning_1 ~~ d_meaning_1")) # variances

kable(params_lcs_meaning_hyp2_fu, digits = 3)
```

::: {.callout-note appearance="minimal"}
Meaning in life further increased from T2 to the T3 follow up, *b* = `r round(params_lcs_meaning_hyp2_fu %>% filter(term=="d_meaning_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_meaning_hyp2_fu %>% filter(term=="d_meaning_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="meaning" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_meaning_hyp2_fu %>% filter(term=="d_meaning_1 ~1 ") %>% pull(p.value), 3)`.  
:::

##### Self-esteem

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_selfes_hyp2_fu <- '
selfes_t2 =~ 1*selfes_par1_t2 + lamb2*selfes_par2_t2 + lamb3*selfes_par3_t2 # This specifies the measurement model for selfes_t2 
selfes_t3 =~ 1*selfes_par1_t3 + lamb2*selfes_par2_t3 + lamb3*selfes_par3_t3 # This specifies the measurement model for selfes_t3 with the equality constrained factor loadings

selfes_t3 ~ 1*selfes_t2     # This parameter regresses selfes_t3 perfectly on selfes_t2
d_selfes_1 =~ 1*selfes_t3   # This defines the latent change score factor as measured perfectly by scores on selfes_t3
selfes_t3 ~ 0*1             # This line constrains the intercept of selfes_t3 to 0
selfes_t3 ~~ 0*selfes_t3    # This fixes the variance of selfes_t3 to 0

d_selfes_1 ~ 1             # This estimates the intercept of the change score 
selfes_t2 ~ 1              # This estimates the intercept of selfes_t2 
d_selfes_1 ~~ d_selfes_1   # This estimates the variance of the change scores 
selfes_t2 ~~ selfes_t2     # This estimates the variance of the selfes_t2 
selfes_t2 ~~ d_selfes_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t2 ~~ selfes_par1_t3   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t2 ~~ selfes_par2_t3   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t2 ~~ selfes_par3_t3   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t2 ~~ res1*selfes_par1_t2   # This allows residual variance on indicator X1 at T1 
selfes_par2_t2 ~~ res2*selfes_par2_t2   # This allows residual variance on indicator X2 at T1
selfes_par3_t2 ~~ res3*selfes_par3_t2   # This allows residual variance on indicator X3 at T1

selfes_par1_t3 ~~ res1*selfes_par1_t3  # This allows residual variance on indicator X1 at T2 
selfes_par2_t3 ~~ res2*selfes_par2_t3  # This allows residual variance on indicator X2 at T2 
selfes_par3_t3 ~~ res3*selfes_par3_t3  # This allows residual variance on indicator X3 at T2

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T1
selfes_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T1

selfes_par1_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t3 ~ m2*1     # This estimates the intercept of X2 at T2
selfes_par3_t3 ~ m3*1     # This estimates the intercept of X3 at T2
'
fit_mi_lcs_selfes_hyp2_fu <- lavaan(mi_lcs_selfes_hyp2_fu, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_selfes_hyp2_fu, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_selfes_hyp2_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_selfes_hyp2_fu <- broom::tidy(fit_mi_lcs_selfes_hyp2_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("selfes_t3 ~ selfes_t2", "d_selfes_1 =~ selfes_t3", "selfes_t2 ~~ d_selfes_1", # change parameters
                           "d_selfes_1 ~1 ", "selfes_t2 ~1 ", "", # means
                           "d_selfes_1 ~~ d_selfes_1")) # variances

kable(params_lcs_selfes_hyp2_fu, digits = 3)
```

::: {.callout-note appearance="minimal"}
Self-esteem further increased from T2 to the T3 follow up, *b* = `r round(params_lcs_selfes_hyp2_fu %>% filter(term=="d_selfes_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_selfes_hyp2_fu %>% filter(term=="d_selfes_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="selfes" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_selfes_hyp2_fu %>% filter(term=="d_selfes_1 ~1 ") %>% pull(p.value), 3)`.
:::

##### Self concept clarity

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# Code snippets adapted from Kievit et al. (2018) -- CC-BY -- https://doi.org/10.1016/j.dcn.2017.11.007

# Fit the multiple indicator Univariate Latent Change Score model
mi_lcs_concept_hyp2_fu <- '
concept_t2 =~ 1*concept_par1_t2 + lamb2*concept_par2_t2 + lamb3*concept_par3_t2 # This specifies the measurement model for concept_t2 
concept_t3 =~ 1*concept_par1_t3 + lamb2*concept_par2_t3 + lamb3*concept_par3_t3 # This specifies the measurement model for concept_t3 with the equality constrained factor loadings

concept_t3 ~ 1*concept_t2     # This parameter regresses concept_t3 perfectly on concept_t2
d_concept_1 =~ 1*concept_t3   # This defines the latent change score factor as measured perfectly by scores on concept_t3
concept_t3 ~ 0*1              # This line constrains the intercept of concept_t3 to 0
concept_t3 ~~ 0*concept_t3    # This fixes the variance of concept_t3 to 0

d_concept_1 ~ 1              # This estimates the intercept of the change score 
concept_t2 ~ 1               # This estimates the intercept of concept_t2 
d_concept_1 ~~ d_concept_1   # This estimates the variance of the change scores 
concept_t2 ~~ concept_t2     # This estimates the variance of the concept_t2 
concept_t2 ~~ d_concept_1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t2 ~~ concept_par1_t3   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t2 ~~ concept_par2_t3   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t2 ~~ concept_par3_t3   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t2 ~~ res1*concept_par1_t2   # This allows residual variance on indicator X1 at T1 
concept_par2_t2 ~~ res2*concept_par2_t2   # This allows residual variance on indicator X2 at T1
concept_par3_t2 ~~ res3*concept_par3_t2   # This allows residual variance on indicator X3 at T1

concept_par1_t3 ~~ res1*concept_par1_t3  # This allows residual variance on indicator X1 at T2 
concept_par2_t3 ~~ res2*concept_par2_t3  # This allows residual variance on indicator X2 at T2 
concept_par3_t3 ~~ res3*concept_par3_t3  # This allows residual variance on indicator X3 at T2

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T1
concept_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T1

concept_par1_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t3 ~ m2*1     # This estimates the intercept of X2 at T2
concept_par3_t3 ~ m3*1     # This estimates the intercept of X3 at T2
'
fit_mi_lcs_concept_hyp2_fu <- lavaan(mi_lcs_concept_hyp2_fu, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_concept_hyp2_fu, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary:
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_concept_hyp2_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_concept_hyp2_fu <- broom::tidy(fit_mi_lcs_concept_hyp2_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("concept_t3 ~ concept_t2", "d_concept_1 =~ concept_t3", "concept_t2 ~~ d_concept_1", # change parameters
                           "d_concept_1 ~1 ", "concept_t2 ~1 ", "", # means
                           "d_concept_1 ~~ d_concept_1")) # variances

kable(params_lcs_concept_hyp2_fu, digits = 3)
```

::: {.callout-note appearance="minimal"}
Self concept clarity further increased from T2 to the T3 follow up, *b* = `r round(params_lcs_concept_hyp2_fu %>% filter(term=="d_concept_1 ~1 ") %>% pull(estimate), 3)`, *beta* = `r round(params_lcs_concept_hyp2_fu %>% filter(term=="d_concept_1 ~1 ") %>% pull(estimate) / (sd_wb_st2 %>% filter(trait=="concept" & time==1) %>% pull(sd_trait)), 3)`, *p* = `r round(params_lcs_concept_hyp2_fu %>% filter(term=="d_concept_1 ~1 ") %>% pull(p.value), 3)`.
:::

::: {.callout-note appearance="minimal"}
I also checked whether there are differences if I model the two intervention groups (self-improvement / self-acceptance) separately. Changes are more or less the same across the two groups.
:::

------------------------------------------------------------------------

### H3: Distance between ideal- and current-personality over time (H1 in paper) {#hyp3}

*The distance between ideal- and current-personality will decrease in both intervention groups (but not in the control group between T1 and T2).* 

We will use two strategies to test this hypothesis. First, we will compute the Fisher z-transformed profile correlation between current- and ideal-personality and test whether it increased across assessments. Second, we will test whether the squared difference between current- and ideal-personality rating for each Big Five trait decreased across assessments. We will test mean-level differences in profile correlations and squared differences between baseline and follow up using mixed-effects models. Our main focus will be changes from T1 to T2 and we will check in a second set of models whether any changes persist from T2 to T3.

#### Profile similarity

Reshape to wide:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"

# reshape to wide
df_sbsa2_wide_profdiff <- df_sbsa2 %>% 
  arrange(pid, time) %>% 
  select(pid, rando, time, profile_corr_item_z, profile_corr_facet_z, ends_with("_sqdiff")) %>% 
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = -c(pid, rando, time))
```

##### Intervention effects (changes from T1 to T2)

Checking assumptions
```{r}
#| echo: true
# item-level profile correlation
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t1)) 
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t1))

# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t1))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2))

# facet-level profile correlation
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t1)) 
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t1))

# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t1))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2))
```

Results summary:
```{r}
#| echo: true
#| warning: false
t_profile_corr_item <- t.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2),
                              df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t1), 
                              paired = TRUE)
t_profile_corr_facet <- t.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2), 
                               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t1), 
                               paired = TRUE)

kable(bind_rows(tidy(t_profile_corr_item), tidy(t_profile_corr_facet)) %>% mutate(outcome = c("Item-level profile corr.", "Facet-level profile corr.")) %>% select(outcome, everything()), digits = 3)

# effect sizes
d_profile_corr_item <- psych::cohen.d(profile_corr_item_z ~ time, data = df_sbsa2 %>% 
                                        filter(rando!="Waitlist-Control" & time %in% c(1,2)))
d_profile_corr_item$cohen.d
d_profile_corr_facet <- psych::cohen.d(profile_corr_facet_z ~ time, data = df_sbsa2 %>% 
                                         filter(rando!="Waitlist-Control" & time %in% c(1,2)))
d_profile_corr_facet$cohen.d
```

::: {.callout-note appearance="minimal"}
Significantly higher profile correlations at the second measurement occasion, both for the item-level profile correlation and the facet-level profile correlations.
:::

What happens in the waitlist control group during this time?
```{r}
#| echo: true
#| warning: false
t_profile_corr_item_cg <- t.test(df_sbsa2_wide_profdiff %>% filter(rando=="Waitlist-Control") %>% pull(profile_corr_item_z_t2),
                              df_sbsa2_wide_profdiff %>% filter(rando=="Waitlist-Control") %>% pull(profile_corr_item_z_t1), 
                              paired = TRUE)
t_profile_corr_facet_cg <- t.test(df_sbsa2_wide_profdiff %>% filter(rando=="Waitlist-Control") %>% pull(profile_corr_facet_z_t2), 
                               df_sbsa2_wide_profdiff %>% filter(rando=="Waitlist-Control") %>% pull(profile_corr_facet_z_t1), 
                               paired = TRUE)

kable(bind_rows(tidy(t_profile_corr_item_cg), tidy(t_profile_corr_facet_cg)) %>% mutate(outcome = c("Item-level profile corr.", "Facet-level profile corr.")) %>% select(outcome, everything()), digits = 5)

# effect sizes
d_profile_corr_item_cg <- psych::cohen.d(profile_corr_item_z ~ time, data = df_sbsa2 %>% 
                                        filter(rando=="Waitlist-Control" & time %in% c(1,2)))
d_profile_corr_item_cg$cohen.d
d_profile_corr_facet_cg <- psych::cohen.d(profile_corr_facet_z ~ time, data = df_sbsa2 %>% 
                                         filter(rando=="Waitlist-Control" & time %in% c(1,2)))
d_profile_corr_facet_cg$cohen.d
```

::: {.callout-note appearance="minimal"}
Slightly higher higher profile correlations at the second measurement occasion also in the controlg group, although this is only significant at .001 for the item-level profile correlation but not for the facet-level profile correlations.
:::

Testing the difference between intervention groups and control group for significance:
```{r}
#| echo: true
#| warning: false

df_sbsa2_anov <- df_sbsa2 %>% 
  mutate(interv = ifelse(rando!="Waitlist-Control", 1, 0)) %>% 
  filter(time!=3) %>% 
  select(pid, interv, time, profile_corr_item_z, profile_corr_facet_z) %>% 
  mutate(time_d = time - 1)

anov_interv_contr_item <- lmerTest::lmer(profile_corr_item_z ~ time_d * interv + (1 | pid), 
                                         data = df_sbsa2_anov)
kable(summary(anov_interv_contr_item)$coefficients, digits = 3)

effectsize::standardize_parameters(anov_interv_contr_item, 
                       method = "pseudo", ci_method = "satterthwaite", ci = 0.999)

anov_interv_contr_facet <- lmerTest::lmer(profile_corr_facet_z ~ time_d * interv + (1 | pid), 
                                         data = df_sbsa2_anov)
kable(summary(anov_interv_contr_facet)$coefficients, digits = 3)

effectsize::standardize_parameters(anov_interv_contr_facet, 
                       method = "pseudo", ci_method = "satterthwaite", ci = 0.999)
```

::: {.callout-note appearance="minimal"}
Higher effect size of change in the intervention groups versus the waitlist control group from T1 to T2 but this difference is not significant. Might have something to do though with different group sizes. Note that this is a rather basic method of standardizing multilevel modeling parameters.
:::

##### Follow-up effects (changes from T2 to T3)

Checking assumptions
```{r}
#| echo: true
# item-level profile correlation
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t3) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t3) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2))

# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t3))

# facet-level profile correlation
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t3) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t3) -
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2))

# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t3))
```

Results summary:
```{r}
#| echo: true
#| warning: false
t_profile_corr_item_fu <- t.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t3), 
                                 df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_item_z_t2), 
                                 paired = TRUE)
t_profile_corr_facet_fu <- t.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t3), 
                                  df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(profile_corr_facet_z_t2), 
                                  paired = TRUE)

kable(bind_rows(tidy(t_profile_corr_item_fu), tidy(t_profile_corr_facet_fu)) %>% mutate(outcome = c("Item-level profile corr.", "Facet-level profile corr.")) %>% select(outcome, everything()), digits = 3)

# effect sizes
d_profile_corr_item_fu <- psych::cohen.d(profile_corr_item_z ~ time, data = df_sbsa2 %>% 
                                           filter(rando!="Waitlist-Control" & time %in% c(2,3)))
d_profile_corr_item_fu$cohen.d
d_profile_corr_facet_fu <- psych::cohen.d(profile_corr_facet_z ~ time, data = df_sbsa2 %>% 
                                            filter(rando!="Waitlist-Control" & time %in% c(2,3)))
d_profile_corr_facet_fu$cohen.d
```

::: {.callout-note appearance="minimal"}
Profile correlations stay stable from the second measurement occasion to the third when evaluated at alpha=.001, both for the item-level profile correlations and the facet-level profile correlations. Slight increase if looking at effect sizes. 
:::

##### Summary plot 
```{r}
#| echo: true
#| warning: false
#| fig-width: 9.5
#| fig-height: 6.5
profile_df_plot <- df_sbsa2 %>% 
  select(pid, time, rando, profile_corr_item_z, profile_corr_facet_z) %>% 
  pivot_longer(-c(pid, time, rando), names_to = "itemfacet", values_to = "corr") %>% 
  filter(!is.na(corr)) %>% 
  mutate(itemfacet2 = fct_recode(itemfacet, "Item-level" = "profile_corr_item_z", "Facet-level" = "profile_corr_facet_z"),
         itemfacet2 = fct_reorder(itemfacet2, corr, .desc = F))

cowplot::plot_grid(
  ggplot(profile_df_plot %>% filter(rando!="Waitlist-Control")) + 
  aes(x = as.factor(time), y = corr) + 
  geom_boxplot() + 
  geom_violin(fill = NA) +
  facet_wrap(vars(itemfacet2)) +
  labs(x = "Measurement Occasion", y = "Profile correlation", 
       title = "Intervention groups") + 
  theme_bw(),
  ggplot(profile_df_plot %>% filter(rando=="Waitlist-Control")) + 
  aes(x = as.factor(time), y = corr) + 
  geom_boxplot() + 
  geom_violin(fill = NA) +
  facet_wrap(vars(itemfacet2)) +
  labs(x = "Measurement Occasion", y = "Profile correlation", 
       title = "Waitlist control group") + 
  theme_bw(),
  ncol = 1, align = "vt"
)

```

::: {.callout-note appearance="minimal"}
Significantly higher profile correlations at the second measurement occasion, both for the item-level profile correlation and the facet-level profile correlations. Further increases (but only slightly) at the T3 follow-up. However, we also see a pattern of increases in the waitlist control group although with higher uncertainty of estimates (smaller sample). We would not have expected that from T1 to T2, but only from T2 to T3.  
:::

#### Individual traits: squared differences

##### Intervention effects (changes from T1 to T2)

Checking assumptions
```{r}
#| echo: true

# extra
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t1))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t1))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t1))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t2))

# agree
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t1))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t1))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t1))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t2))

# consc
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t1))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t1))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t1))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t2))

# neuro
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t1))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t1))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t1))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t2))

# openn
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t1))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t2) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t1))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t1))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t2))
```

Results summary:
```{r}
#| echo: true
#| warning: false
mod_traits_sqdiff <- df_sbsa2_wide_profdiff %>% 
  filter(rando!="Waitlist-Control") %>% 
  select(-starts_with("profile"), -rando, -ends_with("_t3")) %>% 
  pivot_longer(-c(pid), 
               names_to = c("test", "time"), values_to = "score", 
               names_pattern = "(.*)_(t1|t2)") %>% 
  filter(!is.na(score)) %>% 
  group_by(pid, test) %>% 
  mutate(assessments = n()) %>% 
  ungroup() %>% 
  filter(assessments==2) %>% 
  select(-assessments) %>% 
  group_nest(test) %>% 
  mutate(t_tests = map(data, ~t.test(score ~ relevel(as.factor(time), "t2"), # need to relevel this to get T2-T1 diff (not sure why)
                                     data = .x, paired = TRUE, conf.level = 0.999))) %>% 
  pull(t_tests) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

mod_traits_unlist <- mod_traits_sqdiff[[1]] %>% tidy()
for (i in 2:length(mod_traits_sqdiff)) {
  mod_traits_unlist <- bind_rows(mod_traits_unlist, mod_traits_sqdiff[[i]] %>% tidy())
}

kable(mod_traits_unlist %>% mutate(outcome = sort(names(b5_vars))) %>% 
        select(outcome, everything()) %>% arrange(factor(outcome, levels = (names(b5_vars)))), digits = 3) # order by BFI traits

# effect sizes
cohend_cust = function(outcome, df) {
  form = as.formula(paste0(outcome, " ~ time"))
  psych::cohen.d(form, data = df, alpha = 0.001)
}

d_trait <- cohend_cust(paste0(str_trunc(names(b5_vars)[1], 5, ellipsis = ""), "_sqdiff"), 
                       df_sbsa2 %>% filter(rando!="Waitlist-Control" & time %in% c(1,2)))
d_traits_unlist <- as_tibble(d_trait$cohen.d)
for (i in 2:length(names(b5_vars))) {
  d_trait <- cohend_cust(paste0(str_trunc(names(b5_vars)[i], 5, ellipsis = ""), "_sqdiff"), 
                         df_sbsa2 %>% filter(rando!="Waitlist-Control" & time %in% c(1,2)))
  d_traits_unlist <- bind_rows(d_traits_unlist, as_tibble(d_trait$cohen.d))
}
kable(d_traits_unlist %>% mutate(outcome = names(b5_vars)) %>% select(outcome, everything()), digits = 3)
```

[Note: These CIs for *d* are probably wrong -> not appropriate for paired t-test]  

::: {.callout-note appearance="minimal"}
Significantly lower squared mean-level differences at the second measurement occasion for extraversion, agreeableness, and neuroticism (at .001). For conscientiousness and openness only at p < .01. On the level of the 15 BFI-2 facets, we find 8 significant effects (at .001) where squared mean-level differences were reduced. For example, pronounced effect for energy but no effect for assertiveness.
:::

What happens in the waitlist control group during this time?

```{r}
#| echo: true
#| warning: false
mod_traits_sqdiff_cg <- df_sbsa2_wide_profdiff %>% 
  filter(rando=="Waitlist-Control") %>% 
  select(-starts_with("profile"), -rando, -ends_with("_t3")) %>% 
  pivot_longer(-c(pid), 
               names_to = c("test", "time"), values_to = "score", 
               names_pattern = "(.*)_(t1|t2)") %>% 
  filter(!is.na(score)) %>% 
  group_by(pid, test) %>% 
  mutate(assessments = n()) %>% 
  ungroup() %>% 
  filter(assessments==2) %>% 
  select(-assessments) %>% 
  group_nest(test) %>% 
  mutate(t_tests = map(data, ~t.test(score ~ relevel(as.factor(time), "t2"), # need to relevel this to get T2-T1 diff (not sure why)
                                     data = .x, paired = TRUE, conf.level = 0.999))) %>% 
  pull(t_tests) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

mod_traits_unlist_cg <- mod_traits_sqdiff_cg[[1]] %>% tidy()
for (i in 2:length(mod_traits_sqdiff_cg)) {
  mod_traits_unlist_cg <- bind_rows(mod_traits_unlist_cg, mod_traits_sqdiff_cg[[i]] %>% tidy())
}

kable(mod_traits_unlist_cg %>% mutate(outcome = sort(names(b5_vars))) %>% 
        select(outcome, everything()) %>% arrange(factor(outcome, levels = (names(b5_vars)))), digits = 3) # order by BFI traits

# effect sizes
d_trait_cg <- cohend_cust(paste0(str_trunc(names(b5_vars)[1], 5, ellipsis = ""), "_sqdiff"), 
                       df_sbsa2 %>% filter(rando=="Waitlist-Control" & time %in% c(1,2)))
d_traits_unlist_cg <- as_tibble(d_trait_cg$cohen.d)
for (i in 2:length(names(b5_vars))) {
  d_trait_cg <- cohend_cust(paste0(str_trunc(names(b5_vars)[i], 5, ellipsis = ""), "_sqdiff"), 
                         df_sbsa2 %>% filter(rando=="Waitlist-Control" & time %in% c(1,2)))
  d_traits_unlist_cg <- bind_rows(d_traits_unlist_cg, as_tibble(d_trait_cg$cohen.d))
}
kable(d_traits_unlist_cg %>% mutate(outcome = names(b5_vars)) %>% select(outcome, everything()), digits = 3)
```

::: {.callout-note appearance="minimal"}
In the control group, significantly lower squared mean-level differences at the second measurement occasion only for facet organization (at .001). For extraversion, agreeableness, conscientiousness, and neuroticism only at p < .05 (as well as for 8 facets). However, in terms of effect sizes, relatively similar effects to intervention group. 
:::

##### Follow-up effects (changes from T2 to T3)

Checking assumptions
```{r}
#| echo: true

# extra
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t2))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t2))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t2))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(extra_sqdiff_t3))

# agree
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t2))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t2))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t2))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(agree_sqdiff_t3))

# consc
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t2))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t2))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t2))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(consc_sqdiff_t3))

# neuro
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t2))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t2))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t2))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(neuro_sqdiff_t3))

# openn
shapiro.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t2))
lillie.test(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t3) - 
               df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t2))
# descriptives
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t2))
psych::describe(df_sbsa2_wide_profdiff %>% filter(rando!="Waitlist-Control") %>% pull(openn_sqdiff_t3))
```

Results summary:
```{r}
#| echo: true
#| warning: false
mod_traits_sqdiff_fu <- df_sbsa2_wide_profdiff %>% 
  filter(rando!="Waitlist-Control") %>% 
  select(-starts_with("profile"), -rando, -ends_with("_t1")) %>% 
  pivot_longer(-c(pid), 
               names_to = c("test", "time"), values_to = "score", 
               names_pattern = "(.*)_(t2|t3)") %>% 
  filter(!is.na(score)) %>% 
  group_by(pid, test) %>% 
  mutate(assessments = n()) %>% 
  ungroup() %>% 
  filter(assessments==2) %>% 
  select(-assessments) %>% 
  group_nest(test) %>% 
  mutate(t_tests = map(data, ~t.test(score ~ relevel(as.factor(time), "t3"), # need to relevel this to get T3-T2 diff (not sure why)
                                     data = .x, paired = TRUE, conf.level = 0.999))) %>% 
  pull(t_tests) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

mod_traits_unlist_fu <- mod_traits_sqdiff_fu[[1]] %>% tidy()
for (i in 2:length(mod_traits_sqdiff_fu)) {
  mod_traits_unlist_fu <- bind_rows(mod_traits_unlist_fu, mod_traits_sqdiff_fu[[i]] %>% tidy())
}

kable(mod_traits_unlist_fu %>% mutate(outcome = sort(names(b5_vars))) %>% 
        select(outcome, everything()) %>% arrange(factor(outcome, levels = (names(b5_vars)))), digits = 3) # order by BFI traits

# effect sizes
d_trait_fu <- cohend_cust(paste0(str_trunc(names(b5_vars)[1], 5, ellipsis = ""), "_sqdiff"), 
                       df_sbsa2 %>% filter(rando!="Waitlist-Control" & time %in% c(2,3)))
d_traits_unlist_fu <- as_tibble(d_trait_fu$cohen.d)
for (i in 2:length(names(b5_vars))) {
  d_trait_fu <- cohend_cust(paste0(str_trunc(names(b5_vars)[i], 5, ellipsis = ""), "_sqdiff"), 
                         df_sbsa2 %>% filter(rando!="Waitlist-Control" & time %in% c(2,3)))
  d_traits_unlist_fu <- bind_rows(d_traits_unlist_fu, as_tibble(d_trait_fu$cohen.d))
}
kable(d_traits_unlist_fu %>% mutate(outcome = names(b5_vars)) %>% select(outcome, everything()), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant further changes in the squared difference from the second to the third measurement occasion (at .001). For neuroticism (and anxiety) further decreases only at p < .01. 
:::

##### Summary plot

Traits/facets sorted by average size of squared differences - in the intervention groups from T1 to T2  
```{r}
#| echo: true
#| warning: false
#| fig-width: 9.5
#| fig-height: 4.5
sqdiff_df_plot <- df_sbsa2 %>% 
  filter(rando!="Waitlist-Control" & time %in% c(1,2)) %>% 
  select(pid, time, all_of(paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_sqdiff"))) %>% 
  pivot_longer(-c(pid, time), names_to = "trait", values_to = "sqdiff") %>% 
  group_by(trait) %>% 
  mutate(cur_group_id()) %>% 
  ungroup() %>% 
  filter(!is.na(sqdiff)) %>% 
  mutate(trait2 = fct_recode(trait, !!! setNames(paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_sqdiff"),
                                                 str_to_title(names(b5_vars)))),
         trait2 = fct_reorder(trait2, sqdiff, .desc = T))

plot_sqdiff <- ggplot(sqdiff_df_plot) + 
  aes(x = as.factor(time), y = sqdiff) + 
  geom_boxplot() + 
  geom_violin(fill = NA) +
  ggforce::facet_wrap_paginate(~trait2, ncol=3, nrow=2) +
  labs(x = "Measurement Occasion", y = "Squared difference") + 
  theme_bw()

plot_sqdiff + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 1)
plot_sqdiff + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 2)
plot_sqdiff + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 3)
plot_sqdiff + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 4)
plot_sqdiff + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 5)
```

::: {.callout-note appearance="minimal"}
For some of the facets, the distribution look very similar and differences over time are perhaps driven by outliers.
:::

Traits/facets sorted by average size of squared differences - in the control group from T1 to T2  
```{r}
#| echo: true
#| warning: false
#| fig-width: 9.5
#| fig-height: 4.5
sqdiff_df_plot_cg <- df_sbsa2 %>% 
  filter(rando=="Waitlist-Control" & time %in% c(1,2)) %>% 
  select(pid, time, all_of(paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_sqdiff"))) %>% 
  pivot_longer(-c(pid, time), names_to = "trait", values_to = "sqdiff") %>% 
  group_by(trait) %>% 
  mutate(cur_group_id()) %>% 
  ungroup() %>% 
  filter(!is.na(sqdiff)) %>% 
  mutate(trait2 = fct_recode(trait, !!! setNames(paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_sqdiff"),
                                                 str_to_title(names(b5_vars)))),
         trait2 = fct_reorder(trait2, sqdiff, .desc = T))

plot_sqdiff_cg <- ggplot(sqdiff_df_plot_cg) + 
  aes(x = as.factor(time), y = sqdiff) + 
  geom_boxplot() + 
  geom_violin(fill = NA) +
  ggforce::facet_wrap_paginate(~trait2, ncol=3, nrow=2) +
  labs(x = "Measurement Occasion", y = "Squared difference") + 
  theme_bw()

plot_sqdiff_cg + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 1)
plot_sqdiff_cg + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 2)
plot_sqdiff_cg + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 3)
plot_sqdiff_cg + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 4)
plot_sqdiff_cg + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 5)
```

::: {.callout-note appearance="minimal"}
Smaller changes but also quite substantial for some traits/facets (although not significant).
:::

Traits/facets sorted by average size of squared differences - in the intervention groups from T2 to T3  
```{r}
#| echo: true
#| warning: false
#| fig-width: 9.5
#| fig-height: 4.5
sqdiff_df_plot_fu <- df_sbsa2 %>% 
  filter(rando!="Waitlist-Control" & time %in% c(2,3)) %>% 
  select(pid, time, all_of(paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_sqdiff"))) %>% 
  pivot_longer(-c(pid, time), names_to = "trait", values_to = "sqdiff") %>% 
  group_by(trait) %>% 
  mutate(cur_group_id()) %>% 
  ungroup() %>% 
  filter(!is.na(sqdiff)) %>% 
  mutate(trait2 = fct_recode(trait, !!! setNames(paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_sqdiff"),
                                                 str_to_title(names(b5_vars)))),
         trait2 = fct_reorder(trait2, sqdiff, .desc = T))

plot_sqdiff_fu <- ggplot(sqdiff_df_plot_fu) + 
  aes(x = as.factor(time), y = sqdiff) + 
  geom_boxplot() + 
  geom_violin(fill = NA) +
  ggforce::facet_wrap_paginate(~trait2, ncol=3, nrow=2) +
  labs(x = "Measurement Occasion", y = "Squared difference") + 
  theme_bw()

plot_sqdiff_fu + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 1)
plot_sqdiff_fu + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 2)
plot_sqdiff_fu + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 3)
plot_sqdiff_fu + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 4)
plot_sqdiff_fu + ggforce::facet_wrap_paginate(~trait2, ncol=4, nrow=1, page = 5)
```

::: {.callout-note appearance="minimal"}
No substantial changes over time.
:::

------------------------------------------------------------------------

### H4: Change goals and change in personality (current / ideal) in self-improvement group {#hyp4}

Not specifically preregistered for study 2 because we were foremost interested in the moderation hypothesis (H6 in prereg / H2 in paper) and thought that it was somewhat redundant with these models of correlations with the change score. I still ran the models for study 2 here (without the control group and for changes between T1 and T2) in case the comparison with study 1 is of interest.  

*In the self-improvement group, there will be a correlation between change goals and change in current-personality ratings but not change in ideal-personality ratings.* 

We will test this one domain/facet at a time. We will use both general continuous change goal score as well as trait-specific change goals. To test this hypothesis, we will estimate the mean-level differences across time for both current and ideal trait ratings using latent change models and correlate change goals with the change variable from those models. 

Reshape and split data set by intervention group:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false

# from T1 to T2
df_sbsa2_wide_pers_sb <- df_sbsa2 %>% 
  filter(rando=="Self-Improvement" & time %in% c(1,2)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sb07")), # facet-specific change goals
         sb06_01) %>% # general change goal
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with("sb07"), sb06_01)) %>% 
  select(-c(sb07_01_t2, sb07_02_t2, sb07_03_t2, sb07_04_t2, sb07_05_t2, 
            sb07_06_t2, sb07_07_t2, sb07_08_t2, sb07_09_t2, sb07_10_t2, 
            sb07_11_t2, sb07_12_t2, sb07_13_t2, sb07_14_t2, sb07_15_t2, sb06_01_t2))
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sb <- df_sbsa2_wide_pers_sb %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sb)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sb)

group_assign <- df_sbsa2 %>% select(pid, rando) %>% unique()

df_sbsa2_wide_pers_sb <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% 
  filter(rando=="Self-Improvement") %>% select(-rando, -ends_with("_t3")) %>%
  left_join(df_sbsa2_wide_pers_sb)

# follow-up, from T2 to T3 (for later models)
df_sbsa2_wide_pers_sb_fu <- df_sbsa2 %>% 
  filter(rando=="Self-Improvement" & time %in% c(2,3)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sb07")), # facet-specific change goals
         sb06_01) %>% # general change goal
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with("sb07"), sb06_01)) %>% 
  select(-c(sb07_01_t2, sb07_02_t2, sb07_03_t2, sb07_04_t2, sb07_05_t2, 
            sb07_06_t2, sb07_07_t2, sb07_08_t2, sb07_09_t2, sb07_10_t2, 
            sb07_11_t2, sb07_12_t2, sb07_13_t2, sb07_14_t2, sb07_15_t2, sb06_01_t2))
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sb_fu <- df_sbsa2_wide_pers_sb_fu %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sb_fu)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sb_fu)

df_sbsa2_wide_pers_sb_fu <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% 
  filter(rando=="Self-Improvement" & !is.na(valid_t2)) %>% select(-rando, -ends_with("_t1")) %>%
  left_join(df_sbsa2_wide_pers_sb_fu)
```

#### Big Five traits

##### Extraversion - current-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_curr_hyp4 <- '
extra_t1 =~ 1*extra_curr_par1_t1 + lamb2*extra_curr_par2_t1 + lamb3*extra_curr_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_curr_par1_t2 + lamb2*extra_curr_par2_t2 + lamb3*extra_curr_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

extra_curr_par1_t1 ~~ extra_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_curr_par2_t1 ~~ extra_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_curr_par3_t1 ~~ extra_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_curr_par1_t1 ~~ res1*extra_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_curr_par2_t1 ~~ res2*extra_curr_par2_t1   # This allows residual variance on indicator X2 at T1
extra_curr_par3_t1 ~~ res3*extra_curr_par3_t1   # This allows residual variance on indicator X3 at T1

extra_curr_par1_t2 ~~ res1*extra_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_curr_par2_t2 ~~ res2*extra_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_curr_par3_t2 ~~ res3*extra_curr_par3_t2  # This allows residual variance on indicator X3 at T2

extra_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_extra_curr_hyp4 <- lavaan(mi_lcs_extra_curr_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_curr_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_hyp4 <- broom::tidy(fit_mi_lcs_extra_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                     "d_extra_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                     "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of the general change goal with the extraversion change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_curr_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_curr_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Extraversion - ideal-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_ideal_hyp4 <- '
extra_t1 =~ 1*extra_ideal_par1_t1 + lamb2*extra_ideal_par2_t1 + lamb3*extra_ideal_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_ideal_par1_t2 + lamb2*extra_ideal_par2_t2 + lamb3*extra_ideal_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

extra_ideal_par1_t1 ~~ extra_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_ideal_par2_t1 ~~ extra_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_ideal_par3_t1 ~~ extra_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_ideal_par1_t1 ~~ res1*extra_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_ideal_par2_t1 ~~ res2*extra_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
extra_ideal_par3_t1 ~~ res3*extra_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

extra_ideal_par1_t2 ~~ res1*extra_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_ideal_par2_t2 ~~ res2*extra_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_ideal_par3_t2 ~~ res3*extra_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

extra_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_extra_ideal_hyp4 <- lavaan(mi_lcs_extra_ideal_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_ideal_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_hyp4 <- broom::tidy(fit_mi_lcs_extra_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with extraversion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_ideal_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_ideal_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Extraversion - current-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_curr_specif_hyp4 <- '
extra_t1 =~ 1*extra_curr_par1_t1 + lamb2*extra_curr_par2_t1 + lamb3*extra_curr_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_curr_par1_t2 + lamb2*extra_curr_par2_t2 + lamb3*extra_curr_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

goals =~ 1*sb07_01_t1 + sb07_02_t1 + sb07_03_t1 # latent change goal variable (three facets per trait)

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

extra_curr_par1_t1 ~~ extra_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_curr_par2_t1 ~~ extra_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_curr_par3_t1 ~~ extra_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_curr_par1_t1 ~~ res1*extra_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_curr_par2_t1 ~~ res2*extra_curr_par2_t1   # This allows residual variance on indicator X2 at T1
extra_curr_par3_t1 ~~ res3*extra_curr_par3_t1   # This allows residual variance on indicator X3 at T1

extra_curr_par1_t2 ~~ res1*extra_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_curr_par2_t2 ~~ res2*extra_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_curr_par3_t2 ~~ res3*extra_curr_par3_t2  # This allows residual variance on indicator X3 at T2

extra_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_01_t1 ~~ sb07_01_t1
sb07_02_t1 ~~ sb07_02_t1
sb07_03_t1 ~~ sb07_03_t1

sb07_01_t1 ~ 1
sb07_02_t1 ~ 1
sb07_03_t1 ~ 1
'
fit_mi_lcs_extra_curr_specif_hyp4 <- lavaan(mi_lcs_extra_curr_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_curr_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_extra_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "goals ~~ d_extra_1", "goals ~~ goals", # change goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with extraversion change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_curr_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_curr_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1") %>% pull(p.value), 3)`. 
:::

##### Extraversion - ideal-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_ideal_specif_hyp4 <- '
extra_t1 =~ 1*extra_ideal_par1_t1 + lamb2*extra_ideal_par2_t1 + lamb3*extra_ideal_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_ideal_par1_t2 + lamb2*extra_ideal_par2_t2 + lamb3*extra_ideal_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

goals =~ 1*sb07_01_t1 + sb07_02_t1 + sb07_03_t1 # latent change goal variable (three facets per trait)

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

extra_ideal_par1_t1 ~~ extra_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_ideal_par2_t1 ~~ extra_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_ideal_par3_t1 ~~ extra_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_ideal_par1_t1 ~~ res1*extra_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_ideal_par2_t1 ~~ res2*extra_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
extra_ideal_par3_t1 ~~ res3*extra_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

extra_ideal_par1_t2 ~~ res1*extra_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_ideal_par2_t2 ~~ res2*extra_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_ideal_par3_t2 ~~ res3*extra_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

extra_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_01_t1 ~~ sb07_01_t1
sb07_02_t1 ~~ sb07_02_t1
sb07_03_t1 ~~ sb07_03_t1

sb07_01_t1 ~ 1
sb07_02_t1 ~ 1
sb07_03_t1 ~ 1
'
fit_mi_lcs_extra_ideal_specif_hyp4 <- lavaan(mi_lcs_extra_ideal_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_ideal_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "goals ~~ d_extra_1", "goals ~~ goals", # change goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with extraversion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - current-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_curr_hyp4 <- '
agree_t1 =~ 1*agree_curr_par1_t1 + lamb2*agree_curr_par2_t1 + lamb3*agree_curr_par3_t1 # This specifies the measurement model for agree_t1
agree_t2 =~ 1*agree_curr_par1_t2 + lamb2*agree_curr_par2_t2 + lamb3*agree_curr_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

agree_curr_par1_t1 ~~ agree_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_curr_par2_t1 ~~ agree_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_curr_par3_t1 ~~ agree_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_curr_par1_t1 ~~ res1*agree_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_curr_par2_t1 ~~ res2*agree_curr_par2_t1   # This allows residual variance on indicator X2 at T1
agree_curr_par3_t1 ~~ res3*agree_curr_par3_t1   # This allows residual variance on indicator X3 at T1

agree_curr_par1_t2 ~~ res1*agree_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_curr_par2_t2 ~~ res2*agree_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_curr_par3_t2 ~~ res3*agree_curr_par3_t2  # This allows residual variance on indicator X3 at T2

agree_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_agree_curr_hyp4 <- lavaan(mi_lcs_agree_curr_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_curr_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_hyp4 <- broom::tidy(fit_mi_lcs_agree_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                     "d_agree_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                     "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with agreeableness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_agree_curr_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_curr_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - ideal-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_ideal_hyp4 <- '
agree_t1 =~ 1*agree_ideal_par1_t1 + lamb2*agree_ideal_par2_t1 + lamb3*agree_ideal_par3_t1 # This specifies the measurement model for agree_t1 
agree_t2 =~ 1*agree_ideal_par1_t2 + lamb2*agree_ideal_par2_t2 + lamb3*agree_ideal_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

agree_ideal_par1_t1 ~~ agree_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_ideal_par2_t1 ~~ agree_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_ideal_par3_t1 ~~ agree_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_ideal_par1_t1 ~~ res1*agree_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_ideal_par2_t1 ~~ res2*agree_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
agree_ideal_par3_t1 ~~ res3*agree_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

agree_ideal_par1_t2 ~~ res1*agree_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_ideal_par2_t2 ~~ res2*agree_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_ideal_par3_t2 ~~ res3*agree_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

agree_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_agree_ideal_hyp4 <- lavaan(mi_lcs_agree_ideal_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_ideal_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_hyp4 <- broom::tidy(fit_mi_lcs_agree_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with agreeableness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_agree_ideal_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_ideal_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - current-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_curr_specif_hyp4 <- '
agree_t1 =~ 1*agree_curr_par1_t1 + lamb2*agree_curr_par2_t1 + lamb3*agree_curr_par3_t1 # This specifies the measurement model for agree_t1
agree_t2 =~ 1*agree_curr_par1_t2 + lamb2*agree_curr_par2_t2 + lamb3*agree_curr_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

goals =~ 1*sb07_04_t1 + sb07_05_t1 + sb07_06_t1 # latent change goal variable (three facets per trait)

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

agree_curr_par1_t1 ~~ agree_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_curr_par2_t1 ~~ agree_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_curr_par3_t1 ~~ agree_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_curr_par1_t1 ~~ res1*agree_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_curr_par2_t1 ~~ res2*agree_curr_par2_t1   # This allows residual variance on indicator X2 at T1
agree_curr_par3_t1 ~~ res3*agree_curr_par3_t1   # This allows residual variance on indicator X3 at T1

agree_curr_par1_t2 ~~ res1*agree_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_curr_par2_t2 ~~ res2*agree_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_curr_par3_t2 ~~ res3*agree_curr_par3_t2  # This allows residual variance on indicator X3 at T2

agree_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_04_t1 ~~ sb07_04_t1
sb07_05_t1 ~~ sb07_05_t1
sb07_06_t1 ~~ sb07_06_t1

sb07_04_t1 ~ 1
sb07_05_t1 ~ 1
sb07_06_t1 ~ 1
'
fit_mi_lcs_agree_curr_specif_hyp4 <- lavaan(mi_lcs_agree_curr_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_curr_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_agree_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "goals ~~ d_agree_1", "goals ~~ goals", # change goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with agreeableness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_agree_curr_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_curr_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - ideal-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_ideal_specif_hyp4 <- '
agree_t1 =~ 1*agree_ideal_par1_t1 + lamb2*agree_ideal_par2_t1 + lamb3*agree_ideal_par3_t1 # This specifies the measurement model for agree_t1 
agree_t2 =~ 1*agree_ideal_par1_t2 + lamb2*agree_ideal_par2_t2 + lamb3*agree_ideal_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

goals =~ 1*sb07_04_t1 + sb07_05_t1 + sb07_06_t1 # latent change goal variable (three facets per trait)

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

agree_ideal_par1_t1 ~~ agree_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_ideal_par2_t1 ~~ agree_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_ideal_par3_t1 ~~ agree_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_ideal_par1_t1 ~~ res1*agree_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_ideal_par2_t1 ~~ res2*agree_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
agree_ideal_par3_t1 ~~ res3*agree_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

agree_ideal_par1_t2 ~~ res1*agree_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_ideal_par2_t2 ~~ res2*agree_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_ideal_par3_t2 ~~ res3*agree_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

agree_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_04_t1 ~~ sb07_04_t1
sb07_05_t1 ~~ sb07_05_t1
sb07_06_t1 ~~ sb07_06_t1

sb07_04_t1 ~ 1
sb07_05_t1 ~ 1
sb07_06_t1 ~ 1
'
fit_mi_lcs_agree_ideal_specif_hyp4 <- lavaan(mi_lcs_agree_ideal_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_ideal_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "goals ~~ d_agree_1", "goals ~~ goals", # change goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with agreeableness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_agree_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - current-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_curr_hyp4 <- '
consc_t1 =~ 1*consc_curr_par1_t1 + lamb2*consc_curr_par2_t1 + lamb3*consc_curr_par3_t1 # This specifies the measurement model for consc_t1 
consc_t2 =~ 1*consc_curr_par1_t2 + lamb2*consc_curr_par2_t2 + lamb3*consc_curr_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

consc_curr_par1_t1 ~~ consc_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_curr_par2_t1 ~~ consc_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_curr_par3_t1 ~~ consc_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_curr_par1_t1 ~~ res1*consc_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_curr_par2_t1 ~~ res2*consc_curr_par2_t1   # This allows residual variance on indicator X2 at T1
consc_curr_par3_t1 ~~ res3*consc_curr_par3_t1   # This allows residual variance on indicator X3 at T1

consc_curr_par1_t2 ~~ res1*consc_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_curr_par2_t2 ~~ res2*consc_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_curr_par3_t2 ~~ res3*consc_curr_par3_t2  # This allows residual variance on indicator X3 at T2

consc_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_consc_curr_hyp4 <- lavaan(mi_lcs_consc_curr_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_curr_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_hyp4 <- broom::tidy(fit_mi_lcs_consc_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                     "d_consc_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                     "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with conscientiousness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_consc_curr_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_curr_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - ideal-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_ideal_hyp4 <- '
consc_t1 =~ 1*consc_ideal_par1_t1 + lamb2*consc_ideal_par2_t1 + lamb3*consc_ideal_par3_t1 # This specifies the measurement model for consc_t1
consc_t2 =~ 1*consc_ideal_par1_t2 + lamb2*consc_ideal_par2_t2 + lamb3*consc_ideal_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

consc_ideal_par1_t1 ~~ consc_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_ideal_par2_t1 ~~ consc_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_ideal_par3_t1 ~~ consc_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_ideal_par1_t1 ~~ res1*consc_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_ideal_par2_t1 ~~ res2*consc_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
consc_ideal_par3_t1 ~~ res3*consc_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

consc_ideal_par1_t2 ~~ res1*consc_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_ideal_par2_t2 ~~ res2*consc_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_ideal_par3_t2 ~~ res3*consc_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

consc_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_consc_ideal_hyp4 <- lavaan(mi_lcs_consc_ideal_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_ideal_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_hyp4 <- broom::tidy(fit_mi_lcs_consc_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with conscientiousness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_consc_ideal_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_ideal_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - current-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_curr_specif_hyp4 <- '
consc_t1 =~ 1*consc_curr_par1_t1 + lamb2*consc_curr_par2_t1 + lamb3*consc_curr_par3_t1 # This specifies the measurement model for consc_t1 
consc_t2 =~ 1*consc_curr_par1_t2 + lamb2*consc_curr_par2_t2 + lamb3*consc_curr_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

goals =~ 1*sb07_07_t1 + sb07_08_t1 + sb07_09_t1 # latent change goal variable (three facets per trait)

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

consc_curr_par1_t1 ~~ consc_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_curr_par2_t1 ~~ consc_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_curr_par3_t1 ~~ consc_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_curr_par1_t1 ~~ res1*consc_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_curr_par2_t1 ~~ res2*consc_curr_par2_t1   # This allows residual variance on indicator X2 at T1
consc_curr_par3_t1 ~~ res3*consc_curr_par3_t1   # This allows residual variance on indicator X3 at T1

consc_curr_par1_t2 ~~ res1*consc_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_curr_par2_t2 ~~ res2*consc_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_curr_par3_t2 ~~ res3*consc_curr_par3_t2  # This allows residual variance on indicator X3 at T2

consc_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_07_t1 ~~ sb07_07_t1
sb07_08_t1 ~~ sb07_08_t1
sb07_09_t1 ~~ sb07_09_t1

sb07_07_t1 ~ 1
sb07_08_t1 ~ 1
sb07_09_t1 ~ 1
'
fit_mi_lcs_consc_curr_specif_hyp4 <- lavaan(mi_lcs_consc_curr_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_curr_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_consc_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "goals ~~ d_consc_1", "goals ~~ goals", # change goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with conscientiousness change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_consc_curr_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_curr_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - ideal-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_ideal_specif_hyp4 <- '
consc_t1 =~ 1*consc_ideal_par1_t1 + lamb2*consc_ideal_par2_t1 + lamb3*consc_ideal_par3_t1 # This specifies the measurement model for consc_t1
consc_t2 =~ 1*consc_ideal_par1_t2 + lamb2*consc_ideal_par2_t2 + lamb3*consc_ideal_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

goals =~ 1*sb07_07_t1 + sb07_08_t1 + sb07_09_t1 # latent change goal variable (three facets per trait)

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

consc_ideal_par1_t1 ~~ consc_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_ideal_par2_t1 ~~ consc_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_ideal_par3_t1 ~~ consc_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_ideal_par1_t1 ~~ res1*consc_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_ideal_par2_t1 ~~ res2*consc_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
consc_ideal_par3_t1 ~~ res3*consc_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

consc_ideal_par1_t2 ~~ res1*consc_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_ideal_par2_t2 ~~ res2*consc_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_ideal_par3_t2 ~~ res3*consc_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

consc_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_07_t1 ~~ sb07_07_t1
sb07_08_t1 ~~ sb07_08_t1
sb07_09_t1 ~~ sb07_09_t1

sb07_07_t1 ~ 1
sb07_08_t1 ~ 1
sb07_09_t1 ~ 1
'
fit_mi_lcs_consc_ideal_specif_hyp4 <- lavaan(mi_lcs_consc_ideal_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_ideal_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "goals ~~ d_consc_1", "goals ~~ goals", # change goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with conscientiousness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_consc_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - current-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_curr_hyp4 <- '
neuro_t1 =~ 1*neuro_curr_par1_t1 + lamb2*neuro_curr_par2_t1 + lamb3*neuro_curr_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_curr_par1_t2 + lamb2*neuro_curr_par2_t2 + lamb3*neuro_curr_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

neuro_curr_par1_t1 ~~ neuro_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_curr_par2_t1 ~~ neuro_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_curr_par3_t1 ~~ neuro_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_curr_par1_t1 ~~ res1*neuro_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_curr_par2_t1 ~~ res2*neuro_curr_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_curr_par3_t1 ~~ res3*neuro_curr_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_curr_par1_t2 ~~ res1*neuro_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_curr_par2_t2 ~~ res2*neuro_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_curr_par3_t2 ~~ res3*neuro_curr_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_neuro_curr_hyp4 <- lavaan(mi_lcs_neuro_curr_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_curr_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_hyp4 <- broom::tidy(fit_mi_lcs_neuro_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                     "d_neuro_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                     "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with neuroticism change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_neuro_curr_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_curr_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - ideal-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_ideal_hyp4 <- '
neuro_t1 =~ 1*neuro_ideal_par1_t1 + lamb2*neuro_ideal_par2_t1 + lamb3*neuro_ideal_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_ideal_par1_t2 + lamb2*neuro_ideal_par2_t2 + lamb3*neuro_ideal_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

neuro_ideal_par1_t1 ~~ neuro_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_ideal_par2_t1 ~~ neuro_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_ideal_par3_t1 ~~ neuro_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_ideal_par1_t1 ~~ res1*neuro_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_ideal_par2_t1 ~~ res2*neuro_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_ideal_par3_t1 ~~ res3*neuro_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_ideal_par1_t2 ~~ res1*neuro_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_ideal_par2_t2 ~~ res2*neuro_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_ideal_par3_t2 ~~ res3*neuro_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_neuro_ideal_hyp4 <- lavaan(mi_lcs_neuro_ideal_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_ideal_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_hyp4 <- broom::tidy(fit_mi_lcs_neuro_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with neuroticism change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_neuro_ideal_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_ideal_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - current-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_curr_specif_hyp4 <- '
neuro_t1 =~ 1*neuro_curr_par1_t1 + lamb2*neuro_curr_par2_t1 + lamb3*neuro_curr_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_curr_par1_t2 + lamb2*neuro_curr_par2_t2 + lamb3*neuro_curr_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

goals =~ 1*sb07_10_t1 + sb07_11_t1 + sb07_12_t1 # latent change goal variable (three facets per trait)

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

neuro_curr_par1_t1 ~~ neuro_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_curr_par2_t1 ~~ neuro_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_curr_par3_t1 ~~ neuro_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_curr_par1_t1 ~~ res1*neuro_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_curr_par2_t1 ~~ res2*neuro_curr_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_curr_par3_t1 ~~ res3*neuro_curr_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_curr_par1_t2 ~~ res1*neuro_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_curr_par2_t2 ~~ res2*neuro_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_curr_par3_t2 ~~ res3*neuro_curr_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_10_t1 ~~ sb07_10_t1
sb07_11_t1 ~~ sb07_11_t1
sb07_12_t1 ~~ sb07_12_t1

sb07_10_t1 ~ 1
sb07_11_t1 ~ 1
sb07_12_t1 ~ 1
'
fit_mi_lcs_neuro_curr_specif_hyp4 <- lavaan(mi_lcs_neuro_curr_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_curr_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "goals ~~ d_neuro_1", "goals ~~ goals", # change goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level change goals with neuroticism change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_neuro_curr_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_curr_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - ideal-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_ideal_specif_hyp4 <- '
neuro_t1 =~ 1*neuro_ideal_par1_t1 + lamb2*neuro_ideal_par2_t1 + lamb3*neuro_ideal_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_ideal_par1_t2 + lamb2*neuro_ideal_par2_t2 + lamb3*neuro_ideal_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

goals =~ 1*sb07_10_t1 + sb07_11_t1 + sb07_12_t1 # latent change goal variable (three facets per trait)

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

neuro_ideal_par1_t1 ~~ neuro_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_ideal_par2_t1 ~~ neuro_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_ideal_par3_t1 ~~ neuro_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_ideal_par1_t1 ~~ res1*neuro_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_ideal_par2_t1 ~~ res2*neuro_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_ideal_par3_t1 ~~ res3*neuro_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_ideal_par1_t2 ~~ res1*neuro_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_ideal_par2_t2 ~~ res2*neuro_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_ideal_par3_t2 ~~ res3*neuro_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_10_t1 ~~ sb07_10_t1
sb07_11_t1 ~~ sb07_11_t1
sb07_12_t1 ~~ sb07_12_t1

sb07_10_t1 ~ 1
sb07_11_t1 ~ 1
sb07_12_t1 ~ 1
'
fit_mi_lcs_neuro_ideal_specif_hyp4 <- lavaan(mi_lcs_neuro_ideal_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_ideal_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "goals ~~ d_neuro_1", "goals ~~ goals", # change goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with neuroticism change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_neuro_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(p.value), 3)`. 
:::

##### Openness - current-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_curr_hyp4 <- '
openn_t1 =~ 1*openn_curr_par1_t1 + lamb2*openn_curr_par2_t1 + lamb3*openn_curr_par3_t1 # This specifies the measurement model for openn_t1
openn_t2 =~ 1*openn_curr_par1_t2 + lamb2*openn_curr_par2_t2 + lamb3*openn_curr_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

openn_curr_par1_t1 ~~ openn_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_curr_par2_t1 ~~ openn_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_curr_par3_t1 ~~ openn_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_curr_par1_t1 ~~ res1*openn_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_curr_par2_t1 ~~ res2*openn_curr_par2_t1   # This allows residual variance on indicator X2 at T1
openn_curr_par3_t1 ~~ res3*openn_curr_par3_t1   # This allows residual variance on indicator X3 at T1

openn_curr_par1_t2 ~~ res1*openn_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_curr_par2_t2 ~~ res2*openn_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_curr_par3_t2 ~~ res3*openn_curr_par3_t2  # This allows residual variance on indicator X3 at T2

openn_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_openn_curr_hyp4 <- lavaan(mi_lcs_openn_curr_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_openn_curr_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_hyp4 <- broom::tidy(fit_mi_lcs_openn_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                     "d_openn_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                     "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with openness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_openn_curr_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_curr_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Openness - ideal-personality: general change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest change goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_ideal_hyp4 <- '
openn_t1 =~ 1*openn_ideal_par1_t1 + lamb2*openn_ideal_par2_t1 + lamb3*openn_ideal_par3_t1 # This specifies the measurement model for openn_t1 
openn_t2 =~ 1*openn_ideal_par1_t2 + lamb2*openn_ideal_par2_t2 + lamb3*openn_ideal_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

openn_ideal_par1_t1 ~~ openn_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_ideal_par2_t1 ~~ openn_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_ideal_par3_t1 ~~ openn_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_ideal_par1_t1 ~~ res1*openn_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_ideal_par2_t1 ~~ res2*openn_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
openn_ideal_par3_t1 ~~ res3*openn_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

openn_ideal_par1_t2 ~~ res1*openn_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_ideal_par2_t2 ~~ res2*openn_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_ideal_par3_t2 ~~ res3*openn_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

openn_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'
fit_mi_lcs_openn_ideal_hyp4 <- lavaan(mi_lcs_openn_ideal_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_openn_ideal_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_hyp4 <- broom::tidy(fit_mi_lcs_openn_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with openness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_openn_ideal_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_ideal_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Openness - current-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_curr_specif_hyp4 <- '
openn_t1 =~ 1*openn_curr_par1_t1 + lamb2*openn_curr_par2_t1 + lamb3*openn_curr_par3_t1 # This specifies the measurement model for openn_t1
openn_t2 =~ 1*openn_curr_par1_t2 + lamb2*openn_curr_par2_t2 + lamb3*openn_curr_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

goals =~ 1*sb07_13_t1 + sb07_14_t1 + sb07_15_t1 # latent change goal variable (three facets per trait)

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

openn_curr_par1_t1 ~~ openn_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_curr_par2_t1 ~~ openn_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_curr_par3_t1 ~~ openn_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_curr_par1_t1 ~~ res1*openn_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_curr_par2_t1 ~~ res2*openn_curr_par2_t1   # This allows residual variance on indicator X2 at T1
openn_curr_par3_t1 ~~ res3*openn_curr_par3_t1   # This allows residual variance on indicator X3 at T1

openn_curr_par1_t2 ~~ res1*openn_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_curr_par2_t2 ~~ res2*openn_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_curr_par3_t2 ~~ res3*openn_curr_par3_t2  # This allows residual variance on indicator X3 at T2

openn_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_13_t1 ~~ sb07_13_t1
sb07_14_t1 ~~ sb07_14_t1
sb07_15_t1 ~~ sb07_15_t1

sb07_13_t1 ~ 1
sb07_14_t1 ~ 1
sb07_15_t1 ~ 1
'
fit_mi_lcs_openn_curr_specif_hyp4 <- lavaan(mi_lcs_openn_curr_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_openn_curr_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_openn_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "goals ~~ d_openn_1", "goals ~~ goals", # change goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level change goals with openness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_openn_curr_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_curr_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1") %>% pull(p.value), 3)`. 
:::

##### Openness - ideal-personality: specific, facet-level change goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) change goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_ideal_specif_hyp4 <- '
openn_t1 =~ 1*openn_ideal_par1_t1 + lamb2*openn_ideal_par2_t1 + lamb3*openn_ideal_par3_t1 # This specifies the measurement model for openn_t1 
openn_t2 =~ 1*openn_ideal_par1_t2 + lamb2*openn_ideal_par2_t2 + lamb3*openn_ideal_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

goals =~ 1*sb07_13_t1 + sb07_14_t1 + sb07_15_t1 # latent change goal variable (three facets per trait)

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ goals     # estimates the covariance/correlation with the (latent) change goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) change goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) change goal variable

openn_ideal_par1_t1 ~~ openn_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_ideal_par2_t1 ~~ openn_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_ideal_par3_t1 ~~ openn_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_ideal_par1_t1 ~~ res1*openn_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_ideal_par2_t1 ~~ res2*openn_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
openn_ideal_par3_t1 ~~ res3*openn_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

openn_ideal_par1_t2 ~~ res1*openn_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_ideal_par2_t2 ~~ res2*openn_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_ideal_par3_t2 ~~ res3*openn_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

openn_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb07_13_t1 ~~ sb07_13_t1
sb07_14_t1 ~~ sb07_14_t1
sb07_15_t1 ~~ sb07_15_t1

sb07_13_t1 ~ 1
sb07_14_t1 ~ 1
sb07_15_t1 ~ 1
'
fit_mi_lcs_openn_ideal_specif_hyp4 <- lavaan(mi_lcs_openn_ideal_specif_hyp4, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_openn_ideal_specif_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "goals ~~ d_openn_1", "goals ~~ goals", # change goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with openness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_openn_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1") %>% pull(p.value), 3)`. 
:::

#### Big Five facets

Run models for all facets with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create template:
facet_template <- '
facet_t1 =~ 1*ind1_t1 + lamb2*ind2_t1 + lamb3*ind3_t1 + lamb4*ind4_t1 # This specifies the measurement model for facet at T1
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2 (with equality constraints)

facet_t2 ~ 1*facet_t1     # This parameter regresses facet_t2 perfectly on facet_t1
d_facet_1 =~ 1*facet_t2   # This defines the latent change score factor as measured perfectly by scores on facet_t2
facet_t2 ~ 0*1            # This line constrains the intercept of facet_t2 to 0
facet_t2 ~~ 0*facet_t2    # This fixes the variance of facet_t2 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t1 ~ 1               # This estimates the intercept of facet_t1 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t1 ~~ facet_t1       # This estimates the variance of facet_t1 
facet_t1 ~~ d_facet_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_facet_1 ~~ ind_goal     # estimates the covariance/correlation with change goal variable

ind1_t1 ~~ ind1_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind2_t1 ~~ ind2_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind3_t1 ~~ ind3_t2   # This allows residual covariance on indicator X3 across T1 and T2
ind4_t1 ~~ ind4_t2   # This allows residual covariance on indicator X4 across T1 and T2

ind1_t1 ~~ res1*ind1_t1   # This allows residual variance on indicator X1 at T1 
ind2_t1 ~~ res2*ind2_t1   # This allows residual variance on indicator X2 at T1
ind3_t1 ~~ res3*ind3_t1   # This allows residual variance on indicator X3 at T1
ind4_t1 ~~ res4*ind4_t1   # This allows residual variance on indicator X4 at T1

ind1_t2 ~~ res1*ind1_t2  # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2  # This allows residual variance on indicator X2 at T2 
ind3_t2 ~~ res3*ind3_t2  # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2  # This allows residual variance on indicator X4 at T2

ind1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind3_t1 ~ m3*1     # This estimates the intercept of X3 at T1
ind4_t1 ~ m4*1     # This estimates the intercept of X4 at T1

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind_goal ~~ ind_goal
ind_goal ~ 1
'

# loop across 15 facets
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # loop across 2 BFI versions (combined pre&post current/ideal)
  for (j in 5:length(bfi_versions)) {
    items = paste0(bfi_versions[[j]], item_nrs)
    # loop across 2 different goal operationalizations (sb06_01_t1 & sb07_XX_t1)
    for (k in 1:2) {
      if (k==1) {
        goal_op = "sb06_01_t1"
      } else{
        goal_op = paste0("sb07_", str_pad(i-5, 2, pad = "0"), "_t1")
      }
      template_filled <- str_replace_all(facet_template, 
                                         c("facet" = short_name,
                                           "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                           "ind_goal" = goal_op))
      facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb, estimator='mlr', fixed.x=FALSE, missing='fiml')
      # save to environment
      if (k==1) {
        eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_hyp4")), template_filled))
        eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_hyp4")), facet_model_fit))
      } else{
        eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_specif_hyp4")), template_filled))
        eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_specif_hyp4")), facet_model_fit))
      }
    }
  }
}  
```

##### Sociability - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_hyp4 <- broom::tidy(fit_mi_lcs_socia_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of the general change goal with the sociability change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_socia_curr_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_curr_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_hyp4 <- broom::tidy(fit_mi_lcs_socia_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with sociability change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_socia_ideal_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_ideal_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_socia_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~~ sb07_01_t1", "sb07_01_t1 ~~ sb07_01_t1", # change goals
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with sociability change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_socia_curr_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_curr_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~~ sb07_01_t1", "sb07_01_t1 ~~ sb07_01_t1", # change goals
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level change goals with the anxiety change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_socia_ideal_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_ideal_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_hyp4 <- broom::tidy(fit_mi_lcs_asser_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with assertiveness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_asser_curr_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_curr_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_hyp4 <- broom::tidy(fit_mi_lcs_asser_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with assertiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_asser_ideal_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_ideal_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_asser_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~~ sb07_02_t1", "sb07_02_t1 ~~ sb07_02_t1", # change goals
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with assertiveness change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_asser_curr_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_curr_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~~ sb07_02_t1", "sb07_02_t1 ~~ sb07_02_t1", # change goals
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with assertiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_asser_ideal_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_ideal_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_hyp4 <- broom::tidy(fit_mi_lcs_energ_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with energy change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_curr_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_curr_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_hyp4 <- broom::tidy(fit_mi_lcs_energ_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with energy change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_ideal_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_ideal_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_energ_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~~ sb07_03_t1", "sb07_03_t1 ~~ sb07_03_t1", # change goals
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with energy change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_curr_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_curr_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~~ sb07_03_t1", "sb07_03_t1 ~~ sb07_03_t1", # change goals
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with energy change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_ideal_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_ideal_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_hyp4 <- broom::tidy(fit_mi_lcs_compa_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with compassion change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_compa_curr_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_curr_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_hyp4 <- broom::tidy(fit_mi_lcs_compa_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with compassion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_compa_ideal_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_ideal_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_compa_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~~ sb07_04_t1", "sb07_04_t1 ~~ sb07_04_t1", # change goals
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with compassion change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_compa_curr_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_curr_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~~ sb07_04_t1", "sb07_04_t1 ~~ sb07_04_t1", # change goals
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with compassion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_compa_ideal_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_ideal_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_hyp4 <- broom::tidy(fit_mi_lcs_respe_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with respectfulness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_respe_curr_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_curr_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_hyp4 <- broom::tidy(fit_mi_lcs_respe_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with respectfulness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respe_ideal_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_ideal_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_respe_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~~ sb07_05_t1", "sb07_05_t1 ~~ sb07_05_t1", # change goals
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with respectfulness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_respe_curr_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_curr_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~~ sb07_05_t1", "sb07_05_t1 ~~ sb07_05_t1", # change goals
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level change goals with the respectfulness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respe_ideal_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_ideal_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_hyp4 <- broom::tidy(fit_mi_lcs_trust_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with trust change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_curr_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_curr_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_hyp4 <- broom::tidy(fit_mi_lcs_trust_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with trust change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_ideal_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_ideal_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_trust_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~~ sb07_06_t1", "sb07_06_t1 ~~ sb07_06_t1", # change goals
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with trust change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_curr_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_curr_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~~ sb07_06_t1", "sb07_06_t1 ~~ sb07_06_t1", # change goals
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with trust change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_ideal_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_ideal_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_hyp4 <- broom::tidy(fit_mi_lcs_organ_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with organization change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_organ_curr_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_curr_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_hyp4 <- broom::tidy(fit_mi_lcs_organ_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with organization change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_organ_ideal_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_ideal_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_organ_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~~ sb07_07_t1", "sb07_07_t1 ~~ sb07_07_t1", # change goals
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with organization change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_organ_curr_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_curr_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~~ sb07_07_t1", "sb07_07_t1 ~~ sb07_07_t1", # change goals
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with organization change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_organ_ideal_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_ideal_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_hyp4 <- broom::tidy(fit_mi_lcs_produ_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with productiveness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_produ_curr_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_curr_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_hyp4 <- broom::tidy(fit_mi_lcs_produ_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with productiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_produ_ideal_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_ideal_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_produ_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~~ sb07_08_t1", "sb07_08_t1 ~~ sb07_08_t1", # change goals
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with productiveness change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_produ_curr_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_curr_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~~ sb07_08_t1", "sb07_08_t1 ~~ sb07_08_t1", # change goals
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with productiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_produ_ideal_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_ideal_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_hyp4 <- broom::tidy(fit_mi_lcs_respo_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with responsibility change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_curr_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_curr_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_hyp4 <- broom::tidy(fit_mi_lcs_respo_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with responsibility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_ideal_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_ideal_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_respo_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~~ sb07_09_t1", "sb07_09_t1 ~~ sb07_09_t1", # change goals
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with responsibility change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_curr_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_curr_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~~ sb07_09_t1", "sb07_09_t1 ~~ sb07_09_t1", # change goals
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with responsibility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_ideal_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_ideal_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_hyp4 <- broom::tidy(fit_mi_lcs_anxie_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with anxiety change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_anxie_curr_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_curr_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_hyp4 <- broom::tidy(fit_mi_lcs_anxie_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with anxiety change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_anxie_ideal_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_ideal_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~~ sb07_10_t1", "sb07_10_t1 ~~ sb07_10_t1", # change goals
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level change goals with the anxiety change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_anxie_curr_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_curr_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~~ sb07_10_t1", "sb07_10_t1 ~~ sb07_10_t1", # change goals
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with anxiety change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_anxie_ideal_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_ideal_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_hyp4 <- broom::tidy(fit_mi_lcs_depre_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with depression change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_depre_curr_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_curr_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_hyp4 <- broom::tidy(fit_mi_lcs_depre_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with depression change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_depre_ideal_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_ideal_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_depre_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~~ sb07_11_t1", "sb07_11_t1 ~~ sb07_11_t1", # change goals
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level change goals with the depression change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_depre_curr_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_curr_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~~ sb07_11_t1", "sb07_11_t1 ~~ sb07_11_t1", # change goals
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with the depression change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_depre_ideal_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_ideal_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_hyp4 <- broom::tidy(fit_mi_lcs_volat_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with volatility change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_volat_curr_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_curr_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_hyp4 <- broom::tidy(fit_mi_lcs_volat_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with volatility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_volat_ideal_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_ideal_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_volat_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~~ sb07_12_t1", "sb07_12_t1 ~~ sb07_12_t1", # change goals
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with volatility change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_volat_curr_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_curr_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~~ sb07_12_t1", "sb07_12_t1 ~~ sb07_12_t1", # change goals
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with volatility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_volat_ideal_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_ideal_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_hyp4 <- broom::tidy(fit_mi_lcs_curio_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with curiosity change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_curr_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_curr_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_hyp4 <- broom::tidy(fit_mi_lcs_curio_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with curiosity change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_ideal_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_ideal_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_curio_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~~ sb07_13_t1", "sb07_13_t1 ~~ sb07_13_t1", # change goals
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with curiosity change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_curr_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_curr_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~~ sb07_13_t1", "sb07_13_t1 ~~ sb07_13_t1", # change goals
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with curiosity change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_ideal_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_ideal_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_hyp4 <- broom::tidy(fit_mi_lcs_aesth_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with aesthetic change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_aesth_curr_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_curr_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):  
(here there were some convergence problems with the standard model that the loop tried to fit)  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

mi_lcs_aesth_ideal_hyp4 <- '
aesth_t1 =~ 1*bf06_05_t1 + lamb2*bf06_20_t1 + lamb3*bf06_35_t1 + lamb4*bf06_50_t1 # This specifies the measurement model for aesth at T1
aesth_t2 =~ 1*bf06_05_t2 + lamb2*bf06_20_t2 + lamb3*bf06_35_t2 + lamb4*bf06_50_t2 # This specifies the measurement model for aesth at T2 (with equality constraints)

aesth_t2 ~ 1*aesth_t1     # This parameter regresses aesth_t2 perfectly on aesth_t1
d_aesth_1 =~ 1*aesth_t2   # This defines the latent change score factor as measured perfectly by scores on aesth_t2
aesth_t2 ~ 0*1            # This line constrains the intercept of aesth_t2 to 0
aesth_t2 ~~ 0*aesth_t2    # This fixes the variance of aesth_t2 to 0

d_aesth_1 ~ 1              # This estimates the intercept of the change score 
aesth_t1 ~ 1               # This estimates the intercept of aesth_t1 
d_aesth_1 ~~ d_aesth_1     # This estimates the variance of the change scores 
aesth_t1 ~~ aesth_t1       # This estimates the variance of aesth_t1 
aesth_t1 ~~ d_aesth_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_aesth_1 ~~ sb06_01_t1     # estimates the covariance/correlation with change goal variable

bf06_05_t1 ~~ bf06_05_t2   # This allows residual covariance on indicator X1 across T1 and T2
bf06_20_t1 ~~ bf06_20_t2   # This allows residual covariance on indicator X2 across T1 and T2
bf06_35_t1 ~~ bf06_35_t2   # This allows residual covariance on indicator X3 across T1 and T2
bf06_50_t1 ~~ bf06_50_t2   # This allows residual covariance on indicator X4 across T1 and T2

bf06_05_t1 ~~ res1*bf06_05_t1   # This allows residual variance on indicator X1 at T1 
bf06_20_t1 ~~ res2*bf06_20_t1   # This allows residual variance on indicator X2 at T1
bf06_35_t1 ~~ res3*bf06_35_t1   # This allows residual variance on indicator X3 at T1
bf06_50_t1 ~~ res4*bf06_50_t1   # This allows residual variance on indicator X4 at T1

bf06_05_t2 ~~ res1*bf06_05_t2  # This allows residual variance on indicator X1 at T2 
bf06_20_t2 ~~ res2*bf06_20_t2  # This allows residual variance on indicator X2 at T2 
bf06_35_t2 ~~ res3*bf06_35_t2  # This allows residual variance on indicator X3 at T2
bf06_50_t2 ~~ res4*bf06_50_t2  # This allows residual variance on indicator X4 at T2

bf06_05_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
bf06_20_t1 ~ m2*1     # This estimates the intercept of X2 at T1
bf06_35_t1 ~ m3*1     # This estimates the intercept of X3 at T1
bf06_50_t1 ~ m4*1     # This estimates the intercept of X4 at T1

bf06_05_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
bf06_20_t2 ~ m2*1     # This estimates the intercept of X2 at T2
bf06_35_t2 ~ m3*1     # This estimates the intercept of X3 at T2
bf06_50_t2 ~ m4*1     # This estimates the intercept of X4 at T2

sb06_01_t1 ~~ sb06_01_t1
sb06_01_t1 ~ 1
'

fit_mi_lcs_aesth_ideal_hyp4 <- lavaan(mi_lcs_aesth_ideal_hyp4, 
                                     data=df_sbsa2_wide_pers_sb %>% filter(!is.na(bf06_05_t1) & !is.na(bf06_05_t2)), 
                                     estimator='WLSMV', fixed.x=FALSE, ordered="sb06_01_t1") # need to use a different optimizer here!
# This model did not converge properly with FIML and missings. No problem with complete data, though. 
summary(fit_mi_lcs_aesth_ideal_hyp4, fit.measures=TRUE, standardized=TRUE, rsquare=F)

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_hyp4 <- broom::tidy(fit_mi_lcs_aesth_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with aesthetic change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_aesth_ideal_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_ideal_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~~ sb07_14_t1", "sb07_14_t1 ~~ sb07_14_t1", # change goals
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with aesthetic change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_aesth_curr_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_curr_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~~ sb07_14_t1", "sb07_14_t1 ~~ sb07_14_t1", # change goals
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with aesthetic change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_aesth_ideal_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_ideal_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - current-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_hyp4 <- broom::tidy(fit_mi_lcs_imagi_curr_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                     "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with imagination change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_curr_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_curr_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - ideal-personality: general change goals

Results summary (*sb06_01_t1* = general change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_hyp4 <- broom::tidy(fit_mi_lcs_imagi_ideal_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~~ sb06_01_t1", "sb06_01_t1 ~~ sb06_01_t1", "sb06_01_t1 ~1 ", # change goals
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general change goal with imagination change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_ideal_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_ideal_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - current-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_specif_hyp4 <- broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~~ sb07_15_t1", "sb07_15_t1 ~~ sb07_15_t1", # change goals
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with imagination change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_curr_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_curr_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - ideal-personality: specific, facet-level change goals

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_specif_hyp4) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_specif_hyp4 <- broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp4, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~~ sb07_15_t1", "sb07_15_t1 ~~ sb07_15_t1", # change goals
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_specif_hyp4, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level change goals with imagination change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_ideal_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_ideal_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1") %>% pull(p.value), 3)`. 
:::

#### Hyp 4: Effects summary

Run models for all facets with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create df for table:

df_table_hyp4 <- bind_rows(
  #traits
  params_lcs_extra_curr_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1"),
  params_lcs_extra_ideal_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1"),
  params_lcs_extra_curr_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_extra_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_agree_curr_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1"),
  params_lcs_agree_ideal_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1"),
  params_lcs_agree_curr_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_agree_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_consc_curr_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1"),
  params_lcs_consc_ideal_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1"),
  params_lcs_consc_curr_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_consc_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_neuro_curr_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1"),
  params_lcs_neuro_ideal_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1"),
  params_lcs_neuro_curr_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_neuro_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_openn_curr_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1"),
  params_lcs_openn_ideal_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1"),
  params_lcs_openn_curr_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1"),
  params_lcs_openn_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1"),
  #facets
  params_lcs_socia_curr_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1"),
  params_lcs_socia_ideal_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1"),
  params_lcs_socia_curr_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1"),
  params_lcs_socia_ideal_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1"),
  params_lcs_asser_curr_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1"),
  params_lcs_asser_ideal_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1"),
  params_lcs_asser_curr_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1"),
  params_lcs_asser_ideal_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1"),
  params_lcs_energ_curr_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1"),
  params_lcs_energ_ideal_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1"),
  params_lcs_energ_curr_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1"),
  params_lcs_energ_ideal_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1"),
  params_lcs_compa_curr_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1"),
  params_lcs_compa_ideal_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1"),
  params_lcs_compa_curr_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1"),
  params_lcs_compa_ideal_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1"),
  params_lcs_respe_curr_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1"),
  params_lcs_respe_ideal_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1"),
  params_lcs_respe_curr_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1"),
  params_lcs_respe_ideal_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1"),
  params_lcs_trust_curr_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1"),
  params_lcs_trust_ideal_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1"),
  params_lcs_trust_curr_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1"),
  params_lcs_trust_ideal_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1"),
  params_lcs_organ_curr_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1"),
  params_lcs_organ_ideal_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1"),
  params_lcs_organ_curr_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1"),
  params_lcs_organ_ideal_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1"),
  params_lcs_produ_curr_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1"),
  params_lcs_produ_ideal_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1"),
  params_lcs_produ_curr_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1"),
  params_lcs_produ_ideal_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1"),
  params_lcs_respo_curr_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1"),
  params_lcs_respo_ideal_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1"),
  params_lcs_respo_curr_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1"),
  params_lcs_respo_ideal_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1"),
  params_lcs_anxie_curr_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1"),
  params_lcs_anxie_ideal_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1"),
  params_lcs_anxie_curr_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1"),
  params_lcs_anxie_ideal_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1"),
  params_lcs_depre_curr_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1"),
  params_lcs_depre_ideal_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1"),
  params_lcs_depre_curr_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1"),
  params_lcs_depre_ideal_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1"),
  params_lcs_volat_curr_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1"),
  params_lcs_volat_ideal_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1"),
  params_lcs_volat_curr_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1"),
  params_lcs_volat_ideal_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1"),
  params_lcs_curio_curr_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1"),
  params_lcs_curio_ideal_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1"),
  params_lcs_curio_curr_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1"),
  params_lcs_curio_ideal_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1"),
  params_lcs_aesth_curr_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1"),
  params_lcs_aesth_ideal_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1"),
  params_lcs_aesth_curr_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1"),
  params_lcs_aesth_ideal_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1"),
  params_lcs_imagi_curr_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1"),
  params_lcs_imagi_ideal_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1"),
  params_lcs_imagi_curr_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1"),
  params_lcs_imagi_ideal_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1"),
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=4),
         ref = rep(rep(c("current", "ideal"), 2), 20),
         goal = rep(c(rep("general", 2), rep("specific", 2)), 20)) %>% 
  select(trait, ref, goal, estimate, std.all, statistic, p.value)

```

Results summary across the Big Five traits: covariance of the latent change score and change goal(s)
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

kable(df_table_hyp4[1:20, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
Two covariances/correlations that significantly differ from zero:  
- Changes in current-level conscientiousness covary with the specific trait goals (latent factor of the three C facets).  
- Changes in current-level neuroticism covary with the specific trait goals (latent factor of the three N facets).  
:::

Results summary across the Big Five facets: covariance of the latent change score and change goal(s)
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp4[21:80, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
Looking at the facets, we see five covariances that significantly differ from zero (at p < .05):  
- For sociability and assertiveness, changes in the current-level the specific facet change goal (both effects barely significant and in unexpected direction).  
- For productiveness, changes in the current-level the specific facet change goal.  
- Changes in current-level depression and volatility covary with the respective specific facet change goal.  
:::

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_table_hyp4_plot <- bind_rows(
  #traits
  params_lcs_extra_curr_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1"),
  params_lcs_extra_ideal_hyp4 %>% filter(term=="d_extra_1 ~~ sb06_01_t1"),
  params_lcs_extra_curr_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_extra_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_agree_curr_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1"),
  params_lcs_agree_ideal_hyp4 %>% filter(term=="d_agree_1 ~~ sb06_01_t1"),
  params_lcs_agree_curr_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_agree_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_consc_curr_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1"),
  params_lcs_consc_ideal_hyp4 %>% filter(term=="d_consc_1 ~~ sb06_01_t1"),
  params_lcs_consc_curr_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_consc_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_neuro_curr_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1"),
  params_lcs_neuro_ideal_hyp4 %>% filter(term=="d_neuro_1 ~~ sb06_01_t1"),
  params_lcs_neuro_curr_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_neuro_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_openn_curr_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1"),
  params_lcs_openn_ideal_hyp4 %>% filter(term=="d_openn_1 ~~ sb06_01_t1"),
  params_lcs_openn_curr_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1"),
  params_lcs_openn_ideal_specif_hyp4 %>% filter(term=="goals ~~ d_openn_1"),
  #facets
  params_lcs_socia_curr_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1"),
  params_lcs_socia_ideal_hyp4 %>% filter(term=="d_socia_1 ~~ sb06_01_t1"),
  params_lcs_socia_curr_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1"),
  params_lcs_socia_ideal_specif_hyp4 %>% filter(term=="d_socia_1 ~~ sb07_01_t1"),
  params_lcs_asser_curr_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1"),
  params_lcs_asser_ideal_hyp4 %>% filter(term=="d_asser_1 ~~ sb06_01_t1"),
  params_lcs_asser_curr_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1"),
  params_lcs_asser_ideal_specif_hyp4 %>% filter(term=="d_asser_1 ~~ sb07_02_t1"),
  params_lcs_energ_curr_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1"),
  params_lcs_energ_ideal_hyp4 %>% filter(term=="d_energ_1 ~~ sb06_01_t1"),
  params_lcs_energ_curr_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1"),
  params_lcs_energ_ideal_specif_hyp4 %>% filter(term=="d_energ_1 ~~ sb07_03_t1"),
  params_lcs_compa_curr_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1"),
  params_lcs_compa_ideal_hyp4 %>% filter(term=="d_compa_1 ~~ sb06_01_t1"),
  params_lcs_compa_curr_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1"),
  params_lcs_compa_ideal_specif_hyp4 %>% filter(term=="d_compa_1 ~~ sb07_04_t1"),
  params_lcs_respe_curr_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1"),
  params_lcs_respe_ideal_hyp4 %>% filter(term=="d_respe_1 ~~ sb06_01_t1"),
  params_lcs_respe_curr_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1"),
  params_lcs_respe_ideal_specif_hyp4 %>% filter(term=="d_respe_1 ~~ sb07_05_t1"),
  params_lcs_trust_curr_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1"),
  params_lcs_trust_ideal_hyp4 %>% filter(term=="d_trust_1 ~~ sb06_01_t1"),
  params_lcs_trust_curr_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1"),
  params_lcs_trust_ideal_specif_hyp4 %>% filter(term=="d_trust_1 ~~ sb07_06_t1"),
  params_lcs_organ_curr_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1"),
  params_lcs_organ_ideal_hyp4 %>% filter(term=="d_organ_1 ~~ sb06_01_t1"),
  params_lcs_organ_curr_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1"),
  params_lcs_organ_ideal_specif_hyp4 %>% filter(term=="d_organ_1 ~~ sb07_07_t1"),
  params_lcs_produ_curr_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1"),
  params_lcs_produ_ideal_hyp4 %>% filter(term=="d_produ_1 ~~ sb06_01_t1"),
  params_lcs_produ_curr_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1"),
  params_lcs_produ_ideal_specif_hyp4 %>% filter(term=="d_produ_1 ~~ sb07_08_t1"),
  params_lcs_respo_curr_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1"),
  params_lcs_respo_ideal_hyp4 %>% filter(term=="d_respo_1 ~~ sb06_01_t1"),
  params_lcs_respo_curr_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1"),
  params_lcs_respo_ideal_specif_hyp4 %>% filter(term=="d_respo_1 ~~ sb07_09_t1"),
  params_lcs_anxie_curr_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1"),
  params_lcs_anxie_ideal_hyp4 %>% filter(term=="d_anxie_1 ~~ sb06_01_t1"),
  params_lcs_anxie_curr_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1"),
  params_lcs_anxie_ideal_specif_hyp4 %>% filter(term=="d_anxie_1 ~~ sb07_10_t1"),
  params_lcs_depre_curr_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1"),
  params_lcs_depre_ideal_hyp4 %>% filter(term=="d_depre_1 ~~ sb06_01_t1"),
  params_lcs_depre_curr_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1"),
  params_lcs_depre_ideal_specif_hyp4 %>% filter(term=="d_depre_1 ~~ sb07_11_t1"),
  params_lcs_volat_curr_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1"),
  params_lcs_volat_ideal_hyp4 %>% filter(term=="d_volat_1 ~~ sb06_01_t1"),
  params_lcs_volat_curr_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1"),
  params_lcs_volat_ideal_specif_hyp4 %>% filter(term=="d_volat_1 ~~ sb07_12_t1"),
  params_lcs_curio_curr_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1"),
  params_lcs_curio_ideal_hyp4 %>% filter(term=="d_curio_1 ~~ sb06_01_t1"),
  params_lcs_curio_curr_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1"),
  params_lcs_curio_ideal_specif_hyp4 %>% filter(term=="d_curio_1 ~~ sb07_13_t1"),
  params_lcs_aesth_curr_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1"),
  params_lcs_aesth_ideal_hyp4 %>% filter(term=="d_aesth_1 ~~ sb06_01_t1"),
  params_lcs_aesth_curr_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1"),
  params_lcs_aesth_ideal_specif_hyp4 %>% filter(term=="d_aesth_1 ~~ sb07_14_t1"),
  params_lcs_imagi_curr_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1"),
  params_lcs_imagi_ideal_hyp4 %>% filter(term=="d_imagi_1 ~~ sb06_01_t1"),
  params_lcs_imagi_curr_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1"),
  params_lcs_imagi_ideal_specif_hyp4 %>% filter(term=="d_imagi_1 ~~ sb07_15_t1"),
) %>% 
  mutate(trait = rep(names(b5_vars), each=4),
         ref = rep(rep(c("current", "ideal"), 2), 20),
         goal = rep(c(rep("general", 2), rep("specific", 2)), 20)) %>% 
  select(trait, ref, goal, estimate, conf.low, conf.high, std.all, statistic, p.value)

df_table_hyp4_plot <- df_table_hyp4_plot %>% 
  mutate(include_0 = ifelse(conf.low < 0 & conf.high > 0, "n.s.", "*")) %>% 
  mutate(ref = factor(ref, levels = c("current", "ideal"), labels = c("current", "ideal"))) %>% 
  mutate(goal = factor(goal, levels = c("general", "specific"), labels = c("general", "specific"))) %>% 
  mutate(trait = factor(trait, levels = names(b5_vars), labels = names(b5_vars)))
```

Plotting the effect size across all analyses:  

- *current* = current-level personality  
- *ideal* = ideal-level personality  
- *general* = general change goal  
- *specific* = specific, facet-level change goal(s)  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 9.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_table_hyp4_plot, aes(x = fct_rev(trait), y = estimate, color = include_0)) +
  geom_hline(yintercept=0, linetype = 3) +
  geom_point(size=3, position=position_dodge(0.4)) + 
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = include_0), width=.2, position=position_dodge(0.4)) +
  scale_color_manual(values = c("#000000","#A9A9A9")) +   
  facet_wrap( ~ ref + goal, ncol = 2) +
  theme_bw() +
  scale_shape_manual(values=c(18)) + 
  ylab("Effect Estimates (99.9% / 95% CI)") +
  xlab("") +
  theme(legend.title=element_blank()) +
  theme(legend.text=element_text(size=12)) +
  coord_flip() +
  theme(strip.text.x = element_text(size = 12)) +
  theme(axis.text.x=element_text(size=10, angle = 45, hjust = 1), axis.text.y=element_text(size=12)) + 
  guides(color="none")
```

### H5: Acceptance goals and change in personality (current / ideal) in self-acceptance group {#hyp5}

Not specifically preregistered for study 2 because we were foremost interested in the moderation hypothesis (H7 in prereg / H3 in paper) and thought that it was somewhat redundant with these models of correlations with the change score. I still ran the models for study 2 here (without the control group and for changes between T1 and T2) in case the comparison with study 1 is of interest.  

*In the self-acceptance group, there will be a correlation between acceptance goals and change in ideal-personality ratings but not change in current-personality ratings.* 

We will test this one domain/facet at a time. We will use both general continuous change goal score as well as trait-specific change goals. To test this hypothesis, we will estimate the mean-level difference across time for both current and ideal trait ratings using latent change models and correlate change goals with the change variable from those models.

Reshape and split data set by intervention group:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false

# from T1 to T2
df_sbsa2_wide_pers_sa <- df_sbsa2 %>% 
  filter(rando=="Self-Acceptance" & time %in% c(1,2)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sa07")), # facet-specific change goals
         sa06_01) %>% # general change goal
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with("sa07"), sa06_01)) %>% 
  select(-c(sa07_01_t2, sa07_02_t2, sa07_03_t2, sa07_04_t2, sa07_05_t2, 
            sa07_06_t2, sa07_07_t2, sa07_08_t2, sa07_09_t2, sa07_10_t2, 
            sa07_11_t2, sa07_12_t2, sa07_13_t2, sa07_14_t2, sa07_15_t2, sa06_01_t2))
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sa <- df_sbsa2_wide_pers_sa %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sa)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sa)

group_assign <- df_sbsa2 %>% select(pid, rando) %>% unique()

df_sbsa2_wide_pers_sa <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% filter(rando=="Self-Acceptance") %>% select(-rando, -ends_with("_t3")) %>%
  left_join(df_sbsa2_wide_pers_sa)

# follow-up, from T2 to T3 (for later)
df_sbsa2_wide_pers_sa_fu <- df_sbsa2 %>% 
  filter(rando=="Self-Acceptance" & time %in% c(2,3)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sa07")), # facet-specific change goals
         sa06_01) %>% # general change goal
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with("sa07"), sa06_01)) %>% 
  select(-c(sa07_01_t2, sa07_02_t2, sa07_03_t2, sa07_04_t2, sa07_05_t2, 
            sa07_06_t2, sa07_07_t2, sa07_08_t2, sa07_09_t2, sa07_10_t2, 
            sa07_11_t2, sa07_12_t2, sa07_13_t2, sa07_14_t2, sa07_15_t2, sa06_01_t2))
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sa_fu <- df_sbsa2_wide_pers_sa_fu %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sa_fu)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sa)

df_sbsa2_wide_pers_sa_fu <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% filter(rando=="Self-Acceptance" & !is.na(valid_t2)) %>% select(-rando, -ends_with("_t1")) %>%
  left_join(df_sbsa2_wide_pers_sa_fu)
```

#### Big Five traits

##### Extraversion - current-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_curr_hyp5 <- '
extra_t1 =~ 1*extra_curr_par1_t1 + lamb2*extra_curr_par2_t1 + lamb3*extra_curr_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_curr_par1_t2 + lamb2*extra_curr_par2_t2 + lamb3*extra_curr_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

extra_curr_par1_t1 ~~ extra_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_curr_par2_t1 ~~ extra_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_curr_par3_t1 ~~ extra_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_curr_par1_t1 ~~ res1*extra_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_curr_par2_t1 ~~ res2*extra_curr_par2_t1   # This allows residual variance on indicator X2 at T1
extra_curr_par3_t1 ~~ res3*extra_curr_par3_t1   # This allows residual variance on indicator X3 at T1

extra_curr_par1_t2 ~~ res1*extra_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_curr_par2_t2 ~~ res2*extra_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_curr_par3_t2 ~~ res3*extra_curr_par3_t2  # This allows residual variance on indicator X3 at T2

extra_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_extra_curr_hyp5 <- lavaan(mi_lcs_extra_curr_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_curr_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_hyp5 <- broom::tidy(fit_mi_lcs_extra_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                     "d_extra_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                     "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of general acceptance goal with the extraversion change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_curr_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_curr_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Extraversion - ideal-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_ideal_hyp5 <- '
extra_t1 =~ 1*extra_ideal_par1_t1 + lamb2*extra_ideal_par2_t1 + lamb3*extra_ideal_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_ideal_par1_t2 + lamb2*extra_ideal_par2_t2 + lamb3*extra_ideal_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

extra_ideal_par1_t1 ~~ extra_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_ideal_par2_t1 ~~ extra_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_ideal_par3_t1 ~~ extra_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_ideal_par1_t1 ~~ res1*extra_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_ideal_par2_t1 ~~ res2*extra_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
extra_ideal_par3_t1 ~~ res3*extra_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

extra_ideal_par1_t2 ~~ res1*extra_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_ideal_par2_t2 ~~ res2*extra_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_ideal_par3_t2 ~~ res3*extra_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

extra_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_extra_ideal_hyp5 <- lavaan(mi_lcs_extra_ideal_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_ideal_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_hyp5 <- broom::tidy(fit_mi_lcs_extra_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with extraversion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_ideal_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_ideal_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Extraversion - current-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_curr_specif_hyp5 <- '
extra_t1 =~ 1*extra_curr_par1_t1 + lamb2*extra_curr_par2_t1 + lamb3*extra_curr_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_curr_par1_t2 + lamb2*extra_curr_par2_t2 + lamb3*extra_curr_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

goals =~ 1*sa07_01_t1 + sa07_02_t1 + sa07_03_t1 # latent acceptance goal variable (three facets per trait)

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

extra_curr_par1_t1 ~~ extra_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_curr_par2_t1 ~~ extra_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_curr_par3_t1 ~~ extra_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_curr_par1_t1 ~~ res1*extra_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_curr_par2_t1 ~~ res2*extra_curr_par2_t1   # This allows residual variance on indicator X2 at T1
extra_curr_par3_t1 ~~ res3*extra_curr_par3_t1   # This allows residual variance on indicator X3 at T1

extra_curr_par1_t2 ~~ res1*extra_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_curr_par2_t2 ~~ res2*extra_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_curr_par3_t2 ~~ res3*extra_curr_par3_t2  # This allows residual variance on indicator X3 at T2

extra_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_01_t1 ~~ sa07_01_t1
sa07_02_t1 ~~ sa07_02_t1
sa07_03_t1 ~~ sa07_03_t1

sa07_01_t1 ~ 1
sa07_02_t1 ~ 1
sa07_03_t1 ~ 1
'
fit_mi_lcs_extra_curr_specif_hyp5 <- lavaan(mi_lcs_extra_curr_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_curr_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_extra_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "goals ~~ d_extra_1", "goals ~~ goals", # acceptance goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with extraversion change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_curr_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_curr_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1") %>% pull(p.value), 3)`. 
:::

##### Extraversion - ideal-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_extra_ideal_specif_hyp5 <- '
extra_t1 =~ 1*extra_ideal_par1_t1 + lamb2*extra_ideal_par2_t1 + lamb3*extra_ideal_par3_t1 # This specifies the measurement model for extra_t1 
extra_t2 =~ 1*extra_ideal_par1_t2 + lamb2*extra_ideal_par2_t2 + lamb3*extra_ideal_par3_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

goals =~ 1*sa07_01_t1 + sa07_02_t1 + sa07_03_t1 # latent acceptance goal variable (three facets per trait)

extra_t2 ~ 1*extra_t1     # This parameter regresses extra_t2 perfectly on extra_t1
d_extra_1 =~ 1*extra_t2   # This defines the latent change score factor as measured perfectly by scores on extra_t2
extra_t2 ~ 0*1            # This line constrains the intercept of extra_t2 to 0
extra_t2 ~~ 0*extra_t2    # This fixes the variance of extra_t2 to 0

d_extra_1 ~ 1              # This estimates the intercept of the change score 
extra_t1 ~ 1               # This estimates the intercept of extra_t1 
d_extra_1 ~~ d_extra_1     # This estimates the variance of the change scores 
extra_t1 ~~ extra_t1       # This estimates the variance of the extra_t1 
extra_t1 ~~ d_extra_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_extra_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

extra_ideal_par1_t1 ~~ extra_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
extra_ideal_par2_t1 ~~ extra_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
extra_ideal_par3_t1 ~~ extra_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

extra_ideal_par1_t1 ~~ res1*extra_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
extra_ideal_par2_t1 ~~ res2*extra_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
extra_ideal_par3_t1 ~~ res3*extra_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

extra_ideal_par1_t2 ~~ res1*extra_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
extra_ideal_par2_t2 ~~ res2*extra_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
extra_ideal_par3_t2 ~~ res3*extra_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

extra_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
extra_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
extra_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

extra_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
extra_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
extra_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_01_t1 ~~ sa07_01_t1
sa07_02_t1 ~~ sa07_02_t1
sa07_03_t1 ~~ sa07_03_t1

sa07_01_t1 ~ 1
sa07_02_t1 ~ 1
sa07_03_t1 ~ 1
'
fit_mi_lcs_extra_ideal_specif_hyp5 <- lavaan(mi_lcs_extra_ideal_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_extra_ideal_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "goals ~~ d_extra_1", "goals ~~ goals", # acceptance goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with extraversion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_extra_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_extra_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - current-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_curr_hyp5 <- '
agree_t1 =~ 1*agree_curr_par1_t1 + lamb2*agree_curr_par2_t1 + lamb3*agree_curr_par3_t1 # This specifies the measurement model for agree_t1
agree_t2 =~ 1*agree_curr_par1_t2 + lamb2*agree_curr_par2_t2 + lamb3*agree_curr_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

agree_curr_par1_t1 ~~ agree_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_curr_par2_t1 ~~ agree_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_curr_par3_t1 ~~ agree_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_curr_par1_t1 ~~ res1*agree_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_curr_par2_t1 ~~ res2*agree_curr_par2_t1   # This allows residual variance on indicator X2 at T1
agree_curr_par3_t1 ~~ res3*agree_curr_par3_t1   # This allows residual variance on indicator X3 at T1

agree_curr_par1_t2 ~~ res1*agree_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_curr_par2_t2 ~~ res2*agree_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_curr_par3_t2 ~~ res3*agree_curr_par3_t2  # This allows residual variance on indicator X3 at T2

agree_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_agree_curr_hyp5 <- lavaan(mi_lcs_agree_curr_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_curr_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_hyp5 <- broom::tidy(fit_mi_lcs_agree_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                     "d_agree_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                     "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with agreeableness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_agree_curr_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_curr_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - ideal-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_ideal_hyp5 <- '
agree_t1 =~ 1*agree_ideal_par1_t1 + lamb2*agree_ideal_par2_t1 + lamb3*agree_ideal_par3_t1 # This specifies the measurement model for agree_t1 
agree_t2 =~ 1*agree_ideal_par1_t2 + lamb2*agree_ideal_par2_t2 + lamb3*agree_ideal_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

agree_ideal_par1_t1 ~~ agree_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_ideal_par2_t1 ~~ agree_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_ideal_par3_t1 ~~ agree_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_ideal_par1_t1 ~~ res1*agree_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_ideal_par2_t1 ~~ res2*agree_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
agree_ideal_par3_t1 ~~ res3*agree_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

agree_ideal_par1_t2 ~~ res1*agree_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_ideal_par2_t2 ~~ res2*agree_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_ideal_par3_t2 ~~ res3*agree_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

agree_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_agree_ideal_hyp5 <- lavaan(mi_lcs_agree_ideal_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_ideal_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_hyp5 <- broom::tidy(fit_mi_lcs_agree_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with agreeableness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_agree_ideal_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_ideal_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - current-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_curr_specif_hyp5 <- '
agree_t1 =~ 1*agree_curr_par1_t1 + lamb2*agree_curr_par2_t1 + lamb3*agree_curr_par3_t1 # This specifies the measurement model for agree_t1
agree_t2 =~ 1*agree_curr_par1_t2 + lamb2*agree_curr_par2_t2 + lamb3*agree_curr_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

goals =~ 1*sa07_04_t1 + sa07_05_t1 + sa07_06_t1 # latent acceptance goal variable (three facets per trait)

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

agree_curr_par1_t1 ~~ agree_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_curr_par2_t1 ~~ agree_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_curr_par3_t1 ~~ agree_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_curr_par1_t1 ~~ res1*agree_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_curr_par2_t1 ~~ res2*agree_curr_par2_t1   # This allows residual variance on indicator X2 at T1
agree_curr_par3_t1 ~~ res3*agree_curr_par3_t1   # This allows residual variance on indicator X3 at T1

agree_curr_par1_t2 ~~ res1*agree_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_curr_par2_t2 ~~ res2*agree_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_curr_par3_t2 ~~ res3*agree_curr_par3_t2  # This allows residual variance on indicator X3 at T2

agree_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_04_t1 ~~ sa07_04_t1
sa07_05_t1 ~~ sa07_05_t1
sa07_06_t1 ~~ sa07_06_t1

sa07_04_t1 ~ 1
sa07_05_t1 ~ 1
sa07_06_t1 ~ 1
'
fit_mi_lcs_agree_curr_specif_hyp5 <- lavaan(mi_lcs_agree_curr_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_curr_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_agree_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "goals ~~ d_agree_1", "goals ~~ goals", # acceptance goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with agreeableness change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_agree_curr_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_curr_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1") %>% pull(p.value), 3)`. 
:::

##### Agreeableness - ideal-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_agree_ideal_specif_hyp5 <- '
agree_t1 =~ 1*agree_ideal_par1_t1 + lamb2*agree_ideal_par2_t1 + lamb3*agree_ideal_par3_t1 # This specifies the measurement model for agree_t1 
agree_t2 =~ 1*agree_ideal_par1_t2 + lamb2*agree_ideal_par2_t2 + lamb3*agree_ideal_par3_t2 # This specifies the measurement model for agree_t2 with the equality constrained factor loadings

goals =~ 1*sa07_04_t1 + sa07_05_t1 + sa07_06_t1 # latent acceptance goal variable (three facets per trait)

agree_t2 ~ 1*agree_t1     # This parameter regresses agree_t2 perfectly on agree_t1
d_agree_1 =~ 1*agree_t2   # This defines the latent change score factor as measured perfectly by scores on agree_t2
agree_t2 ~ 0*1            # This line constrains the intercept of agree_t2 to 0
agree_t2 ~~ 0*agree_t2    # This fixes the variance of agree_t2 to 0

d_agree_1 ~ 1              # This estimates the intercept of the change score 
agree_t1 ~ 1               # This estimates the intercept of agree_t1 
d_agree_1 ~~ d_agree_1     # This estimates the variance of the change scores 
agree_t1 ~~ agree_t1       # This estimates the variance of the agree_t1 
agree_t1 ~~ d_agree_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_agree_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

agree_ideal_par1_t1 ~~ agree_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
agree_ideal_par2_t1 ~~ agree_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
agree_ideal_par3_t1 ~~ agree_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

agree_ideal_par1_t1 ~~ res1*agree_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
agree_ideal_par2_t1 ~~ res2*agree_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
agree_ideal_par3_t1 ~~ res3*agree_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

agree_ideal_par1_t2 ~~ res1*agree_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
agree_ideal_par2_t2 ~~ res2*agree_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
agree_ideal_par3_t2 ~~ res3*agree_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

agree_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
agree_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
agree_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

agree_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
agree_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
agree_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_04_t1 ~~ sa07_04_t1
sa07_05_t1 ~~ sa07_05_t1
sa07_06_t1 ~~ sa07_06_t1

sa07_04_t1 ~ 1
sa07_05_t1 ~ 1
sa07_06_t1 ~ 1
'
fit_mi_lcs_agree_ideal_specif_hyp5 <- lavaan(mi_lcs_agree_ideal_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_agree_ideal_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "goals ~~ d_agree_1", "goals ~~ goals", # acceptance goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with agreeableness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_agree_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_agree_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - current-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_curr_hyp5 <- '
consc_t1 =~ 1*consc_curr_par1_t1 + lamb2*consc_curr_par2_t1 + lamb3*consc_curr_par3_t1 # This specifies the measurement model for consc_t1 
consc_t2 =~ 1*consc_curr_par1_t2 + lamb2*consc_curr_par2_t2 + lamb3*consc_curr_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

consc_curr_par1_t1 ~~ consc_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_curr_par2_t1 ~~ consc_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_curr_par3_t1 ~~ consc_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_curr_par1_t1 ~~ res1*consc_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_curr_par2_t1 ~~ res2*consc_curr_par2_t1   # This allows residual variance on indicator X2 at T1
consc_curr_par3_t1 ~~ res3*consc_curr_par3_t1   # This allows residual variance on indicator X3 at T1

consc_curr_par1_t2 ~~ res1*consc_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_curr_par2_t2 ~~ res2*consc_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_curr_par3_t2 ~~ res3*consc_curr_par3_t2  # This allows residual variance on indicator X3 at T2

consc_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_consc_curr_hyp5 <- lavaan(mi_lcs_consc_curr_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_curr_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_hyp5 <- broom::tidy(fit_mi_lcs_consc_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                     "d_consc_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                     "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with conscientiousness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_consc_curr_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_curr_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - ideal-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_ideal_hyp5 <- '
consc_t1 =~ 1*consc_ideal_par1_t1 + lamb2*consc_ideal_par2_t1 + lamb3*consc_ideal_par3_t1 # This specifies the measurement model for consc_t1
consc_t2 =~ 1*consc_ideal_par1_t2 + lamb2*consc_ideal_par2_t2 + lamb3*consc_ideal_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

consc_ideal_par1_t1 ~~ consc_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_ideal_par2_t1 ~~ consc_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_ideal_par3_t1 ~~ consc_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_ideal_par1_t1 ~~ res1*consc_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_ideal_par2_t1 ~~ res2*consc_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
consc_ideal_par3_t1 ~~ res3*consc_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

consc_ideal_par1_t2 ~~ res1*consc_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_ideal_par2_t2 ~~ res2*consc_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_ideal_par3_t2 ~~ res3*consc_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

consc_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_consc_ideal_hyp5 <- lavaan(mi_lcs_consc_ideal_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_ideal_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_hyp5 <- broom::tidy(fit_mi_lcs_consc_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with conscientiousness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_consc_ideal_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_ideal_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - current-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_curr_specif_hyp5 <- '
consc_t1 =~ 1*consc_curr_par1_t1 + lamb2*consc_curr_par2_t1 + lamb3*consc_curr_par3_t1 # This specifies the measurement model for consc_t1 
consc_t2 =~ 1*consc_curr_par1_t2 + lamb2*consc_curr_par2_t2 + lamb3*consc_curr_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

goals =~ 1*sa07_07_t1 + sa07_08_t1 + sa07_09_t1 # latent acceptance goal variable (three facets per trait)

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

consc_curr_par1_t1 ~~ consc_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_curr_par2_t1 ~~ consc_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_curr_par3_t1 ~~ consc_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_curr_par1_t1 ~~ res1*consc_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_curr_par2_t1 ~~ res2*consc_curr_par2_t1   # This allows residual variance on indicator X2 at T1
consc_curr_par3_t1 ~~ res3*consc_curr_par3_t1   # This allows residual variance on indicator X3 at T1

consc_curr_par1_t2 ~~ res1*consc_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_curr_par2_t2 ~~ res2*consc_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_curr_par3_t2 ~~ res3*consc_curr_par3_t2  # This allows residual variance on indicator X3 at T2

consc_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_07_t1 ~~ sa07_07_t1
sa07_08_t1 ~~ sa07_08_t1
sa07_09_t1 ~~ sa07_09_t1

sa07_07_t1 ~ 1
sa07_08_t1 ~ 1
sa07_09_t1 ~ 1
'
fit_mi_lcs_consc_curr_specif_hyp5 <- lavaan(mi_lcs_consc_curr_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_curr_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_consc_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "goals ~~ d_consc_1", "goals ~~ goals", # acceptance goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level acceptance goals with the conscientiousness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_consc_curr_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_curr_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness - ideal-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_consc_ideal_specif_hyp5 <- '
consc_t1 =~ 1*consc_ideal_par1_t1 + lamb2*consc_ideal_par2_t1 + lamb3*consc_ideal_par3_t1 # This specifies the measurement model for consc_t1
consc_t2 =~ 1*consc_ideal_par1_t2 + lamb2*consc_ideal_par2_t2 + lamb3*consc_ideal_par3_t2 # This specifies the measurement model for consc_t2 with the equality constrained factor loadings

goals =~ 1*sa07_07_t1 + sa07_08_t1 + sa07_09_t1 # latent acceptance goal variable (three facets per trait)

consc_t2 ~ 1*consc_t1     # This parameter regresses consc_t2 perfectly on consc_t1
d_consc_1 =~ 1*consc_t2   # This defines the latent change score factor as measured perfectly by scores on consc_t2
consc_t2 ~ 0*1            # This line constrains the intercept of consc_t2 to 0
consc_t2 ~~ 0*consc_t2    # This fixes the variance of consc_t2 to 0

d_consc_1 ~ 1              # This estimates the intercept of the change score 
consc_t1 ~ 1               # This estimates the intercept of consc_t1 
d_consc_1 ~~ d_consc_1     # This estimates the variance of the change scores 
consc_t1 ~~ consc_t1       # This estimates the variance of the consc_t1 
consc_t1 ~~ d_consc_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_consc_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

consc_ideal_par1_t1 ~~ consc_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
consc_ideal_par2_t1 ~~ consc_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
consc_ideal_par3_t1 ~~ consc_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

consc_ideal_par1_t1 ~~ res1*consc_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
consc_ideal_par2_t1 ~~ res2*consc_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
consc_ideal_par3_t1 ~~ res3*consc_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

consc_ideal_par1_t2 ~~ res1*consc_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
consc_ideal_par2_t2 ~~ res2*consc_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
consc_ideal_par3_t2 ~~ res3*consc_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

consc_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
consc_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
consc_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

consc_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
consc_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
consc_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_07_t1 ~~ sa07_07_t1
sa07_08_t1 ~~ sa07_08_t1
sa07_09_t1 ~~ sa07_09_t1

sa07_07_t1 ~ 1
sa07_08_t1 ~ 1
sa07_09_t1 ~ 1
'
fit_mi_lcs_consc_ideal_specif_hyp5 <- lavaan(mi_lcs_consc_ideal_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_consc_ideal_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "goals ~~ d_consc_1", "goals ~~ goals", # acceptance goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level acceptance goals with the conscientiousness change score (ideal-personality) is (barely) significantly different from zero, *r* = `r round(params_lcs_consc_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_consc_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - current-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_curr_hyp5 <- '
neuro_t1 =~ 1*neuro_curr_par1_t1 + lamb2*neuro_curr_par2_t1 + lamb3*neuro_curr_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_curr_par1_t2 + lamb2*neuro_curr_par2_t2 + lamb3*neuro_curr_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

neuro_curr_par1_t1 ~~ neuro_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_curr_par2_t1 ~~ neuro_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_curr_par3_t1 ~~ neuro_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_curr_par1_t1 ~~ res1*neuro_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_curr_par2_t1 ~~ res2*neuro_curr_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_curr_par3_t1 ~~ res3*neuro_curr_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_curr_par1_t2 ~~ res1*neuro_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_curr_par2_t2 ~~ res2*neuro_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_curr_par3_t2 ~~ res3*neuro_curr_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_neuro_curr_hyp5 <- lavaan(mi_lcs_neuro_curr_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_curr_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_hyp5 <- broom::tidy(fit_mi_lcs_neuro_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                     "d_neuro_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                     "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with neuroticism change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_neuro_curr_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_curr_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - ideal-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_ideal_hyp5 <- '
neuro_t1 =~ 1*neuro_ideal_par1_t1 + lamb2*neuro_ideal_par2_t1 + lamb3*neuro_ideal_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_ideal_par1_t2 + lamb2*neuro_ideal_par2_t2 + lamb3*neuro_ideal_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

neuro_ideal_par1_t1 ~~ neuro_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_ideal_par2_t1 ~~ neuro_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_ideal_par3_t1 ~~ neuro_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_ideal_par1_t1 ~~ res1*neuro_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_ideal_par2_t1 ~~ res2*neuro_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_ideal_par3_t1 ~~ res3*neuro_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_ideal_par1_t2 ~~ res1*neuro_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_ideal_par2_t2 ~~ res2*neuro_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_ideal_par3_t2 ~~ res3*neuro_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_neuro_ideal_hyp5 <- lavaan(mi_lcs_neuro_ideal_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_ideal_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_hyp5 <- broom::tidy(fit_mi_lcs_neuro_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with neuroticism change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_neuro_ideal_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_ideal_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - current-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_curr_specif_hyp5 <- '
neuro_t1 =~ 1*neuro_curr_par1_t1 + lamb2*neuro_curr_par2_t1 + lamb3*neuro_curr_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_curr_par1_t2 + lamb2*neuro_curr_par2_t2 + lamb3*neuro_curr_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

goals =~ 1*sa07_10_t1 + sa07_11_t1 + sa07_12_t1 # latent acceptance goal variable (three facets per trait)

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

neuro_curr_par1_t1 ~~ neuro_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_curr_par2_t1 ~~ neuro_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_curr_par3_t1 ~~ neuro_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_curr_par1_t1 ~~ res1*neuro_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_curr_par2_t1 ~~ res2*neuro_curr_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_curr_par3_t1 ~~ res3*neuro_curr_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_curr_par1_t2 ~~ res1*neuro_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_curr_par2_t2 ~~ res2*neuro_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_curr_par3_t2 ~~ res3*neuro_curr_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_10_t1 ~~ sa07_10_t1
sa07_11_t1 ~~ sa07_11_t1
sa07_12_t1 ~~ sa07_12_t1

sa07_10_t1 ~ 1
sa07_11_t1 ~ 1
sa07_12_t1 ~ 1
'
fit_mi_lcs_neuro_curr_specif_hyp5 <- lavaan(mi_lcs_neuro_curr_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_curr_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "goals ~~ d_neuro_1", "goals ~~ goals", # acceptance goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with neuroticism change score (current-personality) is (barely) significantly different from zero, *r* = `r round(params_lcs_neuro_curr_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_curr_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(p.value), 3)`. 
:::

##### Neuroticism - ideal-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_neuro_ideal_specif_hyp5 <- '
neuro_t1 =~ 1*neuro_ideal_par1_t1 + lamb2*neuro_ideal_par2_t1 + lamb3*neuro_ideal_par3_t1 # This specifies the measurement model for neuro_t1 
neuro_t2 =~ 1*neuro_ideal_par1_t2 + lamb2*neuro_ideal_par2_t2 + lamb3*neuro_ideal_par3_t2 # This specifies the measurement model for neuro_t2 with the equality constrained factor loadings

goals =~ 1*sa07_10_t1 + sa07_11_t1 + sa07_12_t1 # latent acceptance goal variable (three facets per trait)

neuro_t2 ~ 1*neuro_t1     # This parameter regresses neuro_t2 perfectly on neuro_t1
d_neuro_1 =~ 1*neuro_t2   # This defines the latent change score factor as measured perfectly by scores on neuro_t2
neuro_t2 ~ 0*1            # This line constrains the intercept of neuro_t2 to 0
neuro_t2 ~~ 0*neuro_t2    # This fixes the variance of neuro_t2 to 0

d_neuro_1 ~ 1              # This estimates the intercept of the change score 
neuro_t1 ~ 1               # This estimates the intercept of neuro_t1 
d_neuro_1 ~~ d_neuro_1     # This estimates the variance of the change scores 
neuro_t1 ~~ neuro_t1       # This estimates the variance of the neuro_t1 
neuro_t1 ~~ d_neuro_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_neuro_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

neuro_ideal_par1_t1 ~~ neuro_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
neuro_ideal_par2_t1 ~~ neuro_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
neuro_ideal_par3_t1 ~~ neuro_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

neuro_ideal_par1_t1 ~~ res1*neuro_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
neuro_ideal_par2_t1 ~~ res2*neuro_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
neuro_ideal_par3_t1 ~~ res3*neuro_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

neuro_ideal_par1_t2 ~~ res1*neuro_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
neuro_ideal_par2_t2 ~~ res2*neuro_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
neuro_ideal_par3_t2 ~~ res3*neuro_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

neuro_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
neuro_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
neuro_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

neuro_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
neuro_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
neuro_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_10_t1 ~~ sa07_10_t1
sa07_11_t1 ~~ sa07_11_t1
sa07_12_t1 ~~ sa07_12_t1

sa07_10_t1 ~ 1
sa07_11_t1 ~ 1
sa07_12_t1 ~ 1
'
fit_mi_lcs_neuro_ideal_specif_hyp5 <- lavaan(mi_lcs_neuro_ideal_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_neuro_ideal_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "goals ~~ d_neuro_1", "goals ~~ goals", # acceptance goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level acceptance goals with the neuroticism change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_neuro_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_neuro_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1") %>% pull(p.value), 3)`. 
:::

##### Openness - current-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_curr_hyp5 <- '
openn_t1 =~ 1*openn_curr_par1_t1 + lamb2*openn_curr_par2_t1 + lamb3*openn_curr_par3_t1 # This specifies the measurement model for openn_t1
openn_t2 =~ 1*openn_curr_par1_t2 + lamb2*openn_curr_par2_t2 + lamb3*openn_curr_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

openn_curr_par1_t1 ~~ openn_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_curr_par2_t1 ~~ openn_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_curr_par3_t1 ~~ openn_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_curr_par1_t1 ~~ res1*openn_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_curr_par2_t1 ~~ res2*openn_curr_par2_t1   # This allows residual variance on indicator X2 at T1
openn_curr_par3_t1 ~~ res3*openn_curr_par3_t1   # This allows residual variance on indicator X3 at T1

openn_curr_par1_t2 ~~ res1*openn_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_curr_par2_t2 ~~ res2*openn_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_curr_par3_t2 ~~ res3*openn_curr_par3_t2  # This allows residual variance on indicator X3 at T2

openn_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_openn_curr_hyp5 <- lavaan(mi_lcs_openn_curr_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
summary(fit_mi_lcs_openn_curr_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_hyp5 <- broom::tidy(fit_mi_lcs_openn_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                     "d_openn_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                     "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with openness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_openn_curr_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_curr_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Openness - ideal-personality: general acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with manifest acceptance goal variable to the latent change score model:
# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_ideal_hyp5 <- '
openn_t1 =~ 1*openn_ideal_par1_t1 + lamb2*openn_ideal_par2_t1 + lamb3*openn_ideal_par3_t1 # This specifies the measurement model for openn_t1 
openn_t2 =~ 1*openn_ideal_par1_t2 + lamb2*openn_ideal_par2_t2 + lamb3*openn_ideal_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ sa06_01_t1     # estimates the covariance/correlation with acceptance goal variable

openn_ideal_par1_t1 ~~ openn_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_ideal_par2_t1 ~~ openn_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_ideal_par3_t1 ~~ openn_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_ideal_par1_t1 ~~ res1*openn_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_ideal_par2_t1 ~~ res2*openn_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
openn_ideal_par3_t1 ~~ res3*openn_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

openn_ideal_par1_t2 ~~ res1*openn_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_ideal_par2_t2 ~~ res2*openn_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_ideal_par3_t2 ~~ res3*openn_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

openn_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa06_01_t1 ~~ sa06_01_t1
sa06_01_t1 ~ 1
'
fit_mi_lcs_openn_ideal_hyp5 <- lavaan(mi_lcs_openn_ideal_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing="fiml")
summary(fit_mi_lcs_openn_ideal_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_hyp5 <- broom::tidy(fit_mi_lcs_openn_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}

Correlation of general acceptance goal with openness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_openn_ideal_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_ideal_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`.
:::

##### Openness - current-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_curr_specif_hyp5 <- '
openn_t1 =~ 1*openn_curr_par1_t1 + lamb2*openn_curr_par2_t1 + lamb3*openn_curr_par3_t1 # This specifies the measurement model for openn_t1
openn_t2 =~ 1*openn_curr_par1_t2 + lamb2*openn_curr_par2_t2 + lamb3*openn_curr_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

goals =~ 1*sa07_13_t1 + sa07_14_t1 + sa07_15_t1 # latent acceptance goal variable (three facets per trait)

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

openn_curr_par1_t1 ~~ openn_curr_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_curr_par2_t1 ~~ openn_curr_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_curr_par3_t1 ~~ openn_curr_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_curr_par1_t1 ~~ res1*openn_curr_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_curr_par2_t1 ~~ res2*openn_curr_par2_t1   # This allows residual variance on indicator X2 at T1
openn_curr_par3_t1 ~~ res3*openn_curr_par3_t1   # This allows residual variance on indicator X3 at T1

openn_curr_par1_t2 ~~ res1*openn_curr_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_curr_par2_t2 ~~ res2*openn_curr_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_curr_par3_t2 ~~ res3*openn_curr_par3_t2  # This allows residual variance on indicator X3 at T2

openn_curr_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_curr_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_curr_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_curr_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_curr_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_curr_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_13_t1 ~~ sa07_13_t1
sa07_14_t1 ~~ sa07_14_t1
sa07_15_t1 ~~ sa07_15_t1

sa07_13_t1 ~ 1
sa07_14_t1 ~ 1
sa07_15_t1 ~ 1
'
fit_mi_lcs_openn_curr_specif_hyp5 <- lavaan(mi_lcs_openn_curr_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')

summary(fit_mi_lcs_openn_curr_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_openn_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "goals ~~ d_openn_1", "goals ~~ goals", # acceptance goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with openness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_openn_curr_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_curr_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1") %>% pull(p.value), 3)`. 
:::

##### Openness - ideal-personality: specific, facet-level acceptance goals

Fit model:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adding correlation with latent (made up of the three facets) acceptance goal variable to the latent change score model:

# Fit the multiple indicator univariate latent change score model
mi_lcs_openn_ideal_specif_hyp5 <- '
openn_t1 =~ 1*openn_ideal_par1_t1 + lamb2*openn_ideal_par2_t1 + lamb3*openn_ideal_par3_t1 # This specifies the measurement model for openn_t1 
openn_t2 =~ 1*openn_ideal_par1_t2 + lamb2*openn_ideal_par2_t2 + lamb3*openn_ideal_par3_t2 # This specifies the measurement model for openn_t2 with the equality constrained factor loadings

goals =~ 1*sa07_13_t1 + sa07_14_t1 + sa07_15_t1 # latent acceptance goal variable (three facets per trait)

openn_t2 ~ 1*openn_t1     # This parameter regresses openn_t2 perfectly on openn_t1
d_openn_1 =~ 1*openn_t2   # This defines the latent change score factor as measured perfectly by scores on openn_t2
openn_t2 ~ 0*1            # This line constrains the intercept of openn_t2 to 0
openn_t2 ~~ 0*openn_t2    # This fixes the variance of openn_t2 to 0

d_openn_1 ~ 1              # This estimates the intercept of the change score 
openn_t1 ~ 1               # This estimates the intercept of openn_t1 
d_openn_1 ~~ d_openn_1     # This estimates the variance of the change scores 
openn_t1 ~~ openn_t1       # This estimates the variance of the openn_t1 
openn_t1 ~~ d_openn_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_openn_1 ~~ goals     # estimates the covariance/correlation with the (latent) acceptance goal variable
goals ~ 0*1            # This fixes the intercept of the (latent) acceptance goal variable to 0
goals ~~ goals         # This estimates the variance of the (latent) acceptance goal variable

openn_ideal_par1_t1 ~~ openn_ideal_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
openn_ideal_par2_t1 ~~ openn_ideal_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
openn_ideal_par3_t1 ~~ openn_ideal_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

openn_ideal_par1_t1 ~~ res1*openn_ideal_par1_t1   # This allows residual variance on indicator X1 at T1 
openn_ideal_par2_t1 ~~ res2*openn_ideal_par2_t1   # This allows residual variance on indicator X2 at T1
openn_ideal_par3_t1 ~~ res3*openn_ideal_par3_t1   # This allows residual variance on indicator X3 at T1

openn_ideal_par1_t2 ~~ res1*openn_ideal_par1_t2  # This allows residual variance on indicator X1 at T2 
openn_ideal_par2_t2 ~~ res2*openn_ideal_par2_t2  # This allows residual variance on indicator X2 at T2 
openn_ideal_par3_t2 ~~ res3*openn_ideal_par3_t2  # This allows residual variance on indicator X3 at T2

openn_ideal_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
openn_ideal_par2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
openn_ideal_par3_t1 ~ m3*1     # This estimates the intercept of X3 at T1

openn_ideal_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
openn_ideal_par2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
openn_ideal_par3_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa07_13_t1 ~~ sa07_13_t1
sa07_14_t1 ~~ sa07_14_t1
sa07_15_t1 ~~ sa07_15_t1

sa07_13_t1 ~ 1
sa07_14_t1 ~ 1
sa07_15_t1 ~ 1
'
fit_mi_lcs_openn_ideal_specif_hyp5 <- lavaan(mi_lcs_openn_ideal_specif_hyp5, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing = "fiml")
summary(fit_mi_lcs_openn_ideal_specif_hyp5, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "goals ~~ d_openn_1", "goals ~~ goals", # acceptance goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level acceptance goals with the openness change score (ideal-personality) is (barely) significantly different from zero, *r* = `r round(params_lcs_openn_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_openn_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1") %>% pull(p.value), 3)`.  
:::

#### Big Five facets

Run models for all facets with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create template:
facet_template <- '
facet_t1 =~ 1*ind1_t1 + lamb2*ind2_t1 + lamb3*ind3_t1 + lamb4*ind4_t1 # This specifies the measurement model for facet at T1
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2 (with equality constraints)

facet_t2 ~ 1*facet_t1     # This parameter regresses facet_t2 perfectly on facet_t1
d_facet_1 =~ 1*facet_t2   # This defines the latent change score factor as measured perfectly by scores on facet_t2
facet_t2 ~ 0*1            # This line constrains the intercept of facet_t2 to 0
facet_t2 ~~ 0*facet_t2    # This fixes the variance of facet_t2 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t1 ~ 1               # This estimates the intercept of facet_t1 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t1 ~~ facet_t1       # This estimates the variance of facet_t1 
facet_t1 ~~ d_facet_1       # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

d_facet_1 ~~ ind_goal     # estimates the covariance/correlation with acceptance goal variable

ind1_t1 ~~ ind1_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind2_t1 ~~ ind2_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind3_t1 ~~ ind3_t2   # This allows residual covariance on indicator X3 across T1 and T2
ind4_t1 ~~ ind4_t2   # This allows residual covariance on indicator X4 across T1 and T2

ind1_t1 ~~ res1*ind1_t1   # This allows residual variance on indicator X1 at T1 
ind2_t1 ~~ res2*ind2_t1   # This allows residual variance on indicator X2 at T1
ind3_t1 ~~ res3*ind3_t1   # This allows residual variance on indicator X3 at T1
ind4_t1 ~~ res4*ind4_t1   # This allows residual variance on indicator X4 at T1

ind1_t2 ~~ res1*ind1_t2  # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2  # This allows residual variance on indicator X2 at T2 
ind3_t2 ~~ res3*ind3_t2  # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2  # This allows residual variance on indicator X4 at T2

ind1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind3_t1 ~ m3*1     # This estimates the intercept of X3 at T1
ind4_t1 ~ m4*1     # This estimates the intercept of X4 at T1

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind_goal ~~ ind_goal
ind_goal ~ 1
'

# loop across 15 facets
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # loop across 2 BFI versions (combined pre&post current/ideal)
  for (j in 5:length(bfi_versions)) {
    items = paste0(bfi_versions[[j]], item_nrs)
    # loop across 2 different goal operationalizations (sa06_01_t1 & sa07_XX_t1)
    for (k in 1:2) {
      if (k==1) {
        goal_op = "sa06_01_t1"
      } else{
        goal_op = paste0("sa07_", str_pad(i-5, 2, pad = "0"), "_t1")
      }
      template_filled <- str_replace_all(facet_template, 
                                         c("facet" = short_name,
                                           "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                           "ind_goal" = goal_op))
      facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa, estimator='mlr', fixed.x=FALSE, missing='fiml')
      # save to environment
      if (k==1) {
        eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_hyp5")), template_filled))
        eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_hyp5")), facet_model_fit))
      } else{
        eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_specif_hyp5")), template_filled))
        eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                       str_sub(names(bfi_versions)[j], 6), "_specif_hyp5")), facet_model_fit))
      }
    }
  }
}  
```

##### Sociability - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_hyp5 <- broom::tidy(fit_mi_lcs_socia_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of the general acceptance goal with the sociability change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_socia_curr_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_curr_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_hyp5 <- broom::tidy(fit_mi_lcs_socia_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with sociability change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_socia_ideal_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_ideal_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_socia_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~~ sa07_01_t1", "sa07_01_t1 ~~ sa07_01_t1", # acceptance goals
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with sociability change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_socia_curr_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_curr_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~~ sa07_01_t1", "sa07_01_t1 ~~ sa07_01_t1", # acceptance goals
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with anxiety change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_socia_ideal_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_socia_ideal_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_hyp5 <- broom::tidy(fit_mi_lcs_asser_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with assertiveness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_asser_curr_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_curr_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_hyp5 <- broom::tidy(fit_mi_lcs_asser_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with assertiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_asser_ideal_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_ideal_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_asser_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~~ sa07_02_t1", "sa07_02_t1 ~~ sa07_02_t1", # acceptance goals
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with assertiveness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_asser_curr_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_curr_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~~ sa07_02_t1", "sa07_02_t1 ~~ sa07_02_t1", # acceptance goals
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with assertiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_asser_ideal_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_asser_ideal_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_hyp5 <- broom::tidy(fit_mi_lcs_energ_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with energy change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_curr_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_curr_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_hyp5 <- broom::tidy(fit_mi_lcs_energ_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with energy change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_ideal_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_ideal_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_energ_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~~ sa07_03_t1", "sa07_03_t1 ~~ sa07_03_t1", # acceptance goals
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with energy change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_curr_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_curr_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~~ sa07_03_t1", "sa07_03_t1 ~~ sa07_03_t1", # acceptance goals
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with energy change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_energ_ideal_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_energ_ideal_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_hyp5 <- broom::tidy(fit_mi_lcs_compa_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with compassion change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_compa_curr_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_curr_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_hyp5 <- broom::tidy(fit_mi_lcs_compa_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with compassion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_compa_ideal_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_ideal_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_compa_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~~ sa07_04_t1", "sa07_04_t1 ~~ sa07_04_t1", # acceptance goals
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with compassion change score (current-personality) is (barely) significantly different from zero, *r* = `r round(params_lcs_compa_curr_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_curr_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~~ sa07_04_t1", "sa07_04_t1 ~~ sa07_04_t1", # acceptance goals
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with compassion change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_compa_ideal_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_compa_ideal_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_hyp5 <- broom::tidy(fit_mi_lcs_respe_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with respectfulness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_respe_curr_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_curr_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_hyp5 <- broom::tidy(fit_mi_lcs_respe_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with respectfulness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respe_ideal_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_ideal_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_respe_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~~ sa07_05_t1", "sa07_05_t1 ~~ sa07_05_t1", # acceptance goals
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with respectfulness change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_respe_curr_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_curr_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~~ sa07_05_t1", "sa07_05_t1 ~~ sa07_05_t1", # acceptance goals
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with respectfulness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respe_ideal_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respe_ideal_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_hyp5 <- broom::tidy(fit_mi_lcs_trust_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with trust change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_curr_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_curr_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_hyp5 <- broom::tidy(fit_mi_lcs_trust_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with trust change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_ideal_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_ideal_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_trust_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~~ sa07_06_t1", "sa07_06_t1 ~~ sa07_06_t1", # acceptance goals
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with trust change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_curr_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_curr_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~~ sa07_06_t1", "sa07_06_t1 ~~ sa07_06_t1", # acceptance goals
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with trust change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_trust_ideal_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_trust_ideal_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_hyp5 <- broom::tidy(fit_mi_lcs_organ_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with organization change score (current-personality) is (barely) significantly different from zero, *r* = `r round(params_lcs_organ_curr_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_curr_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_hyp5 <- broom::tidy(fit_mi_lcs_organ_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with organization change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_organ_ideal_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_ideal_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_organ_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~~ sa07_07_t1", "sa07_07_t1 ~~ sa07_07_t1", # acceptance goals
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level acceptance goals with the organization change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_organ_curr_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_curr_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~~ sa07_07_t1", "sa07_07_t1 ~~ sa07_07_t1", # acceptance goals
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with organization change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_organ_ideal_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_organ_ideal_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_hyp5 <- broom::tidy(fit_mi_lcs_produ_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with productiveness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_produ_curr_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_curr_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_hyp5 <- broom::tidy(fit_mi_lcs_produ_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with productiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_produ_ideal_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_ideal_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_produ_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~~ sa07_08_t1", "sa07_08_t1 ~~ sa07_08_t1", # acceptance goals
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with productiveness change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_produ_curr_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_curr_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~~ sa07_08_t1", "sa07_08_t1 ~~ sa07_08_t1", # acceptance goals
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with productiveness change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_produ_ideal_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_produ_ideal_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_hyp5 <- broom::tidy(fit_mi_lcs_respo_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with responsibility change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_curr_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_curr_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_hyp5 <- broom::tidy(fit_mi_lcs_respo_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with responsibility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_ideal_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_ideal_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_respo_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~~ sa07_09_t1", "sa07_09_t1 ~~ sa07_09_t1", # acceptance goals
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level acceptance goals with the responsibility change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_curr_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_curr_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~~ sa07_09_t1", "sa07_09_t1 ~~ sa07_09_t1", # acceptance goals
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with responsibility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_respo_ideal_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_respo_ideal_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_hyp5 <- broom::tidy(fit_mi_lcs_anxie_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with anxiety change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_anxie_curr_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_curr_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_hyp5 <- broom::tidy(fit_mi_lcs_anxie_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with anxiety change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_anxie_ideal_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_ideal_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~~ sa07_10_t1", "sa07_10_t1 ~~ sa07_10_t1", # acceptance goals
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with anxiety change score (current-personality) is significantly different from zero, *r* = `r round(params_lcs_anxie_curr_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_curr_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~~ sa07_10_t1", "sa07_10_t1 ~~ sa07_10_t1", # acceptance goals
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with anxiety change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_anxie_ideal_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_anxie_ideal_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_hyp5 <- broom::tidy(fit_mi_lcs_depre_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with depression change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_depre_curr_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_curr_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_hyp5 <- broom::tidy(fit_mi_lcs_depre_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with depression change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_depre_ideal_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_ideal_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_depre_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~~ sa07_11_t1", "sa07_11_t1 ~~ sa07_11_t1", # acceptance goals
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with depression change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_depre_curr_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_curr_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~~ sa07_11_t1", "sa07_11_t1 ~~ sa07_11_t1", # acceptance goals
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with depression change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_depre_ideal_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_depre_ideal_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_hyp5 <- broom::tidy(fit_mi_lcs_volat_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with volatility change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_volat_curr_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_curr_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_hyp5 <- broom::tidy(fit_mi_lcs_volat_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of general acceptance goal with the volatility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_volat_ideal_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_ideal_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_volat_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~~ sa07_12_t1", "sa07_12_t1 ~~ sa07_12_t1", # acceptance goals
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with volatility change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_volat_curr_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_curr_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~~ sa07_12_t1", "sa07_12_t1 ~~ sa07_12_t1", # acceptance goals
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with volatility change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_volat_ideal_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_volat_ideal_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_hyp5 <- broom::tidy(fit_mi_lcs_curio_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with curiosity change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_curr_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_curr_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_hyp5 <- broom::tidy(fit_mi_lcs_curio_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with curiosity change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_ideal_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_ideal_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_curio_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~~ sa07_13_t1", "sa07_13_t1 ~~ sa07_13_t1", # acceptance goals
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The correlation of specific, facet-level acceptance goals with the curiosity change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_curr_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_curr_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~~ sa07_13_t1", "sa07_13_t1 ~~ sa07_13_t1", # acceptance goals
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with curiosity change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_curio_ideal_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_curio_ideal_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_hyp5 <- broom::tidy(fit_mi_lcs_aesth_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with aesthetic change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_aesth_curr_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_curr_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_hyp5 <- broom::tidy(fit_mi_lcs_aesth_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with aesthetic change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_aesth_ideal_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_ideal_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~~ sa07_14_t1", "sa07_14_t1 ~~ sa07_14_t1", # acceptance goals
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with aesthetic change score (current-personality) is (barely) significantly different from zero, *r* = `r round(params_lcs_aesth_curr_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_curr_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~~ sa07_14_t1", "sa07_14_t1 ~~ sa07_14_t1", # acceptance goals
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with aesthetic change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_aesth_ideal_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_aesth_ideal_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - current-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_hyp5 <- broom::tidy(fit_mi_lcs_imagi_curr_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
  filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                     "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with imagination change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_curr_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_curr_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - ideal-personality: general acceptance goals

Results summary (*sa06_01_t1* = general acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_hyp5 <- broom::tidy(fit_mi_lcs_imagi_ideal_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~~ sa06_01_t1", "sa06_01_t1 ~~ sa06_01_t1", "sa06_01_t1 ~1 ", # acceptance goals
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of general acceptance goal with imagination change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_ideal_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_ideal_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - current-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_specif_hyp5 <- broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~~ sa07_15_t1", "sa07_15_t1 ~~ sa07_15_t1", # acceptance goals
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with imagination change score (current-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_curr_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_curr_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - ideal-personality: specific, facet-level acceptance goals

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_specif_hyp5) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_specif_hyp5 <- broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp5, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, conf.low, conf.high, std.all, statistic, p.value) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~~ sa07_15_t1", "sa07_15_t1 ~~ sa07_15_t1", # acceptance goals
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_specif_hyp5, digits = 3) 
```

::: {.callout-note appearance="minimal"}
Correlation of specific, facet-level acceptance goals with imagination change score (ideal-personality) is not significantly different from zero, *r* = `r round(params_lcs_imagi_ideal_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1") %>% pull(std.all), 3)`, *p* = `r round(params_lcs_imagi_ideal_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1") %>% pull(p.value), 3)`. 
:::

#### Hyp 5: Effects summary

Run models for all facets with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create df for table:

df_table_hyp5 <- bind_rows(
  #traits
  params_lcs_extra_curr_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1"),
  params_lcs_extra_ideal_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1"),
  params_lcs_extra_curr_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_extra_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_agree_curr_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1"),
  params_lcs_agree_ideal_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1"),
  params_lcs_agree_curr_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_agree_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_consc_curr_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1"),
  params_lcs_consc_ideal_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1"),
  params_lcs_consc_curr_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_consc_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_neuro_curr_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1"),
  params_lcs_neuro_ideal_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1"),
  params_lcs_neuro_curr_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_neuro_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_openn_curr_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1"),
  params_lcs_openn_ideal_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1"),
  params_lcs_openn_curr_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1"),
  params_lcs_openn_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1"),
  #facets
  params_lcs_socia_curr_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1"),
  params_lcs_socia_ideal_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1"),
  params_lcs_socia_curr_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1"),
  params_lcs_socia_ideal_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1"),
  params_lcs_asser_curr_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1"),
  params_lcs_asser_ideal_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1"),
  params_lcs_asser_curr_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1"),
  params_lcs_asser_ideal_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1"),
  params_lcs_energ_curr_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1"),
  params_lcs_energ_ideal_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1"),
  params_lcs_energ_curr_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1"),
  params_lcs_energ_ideal_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1"),
  params_lcs_compa_curr_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1"),
  params_lcs_compa_ideal_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1"),
  params_lcs_compa_curr_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1"),
  params_lcs_compa_ideal_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1"),
  params_lcs_respe_curr_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1"),
  params_lcs_respe_ideal_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1"),
  params_lcs_respe_curr_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1"),
  params_lcs_respe_ideal_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1"),
  params_lcs_trust_curr_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1"),
  params_lcs_trust_ideal_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1"),
  params_lcs_trust_curr_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1"),
  params_lcs_trust_ideal_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1"),
  params_lcs_organ_curr_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1"),
  params_lcs_organ_ideal_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1"),
  params_lcs_organ_curr_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1"),
  params_lcs_organ_ideal_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1"),
  params_lcs_produ_curr_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1"),
  params_lcs_produ_ideal_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1"),
  params_lcs_produ_curr_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1"),
  params_lcs_produ_ideal_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1"),
  params_lcs_respo_curr_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1"),
  params_lcs_respo_ideal_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1"),
  params_lcs_respo_curr_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1"),
  params_lcs_respo_ideal_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1"),
  params_lcs_anxie_curr_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1"),
  params_lcs_anxie_ideal_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1"),
  params_lcs_anxie_curr_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1"),
  params_lcs_anxie_ideal_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1"),
  params_lcs_depre_curr_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1"),
  params_lcs_depre_ideal_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1"),
  params_lcs_depre_curr_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1"),
  params_lcs_depre_ideal_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1"),
  params_lcs_volat_curr_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1"),
  params_lcs_volat_ideal_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1"),
  params_lcs_volat_curr_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1"),
  params_lcs_volat_ideal_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1"),
  params_lcs_curio_curr_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1"),
  params_lcs_curio_ideal_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1"),
  params_lcs_curio_curr_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1"),
  params_lcs_curio_ideal_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1"),
  params_lcs_aesth_curr_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1"),
  params_lcs_aesth_ideal_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1"),
  params_lcs_aesth_curr_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1"),
  params_lcs_aesth_ideal_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1"),
  params_lcs_imagi_curr_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1"),
  params_lcs_imagi_ideal_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1"),
  params_lcs_imagi_curr_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1"),
  params_lcs_imagi_ideal_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1"),
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=4),
         ref = rep(rep(c("current", "ideal"), 2), 20),
         goal = rep(c(rep("general", 2), rep("specific", 2)), 20)) %>% 
  select(trait, ref, goal, estimate, std.all, statistic, p.value)

```

Results summary across the Big Five traits: covariance of the latent change score and acceptance goal(s)
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

kable(df_table_hyp5[1:20, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
Four covariances significantly differ from zero (at p < .05):  

- changes in current-level agreeableness covary with the specific acceptance goals (latent factor of the three A facets)
- changes in ideal-level conscientiousness covary with the specific acceptance goals (latent factor of the three C facets)  
changes in current-level neuroticism covary with the specific acceptance goals (latent factor of the three N facets)   
- changes in ideal-level openness covary with the specific acceptance goals (latent factor of the three O facets)  

-> unexpected direction of effects!  
:::

Results summary across the Big Five facets: covariance of the latent change score and acceptance goal(s)
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp5[21:80, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
Looking at the facets, we find five covariances that significantly differ from zero at p < .05 (relatively unsystematic across facets / current-ideal / goal dimension):  
- Changes in current-level compassion and respectfulness covary with the respective facet-specific acceptance goal.  
- Further, changes in current-level organization covary with the general acceptance goal and the specific facet acceptance goal.  
- Changes in current-level anxiety covary with the specific facet acceptance goal.  
:::

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_table_hyp5_plot <- bind_rows(
  #traits
  params_lcs_extra_curr_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1"),
  params_lcs_extra_ideal_hyp5 %>% filter(term=="d_extra_1 ~~ sa06_01_t1"),
  params_lcs_extra_curr_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_extra_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_extra_1"),
  params_lcs_agree_curr_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1"),
  params_lcs_agree_ideal_hyp5 %>% filter(term=="d_agree_1 ~~ sa06_01_t1"),
  params_lcs_agree_curr_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_agree_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_agree_1"),
  params_lcs_consc_curr_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1"),
  params_lcs_consc_ideal_hyp5 %>% filter(term=="d_consc_1 ~~ sa06_01_t1"),
  params_lcs_consc_curr_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_consc_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_consc_1"),
  params_lcs_neuro_curr_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1"),
  params_lcs_neuro_ideal_hyp5 %>% filter(term=="d_neuro_1 ~~ sa06_01_t1"),
  params_lcs_neuro_curr_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_neuro_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_neuro_1"),
  params_lcs_openn_curr_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1"),
  params_lcs_openn_ideal_hyp5 %>% filter(term=="d_openn_1 ~~ sa06_01_t1"),
  params_lcs_openn_curr_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1"),
  params_lcs_openn_ideal_specif_hyp5 %>% filter(term=="goals ~~ d_openn_1"),
  #facets
  params_lcs_socia_curr_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1"),
  params_lcs_socia_ideal_hyp5 %>% filter(term=="d_socia_1 ~~ sa06_01_t1"),
  params_lcs_socia_curr_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1"),
  params_lcs_socia_ideal_specif_hyp5 %>% filter(term=="d_socia_1 ~~ sa07_01_t1"),
  params_lcs_asser_curr_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1"),
  params_lcs_asser_ideal_hyp5 %>% filter(term=="d_asser_1 ~~ sa06_01_t1"),
  params_lcs_asser_curr_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1"),
  params_lcs_asser_ideal_specif_hyp5 %>% filter(term=="d_asser_1 ~~ sa07_02_t1"),
  params_lcs_energ_curr_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1"),
  params_lcs_energ_ideal_hyp5 %>% filter(term=="d_energ_1 ~~ sa06_01_t1"),
  params_lcs_energ_curr_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1"),
  params_lcs_energ_ideal_specif_hyp5 %>% filter(term=="d_energ_1 ~~ sa07_03_t1"),
  params_lcs_compa_curr_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1"),
  params_lcs_compa_ideal_hyp5 %>% filter(term=="d_compa_1 ~~ sa06_01_t1"),
  params_lcs_compa_curr_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1"),
  params_lcs_compa_ideal_specif_hyp5 %>% filter(term=="d_compa_1 ~~ sa07_04_t1"),
  params_lcs_respe_curr_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1"),
  params_lcs_respe_ideal_hyp5 %>% filter(term=="d_respe_1 ~~ sa06_01_t1"),
  params_lcs_respe_curr_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1"),
  params_lcs_respe_ideal_specif_hyp5 %>% filter(term=="d_respe_1 ~~ sa07_05_t1"),
  params_lcs_trust_curr_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1"),
  params_lcs_trust_ideal_hyp5 %>% filter(term=="d_trust_1 ~~ sa06_01_t1"),
  params_lcs_trust_curr_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1"),
  params_lcs_trust_ideal_specif_hyp5 %>% filter(term=="d_trust_1 ~~ sa07_06_t1"),
  params_lcs_organ_curr_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1"),
  params_lcs_organ_ideal_hyp5 %>% filter(term=="d_organ_1 ~~ sa06_01_t1"),
  params_lcs_organ_curr_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1"),
  params_lcs_organ_ideal_specif_hyp5 %>% filter(term=="d_organ_1 ~~ sa07_07_t1"),
  params_lcs_produ_curr_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1"),
  params_lcs_produ_ideal_hyp5 %>% filter(term=="d_produ_1 ~~ sa06_01_t1"),
  params_lcs_produ_curr_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1"),
  params_lcs_produ_ideal_specif_hyp5 %>% filter(term=="d_produ_1 ~~ sa07_08_t1"),
  params_lcs_respo_curr_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1"),
  params_lcs_respo_ideal_hyp5 %>% filter(term=="d_respo_1 ~~ sa06_01_t1"),
  params_lcs_respo_curr_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1"),
  params_lcs_respo_ideal_specif_hyp5 %>% filter(term=="d_respo_1 ~~ sa07_09_t1"),
  params_lcs_anxie_curr_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1"),
  params_lcs_anxie_ideal_hyp5 %>% filter(term=="d_anxie_1 ~~ sa06_01_t1"),
  params_lcs_anxie_curr_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1"),
  params_lcs_anxie_ideal_specif_hyp5 %>% filter(term=="d_anxie_1 ~~ sa07_10_t1"),
  params_lcs_depre_curr_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1"),
  params_lcs_depre_ideal_hyp5 %>% filter(term=="d_depre_1 ~~ sa06_01_t1"),
  params_lcs_depre_curr_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1"),
  params_lcs_depre_ideal_specif_hyp5 %>% filter(term=="d_depre_1 ~~ sa07_11_t1"),
  params_lcs_volat_curr_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1"),
  params_lcs_volat_ideal_hyp5 %>% filter(term=="d_volat_1 ~~ sa06_01_t1"),
  params_lcs_volat_curr_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1"),
  params_lcs_volat_ideal_specif_hyp5 %>% filter(term=="d_volat_1 ~~ sa07_12_t1"),
  params_lcs_curio_curr_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1"),
  params_lcs_curio_ideal_hyp5 %>% filter(term=="d_curio_1 ~~ sa06_01_t1"),
  params_lcs_curio_curr_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1"),
  params_lcs_curio_ideal_specif_hyp5 %>% filter(term=="d_curio_1 ~~ sa07_13_t1"),
  params_lcs_aesth_curr_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1"),
  params_lcs_aesth_ideal_hyp5 %>% filter(term=="d_aesth_1 ~~ sa06_01_t1"),
  params_lcs_aesth_curr_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1"),
  params_lcs_aesth_ideal_specif_hyp5 %>% filter(term=="d_aesth_1 ~~ sa07_14_t1"),
  params_lcs_imagi_curr_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1"),
  params_lcs_imagi_ideal_hyp5 %>% filter(term=="d_imagi_1 ~~ sa06_01_t1"),
  params_lcs_imagi_curr_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1"),
  params_lcs_imagi_ideal_specif_hyp5 %>% filter(term=="d_imagi_1 ~~ sa07_15_t1"),
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=4),
         ref = rep(rep(c("current", "ideal"), 2), 20),
         goal = rep(c(rep("general", 2), rep("specific", 2)), 20)) %>% 
  select(trait, ref, goal, estimate, conf.low, conf.high, std.all, statistic, p.value)

df_table_hyp5_plot <- df_table_hyp5_plot %>% 
  mutate(include_0 = ifelse(conf.low < 0 & conf.high > 0, "n.s.", "*")) %>% 
  mutate(ref = factor(ref, levels = c("current", "ideal"), labels = c("current", "ideal"))) %>% 
  mutate(goal = factor(goal, levels = c("general", "specific"), labels = c("general", "specific"))) %>% 
  mutate(trait = factor(trait, levels = names(b5_vars), labels = names(b5_vars)))
```

Plotting the effect size across all analyses:  

- *current* = current-level personality  
- *ideal* = ideal-level personality  
- *general* = general acceptance goal  
- *specific* = specific, facet-level acceptance goal(s)  

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 9.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_table_hyp5_plot, aes(x = fct_rev(trait), y = estimate, color = include_0)) +
  geom_hline(yintercept=0, linetype = 3) +
  geom_point(size=3, position=position_dodge(0.4)) + 
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high, color = include_0), width=.2, position=position_dodge(0.4)) +
  scale_color_manual(values = c("#000000","#A9A9A9")) +   
  facet_wrap( ~ ref + goal, ncol = 2) +
  theme_bw() +
  scale_shape_manual(values=c(18)) + 
  ylab("Effect Estimates (99.9% / 95% CI)") +
  xlab("") +
  theme(legend.title=element_blank()) +
  theme(legend.text=element_text(size=12)) +
  coord_flip() +
  theme(strip.text.x = element_text(size = 12)) +
  theme(axis.text.x=element_text(size=10, angle = 45, hjust = 1), axis.text.y=element_text(size=12)) + 
  guides(color="none")
```

### H6: Desire to change and frequency of self-improvement behaviors as moderators of change in personality in self-improvement group (H2 in paper) {#hyp6}

*In the self-improvement group, change in current-personality ratings but not change in ideal-personality ratings will be moderated by change goals (both general and trait-/facet-specific goals) and the frequency of self-improvement behaviors.*

We will test this one domain/facet at a time. To test this hypothesis, we will estimate the mean-level difference across time for both current and ideal trait ratings using latent change models and specify change goals (or the frequency of self-improvement behaviors) as a moderator of latent trait change. We will check in a second set of models whether changes in current-personality ratings persist from T2 to T3.  

Reshape and split data set by intervention group:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false

# from T1 to T2
df_sbsa2_wide_pers_sb_mod <- df_sbsa2 %>% 
  filter(rando=="Self-Improvement" & time %in% c(1,2)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sb07", # facet-specific change goals
                                  "sb04"))) %>% # frequency self-improvement behaviors
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with(c("sb07", "sb04")))) %>% 
  select(-c(sb07_01_t2, sb07_02_t2, sb07_03_t2, sb07_04_t2, sb07_05_t2, 
            sb07_06_t2, sb07_07_t2, sb07_08_t2, sb07_09_t2, sb07_10_t2, 
            sb07_11_t2, sb07_12_t2, sb07_13_t2, sb07_14_t2, sb07_15_t2, 
            sb04_01_t1, sb04_02_t1, sb04_03_t1)) # frequency of self-improvement behaviors measured at T2
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sb_mod <- df_sbsa2_wide_pers_sb_mod %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sb_mod)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sb_mod)

group_assign <- df_sbsa2 %>% select(pid, rando) %>% unique()

df_sbsa2_wide_pers_sb_mod <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% 
  filter(rando=="Self-Improvement") %>% select(-rando, -ends_with("_t3")) %>%
  left_join(df_sbsa2_wide_pers_sb_mod)

# follow-up, from T2 to T3
df_sbsa2_wide_pers_sb_mod_fu <- df_sbsa2 %>% 
  filter(rando=="Self-Improvement" & time %in% c(1,2)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sb07", # facet-specific change goals -> asked at T1
                                  "sb04"))) %>% # frequency self-improvement behaviors -> asked at T2
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with(c("sb07", "sb04")))) %>% 
  select(-c(sb07_01_t2, sb07_02_t2, sb07_03_t2, sb07_04_t2, sb07_05_t2, 
            sb07_06_t2, sb07_07_t2, sb07_08_t2, sb07_09_t2, sb07_10_t2, 
            sb07_11_t2, sb07_12_t2, sb07_13_t2, sb07_14_t2, sb07_15_t2, 
            sb04_01_t1, sb04_02_t1, sb04_03_t1)) # frequency of self-improvement behaviors measured at T2
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sb_mod_fu <- df_sbsa2_wide_pers_sb_mod_fu %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sb_mod_fu)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sb_mod_fu)

df_sbsa2_wide_pers_sb_mod_fu <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% 
  filter(rando=="Self-Improvement" & !is.na(valid_t2)) %>% select(-rando, -ends_with("_t1")) %>%
  left_join(df_sbsa2_wide_pers_sb_mod_fu)
```

#### Big Five traits (run models)

Run models for all traits with templates & loops:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates:

# 1st, for facet-specific change goals

trait_template_mod_goal <- '
trait_t1 =~ 1*ind01_t1 + lamb2*ind02_t1 + lamb3*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

goals =~ 1*ind_goal_1 + ind_goal_2 + ind_goal_3 # latent variable for moderator

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t1 ~ 1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ trait_t1         # This estimates the variance of trait_t1 
trait_t1 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t1 ~ goals           # This estimates the moderation effect on personality at T1
d_trait_1 ~ goals          # This estimates the moderation effect on the change score

goals ~ 0*1            # This fixes the intercept of the moderator to 0
goals ~~ goals         # This estimates the variance of the moderator

ind01_t1 ~~ ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ res1*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ res2*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ res3*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ res1*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ res2*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ res3*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ m3*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

ind_goal_1 ~~ ind_goal_1
ind_goal_2 ~~ ind_goal_2
ind_goal_3 ~~ ind_goal_3

ind_goal_1 ~ 1
ind_goal_2 ~ 1
ind_goal_3 ~ 1
'

trait_facets_nrs <- list(a1 = c(1:3), b2 = c(4:6), c3 = c(7:9), d4 = c(10:12), e5 = c(13:15)) # matching facet nrs to traits 

# loop across 5 traits -> change in current-personality ratings
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  # items = paste0(bfi_versions[[5]], item_nrs) # using parcels instead!
  mod_names = paste0("sb07_", str_pad(trait_facets_nrs[[i]], 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(trait_template_mod_goal, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3"), 
                                         "ind_goal_1" = mod_names[1], "ind_goal_2" = mod_names[2], 
                                         "ind_goal_3" = mod_names[3]))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6")), trait_model_fit))
}  

# loop across 5 traits -> change in *ideal*-self ratings (not hypothesis-conform)
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  # items = paste0(bfi_versions[[5]], item_nrs) # using parcels instead!
  mod_names = paste0("sb07_", str_pad(trait_facets_nrs[[i]], 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(trait_template_mod_goal, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), # ideal instead of current!
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3"), 
                                         "ind_goal_1" = mod_names[1], "ind_goal_2" = mod_names[2], 
                                         "ind_goal_3" = mod_names[3]))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp6")), template_filled)) # ideal instead of curr
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp6")), trait_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for current personality ratings)

trait_template_mod_goal_fu <- '
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for trait_t2 
trait_t3 =~ 1*ind01_t3 + lamb2*ind02_t3 + lamb3*ind03_t3 # This specifies the measurement model for trait_t3 with the equality constrained factor loadings

goals =~ 1*ind_goal_1 + ind_goal_2 + ind_goal_3 # latent variable for moderator

trait_t3 ~ 1*trait_t2     # This parameter regresses trait_t3 perfectly on trait_t2
d_trait_1 =~ 1*trait_t3   # This defines the latent change score factor as measured perfectly by scores on trait_t3
trait_t3 ~ 0*1            # This line constrains the intercept of trait_t3 to 0
trait_t3 ~~ 0*trait_t3    # This fixes the variance of trait_t3 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t2 ~ 1               # This estimates the intercept of trait_t2 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t2 ~~ trait_t2         # This estimates the variance of trait_t2 
trait_t2 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t2 ~ goals           # This estimates the moderation effect on personality at T2
d_trait_1 ~ goals          # This estimates the moderation effect on the change score

goals ~ 0*1            # This fixes the intercept of the moderator to 0
goals ~~ goals         # This estimates the variance of the moderator

ind01_t2 ~~ ind01_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind02_t2 ~~ ind02_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind03_t2 ~~ ind03_t3   # This allows residual covariance on indicator X3 across T2 and T3

ind01_t2 ~~ res1*ind01_t2   # This allows residual variance on indicator X1 at T2
ind02_t2 ~~ res2*ind02_t2   # This allows residual variance on indicator X2 at T2
ind03_t2 ~~ res3*ind03_t2   # This allows residual variance on indicator X3 at T2

ind01_t3 ~~ res1*ind01_t3  # This allows residual variance on indicator X1 at T3 
ind02_t3 ~~ res2*ind02_t3  # This allows residual variance on indicator X2 at T3 
ind03_t3 ~~ res3*ind03_t3  # This allows residual variance on indicator X3 at T3

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

ind01_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind02_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind03_t3 ~ m3*1     # This estimates the intercept of X3 at T3

ind_goal_1 ~~ ind_goal_1
ind_goal_2 ~~ ind_goal_2
ind_goal_3 ~~ ind_goal_3

ind_goal_1 ~ 1
ind_goal_2 ~ 1
ind_goal_3 ~ 1
'

# loop across 5 traits -> change in current-personality ratings
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  # items = paste0(bfi_versions[[5]], item_nrs) # using parcels instead!
  mod_names = paste0("sb07_", str_pad(trait_facets_nrs[[i]], 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(trait_template_mod_goal_fu, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3"), 
                                         "ind_goal_1" = mod_names[1], "ind_goal_2" = mod_names[2], 
                                         "ind_goal_3" = mod_names[3]))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6_fu")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6_fu")), trait_model_fit))
}  

# 2nd, for frequency of self-improvement behavior

trait_template_mod_frequ <- '
trait_t1 =~ 1*ind01_t1 + lamb2*ind02_t1 + lamb3*ind03_t1 # This specifies the measurement model for extra_t1 
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

frequ =~ 1*sb04_01_t2 + sb04_02_t2 + sb04_03_t2 # latent variable for moderator

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t1 ~ 1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ trait_t1         # This estimates the variance of trait_t1 
trait_t1 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t1 ~ frequ           # This estimates the moderation effect on personality at T1
d_trait_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind01_t1 ~~ ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ res1*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ res2*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ res3*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ res1*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ res2*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ res3*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ m3*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sb04_01_t2 ~~ sb04_01_t2
sb04_02_t2 ~~ sb04_02_t2
sb04_03_t2 ~~ sb04_03_t2

sb04_01_t2 ~ 1
sb04_02_t2 ~ 1
sb04_03_t2 ~ 1
'

# loop across 5 traits
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  # items = paste0(bfi_versions[[5]], item_nrs) # using parcels instead!
  template_filled <- str_replace_all(trait_template_mod_frequ, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6")), trait_model_fit))
}  

# loop across 5 traits -> change in *ideal*-self ratings (not hypothesis-conform)
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  # items = paste0(bfi_versions[[5]], item_nrs) # using parcels instead!
  template_filled <- str_replace_all(trait_template_mod_frequ, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"),  # ideal instead of current!
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp6")), template_filled)) # ideal instead of curr
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp6")), trait_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for current personality ratings)

trait_template_mod_frequ_fu <- '
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for extra_t2 
trait_t3 =~ 1*ind01_t3 + lamb2*ind02_t3 + lamb3*ind03_t3 # This specifies the measurement model for extra_t3 with the equality constrained factor loadings

frequ =~ 1*sb04_01_t2 + sb04_02_t2 + sb04_03_t2 # latent variable for moderator

trait_t3 ~ 1*trait_t2     # This parameter regresses trait_t3 perfectly on trait_t2
d_trait_1 =~ 1*trait_t3   # This defines the latent change score factor as measured perfectly by scores on trait_t3
trait_t3 ~ 0*1            # This line constrains the intercept of trait_t3 to 0
trait_t3 ~~ 0*trait_t3    # This fixes the variance of trait_t3 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t2 ~ 1               # This estimates the intercept of trait_t2 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t2 ~~ trait_t2         # This estimates the variance of trait_t2 
trait_t2 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t2 ~ frequ           # This estimates the moderation effect on personality at T2
d_trait_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind01_t2 ~~ ind01_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind02_t2 ~~ ind02_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind03_t2 ~~ ind03_t3   # This allows residual covariance on indicator X3 across T2 and T3

ind01_t2 ~~ res1*ind01_t2   # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ res2*ind02_t2   # This allows residual variance on indicator X2 at T2
ind03_t2 ~~ res3*ind03_t2   # This allows residual variance on indicator X3 at T2

ind01_t3 ~~ res1*ind01_t3  # This allows residual variance on indicator X1 at T3 
ind02_t3 ~~ res2*ind02_t3  # This allows residual variance on indicator X2 at T3 
ind03_t3 ~~ res3*ind03_t3  # This allows residual variance on indicator X3 at T3

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

ind01_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind02_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind03_t3 ~ m3*1     # This estimates the intercept of X3 at T3

sb04_01_t2 ~~ sb04_01_t2
sb04_02_t2 ~~ sb04_02_t2
sb04_03_t2 ~~ sb04_03_t2

sb04_01_t2 ~ 1
sb04_02_t2 ~ 1
sb04_03_t2 ~ 1
'

# loop across 5 traits
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  # items = paste0(bfi_versions[[5]], item_nrs) # using parcels instead!
  template_filled <- str_replace_all(trait_template_mod_frequ_fu, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6_fu")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6_fu")), trait_model_fit))
}  
```

#### Big Five traits (current personality)

##### Extraversion: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_extra_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>% 
  left_join(broom::tidy(fit_mi_lcs_extra_curr_specif_hyp6, 
                        conf.int = TRUE, conf.level = 0.95) %>% 
              select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ goals", "goals ~~ goals", "extra_t1 ~ goals", # change goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the extraversion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_curr_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_curr_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Extraversion: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_extra_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ frequ", "frequ ~~ frequ", "extra_t1 ~ frequ", # frequency of self improvement
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The frequency of self-improvement behaviors significantly moderates changes in extraversion (current-personality), *b* = `r round(params_lcs_extra_curr_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_curr_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_agree_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ goals", "goals ~~ goals", "agree_t1 ~ goals", # change goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the agreeableness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_curr_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_curr_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_agree_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ frequ", "frequ ~~ frequ", "agree_t1 ~ frequ", # frequency of self improvement
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the agreeableness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_curr_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_curr_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_consc_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ goals", "goals ~~ goals", "consc_t1 ~ goals", # change goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the conscientiousness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_curr_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_curr_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_consc_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ frequ", "frequ ~~ frequ", "consc_t1 ~ frequ", # frequency of self improvement
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the conscientiousness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_curr_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_curr_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ goals", "goals ~~ goals", "neuro_t1 ~ goals", # change goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the neuroticism change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_curr_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_curr_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_neuro_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ frequ", "frequ ~~ frequ", "neuro_t1 ~ frequ", # frequency of self improvement
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the neuroticism change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_curr_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_curr_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Openness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_openn_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ goals", "goals ~~ goals", "openn_t1 ~ goals", # change goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the openness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_curr_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_curr_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Openness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_openn_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ frequ", "frequ ~~ frequ", "openn_t1 ~ frequ", # frequency of self improvement
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the openness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_curr_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_curr_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Big Five traits (current personality - follow-up T3)

##### Extraversion: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_extra_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t3 ~ extra_t2", "d_extra_1 =~ extra_t3", "extra_t2 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ goals", "goals ~~ goals", "extra_t2 ~ goals", # change goals
                           "d_extra_1 ~1 ", "extra_t2 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the extraversion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_curr_specif_hyp6_fu %>% filter(term=="d_extra_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_curr_specif_hyp6_fu %>% filter(term=="d_extra_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Extraversion: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_extra_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t3 ~ extra_t2", "d_extra_1 =~ extra_t3", "extra_t2 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ frequ", "frequ ~~ frequ", "extra_t2 ~ frequ", # frequency of self improvement
                           "d_extra_1 ~1 ", "extra_t2 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the extraversion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_curr_frequ_hyp6_fu %>% filter(term=="d_extra_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_curr_frequ_hyp6_fu %>% filter(term=="d_extra_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_agree_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t3 ~ agree_t2", "d_agree_1 =~ agree_t3", "agree_t2 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ goals", "goals ~~ goals", "agree_t2 ~ goals", # change goals
                           "d_agree_1 ~1 ", "agree_t2 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the agreeableness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_curr_specif_hyp6_fu %>% filter(term=="d_agree_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_curr_specif_hyp6_fu %>% filter(term=="d_agree_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_agree_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t3 ~ agree_t2", "d_agree_1 =~ agree_t3", "agree_t2 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ frequ", "frequ ~~ frequ", "agree_t2 ~ frequ", # frequency of self improvement
                           "d_agree_1 ~1 ", "agree_t2 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the agreeableness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_curr_frequ_hyp6_fu %>% filter(term=="d_agree_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_curr_frequ_hyp6_fu %>% filter(term=="d_agree_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_consc_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t3 ~ consc_t2", "d_consc_1 =~ consc_t3", "consc_t2 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ goals", "goals ~~ goals", "consc_t2 ~ goals", # change goals
                           "d_consc_1 ~1 ", "consc_t2 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the conscientiousness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_curr_specif_hyp6_fu %>% filter(term=="d_consc_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_curr_specif_hyp6_fu %>% filter(term=="d_consc_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_consc_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t3 ~ consc_t2", "d_consc_1 =~ consc_t3", "consc_t2 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ frequ", "frequ ~~ frequ", "consc_t2 ~ frequ", # frequency of self improvement
                           "d_consc_1 ~1 ", "consc_t2 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the conscientiousness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_curr_frequ_hyp6_fu %>% filter(term=="d_consc_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_curr_frequ_hyp6_fu %>% filter(term=="d_consc_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t3 ~ neuro_t2", "d_neuro_1 =~ neuro_t3", "neuro_t2 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ goals", "goals ~~ goals", "neuro_t2 ~ goals", # change goals
                           "d_neuro_1 ~1 ", "neuro_t2 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the neuroticism change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_curr_specif_hyp6_fu %>% filter(term=="d_neuro_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_curr_specif_hyp6_fu %>% filter(term=="d_neuro_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_neuro_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t3 ~ neuro_t2", "d_neuro_1 =~ neuro_t3", "neuro_t2 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ frequ", "frequ ~~ frequ", "neuro_t2 ~ frequ", # frequency of self improvement
                           "d_neuro_1 ~1 ", "neuro_t2 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the neuroticism change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_curr_frequ_hyp6_fu %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_curr_frequ_hyp6_fu %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Openness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_openn_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t3 ~ openn_t2", "d_openn_1 =~ openn_t3", "openn_t2 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ goals", "goals ~~ goals", "openn_t2 ~ goals", # change goals
                           "d_openn_1 ~1 ", "openn_t2 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the openness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_curr_specif_hyp6_fu %>% filter(term=="d_openn_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_curr_specif_hyp6_fu %>% filter(term=="d_openn_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Openness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_openn_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t3 ~ openn_t2", "d_openn_1 =~ openn_t3", "openn_t2 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ frequ", "frequ ~~ frequ", "openn_t2 ~ frequ", # frequency of self improvement
                           "d_openn_1 ~1 ", "openn_t2 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the openness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_curr_frequ_hyp6_fu %>% filter(term=="d_openn_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_curr_frequ_hyp6_fu %>% filter(term=="d_openn_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Big Five traits (ideal personality)

##### Extraversion: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ goals", "goals ~~ goals", "extra_t1 ~ goals", # change goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the extraversion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_ideal_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_ideal_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Extraversion: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_extra_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ frequ", "frequ ~~ frequ", "extra_t1 ~ frequ", # frequency of self improvement
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the extraversion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_ideal_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_ideal_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ goals", "goals ~~ goals", "agree_t1 ~ goals", # change goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the agreeableness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_ideal_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_ideal_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_agree_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ frequ", "frequ ~~ frequ", "agree_t1 ~ frequ", # frequency of self improvement
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the agreeableness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_ideal_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_ideal_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ goals", "goals ~~ goals", "consc_t1 ~ goals", # change goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the conscientiousness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_ideal_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_ideal_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_consc_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ frequ", "frequ ~~ frequ", "consc_t1 ~ frequ", # frequency of self improvement
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the conscientiousness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_ideal_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_ideal_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ goals", "goals ~~ goals", "neuro_t1 ~ goals", # change goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the neuroticism change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_ideal_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_ideal_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_neuro_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ frequ", "frequ ~~ frequ", "neuro_t1 ~ frequ", # frequency of self improvement
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the neuroticism change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_ideal_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_ideal_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Openness: specific, facet-level change goals as moderator of change

Results summary (*goals* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ goals", "goals ~~ goals", "openn_t1 ~ goals", # change goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level change goals with the openness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_ideal_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_ideal_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Openness: frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_openn_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ frequ", "frequ ~~ frequ", "openn_t1 ~ frequ", # frequency of self improvement
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the openness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_ideal_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_ideal_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Big Five facets (run models)

Run models for all facets with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates:

# 1st, for facet-specific change goal

facet_template_mod_goal <- '
facet_t1 =~ 1*ind1_t1 + lamb2*ind2_t1 + lamb3*ind3_t1 + lamb4*ind4_t1 # This specifies the measurement model for facet at T1
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2 (with equality constraints)

facet_t2 ~ 1*facet_t1     # This parameter regresses facet_t2 perfectly on facet_t1
d_facet_1 =~ 1*facet_t2   # This defines the latent change score factor as measured perfectly by scores on facet_t2
facet_t2 ~ 0*1            # This line constrains the intercept of facet_t2 to 0
facet_t2 ~~ 0*facet_t2    # This fixes the variance of facet_t2 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t1 ~ 1               # This estimates the intercept of facet_t1 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t1 ~~ facet_t1         # This estimates the variance of facet_t1 
facet_t1 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t1 ~ ind_goal        # This estimates the moderation effect on personality at T1
d_facet_1 ~ ind_goal       # This estimates the moderation effect on the change score

ind1_t1 ~~ ind1_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind2_t1 ~~ ind2_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind3_t1 ~~ ind3_t2   # This allows residual covariance on indicator X3 across T1 and T2
ind4_t1 ~~ ind4_t2   # This allows residual covariance on indicator X4 across T1 and T2

ind1_t1 ~~ res1*ind1_t1   # This allows residual variance on indicator X1 at T1 
ind2_t1 ~~ res2*ind2_t1   # This allows residual variance on indicator X2 at T1
ind3_t1 ~~ res3*ind3_t1   # This allows residual variance on indicator X3 at T1
ind4_t1 ~~ res4*ind4_t1   # This allows residual variance on indicator X4 at T1

ind1_t2 ~~ res1*ind1_t2  # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2  # This allows residual variance on indicator X2 at T2 
ind3_t2 ~~ res3*ind3_t2  # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2  # This allows residual variance on indicator X4 at T2

ind1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind3_t1 ~ m3*1     # This estimates the intercept of X3 at T1
ind4_t1 ~ m4*1     # This estimates the intercept of X4 at T1

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind_goal ~~ ind_goal
ind_goal ~ 1
'

# loop across 15 facets -> change in current-personality ratings
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  items = paste0(bfi_versions[[5]], item_nrs)
  mod_name = paste0("sb07_", str_pad(i-5, 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(facet_template_mod_goal, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                         "ind_goal" = mod_name))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6")), facet_model_fit))
}  

# loop across 15 facets -> change in ideal-personality ratings
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  items = paste0(bfi_versions[[6]], item_nrs) # ideal
  mod_name = paste0("sb07_", str_pad(i-5, 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(facet_template_mod_goal, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                         "ind_goal" = mod_name))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp6")), template_filled)) # ideal
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp6")), facet_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for current personality ratings)

facet_template_mod_goal_fu <- '
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2
facet_t3 =~ 1*ind1_t3 + lamb2*ind2_t3 + lamb3*ind3_t3 + lamb4*ind4_t3 # This specifies the measurement model for facet at T3 (with equality constraints)

facet_t3 ~ 1*facet_t2     # This parameter regresses facet_t3 perfectly on facet_t2
d_facet_1 =~ 1*facet_t3   # This defines the latent change score factor as measured perfectly by scores on facet_t3
facet_t3 ~ 0*1            # This line constrains the intercept of facet_t3 to 0
facet_t3 ~~ 0*facet_t3    # This fixes the variance of facet_t3 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t2 ~ 1               # This estimates the intercept of facet_t2 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t2 ~~ facet_t2         # This estimates the variance of facet_t2 
facet_t2 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t2 ~ ind_goal        # This estimates the moderation effect on personality at T2
d_facet_1 ~ ind_goal       # This estimates the moderation effect on the change score

ind1_t2 ~~ ind1_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind2_t2 ~~ ind2_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind3_t2 ~~ ind3_t3   # This allows residual covariance on indicator X3 across T2 and T3
ind4_t2 ~~ ind4_t3   # This allows residual covariance on indicator X4 across T2 and T3

ind1_t2 ~~ res1*ind1_t2   # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2   # This allows residual variance on indicator X2 at T2
ind3_t2 ~~ res3*ind3_t2   # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2   # This allows residual variance on indicator X4 at T2

ind1_t3 ~~ res1*ind1_t3  # This allows residual variance on indicator X1 at T3 
ind2_t3 ~~ res2*ind2_t3  # This allows residual variance on indicator X2 at T3 
ind3_t3 ~~ res3*ind3_t3  # This allows residual variance on indicator X3 at T3
ind4_t3 ~~ res4*ind4_t3  # This allows residual variance on indicator X4 at T3

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind1_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind2_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind3_t3 ~ m3*1     # This estimates the intercept of X3 at T3
ind4_t3 ~ m4*1     # This estimates the intercept of X4 at T3

ind_goal ~~ ind_goal
ind_goal ~ 1
'

# loop across 15 facets -> change in current-personality ratings
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  items = paste0(bfi_versions[[5]], item_nrs)
  mod_name = paste0("sb07_", str_pad(i-5, 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(facet_template_mod_goal_fu, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                         "ind_goal" = mod_name))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6_fu")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp6_fu")), facet_model_fit))
}  

# 2nd, for frequency of self-improvement behavior

facet_template_mod_frequ <- '
facet_t1 =~ 1*ind1_t1 + lamb2*ind2_t1 + lamb3*ind3_t1 + lamb4*ind4_t1 # This specifies the measurement model for facet at T1
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2 (with equality constraints)

frequ =~ 1*sb04_01_t2 + sb04_02_t2 + sb04_03_t2 # latent variable for moderator

facet_t2 ~ 1*facet_t1     # This parameter regresses facet_t2 perfectly on facet_t1
d_facet_1 =~ 1*facet_t2   # This defines the latent change score factor as measured perfectly by scores on facet_t2
facet_t2 ~ 0*1            # This line constrains the intercept of facet_t2 to 0
facet_t2 ~~ 0*facet_t2    # This fixes the variance of facet_t2 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t1 ~ 1               # This estimates the intercept of facet_t1 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t1 ~~ facet_t1         # This estimates the variance of facet_t1 
facet_t1 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t1 ~ frequ           # This estimates the moderation effect on personality at T1
d_facet_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind1_t1 ~~ ind1_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind2_t1 ~~ ind2_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind3_t1 ~~ ind3_t2   # This allows residual covariance on indicator X3 across T1 and T2
ind4_t1 ~~ ind4_t2   # This allows residual covariance on indicator X4 across T1 and T2

ind1_t1 ~~ res1*ind1_t1   # This allows residual variance on indicator X1 at T1 
ind2_t1 ~~ res2*ind2_t1   # This allows residual variance on indicator X2 at T1
ind3_t1 ~~ res3*ind3_t1   # This allows residual variance on indicator X3 at T1
ind4_t1 ~~ res4*ind4_t1   # This allows residual variance on indicator X4 at T1

ind1_t2 ~~ res1*ind1_t2  # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2  # This allows residual variance on indicator X2 at T2 
ind3_t2 ~~ res3*ind3_t2  # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2  # This allows residual variance on indicator X4 at T2

ind1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind3_t1 ~ m3*1     # This estimates the intercept of X3 at T1
ind4_t1 ~ m4*1     # This estimates the intercept of X4 at T1

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

sb04_01_t2 ~~ sb04_01_t2
sb04_02_t2 ~~ sb04_02_t2
sb04_03_t2 ~~ sb04_03_t2

sb04_01_t2 ~ 1
sb04_02_t2 ~ 1
sb04_03_t2 ~ 1
'

# loop across 15 facets -> change in current-personality ratings
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  items = paste0(bfi_versions[[5]], item_nrs)
  template_filled <- str_replace_all(facet_template_mod_frequ, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4]))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6")), facet_model_fit))
}  

# loop across 15 facets -> change in ideal-personality ratings
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  items = paste0(bfi_versions[[6]], item_nrs) # ideal
  template_filled <- str_replace_all(facet_template_mod_frequ, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4]))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp6")), template_filled)) # ideal
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp6")), facet_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for current personality ratings)

facet_template_mod_frequ_fu <- '
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2
facet_t3 =~ 1*ind1_t3 + lamb2*ind2_t3 + lamb3*ind3_t3 + lamb4*ind4_t3 # This specifies the measurement model for facet at T3 (with equality constraints)

frequ =~ 1*sb04_01_t2 + sb04_02_t2 + sb04_03_t2 # latent variable for moderator

facet_t3 ~ 1*facet_t2     # This parameter regresses facet_t3 perfectly on facet_t2
d_facet_1 =~ 1*facet_t3   # This defines the latent change score factor as measured perfectly by scores on facet_t3
facet_t3 ~ 0*1            # This line constrains the intercept of facet_t3 to 0
facet_t3 ~~ 0*facet_t3    # This fixes the variance of facet_t3 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t2 ~ 1               # This estimates the intercept of facet_t2 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t2 ~~ facet_t2         # This estimates the variance of facet_t2 
facet_t2 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t2 ~ frequ           # This estimates the moderation effect on personality at T2
d_facet_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind1_t2 ~~ ind1_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind2_t2 ~~ ind2_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind3_t2 ~~ ind3_t3   # This allows residual covariance on indicator X3 across T2 and T3
ind4_t2 ~~ ind4_t3   # This allows residual covariance on indicator X4 across T2 and T3

ind1_t2 ~~ res1*ind1_t2   # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2   # This allows residual variance on indicator X2 at T2
ind3_t2 ~~ res3*ind3_t2   # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2   # This allows residual variance on indicator X4 at T2

ind1_t3 ~~ res1*ind1_t3  # This allows residual variance on indicator X1 at T3 
ind2_t3 ~~ res2*ind2_t3  # This allows residual variance on indicator X2 at T3 
ind3_t3 ~~ res3*ind3_t3  # This allows residual variance on indicator X3 at T3
ind4_t3 ~~ res4*ind4_t3  # This allows residual variance on indicator X4 at T3

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind1_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind2_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind3_t3 ~ m3*1     # This estimates the intercept of X3 at T3
ind4_t3 ~ m4*1     # This estimates the intercept of X4 at T3

sb04_01_t2 ~~ sb04_01_t2
sb04_02_t2 ~~ sb04_02_t2
sb04_03_t2 ~~ sb04_03_t2

sb04_01_t2 ~ 1
sb04_02_t2 ~ 1
sb04_03_t2 ~ 1
'

# loop across 15 facets -> change in current-personality ratings from T2 to T3
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post current
  items = paste0(bfi_versions[[5]], item_nrs)
  template_filled <- str_replace_all(facet_template_mod_frequ_fu, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4]))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sb_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6_fu")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp6_fu")), facet_model_fit))
}  
```

#### Big Five facets (current personality)

##### Sociability - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_socia_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~ sb07_01_t1", "sb07_01_t1 ~~ sb07_01_t1", "d_socia_1 ~ sb07_01_t1", # change goals
                     "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the sociability change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_socia_curr_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_curr_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_socia_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~ frequ", "frequ ~~ frequ", "socia_t1 ~ frequ", # frequency of self improvement
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The frequency of self-improvement behaviors significantly moderates changes in sociability (current-personality) from T1 to T2, *b* = `r round(params_lcs_socia_curr_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_curr_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_asser_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~ sb07_02_t1", "sb07_02_t1 ~~ sb07_02_t1", "d_asser_1 ~ sb07_02_t1", # change goals
                     "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the assertiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_curr_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_curr_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_asser_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~ frequ", "frequ ~~ frequ", "asser_t1 ~ frequ", # frequency of self improvement
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the assertiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_curr_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_curr_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Energy - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_energ_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~ sb07_03_t1", "sb07_03_t1 ~~ sb07_03_t1", "d_energ_1 ~ sb07_03_t1", # change goals
                     "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the energy change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_curr_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_curr_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_energ_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~ frequ", "frequ ~~ frequ", "energ_t1 ~ frequ", # frequency of self improvement
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the energy change score (current-personality) is not significantly different from zero (at *p* < . 001), *b* = `r round(params_lcs_energ_curr_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_curr_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Compassion - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_compa_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~ sb07_04_t1", "sb07_04_t1 ~~ sb07_04_t1", "d_compa_1 ~ sb07_04_t1", # change goals
                     "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the compassion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_curr_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_curr_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_compa_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~ frequ", "frequ ~~ frequ", "compa_t1 ~ frequ", # frequency of self improvement
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the compassion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_curr_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_curr_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_respe_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~ sb07_05_t1", "sb07_05_t1 ~~ sb07_05_t1", "d_respe_1 ~ sb07_05_t1", # change goals
                     "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the respectfulness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_curr_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_curr_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_respe_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~ frequ", "frequ ~~ frequ", "respe_t1 ~ frequ", # frequency of self improvement
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the respectfulness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_curr_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_curr_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Trust - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_trust_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~ sb07_06_t1", "sb07_06_t1 ~~ sb07_06_t1", "d_trust_1 ~ sb07_06_t1", # change goals
                     "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the trust change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_curr_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_curr_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_trust_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~ frequ", "frequ ~~ frequ", "trust_t1 ~ frequ", # frequency of self improvement
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}

The moderation effect of the self-improvement behaviors with the trust change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_curr_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_curr_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Organization - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_organ_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~ sb07_07_t1", "sb07_07_t1 ~~ sb07_07_t1", "d_organ_1 ~ sb07_07_t1", # change goals
                     "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the organization change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_curr_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_curr_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_organ_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~ frequ", "frequ ~~ frequ", "organ_t1 ~ frequ", # frequency of self improvement
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the organization change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_curr_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_curr_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Productiveness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_produ_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~ sb07_08_t1", "sb07_08_t1 ~~ sb07_08_t1", "d_produ_1 ~ sb07_08_t1", # change goals
                     "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the productiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_curr_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_curr_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_produ_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~ frequ", "frequ ~~ frequ", "produ_t1 ~ frequ", # frequency of self improvement
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the productiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_curr_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_curr_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Responsibility - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_respo_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~ sb07_09_t1", "sb07_09_t1 ~~ sb07_09_t1", "d_respo_1 ~ sb07_09_t1", # change goals
                     "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the responsibility change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_curr_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_curr_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_respo_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~ frequ", "frequ ~~ frequ", "respo_t1 ~ frequ", # frequency of self improvement
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the responsibility change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_curr_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_curr_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Anxiety - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~ sb07_10_t1", "sb07_10_t1 ~~ sb07_10_t1", "d_anxie_1 ~ sb07_10_t1", # change goals
                     "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The frequency of self-improvement behaviors significantly moderates changes in anxiety (current-personality), *b* = `r round(params_lcs_anxie_curr_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_curr_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_anxie_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~ frequ", "frequ ~~ frequ", "anxie_t1 ~ frequ", # frequency of self improvement
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the anxiety change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_curr_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_curr_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Depression - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_depre_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~ sb07_11_t1", "sb07_11_t1 ~~ sb07_11_t1", "d_depre_1 ~ sb07_11_t1", # change goals
                     "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the depression change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_curr_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_curr_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_depre_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~ frequ", "frequ ~~ frequ", "depre_t1 ~ frequ", # frequency of self improvement
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the depression change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_curr_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_curr_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Volatility - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_volat_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~ sb07_12_t1", "sb07_12_t1 ~~ sb07_12_t1", "d_volat_1 ~ sb07_12_t1", # change goals
                     "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the volatility change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_curr_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_curr_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_volat_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~ frequ", "frequ ~~ frequ", "volat_t1 ~ frequ", # frequency of self improvement
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the volatility change score (current-personality) is significantly different from zero, *b* = `r round(params_lcs_volat_curr_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_curr_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Curiosity - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_curio_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~ sb07_13_t1", "sb07_13_t1 ~~ sb07_13_t1", "d_curio_1 ~ sb07_13_t1", # change goals
                     "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the curiosity change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_curr_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_curr_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_curio_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~ frequ", "frequ ~~ frequ", "curio_t1 ~ frequ", # frequency of self improvement
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the curiosity change score (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_curio_curr_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_curr_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~ sb07_14_t1", "sb07_14_t1 ~~ sb07_14_t1", "d_aesth_1 ~ sb07_14_t1", # change goals
                     "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the aesthetic change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_curr_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_curr_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_aesth_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~ frequ", "frequ ~~ frequ", "aesth_t1 ~ frequ", # frequency of self improvement
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the aesthetic change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_curr_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_curr_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Imagination - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_specif_hyp6 <- broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~ sb07_15_t1", "sb07_15_t1 ~~ sb07_15_t1", "d_imagi_1 ~ sb07_15_t1", # change goals
                     "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the imagination change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_curr_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_curr_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_frequ_hyp6 <- broom::tidy(fit_mi_lcs_imagi_curr_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_curr_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~ frequ", "frequ ~~ frequ", "imagi_t1 ~ frequ", # frequency of self improvement
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the imagination change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_curr_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_curr_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Big Five facets (current personality - follow-up T3)

##### Sociability - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_socia_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("socia_t3 ~ socia_t2", "d_socia_1 =~ socia_t3", "socia_t2 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~ sb07_01_t1", "sb07_01_t1 ~~ sb07_01_t1", "d_socia_1 ~ sb07_01_t1", # change goals
                     "d_socia_1 ~1 ", "socia_t2 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the sociability change score (current-personality) from T2 to T3 is not significantly different from zero, *b* = `r round(params_lcs_socia_curr_specif_hyp6_fu %>% filter(term=="d_socia_1 ~ sb07_01_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_curr_specif_hyp6_fu %>% filter(term=="d_socia_1 ~ sb07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_socia_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("socia_t3 ~ socia_t2", "d_socia_1 =~ socia_t3", "socia_t2 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~ frequ", "frequ ~~ frequ", "socia_t2 ~ frequ", # frequency of self improvement
                           "d_socia_1 ~1 ", "socia_t2 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the sociability change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_socia_curr_frequ_hyp6_fu %>% filter(term=="d_socia_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_curr_frequ_hyp6_fu %>% filter(term=="d_socia_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_asser_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("asser_t3 ~ asser_t2", "d_asser_1 =~ asser_t3", "asser_t2 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~ sb07_02_t1", "sb07_02_t1 ~~ sb07_02_t1", "d_asser_1 ~ sb07_02_t1", # change goals
                     "d_asser_1 ~1 ", "asser_t2 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the assertiveness change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_curr_specif_hyp6_fu %>% filter(term=="d_asser_1 ~ sb07_02_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_curr_specif_hyp6_fu %>% filter(term=="d_asser_1 ~ sb07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_asser_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("asser_t3 ~ asser_t2", "d_asser_1 =~ asser_t3", "asser_t2 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~ frequ", "frequ ~~ frequ", "asser_t2 ~ frequ", # frequency of self improvement
                           "d_asser_1 ~1 ", "asser_t2 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the assertiveness change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_curr_frequ_hyp6_fu %>% filter(term=="d_asser_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_curr_frequ_hyp6_fu %>% filter(term=="d_asser_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Energy - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_energ_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("energ_t3 ~ energ_t2", "d_energ_1 =~ energ_t3", "energ_t2 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~ sb07_03_t1", "sb07_03_t1 ~~ sb07_03_t1", "d_energ_1 ~ sb07_03_t1", # change goals
                     "d_energ_1 ~1 ", "energ_t2 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the energy change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_curr_specif_hyp6_fu %>% filter(term=="d_energ_1 ~ sb07_03_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_curr_specif_hyp6_fu %>% filter(term=="d_energ_1 ~ sb07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_energ_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("energ_t3 ~ energ_t2", "d_energ_1 =~ energ_t3", "energ_t2 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~ frequ", "frequ ~~ frequ", "energ_t2 ~ frequ", # frequency of self improvement
                           "d_energ_1 ~1 ", "energ_t2 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the energy change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_curr_frequ_hyp6_fu %>% filter(term=="d_energ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_curr_frequ_hyp6_fu %>% filter(term=="d_energ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Compassion - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_compa_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("compa_t3 ~ compa_t2", "d_compa_1 =~ compa_t3", "compa_t2 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~ sb07_04_t1", "sb07_04_t1 ~~ sb07_04_t1", "d_compa_1 ~ sb07_04_t1", # change goals
                     "d_compa_1 ~1 ", "compa_t2 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the compassion change score from T2 to T3 (current-personality) is not significantly different from zero (at *p* < . 001), *b* = `r round(params_lcs_compa_curr_specif_hyp6_fu %>% filter(term=="d_compa_1 ~ sb07_04_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_curr_specif_hyp6_fu %>% filter(term=="d_compa_1 ~ sb07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_compa_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("compa_t3 ~ compa_t2", "d_compa_1 =~ compa_t3", "compa_t2 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~ frequ", "frequ ~~ frequ", "compa_t2 ~ frequ", # frequency of self improvement
                           "d_compa_1 ~1 ", "compa_t2 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the compassion change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_curr_frequ_hyp6_fu %>% filter(term=="d_compa_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_curr_frequ_hyp6_fu %>% filter(term=="d_compa_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_respe_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respe_t3 ~ respe_t2", "d_respe_1 =~ respe_t3", "respe_t2 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~ sb07_05_t1", "sb07_05_t1 ~~ sb07_05_t1", "d_respe_1 ~ sb07_05_t1", # change goals
                     "d_respe_1 ~1 ", "respe_t2 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the respectfulness change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_curr_specif_hyp6_fu %>% filter(term=="d_respe_1 ~ sb07_05_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_curr_specif_hyp6_fu %>% filter(term=="d_respe_1 ~ sb07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_respe_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respe_t3 ~ respe_t2", "d_respe_1 =~ respe_t3", "respe_t2 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~ frequ", "frequ ~~ frequ", "respe_t2 ~ frequ", # frequency of self improvement
                           "d_respe_1 ~1 ", "respe_t2 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the respectfulness change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_curr_frequ_hyp6_fu %>% filter(term=="d_respe_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_curr_frequ_hyp6_fu %>% filter(term=="d_respe_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Trust - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_trust_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("trust_t3 ~ trust_t2", "d_trust_1 =~ trust_t3", "trust_t2 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~ sb07_06_t1", "sb07_06_t1 ~~ sb07_06_t1", "d_trust_1 ~ sb07_06_t1", # change goals
                     "d_trust_1 ~1 ", "trust_t2 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the trust change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_curr_specif_hyp6_fu %>% filter(term=="d_trust_1 ~ sb07_06_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_curr_specif_hyp6_fu %>% filter(term=="d_trust_1 ~ sb07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_trust_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("trust_t3 ~ trust_t2", "d_trust_1 =~ trust_t3", "trust_t2 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~ frequ", "frequ ~~ frequ", "trust_t2 ~ frequ", # frequency of self improvement
                           "d_trust_1 ~1 ", "trust_t2 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}

The moderation effect of the self-improvement behaviors with the trust change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_curr_frequ_hyp6_fu %>% filter(term=="d_trust_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_curr_frequ_hyp6_fu %>% filter(term=="d_trust_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Organization - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_organ_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("organ_t3 ~ organ_t2", "d_organ_1 =~ organ_t3", "organ_t2 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~ sb07_07_t1", "sb07_07_t1 ~~ sb07_07_t1", "d_organ_1 ~ sb07_07_t1", # change goals
                     "d_organ_1 ~1 ", "organ_t2 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the organization change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_curr_specif_hyp6_fu %>% filter(term=="d_organ_1 ~ sb07_07_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_curr_specif_hyp6_fu %>% filter(term=="d_organ_1 ~ sb07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_organ_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("organ_t3 ~ organ_t2", "d_organ_1 =~ organ_t3", "organ_t2 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~ frequ", "frequ ~~ frequ", "organ_t2 ~ frequ", # frequency of self improvement
                           "d_organ_1 ~1 ", "organ_t2 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the organization change score from T2 to T3 (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_organ_curr_frequ_hyp6_fu %>% filter(term=="d_organ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_curr_frequ_hyp6_fu %>% filter(term=="d_organ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Productiveness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_produ_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("produ_t3 ~ produ_t2", "d_produ_1 =~ produ_t3", "produ_t2 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~ sb07_08_t1", "sb07_08_t1 ~~ sb07_08_t1", "d_produ_1 ~ sb07_08_t1", # change goals
                     "d_produ_1 ~1 ", "produ_t2 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the productiveness change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_curr_specif_hyp6_fu %>% filter(term=="d_produ_1 ~ sb07_08_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_curr_specif_hyp6_fu %>% filter(term=="d_produ_1 ~ sb07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_produ_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("produ_t3 ~ produ_t2", "d_produ_1 =~ produ_t3", "produ_t2 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~ frequ", "frequ ~~ frequ", "produ_t2 ~ frequ", # frequency of self improvement
                           "d_produ_1 ~1 ", "produ_t2 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the productiveness change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_curr_frequ_hyp6_fu %>% filter(term=="d_produ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_curr_frequ_hyp6_fu %>% filter(term=="d_produ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Responsibility - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_respo_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respo_t3 ~ respo_t2", "d_respo_1 =~ respo_t3", "respo_t2 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~ sb07_09_t1", "sb07_09_t1 ~~ sb07_09_t1", "d_respo_1 ~ sb07_09_t1", # change goals
                     "d_respo_1 ~1 ", "respo_t2 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the responsibility change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_curr_specif_hyp6_fu %>% filter(term=="d_respo_1 ~ sb07_09_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_curr_specif_hyp6_fu %>% filter(term=="d_respo_1 ~ sb07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_respo_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respo_t3 ~ respo_t2", "d_respo_1 =~ respo_t3", "respo_t2 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~ frequ", "frequ ~~ frequ", "respo_t2 ~ frequ", # frequency of self improvement
                           "d_respo_1 ~1 ", "respo_t2 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the responsibility change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_curr_frequ_hyp6_fu %>% filter(term=="d_respo_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_curr_frequ_hyp6_fu %>% filter(term=="d_respo_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Anxiety - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("anxie_t3 ~ anxie_t2", "d_anxie_1 =~ anxie_t3", "anxie_t2 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~ sb07_10_t1", "sb07_10_t1 ~~ sb07_10_t1", "d_anxie_1 ~ sb07_10_t1", # change goals
                     "d_anxie_1 ~1 ", "anxie_t2 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the responsibility change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_curr_specif_hyp6_fu %>% filter(term=="d_anxie_1 ~ sb07_10_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_curr_specif_hyp6_fu %>% filter(term=="d_anxie_1 ~ sb07_10_t1") %>% pull(p.value), 3)`.
:::

##### Anxiety - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_anxie_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("anxie_t3 ~ anxie_t2", "d_anxie_1 =~ anxie_t3", "anxie_t2 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~ frequ", "frequ ~~ frequ", "anxie_t2 ~ frequ", # frequency of self improvement
                           "d_anxie_1 ~1 ", "anxie_t2 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the anxiety change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_curr_frequ_hyp6_fu %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_curr_frequ_hyp6_fu %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Depression - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_depre_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("depre_t3 ~ depre_t2", "d_depre_1 =~ depre_t3", "depre_t2 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~ sb07_11_t1", "sb07_11_t1 ~~ sb07_11_t1", "d_depre_1 ~ sb07_11_t1", # change goals
                     "d_depre_1 ~1 ", "depre_t2 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the depression change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_curr_specif_hyp6_fu %>% filter(term=="d_depre_1 ~ sb07_11_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_curr_specif_hyp6_fu %>% filter(term=="d_depre_1 ~ sb07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_depre_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("depre_t3 ~ depre_t2", "d_depre_1 =~ depre_t3", "depre_t2 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~ frequ", "frequ ~~ frequ", "depre_t2 ~ frequ", # frequency of self improvement
                           "d_depre_1 ~1 ", "depre_t2 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the depression change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_curr_frequ_hyp6_fu %>% filter(term=="d_depre_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_curr_frequ_hyp6_fu %>% filter(term=="d_depre_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Volatility - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_volat_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("volat_t3 ~ volat_t2", "d_volat_1 =~ volat_t3", "volat_t2 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~ sb07_12_t1", "sb07_12_t1 ~~ sb07_12_t1", "d_volat_1 ~ sb07_12_t1", # change goals
                     "d_volat_1 ~1 ", "volat_t2 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the volatility change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_curr_specif_hyp6_fu %>% filter(term=="d_volat_1 ~ sb07_12_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_curr_specif_hyp6_fu %>% filter(term=="d_volat_1 ~ sb07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_volat_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("volat_t3 ~ volat_t2", "d_volat_1 =~ volat_t3", "volat_t2 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~ frequ", "frequ ~~ frequ", "volat_t2 ~ frequ", # frequency of self improvement
                           "d_volat_1 ~1 ", "volat_t2 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the volatility change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_curr_frequ_hyp6_fu %>% filter(term=="d_volat_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_curr_frequ_hyp6_fu %>% filter(term=="d_volat_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Curiosity - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_curio_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("curio_t3 ~ curio_t2", "d_curio_1 =~ curio_t3", "curio_t2 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~ sb07_13_t1", "sb07_13_t1 ~~ sb07_13_t1", "d_curio_1 ~ sb07_13_t1", # change goals
                     "d_curio_1 ~1 ", "curio_t2 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the curiosity change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_curr_specif_hyp6_fu %>% filter(term=="d_curio_1 ~ sb07_13_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_curr_specif_hyp6_fu %>% filter(term=="d_curio_1 ~ sb07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_curio_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("curio_t3 ~ curio_t2", "d_curio_1 =~ curio_t3", "curio_t2 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~ frequ", "frequ ~~ frequ", "curio_t2 ~ frequ", # frequency of self improvement
                           "d_curio_1 ~1 ", "curio_t2 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the curiosity change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_curr_frequ_hyp6_fu %>% filter(term=="d_curio_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_curr_frequ_hyp6_fu %>% filter(term=="d_curio_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("aesth_t3 ~ aesth_t2", "d_aesth_1 =~ aesth_t3", "aesth_t2 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~ sb07_14_t1", "sb07_14_t1 ~~ sb07_14_t1", "d_aesth_1 ~ sb07_14_t1", # change goals
                     "d_aesth_1 ~1 ", "aesth_t2 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the aesthetic change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_curr_specif_hyp6_fu %>% filter(term=="d_aesth_1 ~ sb07_14_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_curr_specif_hyp6_fu %>% filter(term=="d_aesth_1 ~ sb07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_aesth_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("aesth_t3 ~ aesth_t2", "d_aesth_1 =~ aesth_t3", "aesth_t2 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~ frequ", "frequ ~~ frequ", "aesth_t2 ~ frequ", # frequency of self improvement
                           "d_aesth_1 ~1 ", "aesth_t2 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the aesthetic change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_curr_frequ_hyp6_fu %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_curr_frequ_hyp6_fu %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Imagination - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_specif_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_specif_hyp6_fu <- broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("imagi_t3 ~ imagi_t2", "d_imagi_1 =~ imagi_t3", "imagi_t2 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~ sb07_15_t1", "sb07_15_t1 ~~ sb07_15_t1", "d_imagi_1 ~ sb07_15_t1", # change goals
                     "d_imagi_1 ~1 ", "imagi_t2 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_specif_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the imagination change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_curr_specif_hyp6_fu %>% filter(term=="d_imagi_1 ~ sb07_15_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_curr_specif_hyp6_fu %>% filter(term=="d_imagi_1 ~ sb07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_frequ_hyp6_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_frequ_hyp6_fu <- broom::tidy(fit_mi_lcs_imagi_curr_frequ_hyp6_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_curr_frequ_hyp6_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("imagi_t3 ~ imagi_t2", "d_imagi_1 =~ imagi_t3", "imagi_t2 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~ frequ", "frequ ~~ frequ", "imagi_t2 ~ frequ", # frequency of self improvement
                           "d_imagi_1 ~1 ", "imagi_t2 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_frequ_hyp6_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the imagination change score from T2 to T3 (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_curr_frequ_hyp6_fu %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_curr_frequ_hyp6_fu %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Big Five facets (ideal personality)

##### Sociability - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~ sb07_01_t1", "sb07_01_t1 ~~ sb07_01_t1", "d_socia_1 ~ sb07_01_t1", # change goals
                     "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the sociability change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_socia_ideal_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_ideal_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_socia_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~ frequ", "frequ ~~ frequ", "socia_t1 ~ frequ", # frequency of self improvement
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with sociability change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_socia_ideal_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_ideal_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~ sb07_02_t1", "sb07_02_t1 ~~ sb07_02_t1", "d_asser_1 ~ sb07_02_t1", # change goals
                     "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the assertiveness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_ideal_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_ideal_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_asser_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~ frequ", "frequ ~~ frequ", "asser_t1 ~ frequ", # frequency of self improvement
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the assertiveness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_ideal_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_ideal_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Energy - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~ sb07_03_t1", "sb07_03_t1 ~~ sb07_03_t1", "d_energ_1 ~ sb07_03_t1", # change goals
                     "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the energy change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_ideal_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_ideal_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_energ_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~ frequ", "frequ ~~ frequ", "energ_t1 ~ frequ", # frequency of self improvement
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the energy change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_ideal_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_ideal_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Compassion - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~ sb07_04_t1", "sb07_04_t1 ~~ sb07_04_t1", "d_compa_1 ~ sb07_04_t1", # change goals
                     "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the compassion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_ideal_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_ideal_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_compa_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~ frequ", "frequ ~~ frequ", "compa_t1 ~ frequ", # frequency of self improvement
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the compassion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_ideal_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_ideal_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~ sb07_05_t1", "sb07_05_t1 ~~ sb07_05_t1", "d_respe_1 ~ sb07_05_t1", # change goals
                     "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the respectfulness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_ideal_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_ideal_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_respe_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~ frequ", "frequ ~~ frequ", "respe_t1 ~ frequ", # frequency of self improvement
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the respectfulness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_ideal_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_ideal_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Trust - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~ sb07_06_t1", "sb07_06_t1 ~~ sb07_06_t1", "d_trust_1 ~ sb07_06_t1", # change goals
                     "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the trust change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_ideal_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_ideal_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_trust_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~ frequ", "frequ ~~ frequ", "trust_t1 ~ frequ", # frequency of self improvement
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}

The moderation effect of the self-improvement behaviors with the trust change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_ideal_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_ideal_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Organization - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~ sb07_07_t1", "sb07_07_t1 ~~ sb07_07_t1", "d_organ_1 ~ sb07_07_t1", # change goals
                     "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the organization change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_ideal_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_ideal_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_organ_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~ frequ", "frequ ~~ frequ", "organ_t1 ~ frequ", # frequency of self improvement
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the organization change score (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_organ_ideal_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_ideal_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Productiveness - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~ sb07_08_t1", "sb07_08_t1 ~~ sb07_08_t1", "d_produ_1 ~ sb07_08_t1", # change goals
                     "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the productiveness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_ideal_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_ideal_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_produ_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~ frequ", "frequ ~~ frequ", "produ_t1 ~ frequ", # frequency of self improvement
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the productiveness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_ideal_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_ideal_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Responsibility - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~ sb07_09_t1", "sb07_09_t1 ~~ sb07_09_t1", "d_respo_1 ~ sb07_09_t1", # change goals
                     "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the responsibility change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_ideal_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_ideal_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_respo_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~ frequ", "frequ ~~ frequ", "respo_t1 ~ frequ", # frequency of self improvement
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the responsibility change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_ideal_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_ideal_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Anxiety - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~ sb07_10_t1", "sb07_10_t1 ~~ sb07_10_t1", "d_anxie_1 ~ sb07_10_t1", # change goals
                     "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the anxiety change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_ideal_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_ideal_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_anxie_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~ frequ", "frequ ~~ frequ", "anxie_t1 ~ frequ", # frequency of self improvement
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the anxiety change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_ideal_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_ideal_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Depression - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~ sb07_11_t1", "sb07_11_t1 ~~ sb07_11_t1", "d_depre_1 ~ sb07_11_t1", # change goals
                     "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the depression change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_ideal_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_ideal_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_depre_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~ frequ", "frequ ~~ frequ", "depre_t1 ~ frequ", # frequency of self improvement
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the depression change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_ideal_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_ideal_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Volatility - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~ sb07_12_t1", "sb07_12_t1 ~~ sb07_12_t1", "d_volat_1 ~ sb07_12_t1", # change goals
                     "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the volatility change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_ideal_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_ideal_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_volat_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~ frequ", "frequ ~~ frequ", "volat_t1 ~ frequ", # frequency of self improvement
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the volatility change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_ideal_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_ideal_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Curiosity - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~ sb07_13_t1", "sb07_13_t1 ~~ sb07_13_t1", "d_curio_1 ~ sb07_13_t1", # change goals
                     "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the curiosity change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_ideal_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_ideal_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_curio_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~ frequ", "frequ ~~ frequ", "curio_t1 ~ frequ", # frequency of self improvement
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the curiosity change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_ideal_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_ideal_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~ sb07_14_t1", "sb07_14_t1 ~~ sb07_14_t1", "d_aesth_1 ~ sb07_14_t1", # change goals
                     "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the aesthetic change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_ideal_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_ideal_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_aesth_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~ frequ", "frequ ~~ frequ", "aesth_t1 ~ frequ", # frequency of self improvement
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the aesthetic change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_ideal_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_ideal_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Imagination - specific, facet-level change goal as moderator of change

Results summary (*sb07_xx_t1* = trait/facet specific change goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_specif_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_specif_hyp6 <- broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~ sb07_15_t1", "sb07_15_t1 ~~ sb07_15_t1", "d_imagi_1 ~ sb07_15_t1", # change goals
                     "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_specif_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific change goal with the imagination change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_ideal_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_ideal_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - frequency of self-improvement behaviors as moderator of change

Results summary (*frequ* = frequency of self-improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_frequ_hyp6) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_frequ_hyp6 <- broom::tidy(fit_mi_lcs_imagi_ideal_frequ_hyp6, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_ideal_frequ_hyp6,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~ frequ", "frequ ~~ frequ", "imagi_t1 ~ frequ", # frequency of self improvement
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_frequ_hyp6, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-improvement behaviors with the imagination change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_ideal_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_ideal_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Hyp 6: Effects summary

##### Summary: Current personality

Collect all relevant effects
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create df for table:

# main effects (change score)
df_table_hyp6_main <- bind_rows(
  #traits
  params_lcs_extra_curr_specif_hyp6 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_extra_curr_frequ_hyp6 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_agree_curr_specif_hyp6 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_agree_curr_frequ_hyp6 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_consc_curr_specif_hyp6 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_consc_curr_frequ_hyp6 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_neuro_curr_specif_hyp6 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_neuro_curr_frequ_hyp6 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_openn_curr_specif_hyp6 %>% filter(term=="d_openn_1 ~1 "),
  params_lcs_openn_curr_frequ_hyp6 %>% filter(term=="d_openn_1 ~1 "),
  #facets
  params_lcs_socia_curr_specif_hyp6 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_socia_curr_frequ_hyp6 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_asser_curr_specif_hyp6 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_asser_curr_frequ_hyp6 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_energ_curr_specif_hyp6 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_energ_curr_frequ_hyp6 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_compa_curr_specif_hyp6 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_compa_curr_frequ_hyp6 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_respe_curr_specif_hyp6 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_respe_curr_frequ_hyp6 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_trust_curr_specif_hyp6 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_trust_curr_frequ_hyp6 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_organ_curr_specif_hyp6 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_organ_curr_frequ_hyp6 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_produ_curr_specif_hyp6 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_produ_curr_frequ_hyp6 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_respo_curr_specif_hyp6 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_respo_curr_frequ_hyp6 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_anxie_curr_specif_hyp6 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_anxie_curr_frequ_hyp6 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_depre_curr_specif_hyp6 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_depre_curr_frequ_hyp6 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_volat_curr_specif_hyp6 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_volat_curr_frequ_hyp6 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_curio_curr_specif_hyp6 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_curio_curr_frequ_hyp6 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_aesth_curr_specif_hyp6 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_aesth_curr_frequ_hyp6 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_imagi_curr_specif_hyp6 %>% filter(term=="d_imagi_1 ~1 "),
  params_lcs_imagi_curr_frequ_hyp6 %>% filter(term=="d_imagi_1 ~1 ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_main = estimate, std_main = std.all, p_main = p.value)

# moderation effects
df_table_hyp6_mod <- bind_rows(
  #traits
  params_lcs_extra_curr_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_curr_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_curr_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_curr_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_curr_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_curr_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_curr_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_curr_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_curr_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_curr_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_curr_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1"),
  params_lcs_socia_curr_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_curr_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1"),
  params_lcs_asser_curr_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_curr_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1"),
  params_lcs_energ_curr_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_curr_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1"),
  params_lcs_compa_curr_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_curr_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1"),
  params_lcs_respe_curr_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_curr_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1"),
  params_lcs_trust_curr_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_curr_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1"),
  params_lcs_organ_curr_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_curr_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1"),
  params_lcs_produ_curr_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_curr_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1"),
  params_lcs_respo_curr_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_curr_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1"),
  params_lcs_anxie_curr_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_curr_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1"),
  params_lcs_depre_curr_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_curr_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1"),
  params_lcs_volat_curr_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_curr_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1"),
  params_lcs_curio_curr_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_curr_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1"),
  params_lcs_aesth_curr_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_curr_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1"),
  params_lcs_imagi_curr_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_mod = estimate, std_mod = std.all, p_mod = p.value)

# combine
df_table_hyp6 <- df_table_hyp6_main %>% left_join(df_table_hyp6_mod)
```

Results summary across the Big Five traits: trait-specific change goals (*Goals*) and frequency of self-improvement behaviors (*Frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

kable(df_table_hyp6[1:10, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
No moderation effects that are significantly different from zero at p < .001. Only at p < .01 do we find a significant effect:  

- changes in current-level extraversion are moderated by the frequency of self-improvement behaviors  
:::

Results summary across the Big Five facets: trait-specific change goals (*goals*) and frequency of self-improvement behaviors (*frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp6[11:40, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
Looking at the facets, we only find one moderator effect that significantly differ from zero (p < .001) and two other effects at p < .05:  

- Within extraversion, we find the effect for the frequency of self-improvement behaviors from above represented in the facet sociability, and at p < .05 in energy (but in the other, unexpected direction).  
- Within openness, change in the curiosity facet is moderated by the frequency of self-improvement behaviors (at p < .01).  
:::

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_table_hyp6_plot <- bind_rows(
  #traits
  params_lcs_extra_curr_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_curr_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_curr_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_curr_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_curr_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_curr_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_curr_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_curr_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_curr_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_curr_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_curr_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1"),
  params_lcs_socia_curr_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_curr_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1"),
  params_lcs_asser_curr_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_curr_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1"),
  params_lcs_energ_curr_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_curr_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1"),
  params_lcs_compa_curr_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_curr_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1"),
  params_lcs_respe_curr_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_curr_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1"),
  params_lcs_trust_curr_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_curr_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1"),
  params_lcs_organ_curr_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_curr_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1"),
  params_lcs_produ_curr_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_curr_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1"),
  params_lcs_respo_curr_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_curr_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1"),
  params_lcs_anxie_curr_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_curr_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1"),
  params_lcs_depre_curr_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_curr_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1"),
  params_lcs_volat_curr_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_curr_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1"),
  params_lcs_curio_curr_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_curr_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1"),
  params_lcs_aesth_curr_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_curr_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1"),
  params_lcs_imagi_curr_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, estimate, 
         ci999lo, ci999hi, ci95lo, ci95hi, std.all, statistic, p.value)

df_table_hyp6_plot <- df_table_hyp6_plot %>% 
  mutate(include_0 = ifelse(ci999lo < 0 & ci999hi > 0, "n.s.", "*")) %>% 
  mutate(ref = factor("Current", levels = c("Current"), labels = c("Current"))) %>% 
  mutate(moderator = factor(moderator, levels = c("Goals", "Frequency"), 
                            labels = c("Goals", "Frequency"))) %>% 
  mutate(trait = factor(trait, levels = names(b5_vars), 
                        labels = stringr::str_to_title(names(b5_vars))))
```

Plotting the effect size across all analyses (only showing the moderation effects):  

- *Current* = current-level personality  
- *Goals* = specific, facet-level change goal(s) as moderator  
- *Frequency* = frequency of self-improvement behavior as moderator  

Important: these show both 99.9% and 95% confidence intervals (for better visual comparability with Study 1 plot)  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
#| code-fold: true
#| code-summary: "Show the code"
#| cache: false

ggplot(df_table_hyp6_plot, aes(x = fct_rev(trait), y = estimate, color = include_0)) +
  geom_hline(yintercept=0, linetype = 3) +
  geom_point(size=3, position=position_dodge(0.4)) + 
  geom_errorbar(aes(ymin = ci999lo, ymax = ci999hi, color = include_0), width=.2,
                position=position_dodge(0.4), size = 0.2, alpha = 0.75) +
  geom_errorbar(aes(ymin = ci95lo, ymax = ci95hi, color = include_0), width=.2,
                position=position_dodge(0.4)) +
  scale_color_manual(values = c("#000000","#A9A9A9")) +   
  facet_wrap( ~ ref + moderator, ncol = 2) +
  theme_bw() +
  scale_shape_manual(values=c(18)) + 
  ylab("Effect Estimates (99.9% / 95% CI)") +
  xlab("") +
  theme(legend.title=element_blank()) +
  theme(legend.text=element_text(size=12)) +
  coord_flip() +
  theme(strip.text.x = element_text(size = 12)) +
  theme(axis.text.x=element_text(size=10, angle = 45, hjust = 1), axis.text.y=element_text(size=12)) + 
  guides(color="none")
```

##### Summary: Ideal personality

Run models for all facets with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create df for table:

# main effects (change score)
df_table_hyp6_ideal_main <- bind_rows(
  #traits
  params_lcs_extra_ideal_specif_hyp6 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_extra_ideal_frequ_hyp6 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_agree_ideal_specif_hyp6 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_agree_ideal_frequ_hyp6 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_consc_ideal_specif_hyp6 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_consc_ideal_frequ_hyp6 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_neuro_ideal_specif_hyp6 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_neuro_ideal_frequ_hyp6 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_openn_ideal_specif_hyp6 %>% filter(term=="d_openn_1 ~1 "),
  params_lcs_openn_ideal_frequ_hyp6 %>% filter(term=="d_openn_1 ~1 "),
  #facets
  params_lcs_socia_ideal_specif_hyp6 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_socia_ideal_frequ_hyp6 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_asser_ideal_specif_hyp6 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_asser_ideal_frequ_hyp6 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_energ_ideal_specif_hyp6 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_energ_ideal_frequ_hyp6 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_compa_ideal_specif_hyp6 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_compa_ideal_frequ_hyp6 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_respe_ideal_specif_hyp6 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_respe_ideal_frequ_hyp6 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_trust_ideal_specif_hyp6 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_trust_ideal_frequ_hyp6 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_organ_ideal_specif_hyp6 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_organ_ideal_frequ_hyp6 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_produ_ideal_specif_hyp6 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_produ_ideal_frequ_hyp6 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_respo_ideal_specif_hyp6 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_respo_ideal_frequ_hyp6 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_anxie_ideal_specif_hyp6 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_anxie_ideal_frequ_hyp6 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_depre_ideal_specif_hyp6 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_depre_ideal_frequ_hyp6 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_volat_ideal_specif_hyp6 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_volat_ideal_frequ_hyp6 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_curio_ideal_specif_hyp6 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_curio_ideal_frequ_hyp6 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_aesth_ideal_specif_hyp6 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_aesth_ideal_frequ_hyp6 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_imagi_ideal_specif_hyp6 %>% filter(term=="d_imagi_1 ~1 "),
  params_lcs_imagi_ideal_frequ_hyp6 %>% filter(term=="d_imagi_1 ~1 ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_main = estimate, std_main = std.all, p_main = p.value)

# moderation effects
df_table_hyp6_ideal_mod <- bind_rows(
  #traits
  params_lcs_extra_ideal_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_ideal_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_ideal_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_ideal_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_ideal_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_ideal_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_ideal_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_ideal_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_ideal_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_ideal_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_ideal_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1"),
  params_lcs_socia_ideal_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_ideal_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1"),
  params_lcs_asser_ideal_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_ideal_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1"),
  params_lcs_energ_ideal_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_ideal_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1"),
  params_lcs_compa_ideal_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_ideal_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1"),
  params_lcs_respe_ideal_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_ideal_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1"),
  params_lcs_trust_ideal_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_ideal_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1"),
  params_lcs_organ_ideal_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_ideal_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1"),
  params_lcs_produ_ideal_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_ideal_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1"),
  params_lcs_respo_ideal_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_ideal_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1"),
  params_lcs_anxie_ideal_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_ideal_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1"),
  params_lcs_depre_ideal_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_ideal_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1"),
  params_lcs_volat_ideal_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_ideal_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1"),
  params_lcs_curio_ideal_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_ideal_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1"),
  params_lcs_aesth_ideal_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_ideal_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1"),
  params_lcs_imagi_ideal_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_mod = estimate, std_mod = std.all, p_mod = p.value)

# combine
df_table_hyp6_ideal <- df_table_hyp6_ideal_main %>% left_join(df_table_hyp6_ideal_mod)
```

Results summary across the Big Five traits: trait-specific change goals (*Goals*) and frequency of self-improvement behaviors (*Frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

kable(df_table_hyp6_ideal[1:10, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation effects at the domain level.  
:::

Results summary across the Big Five facets: trait-specific change goals (*Goals*) and frequency of self-improvement behaviors (*Frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp6_ideal[11:40, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation effects at the facet level (at p < .001).  
:::

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_table_hyp6_plot_ideal <- bind_rows(
  #traits
  params_lcs_extra_ideal_specif_hyp6 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_ideal_frequ_hyp6 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_ideal_specif_hyp6 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_ideal_frequ_hyp6 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_ideal_specif_hyp6 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_ideal_frequ_hyp6 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_ideal_specif_hyp6 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_ideal_frequ_hyp6 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_ideal_specif_hyp6 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_ideal_frequ_hyp6 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_ideal_specif_hyp6 %>% filter(term=="d_socia_1 ~ sb07_01_t1"),
  params_lcs_socia_ideal_frequ_hyp6 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_ideal_specif_hyp6 %>% filter(term=="d_asser_1 ~ sb07_02_t1"),
  params_lcs_asser_ideal_frequ_hyp6 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_ideal_specif_hyp6 %>% filter(term=="d_energ_1 ~ sb07_03_t1"),
  params_lcs_energ_ideal_frequ_hyp6 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_ideal_specif_hyp6 %>% filter(term=="d_compa_1 ~ sb07_04_t1"),
  params_lcs_compa_ideal_frequ_hyp6 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_ideal_specif_hyp6 %>% filter(term=="d_respe_1 ~ sb07_05_t1"),
  params_lcs_respe_ideal_frequ_hyp6 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_ideal_specif_hyp6 %>% filter(term=="d_trust_1 ~ sb07_06_t1"),
  params_lcs_trust_ideal_frequ_hyp6 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_ideal_specif_hyp6 %>% filter(term=="d_organ_1 ~ sb07_07_t1"),
  params_lcs_organ_ideal_frequ_hyp6 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_ideal_specif_hyp6 %>% filter(term=="d_produ_1 ~ sb07_08_t1"),
  params_lcs_produ_ideal_frequ_hyp6 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_ideal_specif_hyp6 %>% filter(term=="d_respo_1 ~ sb07_09_t1"),
  params_lcs_respo_ideal_frequ_hyp6 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_ideal_specif_hyp6 %>% filter(term=="d_anxie_1 ~ sb07_10_t1"),
  params_lcs_anxie_ideal_frequ_hyp6 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_ideal_specif_hyp6 %>% filter(term=="d_depre_1 ~ sb07_11_t1"),
  params_lcs_depre_ideal_frequ_hyp6 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_ideal_specif_hyp6 %>% filter(term=="d_volat_1 ~ sb07_12_t1"),
  params_lcs_volat_ideal_frequ_hyp6 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_ideal_specif_hyp6 %>% filter(term=="d_curio_1 ~ sb07_13_t1"),
  params_lcs_curio_ideal_frequ_hyp6 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_ideal_specif_hyp6 %>% filter(term=="d_aesth_1 ~ sb07_14_t1"),
  params_lcs_aesth_ideal_frequ_hyp6 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_ideal_specif_hyp6 %>% filter(term=="d_imagi_1 ~ sb07_15_t1"),
  params_lcs_imagi_ideal_frequ_hyp6 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, estimate, 
         ci999lo, ci999hi, ci95lo, ci95hi, std.all, statistic, p.value)

df_table_hyp6_plot_ideal <- df_table_hyp6_plot_ideal %>% 
  mutate(include_0 = ifelse(ci999lo < 0 & ci999hi > 0, "n.s.", "*")) %>% 
  mutate(ref = factor("Ideal", levels = c("Ideal"), labels = c("Ideal"))) %>% 
  mutate(moderator = factor(moderator, levels = c("Goals", "Frequency"), 
                            labels = c("Goals", "Frequency"))) %>% 
  mutate(trait = factor(trait, levels = names(b5_vars), 
                        labels = stringr::str_to_title(names(b5_vars))))
```

Plotting the effect size across all analyses (only showing the moderation effects):  

- *Ideal* = ideal-level personality  
- *Goals* = specific, facet-level change goal(s) as moderator  
- *Frequency* = frequency of self-improvement behavior as moderator  

Important: these show both 99.9% and 95% confidence intervals (for better visual comparability with Study 1 plot)  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
#| code-fold: true
#| code-summary: "Show the code"
#| cache: false

ggplot(df_table_hyp6_plot_ideal, aes(x = fct_rev(trait), y = estimate, color = include_0)) +
  geom_hline(yintercept=0, linetype = 3) +
  geom_point(size=3, position=position_dodge(0.4)) + 
  geom_errorbar(aes(ymin = ci999lo, ymax = ci999hi, color = include_0), width=.2,
                position=position_dodge(0.4), size = 0.2, alpha = 0.75) +
  geom_errorbar(aes(ymin = ci95lo, ymax = ci95hi, color = include_0), width=.2,
                position=position_dodge(0.4)) +
  scale_color_manual(values = c("#A9A9A9", "#000000")) + # reversed here because all n.s.
  facet_wrap( ~ ref + moderator, ncol = 2) +
  theme_bw() +
  scale_shape_manual(values=c(18)) + 
  ylab("Effect Estimates (99.9% / 95% CI)") +
  xlab("") +
  theme(legend.title=element_blank()) +
  theme(legend.text=element_text(size=12)) +
  coord_flip() +
  theme(strip.text.x = element_text(size = 12)) +
  theme(axis.text.x=element_text(size=10, angle = 45, hjust = 1), axis.text.y=element_text(size=12)) + 
  guides(color="none")
```

### H7: Desire to change and frequency of self-acceptance behaviors as moderators of change in personality in self-acceptance group {#hyp7}

*In the self-acceptance group, change in ideal-personality ratings but not change in current-personality ratings will be moderated by acceptance goals (both general and trait-/facet-specific goals) and the frequency of self-acceptance behaviors.* 

We will test this one domain/facet at a time. To test this hypothesis, we will estimate the mean-level difference across time for both current and ideal trait ratings using latent change models and specify acceptance goals (or the frequency of self-acceptance behaviors) as a moderator of latent trait change. We will check in a second set of models whether changes in ideal-personality ratings persist from T2 to T3.
 
Reshape and split data set by intervention group:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false

# from T! to T2
df_sbsa2_wide_pers_sa_mod <- df_sbsa2 %>% 
  filter(rando=="Self-Acceptance" & time %in% c(1,2)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sa07", # facet-specific acceptance goals
                                  "sa04"))) %>% # frequency self-acceptance behaviors
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with(c("sa07", "sa04")))) %>% 
  select(-c(sa07_01_t2, sa07_02_t2, sa07_03_t2, sa07_04_t2, sa07_05_t2, 
            sa07_06_t2, sa07_07_t2, sa07_08_t2, sa07_09_t2, sa07_10_t2, 
            sa07_11_t2, sa07_12_t2, sa07_13_t2, sa07_14_t2, sa07_15_t2, 
            sa04_01_t1, sa04_02_t1, sa04_03_t1)) # frequency of self-acceptance behaviors measured at T2
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sa_mod <- df_sbsa2_wide_pers_sa_mod %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sa_mod)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sa_mod)

group_assign <- df_sbsa2 %>% select(pid, rando) %>% unique()

df_sbsa2_wide_pers_sa_mod <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% 
  filter(rando=="Self-Acceptance") %>% select(-rando, -ends_with("_t3")) %>%
  left_join(df_sbsa2_wide_pers_sa_mod)

# follow-up, from T2 to T3
df_sbsa2_wide_pers_sa_mod_fu <- df_sbsa2 %>% 
  filter(rando=="Self-Acceptance" & time %in% c(1,2)) %>% 
  arrange(pid, time) %>% 
  select(pid, time, starts_with(c("sa07", # facet-specific change goals -> asked at T1
                                  "sa04"))) %>% # frequency self-improvement behaviors -> asked at T2
  pivot_wider(names_from = time,
              names_sep = "_t",
              values_from = c(starts_with(c("sa07", "sa04")))) %>% 
  select(-c(sa07_01_t2, sa07_02_t2, sa07_03_t2, sa07_04_t2, sa07_05_t2, 
            sa07_06_t2, sa07_07_t2, sa07_08_t2, sa07_09_t2, sa07_10_t2, 
            sa07_11_t2, sa07_12_t2, sa07_13_t2, sa07_14_t2, sa07_15_t2, 
            sa04_01_t1, sa04_02_t1, sa04_03_t1)) # frequency of self-improvement behaviors measured at T2
# standardize goal variables (better interpretation for when they are in SEM as a single manifest variable, not so much a problem when they form a latent scale)
df_sbsa2_wide_pers_sa_mod_fu <- df_sbsa2_wide_pers_sa_mod_fu %>% 
  mutate_at(c(colnames(df_sbsa2_wide_pers_sa_mod_fu)[-1]), ~(scale(.) %>% as.vector)) 
# colnames(df_sbsa2_wide_pers_sa_mod_fu)

df_sbsa2_wide_pers_sa_mod_fu <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% 
  filter(rando=="Self-Acceptance" & !is.na(valid_t2)) %>% select(-rando, -ends_with("_t1")) %>%
  left_join(df_sbsa2_wide_pers_sa_mod_fu)
```

#### Big Five traits (run models)

Run models for all traits with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates:

# 1st, for facet-specific acceptance goals

trait_template_mod_goal_accept <- '
trait_t1 =~ 1*ind01_t1 + lamb2*ind02_t1 + lamb3*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

goals =~ 1*ind_goal_1 + ind_goal_2 + ind_goal_3 # latent variable for moderator

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t1 ~ 1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ trait_t1         # This estimates the variance of trait_t1 
trait_t1 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t1 ~ goals           # This estimates the moderation effect on personality at T1
d_trait_1 ~ goals          # This estimates the moderation effect on the change score

goals ~ 0*1            # This fixes the intercept of the moderator to 0
goals ~~ goals         # This estimates the variance of the moderator

ind01_t1 ~~ ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ res1*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ res2*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ res3*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ res1*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ res2*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ res3*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ m3*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

ind_goal_1 ~~ ind_goal_1
ind_goal_2 ~~ ind_goal_2
ind_goal_3 ~~ ind_goal_3

ind_goal_1 ~ 1
ind_goal_2 ~ 1
ind_goal_3 ~ 1
'

trait_facets_nrs <- list(a1 = c(1:3), b2 = c(4:6), c3 = c(7:9), d4 = c(10:12), e5 = c(13:15)) # matching facet nrs to traits 

# loop across 5 traits -> change in ideal personality
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal (6 = ideal)
  # items = paste0(bfi_versions[[6]], item_nrs) # using parcels instead!
  mod_names = paste0("sa07_", str_pad(trait_facets_nrs[[i]], 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(trait_template_mod_goal_accept, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3"),
                                         "ind_goal_1" = mod_names[1], "ind_goal_2" = mod_names[2], "ind_goal_3" = mod_names[3]))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7")), trait_model_fit))
}  

# loop across 5 traits -> change in current personality
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal (6 = ideal)
  # items = paste0(bfi_versions[[6]], item_nrs) # using parcels instead!
  mod_names = paste0("sa07_", str_pad(trait_facets_nrs[[i]], 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(trait_template_mod_goal_accept, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), # current instead of ideal
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3"),
                                         "ind_goal_1" = mod_names[1], "ind_goal_2" = mod_names[2], "ind_goal_3" = mod_names[3]))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp7")), template_filled)) # current instead of ideal
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp7")), trait_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for ideal personality ratings)

trait_template_mod_goal_accept_fu <- '
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for trait_t2 
trait_t3 =~ 1*ind01_t3 + lamb2*ind02_t3 + lamb3*ind03_t3 # This specifies the measurement model for trait_t3 with the equality constrained factor loadings

goals =~ 1*ind_goal_1 + ind_goal_2 + ind_goal_3 # latent variable for moderator

trait_t3 ~ 1*trait_t2     # This parameter regresses trait_t3 perfectly on trait_t2
d_trait_1 =~ 1*trait_t3   # This defines the latent change score factor as measured perfectly by scores on trait_t3
trait_t3 ~ 0*1            # This line constrains the intercept of trait_t3 to 0
trait_t3 ~~ 0*trait_t3    # This fixes the variance of trait_t3 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t2 ~ 1               # This estimates the intercept of trait_t2 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t2 ~~ trait_t2         # This estimates the variance of trait_t2 
trait_t2 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t2 ~ goals           # This estimates the moderation effect on personality at T2
d_trait_1 ~ goals          # This estimates the moderation effect on the change score

goals ~ 0*1            # This fixes the intercept of the moderator to 0
goals ~~ goals         # This estimates the variance of the moderator

ind01_t2 ~~ ind01_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind02_t2 ~~ ind02_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind03_t2 ~~ ind03_t3   # This allows residual covariance on indicator X3 across T2 and T3

ind01_t2 ~~ res1*ind01_t2   # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ res2*ind02_t2   # This allows residual variance on indicator X2 at T2
ind03_t2 ~~ res3*ind03_t2   # This allows residual variance on indicator X3 at T2

ind01_t3 ~~ res1*ind01_t3  # This allows residual variance on indicator X1 at T3 
ind02_t3 ~~ res2*ind02_t3  # This allows residual variance on indicator X2 at T3 
ind03_t3 ~~ res3*ind03_t3  # This allows residual variance on indicator X3 at T3

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

ind01_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind02_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind03_t3 ~ m3*1     # This estimates the intercept of X3 at T3

ind_goal_1 ~~ ind_goal_1
ind_goal_2 ~~ ind_goal_2
ind_goal_3 ~~ ind_goal_3

ind_goal_1 ~ 1
ind_goal_2 ~ 1
ind_goal_3 ~ 1
'

# loop across 5 traits -> change in ideal personality (from T2 to T3)
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal (6 = ideal)
  # items = paste0(bfi_versions[[6]], item_nrs) # using parcels instead!
  mod_names = paste0("sa07_", str_pad(trait_facets_nrs[[i]], 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(trait_template_mod_goal_accept_fu, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3"),
                                         "ind_goal_1" = mod_names[1], "ind_goal_2" = mod_names[2], "ind_goal_3" = mod_names[3]))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7_fu")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7_fu")), trait_model_fit))
}  

# 2nd, for frequency of self-acceptance behavior

trait_template_mod_frequ_accept <- '
trait_t1 =~ 1*ind01_t1 + lamb2*ind02_t1 + lamb3*ind03_t1 # This specifies the measurement model for extra_t1 
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for extra_t2 with the equality constrained factor loadings

frequ =~ 1*sa04_01_t2 + sa04_02_t2 + sa04_03_t2 # latent variable for moderator

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t1 ~ 1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ trait_t1         # This estimates the variance of trait_t1 
trait_t1 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t1 ~ frequ           # This estimates the moderation effect on personality at T1
d_trait_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind01_t1 ~~ ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ res1*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ res2*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ res3*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ res1*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ res2*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ res3*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ m3*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

sa04_01_t2 ~~ sa04_01_t2
sa04_02_t2 ~~ sa04_02_t2
sa04_03_t2 ~~ sa04_03_t2

sa04_01_t2 ~ 1
sa04_02_t2 ~ 1
sa04_03_t2 ~ 1
'

# loop across 5 traits -> change in ideal personality
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  # items = paste0(bfi_versions[[6]], item_nrs) # using parcels instead!
  template_filled <- str_replace_all(trait_template_mod_frequ_accept, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7")), template_filled)) 
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7")), trait_model_fit))
}  

# loop across 5 traits -> change in current personality
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  # items = paste0(bfi_versions[[6]], item_nrs) # using parcels instead!
  template_filled <- str_replace_all(trait_template_mod_frequ_accept, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), # current instead of ideal
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp7")), template_filled)) # current instead of ideal
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp7")), trait_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for current personality ratings)

trait_template_mod_frequ_accept_fu <- '
trait_t2 =~ 1*ind01_t2 + lamb2*ind02_t2 + lamb3*ind03_t2 # This specifies the measurement model for extra_t2 
trait_t3 =~ 1*ind01_t3 + lamb2*ind02_t3 + lamb3*ind03_t3 # This specifies the measurement model for extra_t3 with the equality constrained factor loadings

frequ =~ 1*sa04_01_t2 + sa04_02_t2 + sa04_03_t2 # latent variable for moderator

trait_t3 ~ 1*trait_t2     # This parameter regresses trait_t3 perfectly on trait_t2
d_trait_1 =~ 1*trait_t3   # This defines the latent change score factor as measured perfectly by scores on trait_t3
trait_t3 ~ 0*1            # This line constrains the intercept of trait_t3 to 0
trait_t3 ~~ 0*trait_t3    # This fixes the variance of trait_t3 to 0

d_trait_1 ~ 1              # This estimates the intercept of the change score 
trait_t2 ~ 1               # This estimates the intercept of trait_t2 
d_trait_1 ~~ d_trait_1     # This estimates the variance of the change scores 
trait_t2 ~~ trait_t2         # This estimates the variance of trait_t2 
trait_t2 ~~ d_trait_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
trait_t2 ~ frequ           # This estimates the moderation effect on personality at T2
d_trait_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind01_t2 ~~ ind01_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind02_t2 ~~ ind02_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind03_t2 ~~ ind03_t3   # This allows residual covariance on indicator X3 across T2 and T3

ind01_t2 ~~ res1*ind01_t2   # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ res2*ind02_t2   # This allows residual variance on indicator X2 at T2
ind03_t2 ~~ res3*ind03_t2   # This allows residual variance on indicator X3 at T2

ind01_t3 ~~ res1*ind01_t3  # This allows residual variance on indicator X1 at T3 
ind02_t3 ~~ res2*ind02_t3  # This allows residual variance on indicator X2 at T3 
ind03_t3 ~~ res3*ind03_t3  # This allows residual variance on indicator X3 at T3

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ m3*1     # This estimates the intercept of X3 at T2

ind01_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind02_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind03_t3 ~ m3*1     # This estimates the intercept of X3 at T3

sa04_01_t2 ~~ sa04_01_t2
sa04_02_t2 ~~ sa04_02_t2
sa04_03_t2 ~~ sa04_03_t2

sa04_01_t2 ~ 1
sa04_02_t2 ~ 1
sa04_03_t2 ~ 1
'

# loop across 5 traits -> change in ideal personality (from T2 to T3)
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  # items = paste0(bfi_versions[[6]], item_nrs) # using parcels instead!
  template_filled <- str_replace_all(trait_template_mod_frequ_accept_fu, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7_fu")), template_filled)) 
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7_fu")), trait_model_fit))
}  
```

#### Big Five traits (ideal personality)

##### Extraversion: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ goals", "goals ~~ goals", "extra_t1 ~ goals", # acceptance goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the extraversion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_ideal_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_ideal_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Extraversion: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_extra_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ frequ", "frequ ~~ frequ", "extra_t1 ~ frequ", # frequency of self improvement
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the extraversion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_ideal_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_ideal_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ goals", "goals ~~ goals", "agree_t1 ~ goals", # acceptance goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the agreeableness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_ideal_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_ideal_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_agree_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ frequ", "frequ ~~ frequ", "agree_t1 ~ frequ", # frequency of self improvement
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the agreeableness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_ideal_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_ideal_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ goals", "goals ~~ goals", "consc_t1 ~ goals", # acceptance goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the conscientiousness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_ideal_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_ideal_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_consc_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ frequ", "frequ ~~ frequ", "consc_t1 ~ frequ", # frequency of self improvement
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the conscientiousness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_ideal_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_ideal_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(p.value), 3)`.  
:::

##### Neuroticism: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ goals", "goals ~~ goals", "neuro_t1 ~ goals", # acceptance goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the neuroticism change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_ideal_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_ideal_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_neuro_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ frequ", "frequ ~~ frequ", "neuro_t1 ~ frequ", # frequency of self improvement
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the neuroticism change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_ideal_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_ideal_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Openness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ goals", "goals ~~ goals", "openn_t1 ~ goals", # acceptance goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the openness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_ideal_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_ideal_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals") %>% pull(p.value), 3)`.
:::

##### Openness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_openn_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ frequ", "frequ ~~ frequ", "openn_t1 ~ frequ", # frequency of self improvement
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of frequency of self-acceptance behaviors with the openness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_ideal_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_ideal_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(p.value), 3)`.
:::

#### Big Five traits (ideal personality - follow-up at T3)

##### Extraversion: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t3 ~ extra_t2", "d_extra_1 =~ extra_t3", "extra_t2 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ goals", "goals ~~ goals", "extra_t2 ~ goals", # acceptance goals
                           "d_extra_1 ~1 ", "extra_t2 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the extraversion change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_ideal_specif_hyp7_fu %>% filter(term=="d_extra_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_ideal_specif_hyp7_fu %>% filter(term=="d_extra_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Extraversion: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_extra_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t3 ~ extra_t2", "d_extra_1 =~ extra_t3", "extra_t2 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ frequ", "frequ ~~ frequ", "extra_t2 ~ frequ", # frequency of self improvement
                           "d_extra_1 ~1 ", "extra_t2 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the extraversion change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_ideal_frequ_hyp7_fu %>% filter(term=="d_extra_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_ideal_frequ_hyp7_fu %>% filter(term=="d_extra_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t3 ~ agree_t2", "d_agree_1 =~ agree_t3", "agree_t2 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ goals", "goals ~~ goals", "agree_t2 ~ goals", # acceptance goals
                           "d_agree_1 ~1 ", "agree_t2 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the agreeableness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_ideal_specif_hyp7_fu %>% filter(term=="d_agree_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_ideal_specif_hyp7_fu %>% filter(term=="d_agree_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_agree_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t3 ~ agree_t2", "d_agree_1 =~ agree_t3", "agree_t2 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ frequ", "frequ ~~ frequ", "agree_t2 ~ frequ", # frequency of self improvement
                           "d_agree_1 ~1 ", "agree_t2 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the agreeableness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_ideal_frequ_hyp7_fu %>% filter(term=="d_agree_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_ideal_frequ_hyp7_fu %>% filter(term=="d_agree_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t3 ~ consc_t2", "d_consc_1 =~ consc_t3", "consc_t2 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ goals", "goals ~~ goals", "consc_t2 ~ goals", # acceptance goals
                           "d_consc_1 ~1 ", "consc_t2 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the conscientiousness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_ideal_specif_hyp7_fu %>% filter(term=="d_consc_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_ideal_specif_hyp7_fu %>% filter(term=="d_consc_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_consc_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t3 ~ consc_t2", "d_consc_1 =~ consc_t3", "consc_t2 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ frequ", "frequ ~~ frequ", "consc_t2 ~ frequ", # frequency of self improvement
                           "d_consc_1 ~1 ", "consc_t2 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the conscientiousness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_ideal_frequ_hyp7_fu %>% filter(term=="d_consc_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_ideal_frequ_hyp7_fu %>% filter(term=="d_consc_1 ~ frequ") %>% pull(p.value), 3)`.  
:::

##### Neuroticism: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t3 ~ neuro_t2", "d_neuro_1 =~ neuro_t3", "neuro_t2 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ goals", "goals ~~ goals", "neuro_t2 ~ goals", # acceptance goals
                           "d_neuro_1 ~1 ", "neuro_t2 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the neuroticism change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_ideal_specif_hyp7_fu %>% filter(term=="d_neuro_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_ideal_specif_hyp7_fu %>% filter(term=="d_neuro_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_neuro_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t3 ~ neuro_t2", "d_neuro_1 =~ neuro_t3", "neuro_t2 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ frequ", "frequ ~~ frequ", "neuro_t2 ~ frequ", # frequency of self improvement
                           "d_neuro_1 ~1 ", "neuro_t2 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the neuroticism change score from T2 to T3 (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_neuro_ideal_frequ_hyp7_fu %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_ideal_frequ_hyp7_fu %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Openness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t3 ~ openn_t2", "d_openn_1 =~ openn_t3", "openn_t2 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ goals", "goals ~~ goals", "openn_t2 ~ goals", # acceptance goals
                           "d_openn_1 ~1 ", "openn_t2 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the openness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_ideal_specif_hyp7_fu %>% filter(term=="d_openn_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_ideal_specif_hyp7_fu %>% filter(term=="d_openn_1 ~ goals") %>% pull(p.value), 3)`.
:::

##### Openness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_openn_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t3 ~ openn_t2", "d_openn_1 =~ openn_t3", "openn_t2 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ frequ", "frequ ~~ frequ", "openn_t2 ~ frequ", # frequency of self improvement
                           "d_openn_1 ~1 ", "openn_t2 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of frequency of self-acceptance behaviors with the openness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_ideal_frequ_hyp7_fu %>% filter(term=="d_openn_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_ideal_frequ_hyp7_fu %>% filter(term=="d_openn_1 ~ frequ") %>% pull(p.value), 3)`.
:::

#### Big Five traits (current personality)

##### Extraversion: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_extra_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ goals", "goals ~~ goals", "extra_t1 ~ goals", # acceptance goals
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the extraversion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_curr_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_curr_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Extraversion: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_extra_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_extra_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_extra_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_extra_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("extra_t2 ~ extra_t1", "d_extra_1 =~ extra_t2", "extra_t1 ~~ d_extra_1", # change parameters
                           "d_extra_1 ~ frequ", "frequ ~~ frequ", "extra_t1 ~ frequ", # frequency of self improvement
                           "d_extra_1 ~1 ", "extra_t1 ~1 ", "", # means
                           "d_extra_1 ~~ d_extra_1"))
kable(params_lcs_extra_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the extraversion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_extra_curr_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_extra_curr_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_agree_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ goals", "goals ~~ goals", "agree_t1 ~ goals", # acceptance goals
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the agreeableness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_curr_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_curr_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Agreeableness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_agree_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_agree_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_agree_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_agree_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("agree_t2 ~ agree_t1", "d_agree_1 =~ agree_t2", "agree_t1 ~~ d_agree_1", # change parameters
                           "d_agree_1 ~ frequ", "frequ ~~ frequ", "agree_t1 ~ frequ", # frequency of self improvement
                           "d_agree_1 ~1 ", "agree_t1 ~1 ", "", # means
                           "d_agree_1 ~~ d_agree_1"))
kable(params_lcs_agree_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the agreeableness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_agree_curr_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_agree_curr_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_consc_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ goals", "goals ~~ goals", "consc_t1 ~ goals", # acceptance goals
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the conscientiousness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_curr_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_curr_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Conscientiousness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_consc_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_consc_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_consc_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_consc_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("consc_t2 ~ consc_t1", "d_consc_1 =~ consc_t2", "consc_t1 ~~ d_consc_1", # change parameters
                           "d_consc_1 ~ frequ", "frequ ~~ frequ", "consc_t1 ~ frequ", # frequency of self improvement
                           "d_consc_1 ~1 ", "consc_t1 ~1 ", "", # means
                           "d_consc_1 ~~ d_consc_1"))
kable(params_lcs_consc_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the conscientiousness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_consc_curr_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_consc_curr_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ") %>% pull(p.value), 3)`.  
:::

##### Neuroticism: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ goals", "goals ~~ goals", "neuro_t1 ~ goals", # acceptance goals
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the neuroticism change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_neuro_curr_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_curr_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals") %>% pull(p.value), 3)`. 
:::

##### Neuroticism: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_neuro_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_neuro_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_neuro_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_neuro_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("neuro_t2 ~ neuro_t1", "d_neuro_1 =~ neuro_t2", "neuro_t1 ~~ d_neuro_1", # change parameters
                           "d_neuro_1 ~ frequ", "frequ ~~ frequ", "neuro_t1 ~ frequ", # frequency of self improvement
                           "d_neuro_1 ~1 ", "neuro_t1 ~1 ", "", # means
                           "d_neuro_1 ~~ d_neuro_1"))
kable(params_lcs_neuro_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the neuroticism change score (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_neuro_curr_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_neuro_curr_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Openness: specific, facet-level acceptance goals as moderator of change

Results summary (*goals* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_openn_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ goals", "goals ~~ goals", "openn_t1 ~ goals", # acceptance goals
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of specific, facet-level acceptance goals with the openness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_curr_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_curr_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals") %>% pull(p.value), 3)`.
:::

##### Openness: frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self improvement behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_openn_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_openn_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_openn_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_openn_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("openn_t2 ~ openn_t1", "d_openn_1 =~ openn_t2", "openn_t1 ~~ d_openn_1", # change parameters
                           "d_openn_1 ~ frequ", "frequ ~~ frequ", "openn_t1 ~ frequ", # frequency of self improvement
                           "d_openn_1 ~1 ", "openn_t1 ~1 ", "", # means
                           "d_openn_1 ~~ d_openn_1"))
kable(params_lcs_openn_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of frequency of self-acceptance behaviors with the openness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_openn_curr_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_openn_curr_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ") %>% pull(p.value), 3)`.
:::

#### Big Five facets (run models)

Run models for all facets with a template & loop:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates:

# 1st, for facet-specific acceptance goal

facet_template_mod_goal_accept <- '
facet_t1 =~ 1*ind1_t1 + lamb2*ind2_t1 + lamb3*ind3_t1 + lamb4*ind4_t1 # This specifies the measurement model for facet at T1
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2 (with equality constraints)

facet_t2 ~ 1*facet_t1     # This parameter regresses facet_t2 perfectly on facet_t1
d_facet_1 =~ 1*facet_t2   # This defines the latent change score factor as measured perfectly by scores on facet_t2
facet_t2 ~ 0*1            # This line constrains the intercept of facet_t2 to 0
facet_t2 ~~ 0*facet_t2    # This fixes the variance of facet_t2 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t1 ~ 1               # This estimates the intercept of facet_t1 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t1 ~~ facet_t1         # This estimates the variance of facet_t1 
facet_t1 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t1 ~ ind_goal        # This estimates the moderation effect on personality at T1
d_facet_1 ~ ind_goal       # This estimates the moderation effect on the change score

ind1_t1 ~~ ind1_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind2_t1 ~~ ind2_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind3_t1 ~~ ind3_t2   # This allows residual covariance on indicator X3 across T1 and T2
ind4_t1 ~~ ind4_t2   # This allows residual covariance on indicator X4 across T1 and T2

ind1_t1 ~~ res1*ind1_t1   # This allows residual variance on indicator X1 at T1 
ind2_t1 ~~ res2*ind2_t1   # This allows residual variance on indicator X2 at T1
ind3_t1 ~~ res3*ind3_t1   # This allows residual variance on indicator X3 at T1
ind4_t1 ~~ res4*ind4_t1   # This allows residual variance on indicator X4 at T1

ind1_t2 ~~ res1*ind1_t2  # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2  # This allows residual variance on indicator X2 at T2 
ind3_t2 ~~ res3*ind3_t2  # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2  # This allows residual variance on indicator X4 at T2

ind1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind3_t1 ~ m3*1     # This estimates the intercept of X3 at T1
ind4_t1 ~ m4*1     # This estimates the intercept of X4 at T1

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind_goal ~~ ind_goal
ind_goal ~ 1
'

# loop across 15 facets -> changes in ideal personality
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  items = paste0(bfi_versions[[6]], item_nrs)
  mod_name = paste0("sa07_", str_pad(i-5, 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(facet_template_mod_goal_accept, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                         "ind_goal" = mod_name))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7")), facet_model_fit))
}  

# loop across 15 facets -> changes in current personality
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  items = paste0(bfi_versions[[5]], item_nrs) # current instead of ideal!
  mod_name = paste0("sa07_", str_pad(i-5, 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(facet_template_mod_goal_accept, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                         "ind_goal" = mod_name))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp7")), template_filled)) # current instead of ideal!
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_specif_hyp7")), facet_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for ideal personality ratings)

facet_template_mod_goal_accept_fu <- '
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2
facet_t3 =~ 1*ind1_t3 + lamb2*ind2_t3 + lamb3*ind3_t3 + lamb4*ind4_t3 # This specifies the measurement model for facet at T3 (with equality constraints)

facet_t3 ~ 1*facet_t2     # This parameter regresses facet_t3 perfectly on facet_t2
d_facet_1 =~ 1*facet_t3   # This defines the latent change score factor as measured perfectly by scores on facet_t3
facet_t3 ~ 0*1            # This line constrains the intercept of facet_t3 to 0
facet_t3 ~~ 0*facet_t3    # This fixes the variance of facet_t3 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t2 ~ 1               # This estimates the intercept of facet_t2 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t2 ~~ facet_t2         # This estimates the variance of facet_t2 
facet_t2 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t2 ~ ind_goal        # This estimates the moderation effect on personality at T2
d_facet_1 ~ ind_goal       # This estimates the moderation effect on the change score

ind1_t2 ~~ ind1_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind2_t2 ~~ ind2_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind3_t2 ~~ ind3_t3   # This allows residual covariance on indicator X3 across T2 and T3
ind4_t2 ~~ ind4_t3   # This allows residual covariance on indicator X4 across T2 and T3

ind1_t2 ~~ res1*ind1_t2   # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2   # This allows residual variance on indicator X2 at T2
ind3_t2 ~~ res3*ind3_t2   # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2   # This allows residual variance on indicator X4 at T2

ind1_t3 ~~ res1*ind1_t3  # This allows residual variance on indicator X1 at T3 
ind2_t3 ~~ res2*ind2_t3  # This allows residual variance on indicator X2 at T3 
ind3_t3 ~~ res3*ind3_t3  # This allows residual variance on indicator X3 at T3
ind4_t3 ~~ res4*ind4_t3  # This allows residual variance on indicator X4 at T3

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind1_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind2_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind3_t3 ~ m3*1     # This estimates the intercept of X3 at T3
ind4_t3 ~ m4*1     # This estimates the intercept of X4 at T3

ind_goal ~~ ind_goal
ind_goal ~ 1
'

# loop across 15 facets -> changes in ideal personality (from T2 to T3)
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  items = paste0(bfi_versions[[6]], item_nrs)
  mod_name = paste0("sa07_", str_pad(i-5, 2, pad = "0"), "_t1")
  template_filled <- str_replace_all(facet_template_mod_goal_accept_fu, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4],
                                         "ind_goal" = mod_name))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7_fu")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_specif_hyp7_fu")), facet_model_fit))
}  

# 2nd, for frequency of self-acceptance behavior

facet_template_mod_frequ_accept <- '
facet_t1 =~ 1*ind1_t1 + lamb2*ind2_t1 + lamb3*ind3_t1 + lamb4*ind4_t1 # This specifies the measurement model for facet at T1
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2 (with equality constraints)

frequ =~ 1*sa04_01_t2 + sa04_02_t2 + sa04_03_t2 # latent variable for moderator

facet_t2 ~ 1*facet_t1     # This parameter regresses facet_t2 perfectly on facet_t1
d_facet_1 =~ 1*facet_t2   # This defines the latent change score factor as measured perfectly by scores on facet_t2
facet_t2 ~ 0*1            # This line constrains the intercept of facet_t2 to 0
facet_t2 ~~ 0*facet_t2    # This fixes the variance of facet_t2 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t1 ~ 1               # This estimates the intercept of facet_t1 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t1 ~~ facet_t1         # This estimates the variance of facet_t1 
facet_t1 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t1 ~ frequ           # This estimates the moderation effect on personality at T1
d_facet_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind1_t1 ~~ ind1_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind2_t1 ~~ ind2_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind3_t1 ~~ ind3_t2   # This allows residual covariance on indicator X3 across T1 and T2
ind4_t1 ~~ ind4_t2   # This allows residual covariance on indicator X4 across T1 and T2

ind1_t1 ~~ res1*ind1_t1   # This allows residual variance on indicator X1 at T1 
ind2_t1 ~~ res2*ind2_t1   # This allows residual variance on indicator X2 at T1
ind3_t1 ~~ res3*ind3_t1   # This allows residual variance on indicator X3 at T1
ind4_t1 ~~ res4*ind4_t1   # This allows residual variance on indicator X4 at T1

ind1_t2 ~~ res1*ind1_t2  # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2  # This allows residual variance on indicator X2 at T2 
ind3_t2 ~~ res3*ind3_t2  # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2  # This allows residual variance on indicator X4 at T2

ind1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind2_t1 ~ m2*1     # This estimates the intercept of X2 at T1
ind3_t1 ~ m3*1     # This estimates the intercept of X3 at T1
ind4_t1 ~ m4*1     # This estimates the intercept of X4 at T1

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

sa04_01_t2 ~~ sa04_01_t2
sa04_02_t2 ~~ sa04_02_t2
sa04_03_t2 ~~ sa04_03_t2

sa04_01_t2 ~ 1
sa04_02_t2 ~ 1
sa04_03_t2 ~ 1
'

# loop across 15 facets -> changes in ideal personality
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  items = paste0(bfi_versions[[6]], item_nrs)
  template_filled <- str_replace_all(facet_template_mod_frequ_accept, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4]))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7")), facet_model_fit))
}  

# loop across 15 facets -> changes in current personality
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  items = paste0(bfi_versions[[5]], item_nrs) # current instead of ideal!
  template_filled <- str_replace_all(facet_template_mod_frequ_accept, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4]))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp7")), template_filled)) # current instead of ideal!
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[5], 6), "_frequ_hyp7")), facet_model_fit))
}  

# we also need separate models for follow-up (fu), that is, changes from T2 to T3 (only for ideal personality ratings)

facet_template_mod_frequ_accept_fu <- '
facet_t2 =~ 1*ind1_t2 + lamb2*ind2_t2 + lamb3*ind3_t2 + lamb4*ind4_t2 # This specifies the measurement model for facet at T2
facet_t3 =~ 1*ind1_t3 + lamb2*ind2_t3 + lamb3*ind3_t3 + lamb4*ind4_t3 # This specifies the measurement model for facet at T3 (with equality constraints)

frequ =~ 1*sa04_01_t2 + sa04_02_t2 + sa04_03_t2 # latent variable for moderator

facet_t3 ~ 1*facet_t2     # This parameter regresses facet_t3 perfectly on facet_t2
d_facet_1 =~ 1*facet_t3   # This defines the latent change score factor as measured perfectly by scores on facet_t3
facet_t3 ~ 0*1            # This line constrains the intercept of facet_t3 to 0
facet_t3 ~~ 0*facet_t3    # This fixes the variance of facet_t3 to 0

d_facet_1 ~ 1              # This estimates the intercept of the change score 
facet_t2 ~ 1               # This estimates the intercept of facet_t2 
d_facet_1 ~~ d_facet_1     # This estimates the variance of the change scores 
facet_t2 ~~ facet_t2         # This estimates the variance of facet_t2 
facet_t2 ~~ d_facet_1      # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional
facet_t2 ~ frequ           # This estimates the moderation effect on personality at T2
d_facet_1 ~ frequ          # This estimates the moderation effect on the change score

frequ ~ 0*1          # This fixes the intercept of the moderator to 0
frequ ~~ frequ         # This estimates the variance of the moderator

ind1_t2 ~~ ind1_t3   # This allows residual covariance on indicator X1 across T2 and T3
ind2_t2 ~~ ind2_t3   # This allows residual covariance on indicator X2 across T2 and T3
ind3_t2 ~~ ind3_t3   # This allows residual covariance on indicator X3 across T2 and T3
ind4_t2 ~~ ind4_t3   # This allows residual covariance on indicator X4 across T2 and T3

ind1_t2 ~~ res1*ind1_t2   # This allows residual variance on indicator X1 at T2 
ind2_t2 ~~ res2*ind2_t2   # This allows residual variance on indicator X2 at T2
ind3_t2 ~~ res3*ind3_t2   # This allows residual variance on indicator X3 at T2
ind4_t2 ~~ res4*ind4_t2   # This allows residual variance on indicator X4 at T2

ind1_t3 ~~ res1*ind1_t3  # This allows residual variance on indicator X1 at T3 
ind2_t3 ~~ res2*ind2_t3  # This allows residual variance on indicator X2 at T3 
ind3_t3 ~~ res3*ind3_t3  # This allows residual variance on indicator X3 at T3
ind4_t3 ~~ res4*ind4_t3  # This allows residual variance on indicator X4 at T3

ind1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind2_t2 ~ m2*1     # This estimates the intercept of X2 at T2
ind3_t2 ~ m3*1     # This estimates the intercept of X3 at T2
ind4_t2 ~ m4*1     # This estimates the intercept of X4 at T2

ind1_t3 ~ 0*1      # This constrains the intercept of X1 to 0 at T3
ind2_t3 ~ m2*1     # This estimates the intercept of X2 at T3
ind3_t3 ~ m3*1     # This estimates the intercept of X3 at T3
ind4_t3 ~ m4*1     # This estimates the intercept of X4 at T3

sa04_01_t2 ~~ sa04_01_t2
sa04_02_t2 ~~ sa04_02_t2
sa04_03_t2 ~~ sa04_03_t2

sa04_01_t2 ~ 1
sa04_02_t2 ~ 1
sa04_03_t2 ~ 1
'

# loop across 15 facets -> changes in ideal personality
for (i in 6:length(b5_vars)) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # use BFI version combined pre&post ideal
  items = paste0(bfi_versions[[6]], item_nrs)
  template_filled <- str_replace_all(facet_template_mod_frequ_accept_fu, 
                                       c("facet" = short_name,
                                         "ind1" = items[1], "ind2" = items[2], "ind3" = items[3], "ind4" = items[4]))
  facet_model_fit <- lavaan(template_filled, data=df_sbsa2_wide_pers_sa_mod_fu, estimator='mlr', fixed.x=FALSE, missing='fiml')
  eval(call("<-", as.name(paste0("mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7_fu")), template_filled))
  eval(call("<-", as.name(paste0("fit_mi_lcs_", short_name, "_", 
                                     str_sub(names(bfi_versions)[6], 6), "_frequ_hyp7_fu")), facet_model_fit))
} 
```

#### Big Five facets (ideal personality)

##### Sociability - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~ sa07_01_t1", "sa07_01_t1 ~~ sa07_01_t1", "d_socia_1 ~ sa07_01_t1", # acceptance goals
                     "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the sociability change score (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_socia_ideal_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_ideal_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_socia_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~ frequ", "frequ ~~ frequ", "socia_t1 ~ frequ", # frequency of self improvement
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with sociability change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_socia_ideal_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_ideal_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~ sa07_02_t1", "sa07_02_t1 ~~ sa07_02_t1", "d_asser_1 ~ sa07_02_t1", # acceptance goals
                     "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the assertiveness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_ideal_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_ideal_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_asser_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~ frequ", "frequ ~~ frequ", "asser_t1 ~ frequ", # frequency of self improvement
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with assertiveness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_ideal_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_ideal_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Energy - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~ sa07_03_t1", "sa07_03_t1 ~~ sa07_03_t1", "d_energ_1 ~ sa07_03_t1", # acceptance goals
                     "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the energy change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_ideal_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_ideal_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_energ_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~ frequ", "frequ ~~ frequ", "energ_t1 ~ frequ", # frequency of self improvement
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the energy change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_ideal_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_ideal_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Compassion - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~ sa07_04_t1", "sa07_04_t1 ~~ sa07_04_t1", "d_compa_1 ~ sa07_04_t1", # acceptance goals
                     "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the compassion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_ideal_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_ideal_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_compa_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~ frequ", "frequ ~~ frequ", "compa_t1 ~ frequ", # frequency of self improvement
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the compassion change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_ideal_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_ideal_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~ sa07_05_t1", "sa07_05_t1 ~~ sa07_05_t1", "d_respe_1 ~ sa07_05_t1", # acceptance goals
                     "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the respectfulness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_ideal_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_ideal_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_respe_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~ frequ", "frequ ~~ frequ", "respe_t1 ~ frequ", # frequency of self improvement
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with respectfulness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_ideal_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_ideal_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Trust - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~ sa07_06_t1", "sa07_06_t1 ~~ sa07_06_t1", "d_trust_1 ~ sa07_06_t1", # acceptance goals
                     "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the trust change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_ideal_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_ideal_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_trust_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~ frequ", "frequ ~~ frequ", "trust_t1 ~ frequ", # frequency of self improvement
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the trust change score (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_trust_ideal_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_ideal_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Organization - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~ sa07_07_t1", "sa07_07_t1 ~~ sa07_07_t1", "d_organ_1 ~ sa07_07_t1", # acceptance goals
                     "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the organization change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_ideal_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_ideal_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_organ_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~ frequ", "frequ ~~ frequ", "organ_t1 ~ frequ", # frequency of self improvement
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the organization change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_ideal_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_ideal_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Productiveness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~ sa07_08_t1", "sa07_08_t1 ~~ sa07_08_t1", "d_produ_1 ~ sa07_08_t1", # acceptance goals
                     "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the productiveness change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_ideal_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_ideal_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_produ_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~ frequ", "frequ ~~ frequ", "produ_t1 ~ frequ", # frequency of self improvement
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the productiveness change score (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_produ_ideal_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_ideal_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Responsibility - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~ sa07_09_t1", "sa07_09_t1 ~~ sa07_09_t1", "d_respo_1 ~ sa07_09_t1", # acceptance goals
                     "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the responsibility change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_ideal_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_ideal_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_respo_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~ frequ", "frequ ~~ frequ", "respo_t1 ~ frequ", # frequency of self improvement
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the responsibility change score (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_respo_ideal_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_ideal_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Anxiety - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~ sa07_10_t1", "sa07_10_t1 ~~ sa07_10_t1", "d_anxie_1 ~ sa07_10_t1", # acceptance goals
                     "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the anxiety change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_ideal_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_ideal_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_anxie_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~ frequ", "frequ ~~ frequ", "anxie_t1 ~ frequ", # frequency of self improvement
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the anxiety change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_ideal_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_ideal_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Depression - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~ sa07_11_t1", "sa07_11_t1 ~~ sa07_11_t1", "d_depre_1 ~ sa07_11_t1", # acceptance goals
                     "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the depression change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_ideal_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_ideal_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_depre_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~ frequ", "frequ ~~ frequ", "depre_t1 ~ frequ", # frequency of self improvement
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the depression change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_ideal_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_ideal_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Volatility - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~ sa07_12_t1", "sa07_12_t1 ~~ sa07_12_t1", "d_volat_1 ~ sa07_12_t1", # acceptance goals
                     "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the volatility change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_ideal_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_ideal_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_volat_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~ frequ", "frequ ~~ frequ", "volat_t1 ~ frequ", # frequency of self improvement
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the volatility change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_ideal_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_ideal_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Curiosity - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~ sa07_13_t1", "sa07_13_t1 ~~ sa07_13_t1", "d_curio_1 ~ sa07_13_t1", # acceptance goals
                     "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the curiosity change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_ideal_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_ideal_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_curio_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~ frequ", "frequ ~~ frequ", "curio_t1 ~ frequ", # frequency of self improvement
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the curiosity change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_ideal_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_ideal_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~ sa07_14_t1", "sa07_14_t1 ~~ sa07_14_t1", "d_aesth_1 ~ sa07_14_t1", # acceptance goals
                     "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the aesthetic change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_ideal_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_ideal_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_aesth_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~ frequ", "frequ ~~ frequ", "aesth_t1 ~ frequ", # frequency of self improvement
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the aesthetic change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_ideal_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_ideal_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Imagination - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_$$_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_specif_hyp7 <- broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~ sa07_15_t1", "sa07_15_t1 ~~ sa07_15_t1", "d_imagi_1 ~ sa07_15_t1", # acceptance goals
                     "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the imagination change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_ideal_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_ideal_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_frequ_hyp7 <- broom::tidy(fit_mi_lcs_imagi_ideal_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_ideal_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~ frequ", "frequ ~~ frequ", "imagi_t1 ~ frequ", # frequency of self improvement
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the imagination change score (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_ideal_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_ideal_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Big Five facets (ideal personality - follow-up T3)

##### Sociability - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("socia_t3 ~ socia_t2", "d_socia_1 =~ socia_t3", "socia_t2 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~ sa07_01_t1", "sa07_01_t1 ~~ sa07_01_t1", "d_socia_1 ~ sa07_01_t1", # acceptance goals
                     "d_socia_1 ~1 ", "socia_t2 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the sociability change score from T2 to T3 (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_socia_ideal_specif_hyp7_fu %>% filter(term=="d_socia_1 ~ sa07_01_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_ideal_specif_hyp7_fu %>% filter(term=="d_socia_1 ~ sa07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_socia_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("socia_t3 ~ socia_t2", "d_socia_1 =~ socia_t3", "socia_t2 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~ frequ", "frequ ~~ frequ", "socia_t2 ~ frequ", # frequency of self improvement
                           "d_socia_1 ~1 ", "socia_t2 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with sociability change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_socia_ideal_frequ_hyp7_fu %>% filter(term=="d_socia_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_ideal_frequ_hyp7_fu %>% filter(term=="d_socia_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("asser_t3 ~ asser_t2", "d_asser_1 =~ asser_t3", "asser_t2 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~ sa07_02_t1", "sa07_02_t1 ~~ sa07_02_t1", "d_asser_1 ~ sa07_02_t1", # acceptance goals
                     "d_asser_1 ~1 ", "asser_t2 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the assertiveness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_ideal_specif_hyp7_fu %>% filter(term=="d_asser_1 ~ sa07_02_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_ideal_specif_hyp7_fu %>% filter(term=="d_asser_1 ~ sa07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_asser_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("asser_t3 ~ asser_t2", "d_asser_1 =~ asser_t3", "asser_t2 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~ frequ", "frequ ~~ frequ", "asser_t2 ~ frequ", # frequency of self improvement
                           "d_asser_1 ~1 ", "asser_t2 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with assertiveness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_ideal_frequ_hyp7_fu %>% filter(term=="d_asser_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_ideal_frequ_hyp7_fu %>% filter(term=="d_asser_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Energy - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("energ_t3 ~ energ_t2", "d_energ_1 =~ energ_t3", "energ_t2 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~ sa07_03_t1", "sa07_03_t1 ~~ sa07_03_t1", "d_energ_1 ~ sa07_03_t1", # acceptance goals
                     "d_energ_1 ~1 ", "energ_t2 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the energy change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_ideal_specif_hyp7_fu %>% filter(term=="d_energ_1 ~ sa07_03_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_ideal_specif_hyp7_fu %>% filter(term=="d_energ_1 ~ sa07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_energ_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("energ_t3 ~ energ_t2", "d_energ_1 =~ energ_t3", "energ_t2 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~ frequ", "frequ ~~ frequ", "energ_t2 ~ frequ", # frequency of self improvement
                           "d_energ_1 ~1 ", "energ_t2 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the energy change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_ideal_frequ_hyp7_fu %>% filter(term=="d_energ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_ideal_frequ_hyp7_fu %>% filter(term=="d_energ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Compassion - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("compa_t3 ~ compa_t2", "d_compa_1 =~ compa_t3", "compa_t2 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~ sa07_04_t1", "sa07_04_t1 ~~ sa07_04_t1", "d_compa_1 ~ sa07_04_t1", # acceptance goals
                     "d_compa_1 ~1 ", "compa_t2 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the compassion change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_ideal_specif_hyp7_fu %>% filter(term=="d_compa_1 ~ sa07_04_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_ideal_specif_hyp7_fu %>% filter(term=="d_compa_1 ~ sa07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_compa_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("compa_t3 ~ compa_t2", "d_compa_1 =~ compa_t3", "compa_t2 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~ frequ", "frequ ~~ frequ", "compa_t2 ~ frequ", # frequency of self improvement
                           "d_compa_1 ~1 ", "compa_t2 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the compassion change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_ideal_frequ_hyp7_fu %>% filter(term=="d_compa_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_ideal_frequ_hyp7_fu %>% filter(term=="d_compa_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respe_t3 ~ respe_t2", "d_respe_1 =~ respe_t3", "respe_t2 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~ sa07_05_t1", "sa07_05_t1 ~~ sa07_05_t1", "d_respe_1 ~ sa07_05_t1", # acceptance goals
                     "d_respe_1 ~1 ", "respe_t2 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the respectfulness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_ideal_specif_hyp7_fu %>% filter(term=="d_respe_1 ~ sa07_05_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_ideal_specif_hyp7_fu %>% filter(term=="d_respe_1 ~ sa07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_respe_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respe_t3 ~ respe_t2", "d_respe_1 =~ respe_t3", "respe_t2 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~ frequ", "frequ ~~ frequ", "respe_t2 ~ frequ", # frequency of self improvement
                           "d_respe_1 ~1 ", "respe_t2 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with respectfulness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_ideal_frequ_hyp7_fu %>% filter(term=="d_respe_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_ideal_frequ_hyp7_fu %>% filter(term=="d_respe_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Trust - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("trust_t3 ~ trust_t2", "d_trust_1 =~ trust_t3", "trust_t2 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~ sa07_06_t1", "sa07_06_t1 ~~ sa07_06_t1", "d_trust_1 ~ sa07_06_t1", # acceptance goals
                     "d_trust_1 ~1 ", "trust_t2 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the trust change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_ideal_specif_hyp7_fu %>% filter(term=="d_trust_1 ~ sa07_06_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_ideal_specif_hyp7_fu %>% filter(term=="d_trust_1 ~ sa07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_trust_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("trust_t3 ~ trust_t2", "d_trust_1 =~ trust_t3", "trust_t2 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~ frequ", "frequ ~~ frequ", "trust_t2 ~ frequ", # frequency of self improvement
                           "d_trust_1 ~1 ", "trust_t2 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the trust change score from T2 to T3 (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_trust_ideal_frequ_hyp7_fu %>% filter(term=="d_trust_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_ideal_frequ_hyp7_fu %>% filter(term=="d_trust_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Organization - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("organ_t3 ~ organ_t2", "d_organ_1 =~ organ_t3", "organ_t2 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~ sa07_07_t1", "sa07_07_t1 ~~ sa07_07_t1", "d_organ_1 ~ sa07_07_t1", # acceptance goals
                     "d_organ_1 ~1 ", "organ_t2 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the organization change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_ideal_specif_hyp7_fu %>% filter(term=="d_organ_1 ~ sa07_07_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_ideal_specif_hyp7_fu %>% filter(term=="d_organ_1 ~ sa07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_organ_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("organ_t3 ~ organ_t2", "d_organ_1 =~ organ_t3", "organ_t2 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~ frequ", "frequ ~~ frequ", "organ_t2 ~ frequ", # frequency of self improvement
                           "d_organ_1 ~1 ", "organ_t2 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the organization change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_ideal_frequ_hyp7_fu %>% filter(term=="d_organ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_ideal_frequ_hyp7_fu %>% filter(term=="d_organ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Productiveness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("produ_t3 ~ produ_t2", "d_produ_1 =~ produ_t3", "produ_t2 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~ sa07_08_t1", "sa07_08_t1 ~~ sa07_08_t1", "d_produ_1 ~ sa07_08_t1", # acceptance goals
                     "d_produ_1 ~1 ", "produ_t2 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the productiveness change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_ideal_specif_hyp7_fu %>% filter(term=="d_produ_1 ~ sa07_08_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_ideal_specif_hyp7_fu %>% filter(term=="d_produ_1 ~ sa07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_produ_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("produ_t3 ~ produ_t2", "d_produ_1 =~ produ_t3", "produ_t2 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~ frequ", "frequ ~~ frequ", "produ_t2 ~ frequ", # frequency of self improvement
                           "d_produ_1 ~1 ", "produ_t2 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the productiveness change score from T2 to T3 (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_produ_ideal_frequ_hyp7_fu %>% filter(term=="d_produ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_ideal_frequ_hyp7_fu %>% filter(term=="d_produ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Responsibility - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respo_t3 ~ respo_t2", "d_respo_1 =~ respo_t3", "respo_t2 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~ sa07_09_t1", "sa07_09_t1 ~~ sa07_09_t1", "d_respo_1 ~ sa07_09_t1", # acceptance goals
                     "d_respo_1 ~1 ", "respo_t2 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the responsibility change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_ideal_specif_hyp7_fu %>% filter(term=="d_respo_1 ~ sa07_09_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_ideal_specif_hyp7_fu %>% filter(term=="d_respo_1 ~ sa07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_respo_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respo_t3 ~ respo_t2", "d_respo_1 =~ respo_t3", "respo_t2 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~ frequ", "frequ ~~ frequ", "respo_t2 ~ frequ", # frequency of self improvement
                           "d_respo_1 ~1 ", "respo_t2 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the responsibility change score from T2 to T3 (ideal-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_respo_ideal_frequ_hyp7_fu %>% filter(term=="d_respo_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_ideal_frequ_hyp7_fu %>% filter(term=="d_respo_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Anxiety - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("anxie_t3 ~ anxie_t2", "d_anxie_1 =~ anxie_t3", "anxie_t2 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~ sa07_10_t1", "sa07_10_t1 ~~ sa07_10_t1", "d_anxie_1 ~ sa07_10_t1", # acceptance goals
                     "d_anxie_1 ~1 ", "anxie_t2 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the anxiety change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_ideal_specif_hyp7_fu %>% filter(term=="d_anxie_1 ~ sa07_10_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_ideal_specif_hyp7_fu %>% filter(term=="d_anxie_1 ~ sa07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_anxie_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("anxie_t3 ~ anxie_t2", "d_anxie_1 =~ anxie_t3", "anxie_t2 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~ frequ", "frequ ~~ frequ", "anxie_t2 ~ frequ", # frequency of self improvement
                           "d_anxie_1 ~1 ", "anxie_t2 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the anxiety change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_ideal_frequ_hyp7_fu %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_ideal_frequ_hyp7_fu %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Depression - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("depre_t3 ~ depre_t2", "d_depre_1 =~ depre_t3", "depre_t2 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~ sa07_11_t1", "sa07_11_t1 ~~ sa07_11_t1", "d_depre_1 ~ sa07_11_t1", # acceptance goals
                     "d_depre_1 ~1 ", "depre_t2 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the depression change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_ideal_specif_hyp7_fu %>% filter(term=="d_depre_1 ~ sa07_11_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_ideal_specif_hyp7_fu %>% filter(term=="d_depre_1 ~ sa07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_depre_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("depre_t3 ~ depre_t2", "d_depre_1 =~ depre_t3", "depre_t2 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~ frequ", "frequ ~~ frequ", "depre_t2 ~ frequ", # frequency of self improvement
                           "d_depre_1 ~1 ", "depre_t2 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the depression change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_ideal_frequ_hyp7_fu %>% filter(term=="d_depre_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_ideal_frequ_hyp7_fu %>% filter(term=="d_depre_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Volatility - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("volat_t3 ~ volat_t2", "d_volat_1 =~ volat_t3", "volat_t2 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~ sa07_12_t1", "sa07_12_t1 ~~ sa07_12_t1", "d_volat_1 ~ sa07_12_t1", # acceptance goals
                     "d_volat_1 ~1 ", "volat_t2 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the volatility change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_ideal_specif_hyp7_fu %>% filter(term=="d_volat_1 ~ sa07_12_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_ideal_specif_hyp7_fu %>% filter(term=="d_volat_1 ~ sa07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_volat_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("volat_t3 ~ volat_t2", "d_volat_1 =~ volat_t3", "volat_t2 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~ frequ", "frequ ~~ frequ", "volat_t2 ~ frequ", # frequency of self improvement
                           "d_volat_1 ~1 ", "volat_t2 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the volatility change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_ideal_frequ_hyp7_fu %>% filter(term=="d_volat_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_ideal_frequ_hyp7_fu %>% filter(term=="d_volat_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Curiosity - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("curio_t3 ~ curio_t2", "d_curio_1 =~ curio_t3", "curio_t2 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~ sa07_13_t1", "sa07_13_t1 ~~ sa07_13_t1", "d_curio_1 ~ sa07_13_t1", # acceptance goals
                     "d_curio_1 ~1 ", "curio_t2 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the curiosity change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_ideal_specif_hyp7_fu %>% filter(term=="d_curio_1 ~ sa07_13_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_ideal_specif_hyp7_fu %>% filter(term=="d_curio_1 ~ sa07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_curio_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("curio_t3 ~ curio_t2", "d_curio_1 =~ curio_t3", "curio_t2 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~ frequ", "frequ ~~ frequ", "curio_t2 ~ frequ", # frequency of self improvement
                           "d_curio_1 ~1 ", "curio_t2 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the curiosity change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_ideal_frequ_hyp7_fu %>% filter(term=="d_curio_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_ideal_frequ_hyp7_fu %>% filter(term=="d_curio_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("aesth_t3 ~ aesth_t2", "d_aesth_1 =~ aesth_t3", "aesth_t2 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~ sa07_14_t1", "sa07_14_t1 ~~ sa07_14_t1", "d_aesth_1 ~ sa07_14_t1", # acceptance goals
                     "d_aesth_1 ~1 ", "aesth_t2 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the aesthetic change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_ideal_specif_hyp7_fu %>% filter(term=="d_aesth_1 ~ sa07_14_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_ideal_specif_hyp7_fu %>% filter(term=="d_aesth_1 ~ sa07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# model fit
kable(broom::glance(fit_mi_lcs_aesth_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_aesth_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("aesth_t3 ~ aesth_t2", "d_aesth_1 =~ aesth_t3", "aesth_t2 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~ frequ", "frequ ~~ frequ", "aesth_t2 ~ frequ", # frequency of self improvement
                           "d_aesth_1 ~1 ", "aesth_t2 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the aesthetic change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_ideal_frequ_hyp7_fu %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_ideal_frequ_hyp7_fu %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Imagination - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_specif_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_specif_hyp7_fu <- broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_ideal_specif_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("imagi_t3 ~ imagi_t2", "d_imagi_1 =~ imagi_t3", "imagi_t2 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~ sa07_15_t1", "sa07_15_t1 ~~ sa07_15_t1", "d_imagi_1 ~ sa07_15_t1", # acceptance goals
                     "d_imagi_1 ~1 ", "imagi_t2 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_specif_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the imagination change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_ideal_specif_hyp7_fu %>% filter(term=="d_imagi_1 ~ sa07_15_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_ideal_specif_hyp7_fu %>% filter(term=="d_imagi_1 ~ sa07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_ideal_frequ_hyp7_fu) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_ideal_frequ_hyp7_fu <- broom::tidy(fit_mi_lcs_imagi_ideal_frequ_hyp7_fu, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_ideal_frequ_hyp7_fu,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("imagi_t3 ~ imagi_t2", "d_imagi_1 =~ imagi_t3", "imagi_t2 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~ frequ", "frequ ~~ frequ", "imagi_t2 ~ frequ", # frequency of self improvement
                           "d_imagi_1 ~1 ", "imagi_t2 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_ideal_frequ_hyp7_fu, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the imagination change score from T2 to T3 (ideal-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_ideal_frequ_hyp7_fu %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_ideal_frequ_hyp7_fu %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Big Five facets (current personality)

##### Sociability - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_socia_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                     "d_socia_1 ~ sa07_01_t1", "sa07_01_t1 ~~ sa07_01_t1", "d_socia_1 ~ sa07_01_t1", # acceptance goals
                     "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                     "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the sociability change score (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_socia_curr_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_curr_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1") %>% pull(p.value), 3)`. 
:::

##### Sociability - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_socia_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_socia_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_socia_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_socia_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("socia_t2 ~ socia_t1", "d_socia_1 =~ socia_t2", "socia_t1 ~~ d_socia_1", # change parameters
                           "d_socia_1 ~ frequ", "frequ ~~ frequ", "socia_t1 ~ frequ", # frequency of self improvement
                           "d_socia_1 ~1 ", "socia_t1 ~1 ", "", # means
                           "d_socia_1 ~~ d_socia_1"))
kable(params_lcs_socia_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with sociability change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_socia_curr_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_socia_curr_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_asser_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                     "d_asser_1 ~ sa07_02_t1", "sa07_02_t1 ~~ sa07_02_t1", "d_asser_1 ~ sa07_02_t1", # acceptance goals
                     "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                     "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the assertiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_curr_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_curr_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1") %>% pull(p.value), 3)`. 
:::

##### Assertiveness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_asser_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_asser_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_asser_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_asser_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("asser_t2 ~ asser_t1", "d_asser_1 =~ asser_t2", "asser_t1 ~~ d_asser_1", # change parameters
                           "d_asser_1 ~ frequ", "frequ ~~ frequ", "asser_t1 ~ frequ", # frequency of self improvement
                           "d_asser_1 ~1 ", "asser_t1 ~1 ", "", # means
                           "d_asser_1 ~~ d_asser_1"))
kable(params_lcs_asser_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with assertiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_asser_curr_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_asser_curr_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Energy - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_energ_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                     "d_energ_1 ~ sa07_03_t1", "sa07_03_t1 ~~ sa07_03_t1", "d_energ_1 ~ sa07_03_t1", # acceptance goals
                     "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                     "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the energy change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_curr_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_curr_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1") %>% pull(p.value), 3)`. 
:::

##### Energy - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_energ_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_energ_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_energ_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_energ_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("energ_t2 ~ energ_t1", "d_energ_1 =~ energ_t2", "energ_t1 ~~ d_energ_1", # change parameters
                           "d_energ_1 ~ frequ", "frequ ~~ frequ", "energ_t1 ~ frequ", # frequency of self improvement
                           "d_energ_1 ~1 ", "energ_t1 ~1 ", "", # means
                           "d_energ_1 ~~ d_energ_1"))
kable(params_lcs_energ_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the energy change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_energ_curr_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_energ_curr_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Compassion - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_compa_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                     "d_compa_1 ~ sa07_04_t1", "sa07_04_t1 ~~ sa07_04_t1", "d_compa_1 ~ sa07_04_t1", # acceptance goals
                     "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                     "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the compassion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_curr_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_curr_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1") %>% pull(p.value), 3)`. 
:::

##### Compassion - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_compa_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_compa_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_compa_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_compa_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("compa_t2 ~ compa_t1", "d_compa_1 =~ compa_t2", "compa_t1 ~~ d_compa_1", # change parameters
                           "d_compa_1 ~ frequ", "frequ ~~ frequ", "compa_t1 ~ frequ", # frequency of self improvement
                           "d_compa_1 ~1 ", "compa_t1 ~1 ", "", # means
                           "d_compa_1 ~~ d_compa_1"))
kable(params_lcs_compa_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the compassion change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_compa_curr_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_compa_curr_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_respe_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                     "d_respe_1 ~ sa07_05_t1", "sa07_05_t1 ~~ sa07_05_t1", "d_respe_1 ~ sa07_05_t1", # acceptance goals
                     "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                     "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the respectfulness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_curr_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_curr_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1") %>% pull(p.value), 3)`. 
:::

##### Respectfulness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respe_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respe_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_respe_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respe_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respe_t2 ~ respe_t1", "d_respe_1 =~ respe_t2", "respe_t1 ~~ d_respe_1", # change parameters
                           "d_respe_1 ~ frequ", "frequ ~~ frequ", "respe_t1 ~ frequ", # frequency of self improvement
                           "d_respe_1 ~1 ", "respe_t1 ~1 ", "", # means
                           "d_respe_1 ~~ d_respe_1"))
kable(params_lcs_respe_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the respectfulness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respe_curr_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respe_curr_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Trust - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_trust_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                     "d_trust_1 ~ sa07_06_t1", "sa07_06_t1 ~~ sa07_06_t1", "d_trust_1 ~ sa07_06_t1", # acceptance goals
                     "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                     "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the trust change score (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_trust_curr_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_curr_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1") %>% pull(p.value), 3)`. 
:::

##### Trust - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_trust_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_trust_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_trust_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_trust_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("trust_t2 ~ trust_t1", "d_trust_1 =~ trust_t2", "trust_t1 ~~ d_trust_1", # change parameters
                           "d_trust_1 ~ frequ", "frequ ~~ frequ", "trust_t1 ~ frequ", # frequency of self improvement
                           "d_trust_1 ~1 ", "trust_t1 ~1 ", "", # means
                           "d_trust_1 ~~ d_trust_1"))
kable(params_lcs_trust_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the trust change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_trust_curr_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_trust_curr_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Organization - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_organ_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                     "d_organ_1 ~ sa07_07_t1", "sa07_07_t1 ~~ sa07_07_t1", "d_organ_1 ~ sa07_07_t1", # acceptance goals
                     "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                     "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the organization change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_curr_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_curr_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1") %>% pull(p.value), 3)`. 
:::

##### Organization - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_organ_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_organ_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_organ_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_organ_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("organ_t2 ~ organ_t1", "d_organ_1 =~ organ_t2", "organ_t1 ~~ d_organ_1", # change parameters
                           "d_organ_1 ~ frequ", "frequ ~~ frequ", "organ_t1 ~ frequ", # frequency of self improvement
                           "d_organ_1 ~1 ", "organ_t1 ~1 ", "", # means
                           "d_organ_1 ~~ d_organ_1"))
kable(params_lcs_organ_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the organization change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_organ_curr_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_organ_curr_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Productiveness - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_produ_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                     "d_produ_1 ~ sa07_08_t1", "sa07_08_t1 ~~ sa07_08_t1", "d_produ_1 ~ sa07_08_t1", # acceptance goals
                     "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                     "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the productiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_curr_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_curr_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1") %>% pull(p.value), 3)`. 
:::

##### Productiveness - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_produ_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_produ_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_produ_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_produ_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("produ_t2 ~ produ_t1", "d_produ_1 =~ produ_t2", "produ_t1 ~~ d_produ_1", # change parameters
                           "d_produ_1 ~ frequ", "frequ ~~ frequ", "produ_t1 ~ frequ", # frequency of self improvement
                           "d_produ_1 ~1 ", "produ_t1 ~1 ", "", # means
                           "d_produ_1 ~~ d_produ_1"))
kable(params_lcs_produ_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the productiveness change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_produ_curr_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_produ_curr_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Responsibility - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_respo_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                     "d_respo_1 ~ sa07_09_t1", "sa07_09_t1 ~~ sa07_09_t1", "d_respo_1 ~ sa07_09_t1", # acceptance goals
                     "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                     "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the responsibility change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_curr_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_curr_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1") %>% pull(p.value), 3)`. 
:::

##### Responsibility - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_respo_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_respo_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_respo_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_respo_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("respo_t2 ~ respo_t1", "d_respo_1 =~ respo_t2", "respo_t1 ~~ d_respo_1", # change parameters
                           "d_respo_1 ~ frequ", "frequ ~~ frequ", "respo_t1 ~ frequ", # frequency of self improvement
                           "d_respo_1 ~1 ", "respo_t1 ~1 ", "", # means
                           "d_respo_1 ~~ d_respo_1"))
kable(params_lcs_respo_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the responsibility change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_respo_curr_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_respo_curr_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Anxiety - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                     "d_anxie_1 ~ sa07_10_t1", "sa07_10_t1 ~~ sa07_10_t1", "d_anxie_1 ~ sa07_10_t1", # acceptance goals
                     "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                     "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the anxiety change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_anxie_curr_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_curr_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1") %>% pull(p.value), 3)`. 
:::

##### Anxiety - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_anxie_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_anxie_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_anxie_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_anxie_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("anxie_t2 ~ anxie_t1", "d_anxie_1 =~ anxie_t2", "anxie_t1 ~~ d_anxie_1", # change parameters
                           "d_anxie_1 ~ frequ", "frequ ~~ frequ", "anxie_t1 ~ frequ", # frequency of self improvement
                           "d_anxie_1 ~1 ", "anxie_t1 ~1 ", "", # means
                           "d_anxie_1 ~~ d_anxie_1"))
kable(params_lcs_anxie_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the anxiety change score (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_anxie_curr_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_anxie_curr_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Depression - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_depre_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                     "d_depre_1 ~ sa07_11_t1", "sa07_11_t1 ~~ sa07_11_t1", "d_depre_1 ~ sa07_11_t1", # acceptance goals
                     "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                     "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the depression change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_depre_curr_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_curr_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1") %>% pull(p.value), 3)`. 
:::

##### Depression - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_depre_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_depre_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_depre_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_depre_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("depre_t2 ~ depre_t1", "d_depre_1 =~ depre_t2", "depre_t1 ~~ d_depre_1", # change parameters
                           "d_depre_1 ~ frequ", "frequ ~~ frequ", "depre_t1 ~ frequ", # frequency of self improvement
                           "d_depre_1 ~1 ", "depre_t1 ~1 ", "", # means
                           "d_depre_1 ~~ d_depre_1"))
kable(params_lcs_depre_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the depression change score (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_depre_curr_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_depre_curr_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Volatility - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_volat_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                     "d_volat_1 ~ sa07_12_t1", "sa07_12_t1 ~~ sa07_12_t1", "d_volat_1 ~ sa07_12_t1", # acceptance goals
                     "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                     "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the volatility change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_volat_curr_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_curr_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1") %>% pull(p.value), 3)`. 
:::

##### Volatility - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_volat_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_volat_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_volat_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_volat_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("volat_t2 ~ volat_t1", "d_volat_1 =~ volat_t2", "volat_t1 ~~ d_volat_1", # change parameters
                           "d_volat_1 ~ frequ", "frequ ~~ frequ", "volat_t1 ~ frequ", # frequency of self improvement
                           "d_volat_1 ~1 ", "volat_t1 ~1 ", "", # means
                           "d_volat_1 ~~ d_volat_1"))
kable(params_lcs_volat_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the volatility change score (current-personality) is significantly different from zero, *b* = `r round(params_lcs_volat_curr_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_volat_curr_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Curiosity - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_curio_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                     "d_curio_1 ~ sa07_13_t1", "sa07_13_t1 ~~ sa07_13_t1", "d_curio_1 ~ sa07_13_t1", # acceptance goals
                     "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                     "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the curiosity change score (current-personality) is not significantly different from zero (at *p* < .001), *b* = `r round(params_lcs_curio_curr_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_curr_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1") %>% pull(p.value), 3)`. 
:::

##### Curiosity - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_curio_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_curio_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_curio_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_curio_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("curio_t2 ~ curio_t1", "d_curio_1 =~ curio_t2", "curio_t1 ~~ d_curio_1", # change parameters
                           "d_curio_1 ~ frequ", "frequ ~~ frequ", "curio_t1 ~ frequ", # frequency of self improvement
                           "d_curio_1 ~1 ", "curio_t1 ~1 ", "", # means
                           "d_curio_1 ~~ d_curio_1"))
kable(params_lcs_curio_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the curiosity change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_curio_curr_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_curio_curr_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_xx_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                     "d_aesth_1 ~ sa07_14_t1", "sa07_14_t1 ~~ sa07_14_t1", "d_aesth_1 ~ sa07_14_t1", # acceptance goals
                     "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                     "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the aesthetic change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_curr_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_curr_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1") %>% pull(p.value), 3)`. 
:::

##### Aesthetic - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# model fit
kable(broom::glance(fit_mi_lcs_aesth_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_aesth_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_aesth_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_aesth_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("aesth_t2 ~ aesth_t1", "d_aesth_1 =~ aesth_t2", "aesth_t1 ~~ d_aesth_1", # change parameters
                           "d_aesth_1 ~ frequ", "frequ ~~ frequ", "aesth_t1 ~ frequ", # frequency of self improvement
                           "d_aesth_1 ~1 ", "aesth_t1 ~1 ", "", # means
                           "d_aesth_1 ~~ d_aesth_1"))
kable(params_lcs_aesth_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the aesthetic change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_aesth_curr_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_aesth_curr_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

##### Imagination - specific, facet-level acceptance goal as moderator of change

Results summary (*sa07_$$_t1* = trait/facet specific acceptance goal):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_specif_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_specif_hyp7 <- broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
  select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_curr_specif_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
  filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                     "d_imagi_1 ~ sa07_15_t1", "sa07_15_t1 ~~ sa07_15_t1", "d_imagi_1 ~ sa07_15_t1", # acceptance goals
                     "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                     "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_specif_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the facet-specific acceptance goal with the imagination change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_curr_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_curr_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1") %>% pull(p.value), 3)`. 
:::

##### Imagination - frequency of self-acceptance behaviors as moderator of change

Results summary (*frequ* = frequency of self-acceptance behavior):
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model fit
kable(broom::glance(fit_mi_lcs_imagi_curr_frequ_hyp7) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)

# parameters of interest
params_lcs_imagi_curr_frequ_hyp7 <- broom::tidy(fit_mi_lcs_imagi_curr_frequ_hyp7, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, estimate, ci999lo = conf.low, ci999hi = conf.high, std.all, statistic, p.value) %>%    left_join(broom::tidy(fit_mi_lcs_imagi_curr_frequ_hyp7,                          conf.int = TRUE, conf.level = 0.95) %>%                select(term, ci95lo = conf.low, ci95hi = conf.high)) %>% 
        filter(term %in% c("imagi_t2 ~ imagi_t1", "d_imagi_1 =~ imagi_t2", "imagi_t1 ~~ d_imagi_1", # change parameters
                           "d_imagi_1 ~ frequ", "frequ ~~ frequ", "imagi_t1 ~ frequ", # frequency of self improvement
                           "d_imagi_1 ~1 ", "imagi_t1 ~1 ", "", # means
                           "d_imagi_1 ~~ d_imagi_1"))
kable(params_lcs_imagi_curr_frequ_hyp7, digits = 3) 
```

::: {.callout-note appearance="minimal"}
The moderation effect of the frequency of self-acceptance behaviors with the imagination change score (current-personality) is not significantly different from zero, *b* = `r round(params_lcs_imagi_curr_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(estimate), 3)`, *p* = `r round(params_lcs_imagi_curr_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ") %>% pull(p.value), 3)`. 
:::

#### Hyp 7: Effects summary

##### Summary: Ideal personality

Collect all relevant effects:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create df for table:

# main effects (change score)
df_table_hyp7_main <- bind_rows(
  #traits
  params_lcs_extra_ideal_specif_hyp7 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_extra_ideal_frequ_hyp7 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_agree_ideal_specif_hyp7 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_agree_ideal_frequ_hyp7 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_consc_ideal_specif_hyp7 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_consc_ideal_frequ_hyp7 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_neuro_ideal_specif_hyp7 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_neuro_ideal_frequ_hyp7 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_openn_ideal_specif_hyp7 %>% filter(term=="d_openn_1 ~1 "),
  params_lcs_openn_ideal_frequ_hyp7 %>% filter(term=="d_openn_1 ~1 "),
  #facets
  params_lcs_socia_ideal_specif_hyp7 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_socia_ideal_frequ_hyp7 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_asser_ideal_specif_hyp7 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_asser_ideal_frequ_hyp7 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_energ_ideal_specif_hyp7 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_energ_ideal_frequ_hyp7 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_compa_ideal_specif_hyp7 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_compa_ideal_frequ_hyp7 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_respe_ideal_specif_hyp7 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_respe_ideal_frequ_hyp7 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_trust_ideal_specif_hyp7 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_trust_ideal_frequ_hyp7 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_organ_ideal_specif_hyp7 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_organ_ideal_frequ_hyp7 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_produ_ideal_specif_hyp7 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_produ_ideal_frequ_hyp7 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_respo_ideal_specif_hyp7 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_respo_ideal_frequ_hyp7 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_anxie_ideal_specif_hyp7 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_anxie_ideal_frequ_hyp7 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_depre_ideal_specif_hyp7 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_depre_ideal_frequ_hyp7 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_volat_ideal_specif_hyp7 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_volat_ideal_frequ_hyp7 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_curio_ideal_specif_hyp7 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_curio_ideal_frequ_hyp7 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_aesth_ideal_specif_hyp7 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_aesth_ideal_frequ_hyp7 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_imagi_ideal_specif_hyp7 %>% filter(term=="d_imagi_1 ~1 "),
  params_lcs_imagi_ideal_frequ_hyp7 %>% filter(term=="d_imagi_1 ~1 ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_main = estimate, std_main = std.all, p_main = p.value)

# moderation effects
df_table_hyp7_mod <- bind_rows(
  #traits
  params_lcs_extra_ideal_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_ideal_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_ideal_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_ideal_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_ideal_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_ideal_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_ideal_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_ideal_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_ideal_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_ideal_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_ideal_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1"),
  params_lcs_socia_ideal_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_ideal_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1"),
  params_lcs_asser_ideal_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_ideal_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1"),
  params_lcs_energ_ideal_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_ideal_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1"),
  params_lcs_compa_ideal_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_ideal_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1"),
  params_lcs_respe_ideal_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_ideal_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1"),
  params_lcs_trust_ideal_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_ideal_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1"),
  params_lcs_organ_ideal_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_ideal_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1"),
  params_lcs_produ_ideal_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_ideal_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1"),
  params_lcs_respo_ideal_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_ideal_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1"),
  params_lcs_anxie_ideal_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_ideal_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1"),
  params_lcs_depre_ideal_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_ideal_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1"),
  params_lcs_volat_ideal_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_ideal_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1"),
  params_lcs_curio_ideal_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_ideal_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1"),
  params_lcs_aesth_ideal_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_ideal_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1"),
  params_lcs_imagi_ideal_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_mod = estimate, std_mod = std.all, p_mod = p.value)

# combine
df_table_hyp7 <- df_table_hyp7_main %>% left_join(df_table_hyp7_mod)
```

Results summary across the Big Five traits: trait-specific acceptance goals (*Goals*) and frequency of self-acceptance behaviors (*Frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp7[1:10, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant main or moderator effects at the domain level (ideal personality) that are significantly different from zero.  
:::

Results summary across the Big Five facets: trait-specific acceptance goals (*goals*) and frequency of self-acceptance behaviors (*frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp7[11:40, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant main or moderator effects at the domain level (ideal personality) that are significantly different from zero at *p* < .001.  

- Only at p < .05: The facet-specific acceptance goal moderates changes in ideal-level sociability.  
:::

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_table_hyp7_plot <- bind_rows(
  #traits
  params_lcs_extra_ideal_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_ideal_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_ideal_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_ideal_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_ideal_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_ideal_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_ideal_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_ideal_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_ideal_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_ideal_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_ideal_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1"),
  params_lcs_socia_ideal_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_ideal_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1"),
  params_lcs_asser_ideal_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_ideal_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1"),
  params_lcs_energ_ideal_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_ideal_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1"),
  params_lcs_compa_ideal_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_ideal_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1"),
  params_lcs_respe_ideal_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_ideal_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1"),
  params_lcs_trust_ideal_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_ideal_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1"),
  params_lcs_organ_ideal_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_ideal_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1"),
  params_lcs_produ_ideal_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_ideal_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1"),
  params_lcs_respo_ideal_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_ideal_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1"),
  params_lcs_anxie_ideal_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_ideal_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1"),
  params_lcs_depre_ideal_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_ideal_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1"),
  params_lcs_volat_ideal_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_ideal_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1"),
  params_lcs_curio_ideal_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_ideal_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1"),
  params_lcs_aesth_ideal_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_ideal_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1"),
  params_lcs_imagi_ideal_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, estimate, 
         ci999lo, ci999hi, ci95lo, ci95hi, std.all, statistic, p.value)

df_table_hyp7_plot <- df_table_hyp7_plot %>% 
  mutate(include_0 = ifelse(ci999lo < 0 & ci999hi > 0, "n.s.", "*")) %>% 
  mutate(ref = factor("Ideal", levels = c("Ideal"), labels = c("Ideal"))) %>% 
  mutate(moderator = factor(moderator, levels = c("Goals", "Frequency"), 
                            labels = c("Goals", "Frequency"))) %>% 
  mutate(trait = factor(trait, levels = names(b5_vars), 
                        labels = stringr::str_to_title(names(b5_vars))))
```

Plotting the effect size across all analyses:  

- *Ideal* = ideal-level personality  
- *Goals* = specific, facet-level acceptance goal(s) as moderator  
- *Frequency* = frequency of self-acceptance behavior as moderator  

Important: these show both 99.9% and 95% confidence intervals (for better visual comparability with Study 1 plot)  

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_table_hyp7_plot, aes(x = fct_rev(trait), y = estimate, color = include_0)) +
  geom_hline(yintercept=0, linetype = 3) +
  geom_point(size=3, position=position_dodge(0.4)) + 
  geom_errorbar(aes(ymin = ci999lo, ymax = ci999hi, color = include_0), width=.2,
                position=position_dodge(0.4), size = 0.2, alpha = 0.75) +
  geom_errorbar(aes(ymin = ci95lo, ymax = ci95hi, color = include_0), width=.2,
                position=position_dodge(0.4)) +
  scale_color_manual(values = c("#A9A9A9", "#000000")) + # reversed here because all n.s.
  facet_wrap( ~ ref + moderator, ncol = 2) +
  theme_bw() +
  scale_shape_manual(values=c(18)) + 
  ylab("Effect Estimates (99.9% / 95% CI)") +
  xlab("") +
  theme(legend.title=element_blank()) +
  theme(legend.text=element_text(size=12)) +
  coord_flip() +
  theme(strip.text.x = element_text(size = 12)) +
  theme(axis.text.x=element_text(size=10, angle = 45, hjust = 1), axis.text.y=element_text(size=12)) + 
  guides(color="none")
```

##### Summary: Current personality

Collect all relevant effects:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create df for table:

# main effects (change score)
df_table_hyp7_curr_main <- bind_rows(
  #traits
  params_lcs_extra_curr_specif_hyp7 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_extra_curr_frequ_hyp7 %>% filter(term=="d_extra_1 ~1 "),
  params_lcs_agree_curr_specif_hyp7 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_agree_curr_frequ_hyp7 %>% filter(term=="d_agree_1 ~1 "),
  params_lcs_consc_curr_specif_hyp7 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_consc_curr_frequ_hyp7 %>% filter(term=="d_consc_1 ~1 "),
  params_lcs_neuro_curr_specif_hyp7 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_neuro_curr_frequ_hyp7 %>% filter(term=="d_neuro_1 ~1 "),
  params_lcs_openn_curr_specif_hyp7 %>% filter(term=="d_openn_1 ~1 "),
  params_lcs_openn_curr_frequ_hyp7 %>% filter(term=="d_openn_1 ~1 "),
  #facets
  params_lcs_socia_curr_specif_hyp7 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_socia_curr_frequ_hyp7 %>% filter(term=="d_socia_1 ~1 "),
  params_lcs_asser_curr_specif_hyp7 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_asser_curr_frequ_hyp7 %>% filter(term=="d_asser_1 ~1 "),
  params_lcs_energ_curr_specif_hyp7 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_energ_curr_frequ_hyp7 %>% filter(term=="d_energ_1 ~1 "),
  params_lcs_compa_curr_specif_hyp7 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_compa_curr_frequ_hyp7 %>% filter(term=="d_compa_1 ~1 "),
  params_lcs_respe_curr_specif_hyp7 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_respe_curr_frequ_hyp7 %>% filter(term=="d_respe_1 ~1 "),
  params_lcs_trust_curr_specif_hyp7 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_trust_curr_frequ_hyp7 %>% filter(term=="d_trust_1 ~1 "),
  params_lcs_organ_curr_specif_hyp7 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_organ_curr_frequ_hyp7 %>% filter(term=="d_organ_1 ~1 "),
  params_lcs_produ_curr_specif_hyp7 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_produ_curr_frequ_hyp7 %>% filter(term=="d_produ_1 ~1 "),
  params_lcs_respo_curr_specif_hyp7 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_respo_curr_frequ_hyp7 %>% filter(term=="d_respo_1 ~1 "),
  params_lcs_anxie_curr_specif_hyp7 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_anxie_curr_frequ_hyp7 %>% filter(term=="d_anxie_1 ~1 "),
  params_lcs_depre_curr_specif_hyp7 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_depre_curr_frequ_hyp7 %>% filter(term=="d_depre_1 ~1 "),
  params_lcs_volat_curr_specif_hyp7 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_volat_curr_frequ_hyp7 %>% filter(term=="d_volat_1 ~1 "),
  params_lcs_curio_curr_specif_hyp7 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_curio_curr_frequ_hyp7 %>% filter(term=="d_curio_1 ~1 "),
  params_lcs_aesth_curr_specif_hyp7 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_aesth_curr_frequ_hyp7 %>% filter(term=="d_aesth_1 ~1 "),
  params_lcs_imagi_curr_specif_hyp7 %>% filter(term=="d_imagi_1 ~1 "),
  params_lcs_imagi_curr_frequ_hyp7 %>% filter(term=="d_imagi_1 ~1 ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_main = estimate, std_main = std.all, p_main = p.value)

# moderation effects
df_table_hyp7_curr_mod <- bind_rows(
  #traits
  params_lcs_extra_curr_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_curr_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_curr_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_curr_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_curr_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_curr_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_curr_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_curr_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_curr_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_curr_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_curr_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1"),
  params_lcs_socia_curr_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_curr_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1"),
  params_lcs_asser_curr_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_curr_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1"),
  params_lcs_energ_curr_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_curr_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1"),
  params_lcs_compa_curr_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_curr_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1"),
  params_lcs_respe_curr_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_curr_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1"),
  params_lcs_trust_curr_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_curr_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1"),
  params_lcs_organ_curr_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_curr_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1"),
  params_lcs_produ_curr_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_curr_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1"),
  params_lcs_respo_curr_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_curr_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1"),
  params_lcs_anxie_curr_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_curr_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1"),
  params_lcs_depre_curr_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_curr_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1"),
  params_lcs_volat_curr_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_curr_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1"),
  params_lcs_curio_curr_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_curr_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1"),
  params_lcs_aesth_curr_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_curr_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1"),
  params_lcs_imagi_curr_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, est_mod = estimate, std_mod = std.all, p_mod = p.value)

# combine
df_table_hyp7_curr <- df_table_hyp7_curr_main %>% left_join(df_table_hyp7_curr_mod)
```

Results summary across the Big Five traits: trait-specific acceptance goals (*Goals*) and frequency of self-acceptance behaviors (*Frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp7_curr[1:10, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
Significant main effects except for agreeableness. No moderation effects at the domain level that are significantly different from zero at *p* < .001:  

- Only at p < .05: The frequency of self-acceptance behaviors moderates changes in current-level neuroticism.  
:::

Results summary across the Big Five facets: trait-specific acceptance goals (*goals*) and frequency of self-acceptance behaviors (*frequency*) as moderators on the latent change score. *_main* refers to the main effects (change scores) and *_mod* to the moderation effects.  
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
kable(df_table_hyp7_curr[11:40, ], digits = 3)
```

::: {.callout-note appearance="minimal"}
No moderation effects at the facet level that are significantly different from zero at *p* < .001:  

- Only at p < .05: The facet-specific acceptance goal moderates changes in current-level trust.  
- Only at p < .05: The frequency of self-acceptance behaviors moderates changes in current-level anxiety.    
- Only at p < .05: The frequency of self-acceptance behaviors moderates changes in current-level depression.    
- Only at p < .05: The facet-specific acceptance goal moderates changes in current-level curiosity.  
:::

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_table_hyp7_plot_curr <- bind_rows(
  #traits
  params_lcs_extra_curr_specif_hyp7 %>% filter(term=="d_extra_1 ~ goals"),
  params_lcs_extra_curr_frequ_hyp7 %>% filter(term=="d_extra_1 ~ frequ"),
  params_lcs_agree_curr_specif_hyp7 %>% filter(term=="d_agree_1 ~ goals"),
  params_lcs_agree_curr_frequ_hyp7 %>% filter(term=="d_agree_1 ~ frequ"),
  params_lcs_consc_curr_specif_hyp7 %>% filter(term=="d_consc_1 ~ goals"),
  params_lcs_consc_curr_frequ_hyp7 %>% filter(term=="d_consc_1 ~ frequ"),
  params_lcs_neuro_curr_specif_hyp7 %>% filter(term=="d_neuro_1 ~ goals"),
  params_lcs_neuro_curr_frequ_hyp7 %>% filter(term=="d_neuro_1 ~ frequ"),
  params_lcs_openn_curr_specif_hyp7 %>% filter(term=="d_openn_1 ~ goals"),
  params_lcs_openn_curr_frequ_hyp7 %>% filter(term=="d_openn_1 ~ frequ"),
  #facets
  params_lcs_socia_curr_specif_hyp7 %>% filter(term=="d_socia_1 ~ sa07_01_t1"),
  params_lcs_socia_curr_frequ_hyp7 %>% filter(term=="d_socia_1 ~ frequ"),
  params_lcs_asser_curr_specif_hyp7 %>% filter(term=="d_asser_1 ~ sa07_02_t1"),
  params_lcs_asser_curr_frequ_hyp7 %>% filter(term=="d_asser_1 ~ frequ"),
  params_lcs_energ_curr_specif_hyp7 %>% filter(term=="d_energ_1 ~ sa07_03_t1"),
  params_lcs_energ_curr_frequ_hyp7 %>% filter(term=="d_energ_1 ~ frequ"),
  params_lcs_compa_curr_specif_hyp7 %>% filter(term=="d_compa_1 ~ sa07_04_t1"),
  params_lcs_compa_curr_frequ_hyp7 %>% filter(term=="d_compa_1 ~ frequ"),
  params_lcs_respe_curr_specif_hyp7 %>% filter(term=="d_respe_1 ~ sa07_05_t1"),
  params_lcs_respe_curr_frequ_hyp7 %>% filter(term=="d_respe_1 ~ frequ"),
  params_lcs_trust_curr_specif_hyp7 %>% filter(term=="d_trust_1 ~ sa07_06_t1"),
  params_lcs_trust_curr_frequ_hyp7 %>% filter(term=="d_trust_1 ~ frequ"),
  params_lcs_organ_curr_specif_hyp7 %>% filter(term=="d_organ_1 ~ sa07_07_t1"),
  params_lcs_organ_curr_frequ_hyp7 %>% filter(term=="d_organ_1 ~ frequ"),
  params_lcs_produ_curr_specif_hyp7 %>% filter(term=="d_produ_1 ~ sa07_08_t1"),
  params_lcs_produ_curr_frequ_hyp7 %>% filter(term=="d_produ_1 ~ frequ"),
  params_lcs_respo_curr_specif_hyp7 %>% filter(term=="d_respo_1 ~ sa07_09_t1"),
  params_lcs_respo_curr_frequ_hyp7 %>% filter(term=="d_respo_1 ~ frequ"),
  params_lcs_anxie_curr_specif_hyp7 %>% filter(term=="d_anxie_1 ~ sa07_10_t1"),
  params_lcs_anxie_curr_frequ_hyp7 %>% filter(term=="d_anxie_1 ~ frequ"),
  params_lcs_depre_curr_specif_hyp7 %>% filter(term=="d_depre_1 ~ sa07_11_t1"),
  params_lcs_depre_curr_frequ_hyp7 %>% filter(term=="d_depre_1 ~ frequ"),
  params_lcs_volat_curr_specif_hyp7 %>% filter(term=="d_volat_1 ~ sa07_12_t1"),
  params_lcs_volat_curr_frequ_hyp7 %>% filter(term=="d_volat_1 ~ frequ"),
  params_lcs_curio_curr_specif_hyp7 %>% filter(term=="d_curio_1 ~ sa07_13_t1"),
  params_lcs_curio_curr_frequ_hyp7 %>% filter(term=="d_curio_1 ~ frequ"),
  params_lcs_aesth_curr_specif_hyp7 %>% filter(term=="d_aesth_1 ~ sa07_14_t1"),
  params_lcs_aesth_curr_frequ_hyp7 %>% filter(term=="d_aesth_1 ~ frequ"),
  params_lcs_imagi_curr_specif_hyp7 %>% filter(term=="d_imagi_1 ~ sa07_15_t1"),
  params_lcs_imagi_curr_frequ_hyp7 %>% filter(term=="d_imagi_1 ~ frequ")
  ) %>% 
  mutate(trait = rep(names(b5_vars), each=2),
         moderator = rep(c("Goals", "Frequency"), 20)) %>% 
  select(trait, moderator, estimate, 
         ci999lo, ci999hi, ci95lo, ci95hi, std.all, statistic, p.value)

df_table_hyp7_plot_curr <- df_table_hyp7_plot_curr %>% 
  mutate(include_0 = ifelse(ci999lo < 0 & ci999hi > 0, "n.s.", "*")) %>% 
  mutate(ref = factor("Current", levels = c("Current"), labels = c("Current"))) %>% 
  mutate(moderator = factor(moderator, levels = c("Goals", "Frequency"), 
                            labels = c("Goals", "Frequency"))) %>% 
  mutate(trait = factor(trait, levels = names(b5_vars), 
                        labels = stringr::str_to_title(names(b5_vars))))
```

Plotting the effect size across all analyses:  

- *Current* = current-level personality  
- *Goals* = specific, facet-level acceptance goal(s) as moderator  
- *Frequency* = frequency of self-acceptance behavior as moderator

Important: these show both 99.9% and 95% confidence intervals (for better visual comparability with Study 1 plot)  

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
#| code-fold: true
#| code-summary: "Show the code"
#| cache: false

ggplot(df_table_hyp7_plot_curr, aes(x = fct_rev(trait), y = estimate, color = include_0)) +
  geom_hline(yintercept=0, linetype = 3) +
  geom_point(size=3, position=position_dodge(0.4)) + 
  geom_errorbar(aes(ymin = ci999lo, ymax = ci999hi, color = include_0), width=.2,
                position=position_dodge(0.4), size = 0.2, alpha = 0.75) +
  geom_errorbar(aes(ymin = ci95lo, ymax = ci95hi, color = include_0), width=.2,
                position=position_dodge(0.4)) +
  scale_color_manual(values = c("#A9A9A9", "#000000")) + # reversed here because all n.s.
  facet_wrap( ~ ref + moderator, ncol = 2) +
  theme_bw() +
  scale_shape_manual(values=c(18)) + 
  ylab("Effect Estimates (99.9% / 95% CI)") +
  xlab("") +
  theme(legend.title=element_blank()) +
  theme(legend.text=element_text(size=12)) +
  coord_flip() +
  theme(strip.text.x = element_text(size = 12)) +
  theme(axis.text.x=element_text(size=10, angle = 45, hjust = 1), axis.text.y=element_text(size=12)) + 
  guides(color="none")
```

------------------------------------------------------------------------

### Differences in change across intervention groups (Hyp 6 in paper)

*Change in psychological well-being indicators as well as the difference between real- and ideal-personality will differ across groups at follow-up. Based on exploratory results from Study 1, we expect that the self-acceptance intervention leads to more pronounced well-being gains and less pronounced differences between current- and ideal-personality personality compared to the self-improvement intervention.*  

#### Latent well-being change: acceptance vs. improvement

##### Life satisfaction 

Life satisfaction: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_swls_group_config <- '
swls_t1 =~ 1*sw06_01_t1 + c("lamb2a", "lamb2b")*sw06_02_t1 + c("lamb3a", "lamb3b")*sw06_03_t1 + c("lamb4a", "lamb4b")*sw06_04_t1 # This specifies the measurement model for swls_t1 
swls_t2 =~ 1*sw06_01_t2 + c("lamb2a", "lamb2b")*sw06_02_t2 + c("lamb3a", "lamb3b")*sw06_03_t2 + c("lamb4a", "lamb4b")*sw06_04_t2 # This specifies the measurement model for swls_t2 with the equality constrained factor loadings

swls_t2 ~ 1*swls_t1     # This parameter regresses swls_t2 perfectly on swls_t1
d_swls_1 =~ 1*swls_t2   # This defines the latent change score factor as measured perfectly by scores on swls_t2
swls_t2 ~ 0*1           # This line constrains the intercept of swls_t2 to 0
swls_t2 ~~ 0*swls_t2    # This fixes the variance of swls_t2 to 0

d_swls_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
swls_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of swls_t1 
d_swls_1 ~~ c("d_var_a", "d_var_b")*d_swls_1   # This estimates the variance of the change scores 
swls_t1 ~~ c("wb_var_a", "wb_var_b")*swls_t1     # This estimates the variance of the swls_t1 
d_swls_1 ~~ c("fb_a", "fb_b")*swls_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t1 ~~ c("cov1a", "cov1b")*sw06_01_t2   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t1 ~~ c("cov2a", "cov2b")*sw06_02_t2   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t1 ~~ c("cov3a", "cov3b")*sw06_03_t2   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t1 ~~ c("cov4a", "cov4b")*sw06_04_t2   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t1 ~~ c("res1a", "res1b")*sw06_01_t1   # This allows residual variance on indicator X1 at T1 
sw06_02_t1 ~~ c("res2a", "res2b")*sw06_02_t1   # This allows residual variance on indicator X2 at T1
sw06_03_t1 ~~ c("res3a", "res3b")*sw06_03_t1   # This allows residual variance on indicator X3 at T1
sw06_04_t1 ~~ c("res4a", "res4b")*sw06_04_t1   # This allows residual variance on indicator X4 at T1

sw06_01_t2 ~~ c("res1a", "res1b")*sw06_01_t2  # This allows residual variance on indicator X1 at T2 
sw06_02_t2 ~~ c("res2a", "res2b")*sw06_02_t2  # This allows residual variance on indicator X2 at T2 
sw06_03_t2 ~~ c("res3a", "res3b")*sw06_03_t2  # This allows residual variance on indicator X3 at T2
sw06_04_t2 ~~ c("res4a", "res4b")*sw06_04_t2  # This allows residual variance on indicator X4 at T2

sw06_01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
sw06_03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1
sw06_04_t1 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T1

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
sw06_03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
sw06_04_t2 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T2
'
lcs_swls_group_config <- sem(mi_lcs_swls_group_config, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', 
                             fixed.x=FALSE, missing='fiml', group = "rando")

# weak invariance
mi_lcs_swls_group_weak <- '
swls_t1 =~ 1*sw06_01_t1 + c("lamb2", "lamb2")*sw06_02_t1 + c("lamb3", "lamb3")*sw06_03_t1 + c("lamb4", "lamb4")*sw06_04_t1 # This specifies the measurement model for swls_t1 
swls_t2 =~ 1*sw06_01_t2 + c("lamb2", "lamb2")*sw06_02_t2 + c("lamb3", "lamb3")*sw06_03_t2 + c("lamb4", "lamb4")*sw06_04_t2 # This specifies the measurement model for swls_t2 with the equality constrained factor loadings

swls_t2 ~ 1*swls_t1     # This parameter regresses swls_t2 perfectly on swls_t1
d_swls_1 =~ 1*swls_t2   # This defines the latent change score factor as measured perfectly by scores on swls_t2
swls_t2 ~ 0*1           # This line constrains the intercept of swls_t2 to 0
swls_t2 ~~ 0*swls_t2    # This fixes the variance of swls_t2 to 0

d_swls_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
swls_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of swls_t1 
d_swls_1 ~~ c("d_var_a", "d_var_b")*d_swls_1   # This estimates the variance of the change scores 
swls_t1 ~~ c("wb_var_a", "wb_var_b")*swls_t1     # This estimates the variance of the swls_t1 
d_swls_1 ~~ c("fb_a", "fb_b")*swls_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t1 ~~ c("cov1a", "cov1b")*sw06_01_t2   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t1 ~~ c("cov2a", "cov2b")*sw06_02_t2   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t1 ~~ c("cov3a", "cov3b")*sw06_03_t2   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t1 ~~ c("cov4a", "cov4b")*sw06_04_t2   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t1 ~~ c("res1a", "res1b")*sw06_01_t1   # This allows residual variance on indicator X1 at T1 
sw06_02_t1 ~~ c("res2a", "res2b")*sw06_02_t1   # This allows residual variance on indicator X2 at T1
sw06_03_t1 ~~ c("res3a", "res3b")*sw06_03_t1   # This allows residual variance on indicator X3 at T1
sw06_04_t1 ~~ c("res4a", "res4b")*sw06_04_t1   # This allows residual variance on indicator X4 at T1

sw06_01_t2 ~~ c("res1a", "res1b")*sw06_01_t2  # This allows residual variance on indicator X1 at T2 
sw06_02_t2 ~~ c("res2a", "res2b")*sw06_02_t2  # This allows residual variance on indicator X2 at T2 
sw06_03_t2 ~~ c("res3a", "res3b")*sw06_03_t2  # This allows residual variance on indicator X3 at T2
sw06_04_t2 ~~ c("res4a", "res4b")*sw06_04_t2  # This allows residual variance on indicator X4 at T2

sw06_01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
sw06_03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1
sw06_04_t1 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T1

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
sw06_03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
sw06_04_t2 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T2
'

lcs_swls_group_weak <- sem(mi_lcs_swls_group_weak, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "rando", group.equal = "loadings")

# strong invariance
mi_lcs_swls_group_strong <- '
swls_t1 =~ 1*sw06_01_t1 + c("lamb2", "lamb2")*sw06_02_t1 + c("lamb3", "lamb3")*sw06_03_t1 + c("lamb4", "lamb4")*sw06_04_t1 # This specifies the measurement model for swls_t1 
swls_t2 =~ 1*sw06_01_t2 + c("lamb2", "lamb2")*sw06_02_t2 + c("lamb3", "lamb3")*sw06_03_t2 + c("lamb4", "lamb4")*sw06_04_t2 # This specifies the measurement model for swls_t2 with the equality constrained factor loadings

swls_t2 ~ 1*swls_t1     # This parameter regresses swls_t2 perfectly on swls_t1
d_swls_1 =~ 1*swls_t2   # This defines the latent change score factor as measured perfectly by scores on swls_t2
swls_t2 ~ 0*1           # This line constrains the intercept of swls_t2 to 0
swls_t2 ~~ 0*swls_t2    # This fixes the variance of swls_t2 to 0

d_swls_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
swls_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of swls_t1 
d_swls_1 ~~ c("d_var_a", "d_var_b")*d_swls_1   # This estimates the variance of the change scores 
swls_t1 ~~ c("wb_var_a", "wb_var_b")*swls_t1     # This estimates the variance of the swls_t1 
d_swls_1 ~~ c("fb_a", "fb_b")*swls_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t1 ~~ c("cov1a", "cov1b")*sw06_01_t2   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t1 ~~ c("cov2a", "cov2b")*sw06_02_t2   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t1 ~~ c("cov3a", "cov3b")*sw06_03_t2   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t1 ~~ c("cov4a", "cov4b")*sw06_04_t2   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t1 ~~ c("res1a", "res1b")*sw06_01_t1   # This allows residual variance on indicator X1 at T1 
sw06_02_t1 ~~ c("res2a", "res2b")*sw06_02_t1   # This allows residual variance on indicator X2 at T1
sw06_03_t1 ~~ c("res3a", "res3b")*sw06_03_t1   # This allows residual variance on indicator X3 at T1
sw06_04_t1 ~~ c("res4a", "res4b")*sw06_04_t1   # This allows residual variance on indicator X4 at T1

sw06_01_t2 ~~ c("res1a", "res1b")*sw06_01_t2  # This allows residual variance on indicator X1 at T2 
sw06_02_t2 ~~ c("res2a", "res2b")*sw06_02_t2  # This allows residual variance on indicator X2 at T2 
sw06_03_t2 ~~ c("res3a", "res3b")*sw06_03_t2  # This allows residual variance on indicator X3 at T2
sw06_04_t2 ~~ c("res4a", "res4b")*sw06_04_t2  # This allows residual variance on indicator X4 at T2

sw06_01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
sw06_03_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1
sw06_04_t1 ~ c("m4", "m4")*1     # This estimates the intercept of X4 at T1

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
sw06_03_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
sw06_04_t2 ~ c("m4", "m4")*1     # This estimates the intercept of X4 at T2
'

lcs_swls_group_strong <- sem(mi_lcs_swls_group_strong, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "rando", group.equal = c("intercepts", "loadings"))
```

Life satisfaction: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_swls_group_config, lcs_swls_group_weak, lcs_swls_group_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_swls_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_swls <- broom::tidy(lcs_swls_group_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="swls" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_swls_1 ~1 "))
kable(params_main_lcs_swls, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_swls_group_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="swls" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_swls_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Slightly more positive change in life satisfaction in the self-improvement group but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_swls_group_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Meaning in life

Meaning in life: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_meaning_group_config <- '
meaning_t1 =~ 1*meaning_par1_t1 + c("lamb2a", "lamb2b")*meaning_par2_t1 + c("lamb3a", "lamb3b")*meaning_par3_t1 # This specifies the measurement model for meaning_t1 
meaning_t2 =~ 1*meaning_par1_t2 + c("lamb2a", "lamb2b")*meaning_par2_t2 + c("lamb3a", "lamb3b")*meaning_par3_t2 # This specifies the measurement model for meaning_t2 with the equality constrained factor loadings

meaning_t2 ~ 1*meaning_t1     # This parameter regresses meaning_t2 perfectly on meaning_t1
d_meaning_1 =~ 1*meaning_t2   # This defines the latent change score factor as measured perfectly by scores on meaning_t2
meaning_t2 ~ 0*1           # This line constrains the intercept of meaning_t2 to 0
meaning_t2 ~~ 0*meaning_t2    # This fixes the variance of meaning_t2 to 0

d_meaning_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
meaning_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of meaning_t1 
d_meaning_1 ~~ c("d_var_a", "d_var_b")*d_meaning_1   # This estimates the variance of the change scores 
meaning_t1 ~~ c("wb_var_a", "wb_var_b")*meaning_t1     # This estimates the variance of the meaning_t1 
d_meaning_1 ~~ c("fb_a", "fb_b")*meaning_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t1 ~~ c("cov1a", "cov1b")*meaning_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t1 ~~ c("cov2a", "cov2b")*meaning_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t1 ~~ c("cov3a", "cov3b")*meaning_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t1 ~~ c("res1a", "res1b")*meaning_par1_t1   # This allows residual variance on indicator X1 at T1 
meaning_par2_t1 ~~ c("res2a", "res2b")*meaning_par2_t1   # This allows residual variance on indicator X2 at T1
meaning_par3_t1 ~~ c("res3a", "res3b")*meaning_par3_t1   # This allows residual variance on indicator X3 at T1

meaning_par1_t2 ~~ c("res1a", "res1b")*meaning_par1_t2  # This allows residual variance on indicator X1 at T2 
meaning_par2_t2 ~~ c("res2a", "res2b")*meaning_par2_t2  # This allows residual variance on indicator X2 at T2 
meaning_par3_t2 ~~ c("res3a", "res3b")*meaning_par3_t2  # This allows residual variance on indicator X3 at T2

meaning_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
meaning_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
meaning_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'
lcs_meaning_group_config <- sem(mi_lcs_meaning_group_config, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', 
                                fixed.x=FALSE, missing='fiml', group = "rando")

# weak invariance
mi_lcs_meaning_group_weak <- '
meaning_t1 =~ 1*meaning_par1_t1 + c("lamb2", "lamb2")*meaning_par2_t1 + c("lamb3", "lamb3")*meaning_par3_t1 # This specifies the measurement model for meaning_t1 
meaning_t2 =~ 1*meaning_par1_t2 + c("lamb2", "lamb2")*meaning_par2_t2 + c("lamb3", "lamb3")*meaning_par3_t2 # This specifies the measurement model for meaning_t2 with the equality constrained factor loadings

meaning_t2 ~ 1*meaning_t1     # This parameter regresses meaning_t2 perfectly on meaning_t1
d_meaning_1 =~ 1*meaning_t2   # This defines the latent change score factor as measured perfectly by scores on meaning_t2
meaning_t2 ~ 0*1           # This line constrains the intercept of meaning_t2 to 0
meaning_t2 ~~ 0*meaning_t2    # This fixes the variance of meaning_t2 to 0

d_meaning_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
meaning_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of meaning_t1 
d_meaning_1 ~~ c("d_var_a", "d_var_b")*d_meaning_1   # This estimates the variance of the change scores 
meaning_t1 ~~ c("wb_var_a", "wb_var_b")*meaning_t1     # This estimates the variance of the meaning_t1 
d_meaning_1 ~~ c("fb_a", "fb_b")*meaning_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t1 ~~ c("cov1a", "cov1b")*meaning_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t1 ~~ c("cov2a", "cov2b")*meaning_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t1 ~~ c("cov3a", "cov3b")*meaning_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t1 ~~ c("res1a", "res1b")*meaning_par1_t1   # This allows residual variance on indicator X1 at T1 
meaning_par2_t1 ~~ c("res2a", "res2b")*meaning_par2_t1   # This allows residual variance on indicator X2 at T1
meaning_par3_t1 ~~ c("res3a", "res3b")*meaning_par3_t1   # This allows residual variance on indicator X3 at T1

meaning_par1_t2 ~~ c("res1a", "res1b")*meaning_par1_t2  # This allows residual variance on indicator X1 at T2 
meaning_par2_t2 ~~ c("res2a", "res2b")*meaning_par2_t2  # This allows residual variance on indicator X2 at T2 
meaning_par3_t2 ~~ c("res3a", "res3b")*meaning_par3_t2  # This allows residual variance on indicator X3 at T2

meaning_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
meaning_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
meaning_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

lcs_meaning_group_weak <- sem(mi_lcs_meaning_group_weak, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "rando", group.equal = "loadings")

# strong invariance
mi_lcs_meaning_group_strong <- '
meaning_t1 =~ 1*meaning_par1_t1 + c("lamb2", "lamb2")*meaning_par2_t1 + c("lamb3", "lamb3")*meaning_par3_t1 # This specifies the measurement model for meaning_t1 
meaning_t2 =~ 1*meaning_par1_t2 + c("lamb2", "lamb2")*meaning_par2_t2 + c("lamb3", "lamb3")*meaning_par3_t2 # This specifies the measurement model for meaning_t2 with the equality constrained factor loadings

meaning_t2 ~ 1*meaning_t1     # This parameter regresses meaning_t2 perfectly on meaning_t1
d_meaning_1 =~ 1*meaning_t2   # This defines the latent change score factor as measured perfectly by scores on meaning_t2
meaning_t2 ~ 0*1           # This line constrains the intercept of meaning_t2 to 0
meaning_t2 ~~ 0*meaning_t2    # This fixes the variance of meaning_t2 to 0

d_meaning_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
meaning_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of meaning_t1 
d_meaning_1 ~~ c("d_var_a", "d_var_b")*d_meaning_1   # This estimates the variance of the change scores 
meaning_t1 ~~ c("wb_var_a", "wb_var_b")*meaning_t1     # This estimates the variance of the meaning_t1 
d_meaning_1 ~~ c("fb_a", "fb_b")*meaning_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t1 ~~ c("cov1a", "cov1b")*meaning_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t1 ~~ c("cov2a", "cov2b")*meaning_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t1 ~~ c("cov3a", "cov3b")*meaning_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t1 ~~ c("res1a", "res1b")*meaning_par1_t1   # This allows residual variance on indicator X1 at T1 
meaning_par2_t1 ~~ c("res2a", "res2b")*meaning_par2_t1   # This allows residual variance on indicator X2 at T1
meaning_par3_t1 ~~ c("res3a", "res3b")*meaning_par3_t1   # This allows residual variance on indicator X3 at T1

meaning_par1_t2 ~~ c("res1a", "res1b")*meaning_par1_t2  # This allows residual variance on indicator X1 at T2 
meaning_par2_t2 ~~ c("res2a", "res2b")*meaning_par2_t2  # This allows residual variance on indicator X2 at T2 
meaning_par3_t2 ~~ c("res3a", "res3b")*meaning_par3_t2  # This allows residual variance on indicator X3 at T2

meaning_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
meaning_par3_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
meaning_par3_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

lcs_meaning_group_strong <- sem(mi_lcs_meaning_group_strong, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "rando", group.equal = c("intercepts", "loadings"))
```

Meaning in life: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_meaning_group_config, lcs_meaning_group_weak, lcs_meaning_group_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_meaning_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_meaning <- broom::tidy(lcs_meaning_group_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="meaning" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_meaning_1 ~1 "))
kable(params_main_lcs_meaning, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_meaning_group_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="meaning" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_meaning_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Slightly more positive change in meaning in life in the Self-Improvement group but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_meaning_group_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Self-esteem 

Self-esteem: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_selfes_group_config <- '
selfes_t1 =~ 1*selfes_par1_t1 + c("lamb2a", "lamb2b")*selfes_par2_t1 + c("lamb3a", "lamb3b")*selfes_par3_t1 # This specifies the measurement model for selfes_t1 
selfes_t2 =~ 1*selfes_par1_t2 + c("lamb2a", "lamb2b")*selfes_par2_t2 + c("lamb3a", "lamb3b")*selfes_par3_t2 # This specifies the measurement model for selfes_t2 with the equality constrained factor loadings

selfes_t2 ~ 1*selfes_t1     # This parameter regresses selfes_t2 perfectly on selfes_t1
d_selfes_1 =~ 1*selfes_t2   # This defines the latent change score factor as measured perfectly by scores on selfes_t2
selfes_t2 ~ 0*1           # This line constrains the intercept of selfes_t2 to 0
selfes_t2 ~~ 0*selfes_t2    # This fixes the variance of selfes_t2 to 0

d_selfes_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
selfes_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of selfes_t1 
d_selfes_1 ~~ c("d_var_a", "d_var_b")*d_selfes_1   # This estimates the variance of the change scores 
selfes_t1 ~~ c("wb_var_a", "wb_var_b")*selfes_t1     # This estimates the variance of the selfes_t1 
d_selfes_1 ~~ c("fb_a", "fb_b")*selfes_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t1 ~~ c("cov1a", "cov1b")*selfes_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t1 ~~ c("cov2a", "cov2b")*selfes_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t1 ~~ c("cov3a", "cov3b")*selfes_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t1 ~~ c("res1a", "res1b")*selfes_par1_t1   # This allows residual variance on indicator X1 at T1 
selfes_par2_t1 ~~ c("res2a", "res2b")*selfes_par2_t1   # This allows residual variance on indicator X2 at T1
selfes_par3_t1 ~~ c("res3a", "res3b")*selfes_par3_t1   # This allows residual variance on indicator X3 at T1

selfes_par1_t2 ~~ c("res1a", "res1b")*selfes_par1_t2  # This allows residual variance on indicator X1 at T2 
selfes_par2_t2 ~~ c("res2a", "res2b")*selfes_par2_t2  # This allows residual variance on indicator X2 at T2 
selfes_par3_t2 ~~ c("res3a", "res3b")*selfes_par3_t2  # This allows residual variance on indicator X3 at T2

selfes_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
selfes_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
selfes_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'
lcs_selfes_group_config <- sem(mi_lcs_selfes_group_config, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', 
                                fixed.x=FALSE, missing='fiml', group = "rando")

# weak invariance
mi_lcs_selfes_group_weak <- '
selfes_t1 =~ 1*selfes_par1_t1 + c("lamb2", "lamb2")*selfes_par2_t1 + c("lamb3", "lamb3")*selfes_par3_t1 # This specifies the measurement model for selfes_t1 
selfes_t2 =~ 1*selfes_par1_t2 + c("lamb2", "lamb2")*selfes_par2_t2 + c("lamb3", "lamb3")*selfes_par3_t2 # This specifies the measurement model for selfes_t2 with the equality constrained factor loadings

selfes_t2 ~ 1*selfes_t1     # This parameter regresses selfes_t2 perfectly on selfes_t1
d_selfes_1 =~ 1*selfes_t2   # This defines the latent change score factor as measured perfectly by scores on selfes_t2
selfes_t2 ~ 0*1           # This line constrains the intercept of selfes_t2 to 0
selfes_t2 ~~ 0*selfes_t2    # This fixes the variance of selfes_t2 to 0

d_selfes_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
selfes_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of selfes_t1 
d_selfes_1 ~~ c("d_var_a", "d_var_b")*d_selfes_1   # This estimates the variance of the change scores 
selfes_t1 ~~ c("wb_var_a", "wb_var_b")*selfes_t1     # This estimates the variance of the selfes_t1 
d_selfes_1 ~~ c("fb_a", "fb_b")*selfes_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t1 ~~ c("cov1a", "cov1b")*selfes_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t1 ~~ c("cov2a", "cov2b")*selfes_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t1 ~~ c("cov3a", "cov3b")*selfes_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t1 ~~ c("res1a", "res1b")*selfes_par1_t1   # This allows residual variance on indicator X1 at T1 
selfes_par2_t1 ~~ c("res2a", "res2b")*selfes_par2_t1   # This allows residual variance on indicator X2 at T1
selfes_par3_t1 ~~ c("res3a", "res3b")*selfes_par3_t1   # This allows residual variance on indicator X3 at T1

selfes_par1_t2 ~~ c("res1a", "res1b")*selfes_par1_t2  # This allows residual variance on indicator X1 at T2 
selfes_par2_t2 ~~ c("res2a", "res2b")*selfes_par2_t2  # This allows residual variance on indicator X2 at T2 
selfes_par3_t2 ~~ c("res3a", "res3b")*selfes_par3_t2  # This allows residual variance on indicator X3 at T2

selfes_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
selfes_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
selfes_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

lcs_selfes_group_weak <- sem(mi_lcs_selfes_group_weak, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "rando", group.equal = "loadings")

# strong invariance
mi_lcs_selfes_group_strong <- '
selfes_t1 =~ 1*selfes_par1_t1 + c("lamb2", "lamb2")*selfes_par2_t1 + c("lamb3", "lamb3")*selfes_par3_t1 # This specifies the measurement model for selfes_t1 
selfes_t2 =~ 1*selfes_par1_t2 + c("lamb2", "lamb2")*selfes_par2_t2 + c("lamb3", "lamb3")*selfes_par3_t2 # This specifies the measurement model for selfes_t2 with the equality constrained factor loadings

selfes_t2 ~ 1*selfes_t1     # This parameter regresses selfes_t2 perfectly on selfes_t1
d_selfes_1 =~ 1*selfes_t2   # This defines the latent change score factor as measured perfectly by scores on selfes_t2
selfes_t2 ~ 0*1           # This line constrains the intercept of selfes_t2 to 0
selfes_t2 ~~ 0*selfes_t2    # This fixes the variance of selfes_t2 to 0

d_selfes_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
selfes_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of selfes_t1 
d_selfes_1 ~~ c("d_var_a", "d_var_b")*d_selfes_1   # This estimates the variance of the change scores 
selfes_t1 ~~ c("wb_var_a", "wb_var_b")*selfes_t1     # This estimates the variance of the selfes_t1 
d_selfes_1 ~~ c("fb_a", "fb_b")*selfes_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t1 ~~ c("cov1a", "cov1b")*selfes_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t1 ~~ c("cov2a", "cov2b")*selfes_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t1 ~~ c("cov3a", "cov3b")*selfes_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t1 ~~ c("res1a", "res1b")*selfes_par1_t1   # This allows residual variance on indicator X1 at T1 
selfes_par2_t1 ~~ c("res2a", "res2b")*selfes_par2_t1   # This allows residual variance on indicator X2 at T1
selfes_par3_t1 ~~ c("res3a", "res3b")*selfes_par3_t1   # This allows residual variance on indicator X3 at T1

selfes_par1_t2 ~~ c("res1a", "res1b")*selfes_par1_t2  # This allows residual variance on indicator X1 at T2 
selfes_par2_t2 ~~ c("res2a", "res2b")*selfes_par2_t2  # This allows residual variance on indicator X2 at T2 
selfes_par3_t2 ~~ c("res3a", "res3b")*selfes_par3_t2  # This allows residual variance on indicator X3 at T2

selfes_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
selfes_par3_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
selfes_par3_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

lcs_selfes_group_strong <- sem(mi_lcs_selfes_group_strong, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "rando", group.equal = c("intercepts", "loadings"))
```

Self-esteem: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_selfes_group_config, lcs_selfes_group_weak, lcs_selfes_group_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_selfes_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_selfes <- broom::tidy(lcs_selfes_group_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="selfes" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_selfes_1 ~1 "))
kable(params_main_lcs_selfes, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_selfes_group_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="selfes" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_selfes_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Slightly more positive change in self-esteem in the self-improvement group but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_selfes_group_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Self-concept clarity 

Self-concept clarity: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_concept_group_config <- '
concept_t1 =~ 1*concept_par1_t1 + c("lamb2a", "lamb2b")*concept_par2_t1 + c("lamb3a", "lamb3b")*concept_par3_t1 # This specifies the measurement model for concept_t1 
concept_t2 =~ 1*concept_par1_t2 + c("lamb2a", "lamb2b")*concept_par2_t2 + c("lamb3a", "lamb3b")*concept_par3_t2 # This specifies the measurement model for concept_t2 with the equality constrained factor loadings

concept_t2 ~ 1*concept_t1     # This parameter regresses concept_t2 perfectly on concept_t1
d_concept_1 =~ 1*concept_t2   # This defines the latent change score factor as measured perfectly by scores on concept_t2
concept_t2 ~ 0*1           # This line constrains the intercept of concept_t2 to 0
concept_t2 ~~ 0*concept_t2    # This fixes the variance of concept_t2 to 0

d_concept_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
concept_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of concept_t1 
d_concept_1 ~~ c("d_var_a", "d_var_b")*d_concept_1   # This estimates the variance of the change scores 
concept_t1 ~~ c("wb_var_a", "wb_var_b")*concept_t1     # This estimates the variance of the concept_t1 
d_concept_1 ~~ c("fb_a", "fb_b")*concept_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t1 ~~ c("cov1a", "cov1b")*concept_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t1 ~~ c("cov2a", "cov2b")*concept_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t1 ~~ c("cov3a", "cov3b")*concept_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t1 ~~ c("res1a", "res1b")*concept_par1_t1   # This allows residual variance on indicator X1 at T1 
concept_par2_t1 ~~ c("res2a", "res2b")*concept_par2_t1   # This allows residual variance on indicator X2 at T1
concept_par3_t1 ~~ c("res3a", "res3b")*concept_par3_t1   # This allows residual variance on indicator X3 at T1

concept_par1_t2 ~~ c("res1a", "res1b")*concept_par1_t2  # This allows residual variance on indicator X1 at T2 
concept_par2_t2 ~~ c("res2a", "res2b")*concept_par2_t2  # This allows residual variance on indicator X2 at T2 
concept_par3_t2 ~~ c("res3a", "res3b")*concept_par3_t2  # This allows residual variance on indicator X3 at T2

concept_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
concept_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
concept_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'
lcs_concept_group_config <- sem(mi_lcs_concept_group_config, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', 
                                fixed.x=FALSE, missing='fiml', group = "rando")

# weak invariance
mi_lcs_concept_group_weak <- '
concept_t1 =~ 1*concept_par1_t1 + c("lamb2", "lamb2")*concept_par2_t1 + c("lamb3", "lamb3")*concept_par3_t1 # This specifies the measurement model for concept_t1 
concept_t2 =~ 1*concept_par1_t2 + c("lamb2", "lamb2")*concept_par2_t2 + c("lamb3", "lamb3")*concept_par3_t2 # This specifies the measurement model for concept_t2 with the equality constrained factor loadings

concept_t2 ~ 1*concept_t1     # This parameter regresses concept_t2 perfectly on concept_t1
d_concept_1 =~ 1*concept_t2   # This defines the latent change score factor as measured perfectly by scores on concept_t2
concept_t2 ~ 0*1           # This line constrains the intercept of concept_t2 to 0
concept_t2 ~~ 0*concept_t2    # This fixes the variance of concept_t2 to 0

d_concept_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
concept_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of concept_t1 
d_concept_1 ~~ c("d_var_a", "d_var_b")*d_concept_1   # This estimates the variance of the change scores 
concept_t1 ~~ c("wb_var_a", "wb_var_b")*concept_t1     # This estimates the variance of the concept_t1 
d_concept_1 ~~ c("fb_a", "fb_b")*concept_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t1 ~~ c("cov1a", "cov1b")*concept_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t1 ~~ c("cov2a", "cov2b")*concept_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t1 ~~ c("cov3a", "cov3b")*concept_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t1 ~~ c("res1a", "res1b")*concept_par1_t1   # This allows residual variance on indicator X1 at T1 
concept_par2_t1 ~~ c("res2a", "res2b")*concept_par2_t1   # This allows residual variance on indicator X2 at T1
concept_par3_t1 ~~ c("res3a", "res3b")*concept_par3_t1   # This allows residual variance on indicator X3 at T1

concept_par1_t2 ~~ c("res1a", "res1b")*concept_par1_t2  # This allows residual variance on indicator X1 at T2 
concept_par2_t2 ~~ c("res2a", "res2b")*concept_par2_t2  # This allows residual variance on indicator X2 at T2 
concept_par3_t2 ~~ c("res3a", "res3b")*concept_par3_t2  # This allows residual variance on indicator X3 at T2

concept_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
concept_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
concept_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

lcs_concept_group_weak <- sem(mi_lcs_concept_group_weak, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "rando", group.equal = "loadings")

# strong invariance
mi_lcs_concept_group_strong <- '
concept_t1 =~ 1*concept_par1_t1 + c("lamb2", "lamb2")*concept_par2_t1 + c("lamb3", "lamb3")*concept_par3_t1 # This specifies the measurement model for concept_t1 
concept_t2 =~ 1*concept_par1_t2 + c("lamb2", "lamb2")*concept_par2_t2 + c("lamb3", "lamb3")*concept_par3_t2 # This specifies the measurement model for concept_t2 with the equality constrained factor loadings

concept_t2 ~ 1*concept_t1     # This parameter regresses concept_t2 perfectly on concept_t1
d_concept_1 =~ 1*concept_t2   # This defines the latent change score factor as measured perfectly by scores on concept_t2
concept_t2 ~ 0*1           # This line constrains the intercept of concept_t2 to 0
concept_t2 ~~ 0*concept_t2    # This fixes the variance of concept_t2 to 0

d_concept_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
concept_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of concept_t1 
d_concept_1 ~~ c("d_var_a", "d_var_b")*d_concept_1   # This estimates the variance of the change scores 
concept_t1 ~~ c("wb_var_a", "wb_var_b")*concept_t1     # This estimates the variance of the concept_t1 
d_concept_1 ~~ c("fb_a", "fb_b")*concept_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t1 ~~ c("cov1a", "cov1b")*concept_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t1 ~~ c("cov2a", "cov2b")*concept_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t1 ~~ c("cov3a", "cov3b")*concept_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t1 ~~ c("res1a", "res1b")*concept_par1_t1   # This allows residual variance on indicator X1 at T1 
concept_par2_t1 ~~ c("res2a", "res2b")*concept_par2_t1   # This allows residual variance on indicator X2 at T1
concept_par3_t1 ~~ c("res3a", "res3b")*concept_par3_t1   # This allows residual variance on indicator X3 at T1

concept_par1_t2 ~~ c("res1a", "res1b")*concept_par1_t2  # This allows residual variance on indicator X1 at T2 
concept_par2_t2 ~~ c("res2a", "res2b")*concept_par2_t2  # This allows residual variance on indicator X2 at T2 
concept_par3_t2 ~~ c("res3a", "res3b")*concept_par3_t2  # This allows residual variance on indicator X3 at T2

concept_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
concept_par3_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
concept_par3_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

lcs_concept_group_strong <- sem(mi_lcs_concept_group_strong, data=df_sbsa2_wide_wb %>% filter(rando!="Waitlist-Control"), estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "rando", group.equal = c("intercepts", "loadings"))
```

Self-concept clarity: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_concept_group_config, lcs_concept_group_weak, lcs_concept_group_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_concept_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_concept <- broom::tidy(lcs_concept_group_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="concept" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_concept_1 ~1 "))
kable(params_main_lcs_concept, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_concept_group_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="concept" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_concept_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Slightly more positive change in self-concept clarity in the self-improvement group but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_concept_group_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Summary of latent main effects

```{r}
#| echo: true
#| warning: false

params_main_wb_summary <- bind_rows(
  params_main_lcs_swls %>% mutate(trait = "Life satisfaction") %>% select(trait, group = label, estimate, beta, p.value),
  params_main_lcs_meaning %>% mutate(trait = "Meaning in life") %>% select(trait, group = label, estimate, beta, p.value),
  params_main_lcs_selfes %>% mutate(trait = "Self-esteem") %>% select(trait, group = label, estimate, beta, p.value),
  params_main_lcs_concept %>% mutate(trait = "Self-concept clarity") %>% select(trait, group = label, estimate, beta, p.value)) %>% mutate(group = ifelse(group=="d_int_a", "Self-Acceptance", "Self-Improvement"))

kable(params_main_wb_summary, digits = 3)
```

#### Latent well-being change: intervention vs. control

After seeing that the two intervention groups do not differ substantially, we want to test the control group vs. the two intervention groups (all from T1 to T2).  

```{r}
#| echo: true
#| warning: false
# add new group variable
df_sbsa2_wide_wb <- df_sbsa2_wide_wb %>% 
  mutate(group_cg = ifelse(rando=="Waitlist-Control", "Control", "Intervention"))

df_sbsa2_wide_wb %>% group_by(group_cg) %>% tally()
```

##### Life satisfaction 

Life satisfaction: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_swls_group_cg_config <- '
swls_t1 =~ 1*sw06_01_t1 + c("lamb2a", "lamb2b")*sw06_02_t1 + c("lamb3a", "lamb3b")*sw06_03_t1 + c("lamb4a", "lamb4b")*sw06_04_t1 # This specifies the measurement model for swls_t1 
swls_t2 =~ 1*sw06_01_t2 + c("lamb2a", "lamb2b")*sw06_02_t2 + c("lamb3a", "lamb3b")*sw06_03_t2 + c("lamb4a", "lamb4b")*sw06_04_t2 # This specifies the measurement model for swls_t2 with the equality constrained factor loadings

swls_t2 ~ 1*swls_t1     # This parameter regresses swls_t2 perfectly on swls_t1
d_swls_1 =~ 1*swls_t2   # This defines the latent change score factor as measured perfectly by scores on swls_t2
swls_t2 ~ 0*1           # This line constrains the intercept of swls_t2 to 0
swls_t2 ~~ 0*swls_t2    # This fixes the variance of swls_t2 to 0

d_swls_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
swls_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of swls_t1 
d_swls_1 ~~ c("d_var_a", "d_var_b")*d_swls_1   # This estimates the variance of the change scores 
swls_t1 ~~ c("wb_var_a", "wb_var_b")*swls_t1     # This estimates the variance of the swls_t1 
d_swls_1 ~~ c("fb_a", "fb_b")*swls_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t1 ~~ c("cov1a", "cov1b")*sw06_01_t2   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t1 ~~ c("cov2a", "cov2b")*sw06_02_t2   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t1 ~~ c("cov3a", "cov3b")*sw06_03_t2   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t1 ~~ c("cov4a", "cov4b")*sw06_04_t2   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t1 ~~ c("res1a", "res1b")*sw06_01_t1   # This allows residual variance on indicator X1 at T1 
sw06_02_t1 ~~ c("res2a", "res2b")*sw06_02_t1   # This allows residual variance on indicator X2 at T1
sw06_03_t1 ~~ c("res3a", "res3b")*sw06_03_t1   # This allows residual variance on indicator X3 at T1
sw06_04_t1 ~~ c("res4a", "res4b")*sw06_04_t1   # This allows residual variance on indicator X4 at T1

sw06_01_t2 ~~ c("res1a", "res1b")*sw06_01_t2  # This allows residual variance on indicator X1 at T2 
sw06_02_t2 ~~ c("res2a", "res2b")*sw06_02_t2  # This allows residual variance on indicator X2 at T2 
sw06_03_t2 ~~ c("res3a", "res3b")*sw06_03_t2  # This allows residual variance on indicator X3 at T2
sw06_04_t2 ~~ c("res4a", "res4b")*sw06_04_t2  # This allows residual variance on indicator X4 at T2

sw06_01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
sw06_03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1
sw06_04_t1 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T1

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
sw06_03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
sw06_04_t2 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T2
'
lcs_swls_group_cg_config <- sem(mi_lcs_swls_group_cg_config, data=df_sbsa2_wide_wb, estimator='mlr', 
                             fixed.x=FALSE, missing='fiml', group = "group_cg")

# weak invariance
mi_lcs_swls_group_cg_weak <- '
swls_t1 =~ 1*sw06_01_t1 + c("lamb2", "lamb2")*sw06_02_t1 + c("lamb3", "lamb3")*sw06_03_t1 + c("lamb4", "lamb4")*sw06_04_t1 # This specifies the measurement model for swls_t1 
swls_t2 =~ 1*sw06_01_t2 + c("lamb2", "lamb2")*sw06_02_t2 + c("lamb3", "lamb3")*sw06_03_t2 + c("lamb4", "lamb4")*sw06_04_t2 # This specifies the measurement model for swls_t2 with the equality constrained factor loadings

swls_t2 ~ 1*swls_t1     # This parameter regresses swls_t2 perfectly on swls_t1
d_swls_1 =~ 1*swls_t2   # This defines the latent change score factor as measured perfectly by scores on swls_t2
swls_t2 ~ 0*1           # This line constrains the intercept of swls_t2 to 0
swls_t2 ~~ 0*swls_t2    # This fixes the variance of swls_t2 to 0

d_swls_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
swls_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of swls_t1 
d_swls_1 ~~ c("d_var_a", "d_var_b")*d_swls_1   # This estimates the variance of the change scores 
swls_t1 ~~ c("wb_var_a", "wb_var_b")*swls_t1     # This estimates the variance of the swls_t1 
d_swls_1 ~~ c("fb_a", "fb_b")*swls_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t1 ~~ c("cov1a", "cov1b")*sw06_01_t2   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t1 ~~ c("cov2a", "cov2b")*sw06_02_t2   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t1 ~~ c("cov3a", "cov3b")*sw06_03_t2   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t1 ~~ c("cov4a", "cov4b")*sw06_04_t2   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t1 ~~ c("res1a", "res1b")*sw06_01_t1   # This allows residual variance on indicator X1 at T1 
sw06_02_t1 ~~ c("res2a", "res2b")*sw06_02_t1   # This allows residual variance on indicator X2 at T1
sw06_03_t1 ~~ c("res3a", "res3b")*sw06_03_t1   # This allows residual variance on indicator X3 at T1
sw06_04_t1 ~~ c("res4a", "res4b")*sw06_04_t1   # This allows residual variance on indicator X4 at T1

sw06_01_t2 ~~ c("res1a", "res1b")*sw06_01_t2  # This allows residual variance on indicator X1 at T2 
sw06_02_t2 ~~ c("res2a", "res2b")*sw06_02_t2  # This allows residual variance on indicator X2 at T2 
sw06_03_t2 ~~ c("res3a", "res3b")*sw06_03_t2  # This allows residual variance on indicator X3 at T2
sw06_04_t2 ~~ c("res4a", "res4b")*sw06_04_t2  # This allows residual variance on indicator X4 at T2

sw06_01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
sw06_03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1
sw06_04_t1 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T1

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
sw06_03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
sw06_04_t2 ~ c("m4a", "m4b")*1     # This estimates the intercept of X4 at T2
'

lcs_swls_group_cg_weak <- sem(mi_lcs_swls_group_cg_weak, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "group_cg", group.equal = "loadings")

# strong invariance
mi_lcs_swls_group_cg_strong <- '
swls_t1 =~ 1*sw06_01_t1 + c("lamb2", "lamb2")*sw06_02_t1 + c("lamb3", "lamb3")*sw06_03_t1 + c("lamb4", "lamb4")*sw06_04_t1 # This specifies the measurement model for swls_t1 
swls_t2 =~ 1*sw06_01_t2 + c("lamb2", "lamb2")*sw06_02_t2 + c("lamb3", "lamb3")*sw06_03_t2 + c("lamb4", "lamb4")*sw06_04_t2 # This specifies the measurement model for swls_t2 with the equality constrained factor loadings

swls_t2 ~ 1*swls_t1     # This parameter regresses swls_t2 perfectly on swls_t1
d_swls_1 =~ 1*swls_t2   # This defines the latent change score factor as measured perfectly by scores on swls_t2
swls_t2 ~ 0*1           # This line constrains the intercept of swls_t2 to 0
swls_t2 ~~ 0*swls_t2    # This fixes the variance of swls_t2 to 0

d_swls_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
swls_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of swls_t1 
d_swls_1 ~~ c("d_var_a", "d_var_b")*d_swls_1   # This estimates the variance of the change scores 
swls_t1 ~~ c("wb_var_a", "wb_var_b")*swls_t1     # This estimates the variance of the swls_t1 
d_swls_1 ~~ c("fb_a", "fb_b")*swls_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

sw06_01_t1 ~~ c("cov1a", "cov1b")*sw06_01_t2   # This allows residual covariance on indicator X1 across T1 and T2
sw06_02_t1 ~~ c("cov2a", "cov2b")*sw06_02_t2   # This allows residual covariance on indicator X2 across T1 and T2
sw06_03_t1 ~~ c("cov3a", "cov3b")*sw06_03_t2   # This allows residual covariance on indicator X3 across T1 and T2
sw06_04_t1 ~~ c("cov4a", "cov4b")*sw06_04_t2   # This allows residual covariance on indicator X4 across T1 and T2

sw06_01_t1 ~~ c("res1a", "res1b")*sw06_01_t1   # This allows residual variance on indicator X1 at T1 
sw06_02_t1 ~~ c("res2a", "res2b")*sw06_02_t1   # This allows residual variance on indicator X2 at T1
sw06_03_t1 ~~ c("res3a", "res3b")*sw06_03_t1   # This allows residual variance on indicator X3 at T1
sw06_04_t1 ~~ c("res4a", "res4b")*sw06_04_t1   # This allows residual variance on indicator X4 at T1

sw06_01_t2 ~~ c("res1a", "res1b")*sw06_01_t2  # This allows residual variance on indicator X1 at T2 
sw06_02_t2 ~~ c("res2a", "res2b")*sw06_02_t2  # This allows residual variance on indicator X2 at T2 
sw06_03_t2 ~~ c("res3a", "res3b")*sw06_03_t2  # This allows residual variance on indicator X3 at T2
sw06_04_t2 ~~ c("res4a", "res4b")*sw06_04_t2  # This allows residual variance on indicator X4 at T2

sw06_01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
sw06_02_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
sw06_03_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1
sw06_04_t1 ~ c("m4", "m4")*1     # This estimates the intercept of X4 at T1

sw06_01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
sw06_02_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
sw06_03_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
sw06_04_t2 ~ c("m4", "m4")*1     # This estimates the intercept of X4 at T2
'

lcs_swls_group_cg_strong <- sem(mi_lcs_swls_group_cg_strong, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "group_cg", group.equal = c("intercepts", "loadings"))
```

Life satisfaction: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_swls_group_cg_config, lcs_swls_group_cg_weak, lcs_swls_group_cg_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_swls_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Control group, b = Intervention groups)
params_main_lcs_swls_cg <- broom::tidy(lcs_swls_group_cg_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="swls" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_swls_1 ~1 "))
kable(params_main_lcs_swls_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_swls_group_cg_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="swls" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_swls_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Slightly more positive change in life satisfaction in the intervention groups compared to the control group but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_swls_group_cg_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Meaning in life

Meaning in life: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_meaning_group_cg_config <- '
meaning_t1 =~ 1*meaning_par1_t1 + c("lamb2a", "lamb2b")*meaning_par2_t1 + c("lamb3a", "lamb3b")*meaning_par3_t1 # This specifies the measurement model for meaning_t1 
meaning_t2 =~ 1*meaning_par1_t2 + c("lamb2a", "lamb2b")*meaning_par2_t2 + c("lamb3a", "lamb3b")*meaning_par3_t2 # This specifies the measurement model for meaning_t2 with the equality constrained factor loadings

meaning_t2 ~ 1*meaning_t1     # This parameter regresses meaning_t2 perfectly on meaning_t1
d_meaning_1 =~ 1*meaning_t2   # This defines the latent change score factor as measured perfectly by scores on meaning_t2
meaning_t2 ~ 0*1           # This line constrains the intercept of meaning_t2 to 0
meaning_t2 ~~ 0*meaning_t2    # This fixes the variance of meaning_t2 to 0

d_meaning_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
meaning_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of meaning_t1 
d_meaning_1 ~~ c("d_var_a", "d_var_b")*d_meaning_1   # This estimates the variance of the change scores 
meaning_t1 ~~ c("wb_var_a", "wb_var_b")*meaning_t1     # This estimates the variance of the meaning_t1 
d_meaning_1 ~~ c("fb_a", "fb_b")*meaning_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t1 ~~ c("cov1a", "cov1b")*meaning_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t1 ~~ c("cov2a", "cov2b")*meaning_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t1 ~~ c("cov3a", "cov3b")*meaning_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t1 ~~ c("res1a", "res1b")*meaning_par1_t1   # This allows residual variance on indicator X1 at T1 
meaning_par2_t1 ~~ c("res2a", "res2b")*meaning_par2_t1   # This allows residual variance on indicator X2 at T1
meaning_par3_t1 ~~ c("res3a", "res3b")*meaning_par3_t1   # This allows residual variance on indicator X3 at T1

meaning_par1_t2 ~~ c("res1a", "res1b")*meaning_par1_t2  # This allows residual variance on indicator X1 at T2 
meaning_par2_t2 ~~ c("res2a", "res2b")*meaning_par2_t2  # This allows residual variance on indicator X2 at T2 
meaning_par3_t2 ~~ c("res3a", "res3b")*meaning_par3_t2  # This allows residual variance on indicator X3 at T2

meaning_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
meaning_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
meaning_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'
lcs_meaning_group_cg_config <- sem(mi_lcs_meaning_group_cg_config, data=df_sbsa2_wide_wb, estimator='mlr', 
                                fixed.x=FALSE, missing='fiml', group = "group_cg")

# weak invariance
mi_lcs_meaning_group_cg_weak <- '
meaning_t1 =~ 1*meaning_par1_t1 + c("lamb2", "lamb2")*meaning_par2_t1 + c("lamb3", "lamb3")*meaning_par3_t1 # This specifies the measurement model for meaning_t1 
meaning_t2 =~ 1*meaning_par1_t2 + c("lamb2", "lamb2")*meaning_par2_t2 + c("lamb3", "lamb3")*meaning_par3_t2 # This specifies the measurement model for meaning_t2 with the equality constrained factor loadings

meaning_t2 ~ 1*meaning_t1     # This parameter regresses meaning_t2 perfectly on meaning_t1
d_meaning_1 =~ 1*meaning_t2   # This defines the latent change score factor as measured perfectly by scores on meaning_t2
meaning_t2 ~ 0*1           # This line constrains the intercept of meaning_t2 to 0
meaning_t2 ~~ 0*meaning_t2    # This fixes the variance of meaning_t2 to 0

d_meaning_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
meaning_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of meaning_t1 
d_meaning_1 ~~ c("d_var_a", "d_var_b")*d_meaning_1   # This estimates the variance of the change scores 
meaning_t1 ~~ c("wb_var_a", "wb_var_b")*meaning_t1     # This estimates the variance of the meaning_t1 
d_meaning_1 ~~ c("fb_a", "fb_b")*meaning_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t1 ~~ c("cov1a", "cov1b")*meaning_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t1 ~~ c("cov2a", "cov2b")*meaning_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t1 ~~ c("cov3a", "cov3b")*meaning_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t1 ~~ c("res1a", "res1b")*meaning_par1_t1   # This allows residual variance on indicator X1 at T1 
meaning_par2_t1 ~~ c("res2a", "res2b")*meaning_par2_t1   # This allows residual variance on indicator X2 at T1
meaning_par3_t1 ~~ c("res3a", "res3b")*meaning_par3_t1   # This allows residual variance on indicator X3 at T1

meaning_par1_t2 ~~ c("res1a", "res1b")*meaning_par1_t2  # This allows residual variance on indicator X1 at T2 
meaning_par2_t2 ~~ c("res2a", "res2b")*meaning_par2_t2  # This allows residual variance on indicator X2 at T2 
meaning_par3_t2 ~~ c("res3a", "res3b")*meaning_par3_t2  # This allows residual variance on indicator X3 at T2

meaning_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
meaning_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
meaning_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

lcs_meaning_group_cg_weak <- sem(mi_lcs_meaning_group_cg_weak, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "group_cg", group.equal = "loadings")

# strong invariance
mi_lcs_meaning_group_cg_strong <- '
meaning_t1 =~ 1*meaning_par1_t1 + c("lamb2", "lamb2")*meaning_par2_t1 + c("lamb3", "lamb3")*meaning_par3_t1 # This specifies the measurement model for meaning_t1 
meaning_t2 =~ 1*meaning_par1_t2 + c("lamb2", "lamb2")*meaning_par2_t2 + c("lamb3", "lamb3")*meaning_par3_t2 # This specifies the measurement model for meaning_t2 with the equality constrained factor loadings

meaning_t2 ~ 1*meaning_t1     # This parameter regresses meaning_t2 perfectly on meaning_t1
d_meaning_1 =~ 1*meaning_t2   # This defines the latent change score factor as measured perfectly by scores on meaning_t2
meaning_t2 ~ 0*1           # This line constrains the intercept of meaning_t2 to 0
meaning_t2 ~~ 0*meaning_t2    # This fixes the variance of meaning_t2 to 0

d_meaning_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
meaning_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of meaning_t1 
d_meaning_1 ~~ c("d_var_a", "d_var_b")*d_meaning_1   # This estimates the variance of the change scores 
meaning_t1 ~~ c("wb_var_a", "wb_var_b")*meaning_t1     # This estimates the variance of the meaning_t1 
d_meaning_1 ~~ c("fb_a", "fb_b")*meaning_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

meaning_par1_t1 ~~ c("cov1a", "cov1b")*meaning_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
meaning_par2_t1 ~~ c("cov2a", "cov2b")*meaning_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
meaning_par3_t1 ~~ c("cov3a", "cov3b")*meaning_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

meaning_par1_t1 ~~ c("res1a", "res1b")*meaning_par1_t1   # This allows residual variance on indicator X1 at T1 
meaning_par2_t1 ~~ c("res2a", "res2b")*meaning_par2_t1   # This allows residual variance on indicator X2 at T1
meaning_par3_t1 ~~ c("res3a", "res3b")*meaning_par3_t1   # This allows residual variance on indicator X3 at T1

meaning_par1_t2 ~~ c("res1a", "res1b")*meaning_par1_t2  # This allows residual variance on indicator X1 at T2 
meaning_par2_t2 ~~ c("res2a", "res2b")*meaning_par2_t2  # This allows residual variance on indicator X2 at T2 
meaning_par3_t2 ~~ c("res3a", "res3b")*meaning_par3_t2  # This allows residual variance on indicator X3 at T2

meaning_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
meaning_par2_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
meaning_par3_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

meaning_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
meaning_par2_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
meaning_par3_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

lcs_meaning_group_cg_strong <- sem(mi_lcs_meaning_group_cg_strong, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "group_cg", group.equal = c("intercepts", "loadings"))
```

Meaning in life: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_meaning_group_cg_config, lcs_meaning_group_cg_weak, lcs_meaning_group_cg_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_meaning_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Control group, b = Intervention groups)
params_main_lcs_meaning_cg <- broom::tidy(lcs_meaning_group_cg_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="meaning" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_meaning_1 ~1 "))
kable(params_main_lcs_meaning_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_meaning_group_cg_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="meaning" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_meaning_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Somewhat more positive change in meaning in life in the control group compared to the intervention groups but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_meaning_group_cg_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Self-esteem 

Self-esteem: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_selfes_group_cg_config <- '
selfes_t1 =~ 1*selfes_par1_t1 + c("lamb2a", "lamb2b")*selfes_par2_t1 + c("lamb3a", "lamb3b")*selfes_par3_t1 # This specifies the measurement model for selfes_t1 
selfes_t2 =~ 1*selfes_par1_t2 + c("lamb2a", "lamb2b")*selfes_par2_t2 + c("lamb3a", "lamb3b")*selfes_par3_t2 # This specifies the measurement model for selfes_t2 with the equality constrained factor loadings

selfes_t2 ~ 1*selfes_t1     # This parameter regresses selfes_t2 perfectly on selfes_t1
d_selfes_1 =~ 1*selfes_t2   # This defines the latent change score factor as measured perfectly by scores on selfes_t2
selfes_t2 ~ 0*1           # This line constrains the intercept of selfes_t2 to 0
selfes_t2 ~~ 0*selfes_t2    # This fixes the variance of selfes_t2 to 0

d_selfes_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
selfes_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of selfes_t1 
d_selfes_1 ~~ c("d_var_a", "d_var_b")*d_selfes_1   # This estimates the variance of the change scores 
selfes_t1 ~~ c("wb_var_a", "wb_var_b")*selfes_t1     # This estimates the variance of the selfes_t1 
d_selfes_1 ~~ c("fb_a", "fb_b")*selfes_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t1 ~~ c("cov1a", "cov1b")*selfes_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t1 ~~ c("cov2a", "cov2b")*selfes_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t1 ~~ c("cov3a", "cov3b")*selfes_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t1 ~~ c("res1a", "res1b")*selfes_par1_t1   # This allows residual variance on indicator X1 at T1 
selfes_par2_t1 ~~ c("res2a", "res2b")*selfes_par2_t1   # This allows residual variance on indicator X2 at T1
selfes_par3_t1 ~~ c("res3a", "res3b")*selfes_par3_t1   # This allows residual variance on indicator X3 at T1

selfes_par1_t2 ~~ c("res1a", "res1b")*selfes_par1_t2  # This allows residual variance on indicator X1 at T2 
selfes_par2_t2 ~~ c("res2a", "res2b")*selfes_par2_t2  # This allows residual variance on indicator X2 at T2 
selfes_par3_t2 ~~ c("res3a", "res3b")*selfes_par3_t2  # This allows residual variance on indicator X3 at T2

selfes_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
selfes_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
selfes_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'
lcs_selfes_group_cg_config <- sem(mi_lcs_selfes_group_cg_config, data=df_sbsa2_wide_wb, estimator='mlr', 
                                fixed.x=FALSE, missing='fiml', group = "group_cg")

# weak invariance
mi_lcs_selfes_group_cg_weak <- '
selfes_t1 =~ 1*selfes_par1_t1 + c("lamb2", "lamb2")*selfes_par2_t1 + c("lamb3", "lamb3")*selfes_par3_t1 # This specifies the measurement model for selfes_t1 
selfes_t2 =~ 1*selfes_par1_t2 + c("lamb2", "lamb2")*selfes_par2_t2 + c("lamb3", "lamb3")*selfes_par3_t2 # This specifies the measurement model for selfes_t2 with the equality constrained factor loadings

selfes_t2 ~ 1*selfes_t1     # This parameter regresses selfes_t2 perfectly on selfes_t1
d_selfes_1 =~ 1*selfes_t2   # This defines the latent change score factor as measured perfectly by scores on selfes_t2
selfes_t2 ~ 0*1           # This line constrains the intercept of selfes_t2 to 0
selfes_t2 ~~ 0*selfes_t2    # This fixes the variance of selfes_t2 to 0

d_selfes_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
selfes_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of selfes_t1 
d_selfes_1 ~~ c("d_var_a", "d_var_b")*d_selfes_1   # This estimates the variance of the change scores 
selfes_t1 ~~ c("wb_var_a", "wb_var_b")*selfes_t1     # This estimates the variance of the selfes_t1 
d_selfes_1 ~~ c("fb_a", "fb_b")*selfes_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t1 ~~ c("cov1a", "cov1b")*selfes_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t1 ~~ c("cov2a", "cov2b")*selfes_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t1 ~~ c("cov3a", "cov3b")*selfes_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t1 ~~ c("res1a", "res1b")*selfes_par1_t1   # This allows residual variance on indicator X1 at T1 
selfes_par2_t1 ~~ c("res2a", "res2b")*selfes_par2_t1   # This allows residual variance on indicator X2 at T1
selfes_par3_t1 ~~ c("res3a", "res3b")*selfes_par3_t1   # This allows residual variance on indicator X3 at T1

selfes_par1_t2 ~~ c("res1a", "res1b")*selfes_par1_t2  # This allows residual variance on indicator X1 at T2 
selfes_par2_t2 ~~ c("res2a", "res2b")*selfes_par2_t2  # This allows residual variance on indicator X2 at T2 
selfes_par3_t2 ~~ c("res3a", "res3b")*selfes_par3_t2  # This allows residual variance on indicator X3 at T2

selfes_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
selfes_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
selfes_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

lcs_selfes_group_cg_weak <- sem(mi_lcs_selfes_group_cg_weak, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "group_cg", group.equal = "loadings")

# strong invariance
mi_lcs_selfes_group_cg_strong <- '
selfes_t1 =~ 1*selfes_par1_t1 + c("lamb2", "lamb2")*selfes_par2_t1 + c("lamb3", "lamb3")*selfes_par3_t1 # This specifies the measurement model for selfes_t1 
selfes_t2 =~ 1*selfes_par1_t2 + c("lamb2", "lamb2")*selfes_par2_t2 + c("lamb3", "lamb3")*selfes_par3_t2 # This specifies the measurement model for selfes_t2 with the equality constrained factor loadings

selfes_t2 ~ 1*selfes_t1     # This parameter regresses selfes_t2 perfectly on selfes_t1
d_selfes_1 =~ 1*selfes_t2   # This defines the latent change score factor as measured perfectly by scores on selfes_t2
selfes_t2 ~ 0*1           # This line constrains the intercept of selfes_t2 to 0
selfes_t2 ~~ 0*selfes_t2    # This fixes the variance of selfes_t2 to 0

d_selfes_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
selfes_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of selfes_t1 
d_selfes_1 ~~ c("d_var_a", "d_var_b")*d_selfes_1   # This estimates the variance of the change scores 
selfes_t1 ~~ c("wb_var_a", "wb_var_b")*selfes_t1     # This estimates the variance of the selfes_t1 
d_selfes_1 ~~ c("fb_a", "fb_b")*selfes_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

selfes_par1_t1 ~~ c("cov1a", "cov1b")*selfes_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
selfes_par2_t1 ~~ c("cov2a", "cov2b")*selfes_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
selfes_par3_t1 ~~ c("cov3a", "cov3b")*selfes_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

selfes_par1_t1 ~~ c("res1a", "res1b")*selfes_par1_t1   # This allows residual variance on indicator X1 at T1 
selfes_par2_t1 ~~ c("res2a", "res2b")*selfes_par2_t1   # This allows residual variance on indicator X2 at T1
selfes_par3_t1 ~~ c("res3a", "res3b")*selfes_par3_t1   # This allows residual variance on indicator X3 at T1

selfes_par1_t2 ~~ c("res1a", "res1b")*selfes_par1_t2  # This allows residual variance on indicator X1 at T2 
selfes_par2_t2 ~~ c("res2a", "res2b")*selfes_par2_t2  # This allows residual variance on indicator X2 at T2 
selfes_par3_t2 ~~ c("res3a", "res3b")*selfes_par3_t2  # This allows residual variance on indicator X3 at T2

selfes_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
selfes_par2_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
selfes_par3_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

selfes_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
selfes_par2_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
selfes_par3_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

lcs_selfes_group_cg_strong <- sem(mi_lcs_selfes_group_cg_strong, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "group_cg", group.equal = c("intercepts", "loadings"))
```

Self-esteem: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_selfes_group_cg_config, lcs_selfes_group_cg_weak, lcs_selfes_group_cg_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_selfes_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Control group, b = Intervention groups)
params_main_lcs_selfes_cg <- broom::tidy(lcs_selfes_group_cg_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="selfes" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_selfes_1 ~1 "))
kable(params_main_lcs_selfes_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_selfes_group_cg_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="selfes" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_selfes_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Somewhat more positive change in self-esteem in the intervention groups compared to the control group but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_selfes_group_cg_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Self-concept clarity 

Self-concept clarity: fitting multi-group models
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# adapt latent change score model from above and add grouping factor in estimation (also add vectorized equality constraints to the model)

# configural invariance
mi_lcs_concept_group_cg_config <- '
concept_t1 =~ 1*concept_par1_t1 + c("lamb2a", "lamb2b")*concept_par2_t1 + c("lamb3a", "lamb3b")*concept_par3_t1 # This specifies the measurement model for concept_t1 
concept_t2 =~ 1*concept_par1_t2 + c("lamb2a", "lamb2b")*concept_par2_t2 + c("lamb3a", "lamb3b")*concept_par3_t2 # This specifies the measurement model for concept_t2 with the equality constrained factor loadings

concept_t2 ~ 1*concept_t1     # This parameter regresses concept_t2 perfectly on concept_t1
d_concept_1 =~ 1*concept_t2   # This defines the latent change score factor as measured perfectly by scores on concept_t2
concept_t2 ~ 0*1           # This line constrains the intercept of concept_t2 to 0
concept_t2 ~~ 0*concept_t2    # This fixes the variance of concept_t2 to 0

d_concept_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
concept_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of concept_t1 
d_concept_1 ~~ c("d_var_a", "d_var_b")*d_concept_1   # This estimates the variance of the change scores 
concept_t1 ~~ c("wb_var_a", "wb_var_b")*concept_t1     # This estimates the variance of the concept_t1 
d_concept_1 ~~ c("fb_a", "fb_b")*concept_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t1 ~~ c("cov1a", "cov1b")*concept_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t1 ~~ c("cov2a", "cov2b")*concept_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t1 ~~ c("cov3a", "cov3b")*concept_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t1 ~~ c("res1a", "res1b")*concept_par1_t1   # This allows residual variance on indicator X1 at T1 
concept_par2_t1 ~~ c("res2a", "res2b")*concept_par2_t1   # This allows residual variance on indicator X2 at T1
concept_par3_t1 ~~ c("res3a", "res3b")*concept_par3_t1   # This allows residual variance on indicator X3 at T1

concept_par1_t2 ~~ c("res1a", "res1b")*concept_par1_t2  # This allows residual variance on indicator X1 at T2 
concept_par2_t2 ~~ c("res2a", "res2b")*concept_par2_t2  # This allows residual variance on indicator X2 at T2 
concept_par3_t2 ~~ c("res3a", "res3b")*concept_par3_t2  # This allows residual variance on indicator X3 at T2

concept_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
concept_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
concept_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'
lcs_concept_group_cg_config <- sem(mi_lcs_concept_group_cg_config, data=df_sbsa2_wide_wb, estimator='mlr', 
                                fixed.x=FALSE, missing='fiml', group = "group_cg")

# weak invariance
mi_lcs_concept_group_cg_weak <- '
concept_t1 =~ 1*concept_par1_t1 + c("lamb2", "lamb2")*concept_par2_t1 + c("lamb3", "lamb3")*concept_par3_t1 # This specifies the measurement model for concept_t1 
concept_t2 =~ 1*concept_par1_t2 + c("lamb2", "lamb2")*concept_par2_t2 + c("lamb3", "lamb3")*concept_par3_t2 # This specifies the measurement model for concept_t2 with the equality constrained factor loadings

concept_t2 ~ 1*concept_t1     # This parameter regresses concept_t2 perfectly on concept_t1
d_concept_1 =~ 1*concept_t2   # This defines the latent change score factor as measured perfectly by scores on concept_t2
concept_t2 ~ 0*1           # This line constrains the intercept of concept_t2 to 0
concept_t2 ~~ 0*concept_t2    # This fixes the variance of concept_t2 to 0

d_concept_1 ~ c("d_int_a", "d_int_b")*1           # This estimates the intercept of the change score 
concept_t1 ~ c("wb_int_a", "wb_int_b")*1            # This estimates the intercept of concept_t1 
d_concept_1 ~~ c("d_var_a", "d_var_b")*d_concept_1   # This estimates the variance of the change scores 
concept_t1 ~~ c("wb_var_a", "wb_var_b")*concept_t1     # This estimates the variance of the concept_t1 
d_concept_1 ~~ c("fb_a", "fb_b")*concept_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t1 ~~ c("cov1a", "cov1b")*concept_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t1 ~~ c("cov2a", "cov2b")*concept_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t1 ~~ c("cov3a", "cov3b")*concept_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t1 ~~ c("res1a", "res1b")*concept_par1_t1   # This allows residual variance on indicator X1 at T1 
concept_par2_t1 ~~ c("res2a", "res2b")*concept_par2_t1   # This allows residual variance on indicator X2 at T1
concept_par3_t1 ~~ c("res3a", "res3b")*concept_par3_t1   # This allows residual variance on indicator X3 at T1

concept_par1_t2 ~~ c("res1a", "res1b")*concept_par1_t2  # This allows residual variance on indicator X1 at T2 
concept_par2_t2 ~~ c("res2a", "res2b")*concept_par2_t2  # This allows residual variance on indicator X2 at T2 
concept_par3_t2 ~~ c("res3a", "res3b")*concept_par3_t2  # This allows residual variance on indicator X3 at T2

concept_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
concept_par3_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
concept_par3_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

lcs_concept_group_cg_weak <- sem(mi_lcs_concept_group_cg_weak, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                           group = "group_cg", group.equal = "loadings")

# strong invariance
mi_lcs_concept_group_cg_strong <- '
concept_t1 =~ 1*concept_par1_t1 + c("lamb2", "lamb2")*concept_par2_t1 + c("lamb3", "lamb3")*concept_par3_t1 # This specifies the measurement model for concept_t1 
concept_t2 =~ 1*concept_par1_t2 + c("lamb2", "lamb2")*concept_par2_t2 + c("lamb3", "lamb3")*concept_par3_t2 # This specifies the measurement model for concept_t2 with the equality constrained factor loadings

concept_t2 ~ 1*concept_t1     # This parameter regresses concept_t2 perfectly on concept_t1
d_concept_1 =~ 1*concept_t2   # This defines the latent change score factor as measured perfectly by scores on concept_t2
concept_t2 ~ 0*1           # This line constrains the intercept of concept_t2 to 0
concept_t2 ~~ 0*concept_t2    # This fixes the variance of concept_t2 to 0

d_concept_1 ~ c("d_int", "d_int")*1           # This estimates the intercept of the change score 
concept_t1 ~ c("wb_int", "wb_int")*1            # This estimates the intercept of concept_t1 
d_concept_1 ~~ c("d_var_a", "d_var_b")*d_concept_1   # This estimates the variance of the change scores 
concept_t1 ~~ c("wb_var_a", "wb_var_b")*concept_t1     # This estimates the variance of the concept_t1 
d_concept_1 ~~ c("fb_a", "fb_b")*concept_t1     # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional

concept_par1_t1 ~~ c("cov1a", "cov1b")*concept_par1_t2   # This allows residual covariance on indicator X1 across T1 and T2
concept_par2_t1 ~~ c("cov2a", "cov2b")*concept_par2_t2   # This allows residual covariance on indicator X2 across T1 and T2
concept_par3_t1 ~~ c("cov3a", "cov3b")*concept_par3_t2   # This allows residual covariance on indicator X3 across T1 and T2

concept_par1_t1 ~~ c("res1a", "res1b")*concept_par1_t1   # This allows residual variance on indicator X1 at T1 
concept_par2_t1 ~~ c("res2a", "res2b")*concept_par2_t1   # This allows residual variance on indicator X2 at T1
concept_par3_t1 ~~ c("res3a", "res3b")*concept_par3_t1   # This allows residual variance on indicator X3 at T1

concept_par1_t2 ~~ c("res1a", "res1b")*concept_par1_t2  # This allows residual variance on indicator X1 at T2 
concept_par2_t2 ~~ c("res2a", "res2b")*concept_par2_t2  # This allows residual variance on indicator X2 at T2 
concept_par3_t2 ~~ c("res3a", "res3b")*concept_par3_t2  # This allows residual variance on indicator X3 at T2

concept_par1_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
concept_par2_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
concept_par3_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

concept_par1_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
concept_par2_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
concept_par3_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

lcs_concept_group_cg_strong <- sem(mi_lcs_concept_group_cg_strong, data=df_sbsa2_wide_wb, estimator='mlr', fixed.x=FALSE, missing='fiml', 
                             group = "group_cg", group.equal = c("intercepts", "loadings"))
```

Self-concept clarity: results
```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5

# model comparison tests for measurement invariance
lavTestLRT(lcs_concept_group_cg_config, lcs_concept_group_cg_weak, lcs_concept_group_cg_strong)

# show model with varying latent change parameters 
# -> key parameter is "d_concept_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Control group, b = Intervention groups)
params_main_lcs_concept_cg <- broom::tidy(lcs_concept_group_cg_weak, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="concept" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_concept_1 ~1 "))
kable(params_main_lcs_concept_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(lcs_concept_group_cg_strong, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_wb_st2 %>% filter(trait=="concept" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_concept_1 ~1 ")), digits = 3) 
```

::: {.callout-note appearance="minimal"}
Somewhat more positive change in self-concept clarity in the intervention groups compared to the control group but no substantial differences according to the LRTs.
:::

```{r}
#| echo: true
#| fig-width: 9.5
#| fig-height: 6.5
# whole model (weak invariance)
summary(lcs_concept_group_cg_weak, fit.measures=TRUE, standardized=TRUE, rsquare=F)
```

##### Summary of latent main effects

```{r}
#| echo: true
#| warning: false

params_main_wb_summary_cg <- bind_rows(
  params_main_lcs_swls_cg %>% mutate(trait = "Life satisfaction") %>% select(trait, group = label, estimate, beta, p.value),
  params_main_lcs_meaning_cg %>% mutate(trait = "Meaning in life") %>% select(trait, group = label, estimate, beta, p.value),
  params_main_lcs_selfes_cg %>% mutate(trait = "Self-esteem") %>% select(trait, group = label, estimate, beta, p.value),
  params_main_lcs_concept_cg %>% mutate(trait = "Self-concept clarity") %>% select(trait, group = label, estimate, beta, p.value)) %>% mutate(group = ifelse(group=="d_int_a", "Control", "Intervention"))

kable(params_main_wb_summary_cg, digits = 3)
```

#### Profile correlations / squared diffs: acceptance vs. improvement (MLMs)

Profile correlations by group and measurement occasion (multilevel regression models) - results:
```{r}
#| echo: true
#| warning: false
#| cache: true
df_sbsa2_t1t2 <- df_sbsa2 %>% filter(rando!="Waitlist-Control" & time %in% c(1,2)) %>% mutate(time_d = time - 1)

psych::describeBy(df_sbsa2_t1t2$profile_corr_item_z, list(df_sbsa2_t1t2$rando, df_sbsa2_t1t2$time_d))
psych::describeBy(df_sbsa2_t1t2$profile_corr_facet_z, list(df_sbsa2_t1t2$rando, df_sbsa2_t1t2$time_d))

lm_profile_corr_item <- lmerTest::lmer(profile_corr_item_z ~ time_d * rando + (1 | pid), data = df_sbsa2_t1t2)
lm_profile_corr_facet <- lmerTest::lmer(profile_corr_facet_z ~ time_d * rando + (1 | pid), data = df_sbsa2_t1t2)

kable(bind_rows(as.data.frame(summary(lm_profile_corr_item)$coefficients), as.data.frame(summary(lm_profile_corr_facet)$coefficients)) %>% as_tibble() %>% mutate(outcome = c(rep("Item-level profile corr.", 4), rep("Facet-level profile corr.", 4)), term = c(rep(c("Intercept", "time", "group", "time*group"), 2))) %>% select(outcome, term, everything()) %>% rename(p = `Pr(>|t|)`), digits = 3)
```

Squared trait-/facet-differences by group and measurement occasion (multilevel regression models) - results:
```{r}
#| echo: true
#| warning: false
#| cache: true
mod_traits_sqdiff_groups <- df_sbsa2_t1t2 %>% 
  select(pid, time_d, rando, ends_with("_sqdiff")) %>% 
  pivot_longer(ends_with("_sqdiff"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_by(pid, test) %>% 
  mutate(assessments = n()) %>% 
  ungroup() %>% 
  filter(assessments==2) %>% 
  select(-assessments) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * rando + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

mod_traits_sqdiff_groups_unlist <- as.data.frame(summary(mod_traits_sqdiff_groups[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(mod_traits_sqdiff_groups)) {
  mod_traits_sqdiff_groups_unlist <- bind_rows(mod_traits_sqdiff_groups_unlist, 
                                               as.data.frame(summary(mod_traits_sqdiff_groups[[i]])$coefficients) %>% as_tibble())
}

kable(mod_traits_sqdiff_groups_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=4), 
               term = c(rep(c("Intercept", "time", "group", "time*group"), 20))) %>% 
        select(outcome, term, everything()) %>% rename(p = `Pr(>|t|)`) %>% 
        arrange(factor(outcome, levels = (names(b5_vars)))), 
      digits = 3)
```

::: {.callout-note appearance="minimal"}
With both conceptualizations of the similarity / difference of current- and ideal-level personality (profile correlations / squared differences), we find no significant effects of group (at T1) or of interaction effects of group by measurement occasion (at T2).  
:::


#### Latent personality change: acceptance vs. improvement

##### Run models 

Adapt latent change score model from above (but without any moderation) and add grouping factor in estimation (adding vectorized equality constraints to the model step by step):  

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates:

# configural invariance
trait_template_main_config <- '
trait_t1 =~ 1*ind01_t1 +  c("lamb2a", "lamb2b")*ind02_t1 + c("lamb3a", "lamb3b")*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 +  c("lamb2a", "lamb2b")*ind02_t2 + c("lamb3a", "lamb3b")*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ c("d_int_a", "d_int_b")*1              # This estimates the intercept of the change score 
trait_t1 ~ c("b5_int_a", "b5_int_b")*1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ c("d_var_a", "d_var_b")*d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ c("b5_var_a", "b5_var_b")*trait_t1         # This estimates the variance of trait_t1 
d_trait_1 ~~ c("fb_a", "fb_b")* trait_t1   # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional and the moderation effect on the change score

ind01_t1 ~~ c("cov1a", "cov1b")*ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ c("cov2a", "cov2b")*ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ c("cov3a", "cov3b")*ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ c("res1a", "res1b")*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ c("res2a", "res2b")*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ c("res3a", "res3b")*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ c("res1a", "res1b")*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ c("res2a", "res2b")*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ c("res3a", "res3b")*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

# weak invariance
trait_template_main_weak <- '
trait_t1 =~ 1*ind01_t1 +  c("lamb2", "lamb2")*ind02_t1 + c("lamb3", "lamb3")*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 +  c("lamb2", "lamb2")*ind02_t2 + c("lamb3", "lamb3")*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ c("d_int_a", "d_int_b")*1              # This estimates the intercept of the change score 
trait_t1 ~ c("b5_int_a", "b5_int_b")*1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ c("d_var_a", "d_var_b")*d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ c("b5_var_a", "b5_var_b")*trait_t1         # This estimates the variance of trait_t1 
d_trait_1 ~~ c("fb_a", "fb_b")* trait_t1   # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional and the moderation effect on the change score

ind01_t1 ~~ c("cov1a", "cov1b")*ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ c("cov2a", "cov2b")*ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ c("cov3a", "cov3b")*ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ c("res1a", "res1b")*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ c("res2a", "res2b")*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ c("res3a", "res3b")*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ c("res1a", "res1b")*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ c("res2a", "res2b")*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ c("res3a", "res3b")*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

# strong invariance
trait_template_main_strong <- '
trait_t1 =~ 1*ind01_t1 +  c("lamb2", "lamb2")*ind02_t1 + c("lamb3", "lamb3")*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 +  c("lamb2", "lamb2")*ind02_t2 + c("lamb3", "lamb3")*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ c("d_int", "d_int")*1              # This estimates the intercept of the change score 
trait_t1 ~ c("b5_int", "b5_int")*1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ c("d_var_a", "d_var_b")*d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ c("b5_var_a", "b5_var_b")*trait_t1         # This estimates the variance of trait_t1 
d_trait_1 ~~ c("fb_a", "fb_b")* trait_t1   # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score remains unconditional and the moderation effect on the change score

ind01_t1 ~~ c("cov1a", "cov1b")*ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ c("cov2a", "cov2b")*ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ c("cov3a", "cov3b")*ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ c("res1a", "res1b")*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ c("res2a", "res2b")*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ c("res3a", "res3b")*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ c("res1a", "res1b")*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ c("res2a", "res2b")*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ c("res3a", "res3b")*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

# strict invariance -> not really needed for this analysis

# loop across 5 traits
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # configural - current
  template_filled_config_current <- str_replace_all(trait_template_main_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_main_fit_config_current <- lavaan(template_filled_config_current, 
                                          data = bind_rows(df_sbsa2_wide_pers_sa_mod, df_sbsa2_wide_pers_sb_mod) %>% left_join(group_assign), 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_config_current")), template_filled_config_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_config_current")), trait_main_fit_config_current))
  # configural - ideal
  template_filled_config_ideal <- str_replace_all(trait_template_main_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_main_fit_config_ideal <- lavaan(template_filled_config_ideal, 
                                        data = bind_rows(df_sbsa2_wide_pers_sa_mod, df_sbsa2_wide_pers_sb_mod) %>% left_join(group_assign), 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_config_ideal")), template_filled_config_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_config_ideal")), trait_main_fit_config_ideal))
  # weak - current
  template_filled_weak_current <- str_replace_all(trait_template_main_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_main_fit_weak_current <- lavaan(template_filled_weak_current, 
                                          data = bind_rows(df_sbsa2_wide_pers_sa_mod, df_sbsa2_wide_pers_sb_mod) %>% left_join(group_assign), 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_weak_current")), template_filled_weak_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_weak_current")), trait_main_fit_weak_current))
  # weak - ideal
  template_filled_weak_ideal <- str_replace_all(trait_template_main_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_main_fit_weak_ideal <- lavaan(template_filled_weak_ideal, 
                                        data = bind_rows(df_sbsa2_wide_pers_sa_mod, df_sbsa2_wide_pers_sb_mod) %>% left_join(group_assign), 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_weak_ideal")), template_filled_weak_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_weak_ideal")), trait_main_fit_weak_ideal))
  # strong - current
  template_filled_strong_current <- str_replace_all(trait_template_main_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_main_fit_strong_current <- lavaan(template_filled_strong_current, 
                                          data = bind_rows(df_sbsa2_wide_pers_sa_mod, df_sbsa2_wide_pers_sb_mod) %>% left_join(group_assign), 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_strong_current")), template_filled_strong_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_strong_current")), trait_main_fit_strong_current))
  # strong - ideal
  template_filled_strong_ideal <- str_replace_all(trait_template_main_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_main_fit_strong_ideal <- lavaan(template_filled_strong_ideal, 
                                        data = bind_rows(df_sbsa2_wide_pers_sa_mod, df_sbsa2_wide_pers_sb_mod) %>% left_join(group_assign), 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_strong_ideal")), template_filled_strong_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_strong_ideal")), trait_main_fit_strong_ideal))
}
```

##### Current personality traits

Extraversion (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_main_config_current, fit_lcs_extra_main_weak_current, fit_lcs_extra_main_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_extra_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_extra_current <- broom::tidy(fit_lcs_extra_main_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
  mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_extra_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_main_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_main_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Very similar change in extraversion in both groups. No significant differences according to the LRTs.
:::

Agreeableness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_main_config_current, fit_lcs_agree_main_weak_current, fit_lcs_agree_main_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_agree_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_agree_current <- broom::tidy(fit_lcs_agree_main_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_agree_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_main_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_main_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No change in agreeableness in both groups (increase is slightly larger in self-acceptance group). No significant differences according to the LRTs.
:::

Conscientiousness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_main_config_current, fit_lcs_consc_main_weak_current, fit_lcs_consc_main_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_consc_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_consc_current <- broom::tidy(fit_lcs_consc_main_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_consc_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_main_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_main_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in conscientiousness in both groups (increase is slightly larger in self-acceptance group). No significant differences according to the LRTs.
:::

Neuroticism (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_main_config_current, fit_lcs_neuro_main_weak_current, fit_lcs_neuro_main_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_neuro_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_neuro_current <- broom::tidy(fit_lcs_neuro_main_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_neuro_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_main_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_main_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in neuroticism in both groups (decrease is slightly larger in self-improvement group). No significant differences according to the LRTs.
:::

Openness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_main_config_current, fit_lcs_openn_main_weak_current, fit_lcs_openn_main_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_openn_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_openn_current <- broom::tidy(fit_lcs_openn_main_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_openn_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_main_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_main_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar (quite small) change in openness in both groups (increase is slightly larger in self-acceptance group). No significant differences according to the LRTs.
:::

##### Ideal personality traits

Extraversion (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_main_config_ideal, fit_lcs_extra_main_weak_ideal, fit_lcs_extra_main_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_extra_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_extra_ideal <- broom::tidy(fit_lcs_extra_main_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_extra_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_main_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_main_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Slight decrease in extraversion that is n.s. and slightly more pronounced in the self-acceptance group. 
:::

Agreeableness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_main_config_ideal, fit_lcs_agree_main_weak_ideal, fit_lcs_agree_main_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_agree_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_agree_ideal <- broom::tidy(fit_lcs_agree_main_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_agree_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_main_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_main_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Almost no change in agreeableness in both groups (n.s.). Slight decrease in self-acceptance group. No significant differences according to the LRTs.
:::

Conscientiousness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_main_config_ideal, fit_lcs_consc_main_weak_ideal, fit_lcs_consc_main_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_consc_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_consc_ideal <- broom::tidy(fit_lcs_consc_main_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_consc_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_main_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_main_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Almost no change in conscientiousness in both groups (n.s.). Increase is slightly less pronounced in self-acceptance group. No significant differences according to the LRTs.
:::

Neuroticism (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_main_config_ideal, fit_lcs_neuro_main_weak_ideal, fit_lcs_neuro_main_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_neuro_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_neuro_ideal <- broom::tidy(fit_lcs_neuro_main_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_neuro_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_main_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_main_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Very similar change in neuroticism in both groups (slight decrease in self-improvement group). No significant differences according to the LRTs.
:::

Openness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_main_config_ideal, fit_lcs_openn_main_weak_ideal, fit_lcs_openn_main_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_openn_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_main_lcs_openn_ideal <- broom::tidy(fit_lcs_openn_main_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_openn_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_main_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_main_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in ideal-personality openness in both groups (slight decrease in self-improvement group). No significant differences according to the LRTs.
:::

##### Summary of latent main effects

```{r}
#| echo: true
#| warning: false

params_main_summary <- bind_rows(
  params_main_lcs_extra_current %>% mutate(trait = names(b5_vars)[1], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_extra_ideal %>% mutate(trait = names(b5_vars)[1], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_agree_current %>% mutate(trait = names(b5_vars)[2], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_agree_ideal %>% mutate(trait = names(b5_vars)[2], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_consc_current %>% mutate(trait = names(b5_vars)[3], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_consc_ideal %>% mutate(trait = names(b5_vars)[3], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_neuro_current %>% mutate(trait = names(b5_vars)[4], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_neuro_ideal %>% mutate(trait = names(b5_vars)[4], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_openn_current %>% mutate(trait = names(b5_vars)[5], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_openn_ideal %>% mutate(trait = names(b5_vars)[5], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff)
) %>% mutate(group = ifelse(group=="d_int_a", "accept", "improve"))

kable(params_main_summary, digits = 3)
```

#### Latent personality change: intervention vs. control

##### Run models 

After seeing that the two intervention groups do not differ substantially, we want to test the control group vs. the two intervention groups (all from T1 to T2).  

```{r}
#| echo: true
#| warning: false
# new data frame
df_sbsa2_wide_pers_int_cg <- df_sbsa2_wide_pers %>% 
  mutate(group_cg = ifelse(rando=="Waitlist-Control", "Control", "Intervention"))

df_sbsa2_wide_pers_int_cg %>% group_by(group_cg) %>% tally()
```

Adapt latent change score model from above (but without any moderation) and add grouping factor in estimation (adding vectorized equality constraints to the model step by step):  

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates: -> same templates as above, we're only setting up a different group comparison!

# loop across 5 traits
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # configural - current
  template_filled_config_current_cg <- str_replace_all(trait_template_main_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_main_fit_config_current_cg <- lavaan(template_filled_config_current_cg, 
                                          data = df_sbsa2_wide_pers_int_cg, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "group_cg")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_config_current_cg")), template_filled_config_current_cg))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_config_current_cg")), trait_main_fit_config_current_cg))
  # configural - ideal
  template_filled_config_ideal_cg <- str_replace_all(trait_template_main_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_main_fit_config_ideal_cg <- lavaan(template_filled_config_ideal_cg, 
                                        data = df_sbsa2_wide_pers_int_cg, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "group_cg")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_config_ideal_cg")), template_filled_config_ideal_cg))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_config_ideal_cg")), trait_main_fit_config_ideal_cg))
  # weak - current
  template_filled_weak_current_cg <- str_replace_all(trait_template_main_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_main_fit_weak_current_cg <- lavaan(template_filled_weak_current_cg, 
                                          data = df_sbsa2_wide_pers_int_cg, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "group_cg", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_weak_current_cg")), template_filled_weak_current_cg))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_weak_current_cg")), trait_main_fit_weak_current_cg))
  # weak - ideal
  template_filled_weak_ideal_cg <- str_replace_all(trait_template_main_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_main_fit_weak_ideal_cg <- lavaan(template_filled_weak_ideal_cg, 
                                        data = df_sbsa2_wide_pers_int_cg, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "group_cg", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_weak_ideal_cg")), template_filled_weak_ideal_cg))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_weak_ideal_cg")), trait_main_fit_weak_ideal_cg))
  # strong - current
  template_filled_strong_current_cg <- str_replace_all(trait_template_main_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_main_fit_strong_current_cg <- lavaan(template_filled_strong_current_cg, 
                                          data = df_sbsa2_wide_pers_int_cg, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "group_cg", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_strong_current_cg")), template_filled_strong_current_cg))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_strong_current_cg")), trait_main_fit_strong_current_cg))
  # strong - ideal
  template_filled_strong_ideal_cg <- str_replace_all(trait_template_main_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_main_fit_strong_ideal_cg <- lavaan(template_filled_strong_ideal_cg, 
                                        data = df_sbsa2_wide_pers_int_cg, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "group_cg", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_main_strong_ideal_cg")), template_filled_strong_ideal_cg))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_main_strong_ideal_cg")), trait_main_fit_strong_ideal_cg))
}
```

Control group comes first in the multigroup SEM:  
*a* = waitlist control group (*N* = 175), *b* = both intervention groups (*N* = 674) 

##### Current personality traits

Extraversion (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_main_config_current_cg, fit_lcs_extra_main_weak_current_cg, fit_lcs_extra_main_strong_current_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_extra_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_extra_current_cg <- broom::tidy(fit_lcs_extra_main_weak_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_extra_current_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_main_strong_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_main_weak_current_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant differences according to the LRTs but slight difference visible (stronger increase in intervention groups). Latent change score only significant (at *p* < .001) in the intervention groups.
:::

Agreeableness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_main_config_current_cg, fit_lcs_agree_main_weak_current_cg, fit_lcs_agree_main_strong_current_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_agree_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_agree_current_cg <- broom::tidy(fit_lcs_agree_main_weak_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_agree_current_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_main_strong_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_main_weak_current_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No change in agreeableness in both groups (at *p* < .001). Effect is even slightly larger in control group. No significant differences according to the LRTs.  
:::

Conscientiousness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_main_config_current_cg, fit_lcs_consc_main_weak_current_cg, fit_lcs_consc_main_strong_current_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_consc_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_consc_current_cg <- broom::tidy(fit_lcs_consc_main_weak_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_consc_current_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_main_strong_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_main_weak_current_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in conscientiousness in both groups (increase is, however, not significant in the control group at *p* < .001). No significant differences according to the LRTs.
:::

Neuroticism (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_main_config_current_cg, fit_lcs_neuro_main_weak_current_cg, fit_lcs_neuro_main_strong_current_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_neuro_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_neuro_current_cg <- broom::tidy(fit_lcs_neuro_main_weak_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_neuro_current_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_main_strong_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_main_weak_current_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant differences according to the LRTs but slight difference visible (stronger neuroticism decrease in intervention groups). Latent change score only significant (at *p* < .001) in the intervention groups.
:::

Openness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_main_config_current_cg, fit_lcs_openn_main_weak_current_cg, fit_lcs_openn_main_strong_current_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_openn_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_openn_current_cg <- broom::tidy(fit_lcs_openn_main_weak_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_openn_current_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_main_strong_current_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="current" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_main_weak_current_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant differences according to the LRTs but difference visible, with stronger openness increase in intervention groups. Latent change score only significant in the intervention groups.
:::

##### Ideal personality traits

Extraversion (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_main_config_ideal_cg, fit_lcs_extra_main_weak_ideal_cg, fit_lcs_extra_main_strong_ideal_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_extra_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_extra_ideal_cg <- broom::tidy(fit_lcs_extra_main_weak_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_extra_ideal_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_main_strong_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="extra" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_main_weak_ideal_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Slight decrease in extraversion that is n.s. and slightly more pronounced in the intervention groups. No significant differences according to the LRTs. 
:::

Agreeableness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_main_config_ideal_cg, fit_lcs_agree_main_weak_ideal_cg, fit_lcs_agree_main_strong_ideal_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_agree_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_agree_ideal_cg <- broom::tidy(fit_lcs_agree_main_weak_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_agree_ideal_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_main_strong_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="agree" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_main_weak_ideal_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Almost no change in agreeableness in both groups (n.s.). No significant differences according to the LRTs.
:::

Conscientiousness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_main_config_ideal_cg, fit_lcs_consc_main_weak_ideal_cg, fit_lcs_consc_main_strong_ideal_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_consc_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_consc_ideal_cg <- broom::tidy(fit_lcs_consc_main_weak_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_consc_ideal_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_main_strong_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="consc" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_main_weak_ideal_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Almost no change in conscientiousness in both groups (n.s.). No significant differences according to the LRTs.
:::

Neuroticism (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_main_config_ideal_cg, fit_lcs_neuro_main_weak_ideal_cg, fit_lcs_neuro_main_strong_ideal_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_neuro_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_neuro_ideal_cg <- broom::tidy(fit_lcs_neuro_main_weak_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_neuro_ideal_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_main_strong_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="neuro" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_main_weak_ideal_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in neuroticism in both groups. No significant differences according to the LRTs (at *p* < .001). Some evidence for significant increase in model fit when constraining factor structures to be equal (weak MI), but this does not concern the latent change score yet. 
:::

Openness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_main_config_ideal_cg, fit_lcs_openn_main_weak_ideal_cg, fit_lcs_openn_main_strong_ideal_cg)

# show model with varying latent change parameters 
# -> key parameter is "d_openn_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = waitlist control group, b = both intervention groups)
params_main_lcs_openn_ideal_cg <- broom::tidy(fit_lcs_openn_main_weak_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")) %>% mutate(sig_diff = " ")
kable(params_main_lcs_openn_ideal_cg, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_main_strong_ideal_cg, conf.int = TRUE, conf.level = 0.999) %>% 
        mutate(beta = estimate / 
           (sd_pers_st2 %>% filter(trait=="openn" & reference=="ideal" & time==1) %>% pull(sd_trait))) %>% 
        select(term, label, estimate, beta, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_main_weak_ideal_cg) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in ideal-personality openness in both groups. No significant differences according to the LRTs.
:::

##### Summary of latent main effects

```{r}
#| echo: true
#| warning: false

params_main_summary_cg <- bind_rows(
  params_main_lcs_extra_current_cg %>% mutate(trait = names(b5_vars)[1], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_extra_ideal_cg %>% mutate(trait = names(b5_vars)[1], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_agree_current_cg %>% mutate(trait = names(b5_vars)[2], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_agree_ideal_cg %>% mutate(trait = names(b5_vars)[2], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_consc_current_cg %>% mutate(trait = names(b5_vars)[3], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_consc_ideal_cg %>% mutate(trait = names(b5_vars)[3], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_neuro_current_cg %>% mutate(trait = names(b5_vars)[4], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_neuro_ideal_cg %>% mutate(trait = names(b5_vars)[4], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_openn_current_cg %>% mutate(trait = names(b5_vars)[5], self = "current") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff),
  params_main_lcs_openn_ideal_cg %>% mutate(trait = names(b5_vars)[5], self = "ideal") %>% select(trait, self, group = label, estimate, beta, p.value, sig_diff)
) %>% mutate(group = ifelse(group=="d_int_a", "Control", "Intervention"))

kable(params_main_summary_cg, digits = 3)
```

#### Multilevel models: intervention groups vs. control group

Does it look differently if we test the control group vs. the two intervention groups (all from T1 to T2) using multilevel models instead of the multigroup SEM comparison?  

We'll do this for current personality, ideal personality, and well-being.  

##### Run models 

Create data frame:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_mlm_check_curr <- df_sbsa2 %>% 
  filter(time %in% c(1,2)) %>% 
  mutate(time_d = time - 1,
         intv = ifelse(rando!="Waitlist-Control", 1, 0)) %>% 
  select(pid, time_d, rando, intv, 
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_comb_curr"))

df_mlm_check_ideal <- df_sbsa2 %>% 
  filter(time %in% c(1,2)) %>% 
  mutate(time_d = time - 1,
         intv = ifelse(rando!="Waitlist-Control", 1, 0)) %>% 
  select(pid, time_d, rando, intv, 
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_comb_ideal"))

df_mlm_check_wb <- df_sbsa2 %>% 
  filter(time %in% c(1,2)) %>% 
  mutate(time_d = time - 1,
         intv = ifelse(rando!="Waitlist-Control", 1, 0)) %>% 
  select(pid, time_d, rando, intv, 
         swls, meaning, selfes, concept)

df_mlm_check_curr %>% group_by(intv, time_d) %>% tally()
```

Convert to long format and run model across all domains and facets:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true
df_mlm_check_curr <- df_mlm_check_curr %>% 
  pivot_longer(ends_with("_comb_curr"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * intv + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_mlm_check_ideal <- df_mlm_check_ideal %>% 
  pivot_longer(ends_with("_comb_ideal"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * intv + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_mlm_check_wb <- df_mlm_check_wb %>% 
  pivot_longer(c(swls, meaning, selfes, concept), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * intv + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(c("Self-concept clarity", "Meaning in life", "Self-esteem", "Life satisfaction"))
```

##### Results: current personality 

Just the domains for now (not the facets): 
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true

# unlist
df_mlm_check_curr_unlist <- as.data.frame(summary(df_mlm_check_curr[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(df_mlm_check_curr)) {
  df_mlm_check_curr_unlist <- bind_rows(df_mlm_check_curr_unlist, 
                                          as.data.frame(summary(df_mlm_check_curr[[i]])$coefficients) %>% as_tibble())
}

# label etc.
df_mlm_check_curr_unlist <- df_mlm_check_curr_unlist %>% # order by BFI traits
        mutate(outcome = rep(sort(names(b5_vars)), each=4), 
               term = c(rep(c("Intercept", "time (1 vs. 2)", 
                              "group (control vs. intv.)", "time*group"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% 
  select(outcome, term, est, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# display -> only for domains for now
kable(df_mlm_check_curr_unlist[1:20, ] , 
      digits = 3)
```

These are unstandardized effect sizes, interpretable on the original scale.  

Control group comes first: 0 = waitlist control group (*N* = 175), 1 = both intervention groups (*N* = 674) 

##### Results: ideal personality 

Just the domains for now (not the facets): 
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true

# unlist
df_mlm_check_ideal_unlist <- as.data.frame(summary(df_mlm_check_ideal[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(df_mlm_check_ideal)) {
  df_mlm_check_ideal_unlist <- bind_rows(df_mlm_check_ideal_unlist, 
                                          as.data.frame(summary(df_mlm_check_ideal[[i]])$coefficients) %>% as_tibble())
}

# label etc.
df_mlm_check_ideal_unlist <- df_mlm_check_ideal_unlist %>% # order by BFI traits
        mutate(outcome = rep(sort(names(b5_vars)), each=4), 
               term = c(rep(c("Intercept", "time (1 vs. 2)", 
                              "group (control vs. intv.)", "time*group"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% 
  select(outcome, term, est, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# display -> only for domains for now
kable(df_mlm_check_ideal_unlist[1:20, ] , 
      digits = 3)
```

These are unstandardized effect sizes, interpretable on the original scale.  

Control group comes first: 0 = waitlist control group (*N* = 175), 1 = both intervention groups (*N* = 674) 

##### Results: well-being

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true

# unlist
df_mlm_check_wb_unlist <- as.data.frame(summary(df_mlm_check_wb[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(df_mlm_check_wb)) {
  df_mlm_check_wb_unlist <- bind_rows(df_mlm_check_wb_unlist, 
                                          as.data.frame(summary(df_mlm_check_wb[[i]])$coefficients) %>% as_tibble())
}

# label etc.
df_mlm_check_wb_unlist <- df_mlm_check_wb_unlist %>% # order by BFI traits
        mutate(outcome = rep(c("Self-concept clarity", "Meaning in life", 
                               "Self-esteem", "Life satisfaction"), each=4), 
               term = c(rep(c("Intercept", "time (1 vs. 2)", 
                              "group (control vs. intv.)", "time*group"), 4))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% 
  select(outcome, term, est, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars))))

# display -> only for domains for now
kable(df_mlm_check_wb_unlist, digits = 3)
```

These are unstandardized effect sizes, interpretable on the original scale.  

Control group comes first: 0 = waitlist control group (*N* = 175), 1 = both intervention groups (*N* = 674) 

## Exploratory findings

### Differences across intervention groups (a)

Now confirmatory in Study 2.  

### Personal project dimensions (b)

We will explore b) whether the extent of change/acceptance is related to personal project dimension variables.  

Not assessed, anymore, in study 2. Please see study 1 report for results.  

### Traits that were selected as change goals (c)

We will explore c) whether there are stronger rates of change/acceptance on traits that were selected as change goals (in the 5 free-form adjectives) than those that were not. 

*TBD!*

### Robustness check (d)

Does self-improvement intervene on current personality trait change (but not ideal personality)? Does self-acceptance intervene on ideal personality trait change (but not current personality)?

#### From T1 to T2

Changes in current personality traits over time:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_manip_check_curr <- df_sbsa2_t1t2 %>% 
  select(pid, time_d, rando, 
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_comb_curr")) %>% 
  pivot_longer(ends_with("_comb_curr"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * rando + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_manip_check_curr_unlist <- as.data.frame(summary(df_manip_check_curr[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(df_manip_check_curr)) {
  df_manip_check_curr_unlist <- bind_rows(df_manip_check_curr_unlist, 
                                          as.data.frame(summary(df_manip_check_curr[[i]])$coefficients) %>% as_tibble())
}
```

```{r}
#| echo: true
#| warning: false

kable(df_manip_check_curr_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=4), 
               term = c(rep(c("Intercept", "time", "group", "time*group"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars)))), # order by BFI traits, 
      digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant *group* effects (higher trait level in self-improvement group at baseline) and also no significant differences in the changes over time in current-personality trait levels (*timeXgroup*). Significant (at *p* < .001) changes over time in current-personality trait levels (*time*) for 3 of the domains and five of the facets (independent of intervention group membership).
:::

Changes in ideal personality traits over time:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_manip_check_ideal <- df_sbsa2_t1t2 %>% 
  select(pid, time_d, rando, 
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_comb_ideal")) %>% 
  pivot_longer(ends_with("_comb_ideal"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * rando + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_manip_check_ideal_unlist <- as.data.frame(summary(df_manip_check_ideal[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(df_manip_check_ideal)) {
  df_manip_check_ideal_unlist <- bind_rows(df_manip_check_ideal_unlist, 
                                          as.data.frame(summary(df_manip_check_ideal[[i]])$coefficients) %>% as_tibble())
}
```

```{r}
#| echo: true
#| warning: false

kable(df_manip_check_ideal_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=4), 
               term = c(rep(c("Intercept", "time", "group", "time*group"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars)))), # order by BFI traits, 
      digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant *group* effects (higher trait level in self-improvement group at baseline) and also no significant differences in the changes over time in ideal-personality trait levels (*timeXgroup*). No significant changes over time in ideal-personality trait levels (*time*; independent of intervention group membership).
:::

#### From T2 to T3

Changes in current personality traits over time:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_sbsa2_t2t3 <- df_sbsa2 %>% filter(rando!="Waitlist-Control" & time %in% c(2,3)) %>% mutate(time_d = time - 2)

df_manip_check_curr_fu <- df_sbsa2_t2t3 %>% 
  select(pid, time_d, rando, 
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_comb_curr")) %>% 
  pivot_longer(ends_with("_comb_curr"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * rando + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_manip_check_curr_fu_unlist <- as.data.frame(summary(df_manip_check_curr_fu[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(df_manip_check_curr_fu)) {
  df_manip_check_curr_fu_unlist <- bind_rows(df_manip_check_curr_fu_unlist, 
                                          as.data.frame(summary(df_manip_check_curr_fu[[i]])$coefficients) %>% as_tibble())
}
```

```{r}
#| echo: true
#| warning: false

kable(df_manip_check_curr_fu_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=4), 
               term = c(rep(c("Intercept", "time", "group", "time*group"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars)))), # order by BFI traits, 
      digits = 3)
```

::: {.callout-note appearance="minimal"}
No further changes from T2 to T3 that are significant at *p* < .001 (independent of intervention group membership). Suggestive increase in conscientiousness.
:::

Changes in ideal personality traits over time:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_manip_check_ideal_fu <- df_sbsa2_t2t3 %>% 
  select(pid, time_d, rando, 
         paste0(str_trunc(names(b5_vars), 5, ellipsis = ""), "_comb_ideal")) %>% 
  pivot_longer(ends_with("_comb_ideal"), 
               names_to = "test", names_prefix = "facet", values_to = "score", values_drop_na = TRUE) %>% 
  group_nest(test) %>% 
  mutate(lmer_mods = map(data, ~lmerTest::lmer(score ~ time_d * rando + (1 | pid), data = .x))) %>% 
  pull(lmer_mods) %>% 
  purrr::set_names(sort(names(b5_vars))) # ordered alphabetically

df_manip_check_ideal_fu_unlist <- as.data.frame(summary(df_manip_check_ideal_fu[[1]])$coefficients) %>% as_tibble()
for (i in 2:length(df_manip_check_ideal_fu)) {
  df_manip_check_ideal_fu_unlist <- bind_rows(df_manip_check_ideal_fu_unlist, 
                                          as.data.frame(summary(df_manip_check_ideal_fu[[i]])$coefficients) %>% as_tibble())
}
```

```{r}
#| echo: true
#| warning: false

kable(df_manip_check_ideal_fu_unlist %>% 
        mutate(outcome = rep(sort(names(b5_vars)), each=4), 
               term = c(rep(c("Intercept", "time", "group", "time*group"), 20))) %>% 
        rename(p = `Pr(>|t|)`, std_err = `Std. Error`, est = Estimate) %>% select(outcome, term, est, std_err, p) %>% 
        mutate(sig = ifelse(p < .05, ifelse(p < .01, ifelse(p < .001, "***", "**"), "*"), " ")) %>% 
        arrange(factor(outcome, levels = (names(b5_vars)))), # order by BFI traits, 
      digits = 3)
```

::: {.callout-note appearance="minimal"}
No further changes from T2 to T3 that are significant at *p* < .001 (independent of intervention group membership). No group differences. 
:::


#### Descriptive plots: mean-level changes

##### Personality

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_manip_check_forplot <- df_sbsa2 %>% 
  select(pid, time, rando, contains("_comb_"), -c(na_comb_curr, na_comb_ideal)) %>% 
  pivot_longer(-c(pid, time, rando), 
               cols_vary = "slowest",
               names_to = c("trait", "reference"),
               names_pattern = "(.*)_(.*)",
               values_to = "score") %>% 
  mutate(trait = gsub("_comb", "", trait),
         reference = ifelse(reference=="curr", "current", reference)) %>% 
  left_join(tibble(long = str_to_title(names(b5_vars)), trait = str_trunc(names(b5_vars), 5, ellipsis = ""))) %>% 
  select(-trait, trait = long) %>% 
  filter(!is.na(score)) %>% 
  group_by(trait, reference, rando, time) %>% 
  summarise(n = n(), m_trait = mean(score), sd_trait = sd(score)) %>% 
  ungroup() %>% 
  mutate(Group = factor(rando, 
                        levels = c("Self-Improvement", "Self-Acceptance", "Waitlist-Control"), 
                        labels = c("Self-Improvement", "Self-Acceptance", "Waitlist-Control")),
         Time = factor(time),
         Trait = factor(trait, 
                        levels = str_to_title(names(b5_vars))[c(1,6:8, 2,9:11, 3,12:14, 4,15:17, 5,18:20)], # group facets with each trait
                        labels = str_to_title(names(b5_vars))[c(1,6:8, 2,9:11, 3,12:14, 4,15:17, 5,18:20)]),
         Reference = factor(reference, levels = c("current", "ideal"), labels = c("Current Personality", "Ideal Personality")),
         lwr95 = m_trait - qnorm(0.975)*sd_trait/sqrt(n),
         upr95 = m_trait + qnorm(0.975)*sd_trait/sqrt(n)) %>% 
  select(-c(time, rando, trait, reference))
```

Table of all outcomes:

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true

df_manip_check_forplot %>% arrange(Trait, Reference, Group, Time) %>% 
  mutate_if(is.numeric, round, digits=2) %>% 
  select(Trait, Reference, Group, Time, n, m_trait, lwr95, upr95, sd_trait) %>% 
  kable(digits = 2)
```

Plotting mean-level changes on a descriptive level: Big Five dimensions and facets  
```{r}
#| echo: true
#| fig-width: 8
#| fig-height: 9.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_manip_check_forplot, 
       aes(y = m_trait, x = Time, shape = Group, color = Reference)) + 
  geom_point(position = position_dodge(0.45)) +
  scale_shape_manual(values=c(17, 19, 15)) + 
  geom_errorbar(aes(ymin = lwr95, ymax = upr95), width=.3, position=position_dodge(0.45)) +
  ylab("Mean Trait Level (95% CI)") + 
  facet_wrap( ~ Trait, ncol = 4) +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        strip.background=element_rect(fill="grey93"))
```

Plotting mean-level changes on a descriptive level: Extraversion
```{r}
#| echo: true
#| fig-width: 5
#| fig-height: 3.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_manip_check_forplot %>% filter(Trait=="Extraversion"), 
       aes(y = m_trait, x = Time, shape = Group, color = Reference)) + 
  geom_point(position = position_dodge(0.35)) +
  scale_shape_manual(values=c(17, 19, 15)) + 
  geom_errorbar(aes(ymin = lwr95, ymax = upr95), width=.3, position=position_dodge(0.35)) +
  ylab("Mean Trait Level (95% CI)") + 
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        strip.background=element_rect(fill="grey93"))
```

Plotting mean-level changes on a descriptive level: Agreeableness
```{r}
#| echo: true
#| fig-width: 5
#| fig-height: 3.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_manip_check_forplot %>% filter(Trait=="Agreeableness"), 
       aes(y = m_trait, x = Time, shape = Group, color = Reference)) + 
  geom_point(position = position_dodge(0.35)) +
  scale_shape_manual(values=c(17, 19, 15)) + 
  geom_errorbar(aes(ymin = lwr95, ymax = upr95), width=.3, position=position_dodge(0.35)) +
  ylab("Mean Trait Level (95% CI)") + 
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        strip.background=element_rect(fill="grey93"))
```

Plotting mean-level changes on a descriptive level: Conscientiousness
```{r}
#| echo: true
#| fig-width: 5
#| fig-height: 3.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_manip_check_forplot %>% filter(Trait=="Conscientiousness"), 
       aes(y = m_trait, x = Time, shape = Group, color = Reference)) + 
  geom_point(position = position_dodge(0.35)) +
  scale_shape_manual(values=c(17, 19, 15)) + 
  geom_errorbar(aes(ymin = lwr95, ymax = upr95), width=.3, position=position_dodge(0.35)) +
  ylab("Mean Trait Level (95% CI)") + 
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        strip.background=element_rect(fill="grey93"))
```

Plotting mean-level changes on a descriptive level: Neuroticism
```{r}
#| echo: true
#| fig-width: 5
#| fig-height: 3.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_manip_check_forplot %>% filter(Trait=="Neuroticism"), 
       aes(y = m_trait, x = Time, shape = Group, color = Reference)) + 
  geom_point(position = position_dodge(0.35)) +
  scale_shape_manual(values=c(17, 19, 15)) + 
  geom_errorbar(aes(ymin = lwr95, ymax = upr95), width=.3, position=position_dodge(0.35)) +
  ylab("Mean Trait Level (95% CI)") + 
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        strip.background=element_rect(fill="grey93"))
```

Plotting mean-level changes on a descriptive level: Openness
```{r}
#| echo: true
#| fig-width: 5
#| fig-height: 3.5
#| code-fold: true
#| code-summary: "Show the code"

ggplot(df_manip_check_forplot %>% filter(Trait=="Openness"), 
       aes(y = m_trait, x = Time, shape = Group, color = Reference)) + 
  geom_point(position = position_dodge(0.35)) +
  scale_shape_manual(values=c(17, 19, 15)) + 
  geom_errorbar(aes(ymin = lwr95, ymax = upr95), width=.3, position=position_dodge(0.35)) +
  ylab("Mean Trait Level (95% CI)") + 
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        strip.background=element_rect(fill="grey93"))
```

##### Well-Being

Prepare data frame for plotting:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

df_manip_check_wb_forplot <- df_sbsa2 %>% 
  mutate(time_d = time - 1) %>% 
  select(pid, time_d, rando, swls, meaning, selfes, concept) %>% 
  pivot_longer(-c(pid, time_d, rando), 
               cols_vary = "slowest",
               names_to = c("trait"),
               values_to = "score") %>% 
  mutate(trait = case_when(trait=="swls" ~ "Life Satisfaction", trait=="meaning" ~ "Meaning in Life", 
                           trait=="selfes" ~ "Self-Esteem", trait=="concept" ~ "Self-Concept Clarity")) %>% 
  filter(!is.na(score)) %>% 
  group_by(trait, rando, time_d) %>% 
  summarise(n = n(), m_trait = mean(score), sd_trait = sd(score)) %>% 
  ungroup() %>% 
  mutate(Group = factor(rando, levels = c("Self-Improvement", "Self-Acceptance", "Waitlist-Control"), 
                        labels = c("Self-Improvement", "Self-Acceptance", "Waitlist-Control")),
         Time = factor(time_d+1),
         Trait = factor(trait, 
                        levels = c("Life Satisfaction", "Meaning in Life", "Self-Esteem", "Self-Concept Clarity"), # group facets with each trait
                        labels = c("Life Satisfaction", "Meaning in Life", "Self-Esteem", "Self-Concept Clarity")),
         lwr95 = m_trait - qnorm(0.975)*sd_trait/sqrt(n),
         upr95 = m_trait + qnorm(0.975)*sd_trait/sqrt(n)) %>% 
  select(-c(time_d, rando, trait))
```

Table of all outcomes:

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true

df_manip_check_wb_forplot %>% arrange(Trait, Group, Time) %>% 
  mutate_if(is.numeric, round, digits=2) %>% 
  select(Trait, Group, Time, n, m_trait, lwr95, upr95, sd_trait) %>% 
  kable(digits = 2)
```

Plotting mean-level changes on a descriptive level: all four well-being aspects
```{r}
#| echo: true
#| fig-width: 6.5
#| fig-height: 6.5
#| code-fold: true
#| code-summary: "Show the code"
#| cache: false

ggplot(df_manip_check_wb_forplot, 
       aes(y = m_trait, x = Time, shape = Group)) + 
  geom_point(position = position_dodge(0.3)) +
  scale_shape_manual(values=c(17, 19, 15)) + 
  geom_errorbar(aes(ymin = lwr95, ymax = upr95), width=.3, position=position_dodge(0.3)) +
  ylab("Mean Well-Being Level (95% CI)") + 
  facet_wrap( ~ Trait, ncol = 2) +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        strip.background=element_rect(fill="grey93"))
```

### Word clouds of change descriptions (e)

Generate word clouds based on the content from the free-form change descriptions written after the intervention at T2 and T3 (same question asked at both time points).

*For data protection reasons, we don't provide the free-form change descriptions on the OSF. Therefore, the following code chunks are not run (eval: false). We do, however, provide an even more extensive overview of these open-response variables including word clouds in the separate document textmining.html.*

Prepare data, separately for each intervention group
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true
#| eval: false

# see tutorial here: https://towardsdatascience.com/create-a-word-cloud-with-r-bde3e7422e8a

# self-improvement group

# Create a vector containing only the text
text_sb <- df_sbsa2 %>% filter(!is.na(sb14_01) & rando!="Waitlist-Control") %>% pull(sb14_01)
text_sb <- gsub("[\r\n]", " ", text_sb)
# Create a corpus  
docs_sb <- tm::VCorpus(tm::VectorSource(text_sb))

# cleaning the text
docs_sb <- docs_sb %>%
  tm_map(removeNumbers) %>%
  tm_map(removePunctuation) %>%
  tm_map(stripWhitespace)
docs_sb <- tm_map(docs_sb, content_transformer(tolower))
docs_sb <- tm_map(docs_sb, removeWords, stopwords("english"))

# Create a document-term-matrix
dtm_sb <- TermDocumentMatrix(docs_sb) 
matrix_sb <- as.matrix(dtm_sb) 
words_sb <- sort(rowSums(matrix_sb), decreasing=TRUE) 
df_words_sb <- data.frame(word = names(words_sb), freq=words_sb)
# remove a few of the frequent "non-words"
df_words_sb <- df_words_sb %>% as_tibble() %>% 
  filter(!word %in% c("ive", "didnt", "cant", "dont"))

# self-acceptance group

# Create a vector containing only the text
text_sa <- df_sbsa2 %>% filter(!is.na(sa13_01) & rando!="Waitlist-Control") %>% pull(sa13_01)
text_sa <- gsub("[\r\n]", " ", text_sa)
# Create a corpus  
docs_sa <- tm::VCorpus(tm::VectorSource(text_sa))

# cleaning the text
docs_sa <- docs_sa %>%
  tm_map(removeNumbers) %>%
  tm_map(removePunctuation) %>%
  tm_map(stripWhitespace)
docs_sa <- tm_map(docs_sa, content_transformer(tolower))
docs_sa <- tm_map(docs_sa, removeWords, stopwords("english"))

# Create a document-term-matrix
dtm_sa <- TermDocumentMatrix(docs_sa) 
matrix_sa <- as.matrix(dtm_sa) 
words_sa <- sort(rowSums(matrix_sa), decreasing=TRUE) 
df_words_sa <- data.frame(word = names(words_sa), freq=words_sa)
# remove a few of the frequent "non-words"
df_words_sa <- df_words_sa %>% as_tibble() %>% 
  filter(!word %in% c("ive", "didnt", "cant", "dont"))
```

Generate the word cloud: for self-improvement group
```{r}
#| echo: true
#| fig-width: 8
#| fig-height: 8
#| code-fold: true
#| code-summary: "Show the code"
#| eval: false

set.seed(1234) # for reproducibility 
wordcloud(words = df_words_sb$word, freq = df_words_sb$freq, min.freq = 1,           
          max.words=150, random.order=FALSE, rot.per=0.35,            
          colors=brewer.pal(8, "Dark2"))
```

Generate the word cloud: for self-acceptance group
```{r}
#| echo: true
#| fig-width: 8
#| fig-height: 8
#| code-fold: true
#| code-summary: "Show the code"
#| eval: false

set.seed(1234) # for reproducibility 
wordcloud(words = df_words_sa$word, freq = df_words_sa$freq, min.freq = 1,           
          max.words=150, random.order=FALSE, rot.per=0.35,            
          colors=brewer.pal(8, "Dark2"))
```

Lastly, delete free-form text variables again from data set
```{r}
#| echo: true
#| warning: false
#| eval: false

df_sbsa2 <- df_sbsa2 %>% select(-any_of(c("sb14_01", "sa13_01")))
base::save(df_sbsa2, file = "data/df_sbsa2.rda")
```

### Word clouds of diary entries (f)

Generate word clouds based on the content of the three diaries written between T1 and T2. I only focus on the two intervention groups here (not on the CG between T2 and T3).  

*For data protection reasons, we don't provide the diary entries on the OSF. Therefore, the following code chunks are not run (eval: false). We do, however, provide an even more extensive overview of all open-response variables including word clouds of the diaries in the separate document textmining.html.*

Read in the data and see how many people filled out the diaries (optional but still compensated)  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true
#| eval: false

path_diar1_sb <- "data/diaries/sb_1/data_PersonalityChange_2024-03-22_14-37.xlsx"
path_diar2_sb <- "data/diaries/sb_2/data_PersonalityChange_2024-03-22_16-19.xlsx"
path_diar3_sb <- "data/diaries/sb_3/data_PersonalityChange_2024-03-22_16-22.xlsx"

path_diar1_sa <- "data/diaries/sa_1/data_PersonalityChange_2024-03-22_16-18.xlsx"
path_diar2_sa <- "data/diaries/sa_2/data_PersonalityChange_2024-03-22_16-20.xlsx"
path_diar3_sa <- "data/diaries/sa_3/data_PersonalityChange_2024-03-22_16-22.xlsx"

# T1
diar1_sb <- readxl::read_excel(path_diar1_sb, col_names = F, skip = 2, guess_max = 10000)
var_names1_sb <- readxl::read_excel(path_diar1_sb, col_names = F)[c(1,2), ]
var_names1_sb <- data.frame(t(var_names1_sb))
colnames(diar1_sb) <- stringr::str_to_lower(var_names1_sb$X1) # only lower case pls
# label data 
diar1_sb <- labelled::set_variable_labels(diar1_sb, .labels = var_names1_sb$X2)
diar1_sb <- diar1_sb %>% filter(dm01_01!="Test" & !is.na(sb15_01)) %>% select(dm01_01, sb15_01)

diar1_sa <- readxl::read_excel(path_diar1_sa, col_names = F, skip = 2, guess_max = 10000)
var_names1_sa <- readxl::read_excel(path_diar1_sa, col_names = F)[c(1,2), ]
var_names1_sa <- data.frame(t(var_names1_sa))
colnames(diar1_sa) <- stringr::str_to_lower(var_names1_sa$X1) # only lower case pls
# label data 
diar1_sa <- labelled::set_variable_labels(diar1_sa, .labels = var_names1_sa$X2)
diar1_sa <- diar1_sa %>% filter(dm01_01!="Test" & !is.na(sa15_01)) %>% select(dm01_01, sa15_01)

# T2
diar2_sb <- readxl::read_excel(path_diar2_sb, col_names = F, skip = 2, guess_max = 10000)
var_names2_sb <- readxl::read_excel(path_diar2_sb, col_names = F)[c(1,2), ]
var_names2_sb <- data.frame(t(var_names2_sb))
colnames(diar2_sb) <- stringr::str_to_lower(var_names2_sb$X1) # only lower case pls
# label data 
diar2_sb <- labelled::set_variable_labels(diar2_sb, .labels = var_names2_sb$X2)
diar2_sb <- diar2_sb %>% filter(dm01_01!="Test" & !is.na(sb15_01)) %>% select(dm01_01, sb15_01)

diar2_sa <- readxl::read_excel(path_diar2_sa, col_names = F, skip = 2, guess_max = 10000)
var_names2_sa <- readxl::read_excel(path_diar2_sa, col_names = F)[c(1,2), ]
var_names2_sa <- data.frame(t(var_names2_sa))
colnames(diar2_sa) <- stringr::str_to_lower(var_names2_sa$X1) # only lower case pls
# label data 
diar2_sa <- labelled::set_variable_labels(diar2_sa, .labels = var_names2_sa$X2)
diar2_sa <- diar2_sa %>% filter(dm01_01!="Test" & !is.na(sa15_01)) %>% select(dm01_01, sa15_01)

# T3
diar3_sb <- readxl::read_excel(path_diar3_sb, col_names = F, skip = 2, guess_max = 10000)
var_names3_sb <- readxl::read_excel(path_diar3_sb, col_names = F)[c(1,2), ]
var_names3_sb <- data.frame(t(var_names3_sb))
colnames(diar3_sb) <- stringr::str_to_lower(var_names3_sb$X1) # only lower case pls
# label data 
diar3_sb <- labelled::set_variable_labels(diar3_sb, .labels = var_names3_sb$X2)
diar3_sb <- diar3_sb %>% filter(dm01_01!="Test" & !is.na(sb15_01)) %>% select(dm01_01, sb15_01)

diar3_sa <- readxl::read_excel(path_diar3_sa, col_names = F, skip = 2, guess_max = 10000)
var_names3_sa <- readxl::read_excel(path_diar3_sa, col_names = F)[c(1,2), ]
var_names3_sa <- data.frame(t(var_names3_sa))
colnames(diar3_sa) <- stringr::str_to_lower(var_names3_sa$X1) # only lower case pls
# label data 
diar3_sa <- labelled::set_variable_labels(diar3_sa, .labels = var_names3_sa$X2)
diar3_sa <- diar3_sa %>% filter(dm01_01!="Test" & !is.na(sa15_01)) %>% select(dm01_01, sa15_01)

# appending together all three diaries in each group
diaries_sb <- bind_rows(diar1_sb, diar2_sb, diar3_sb)
diaries_sa <- bind_rows(diar1_sa, diar2_sa, diar3_sa)

# filter out one case where it was obvious that they used a LLM
diaries_sb <- diaries_sb %>% filter(!str_detect(sb15_01, "language model"))
```

How many diaries at each time point?
```{r}
#| echo: true
#| warning: false
#| eval: false

tibble(time = c(1, 2, 3), improve = c(nrow(diar1_sb), nrow(diar2_sb), nrow(diar2_sb)),
       accept = c(nrow(diar1_sa), nrow(diar2_sa), nrow(diar2_sa)))
```

Prepare data, separately for each intervention group
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true
#| eval: false

# see tutorial here: https://towardsdatascience.com/create-a-word-cloud-with-r-bde3e7422e8a

# self-improvement group

# Create a vector containing only the text
text_diaries_sb <- diaries_sb %>% pull(sb15_01)
text_diaries_sb <- gsub("[\r\n]", " ", text_diaries_sb)
# Create a corpus  
docs_diaries_sb <- tm::VCorpus(tm::VectorSource(text_diaries_sb))

# cleaning the text
docs_diaries_sb <- docs_diaries_sb %>%
  tm_map(removeNumbers) %>%
  tm_map(removePunctuation) %>%
  tm_map(stripWhitespace)
docs_diaries_sb <- tm_map(docs_diaries_sb, content_transformer(tolower))
docs_diaries_sb <- tm_map(docs_diaries_sb, removeWords, stopwords("english"))

# Create a document-term-matrix
dtm_diaries_sb <- TermDocumentMatrix(docs_diaries_sb) 
matrix_diaries_sb <- as.matrix(dtm_diaries_sb) 
words_diaries_sb <- sort(rowSums(matrix_diaries_sb), decreasing=TRUE) 
df_words_diaries_sb <- data.frame(word = names(words_diaries_sb), freq=words_diaries_sb)
# remove a few of the frequent "non-words"
df_words_diaries_sb <- df_words_diaries_sb %>% as_tibble() %>% 
  filter(!word %in% c("ive", "didnt", "cant", "dont"))

# self-acceptance group

# Create a vector containing only the text
text_diaries_sa <- diaries_sa %>% pull(sa15_01)
text_diaries_sa <- gsub("[\r\n]", " ", text_diaries_sa)
# Create a corpus  
docs_diaries_sa <- tm::VCorpus(tm::VectorSource(text_diaries_sa))

# cleaning the text
docs_diaries_sa <- docs_diaries_sa %>%
  tm_map(removeNumbers) %>%
  tm_map(removePunctuation) %>%
  tm_map(stripWhitespace)
docs_diaries_sa <- tm_map(docs_diaries_sa, content_transformer(tolower))
docs_diaries_sa <- tm_map(docs_diaries_sa, removeWords, stopwords("english"))

# Create a document-term-matrix
dtm_diaries_sa <- TermDocumentMatrix(docs_diaries_sa) 
matrix_diaries_sa <- as.matrix(dtm_diaries_sa) 
words_diaries_sa <- sort(rowSums(matrix_diaries_sa), decreasing=TRUE) 
df_words_diaries_sa <- data.frame(word = names(words_diaries_sa), freq=words_diaries_sa)
# remove a few of the frequent "non-words"
df_words_diaries_sa <- df_words_diaries_sa %>% as_tibble() %>% 
  filter(!word %in% c("ive", "didnt", "cant", "dont"))
```

Generate the word cloud: for self-improvement group
```{r}
#| echo: true
#| fig-width: 8
#| fig-height: 8
#| code-fold: true
#| code-summary: "Show the code"
#| eval: false

set.seed(1234) # for reproducibility 
wordcloud(words = df_words_diaries_sb$word, freq = df_words_diaries_sb$freq, min.freq = 1,           
          max.words=150, random.order=FALSE, rot.per=0.35,            
          colors=brewer.pal(8, "Dark2"))
```

Generate the word cloud: for self-acceptance group
```{r}
#| echo: true
#| fig-width: 8
#| fig-height: 8
#| code-fold: true
#| code-summary: "Show the code"
#| eval: false

set.seed(1234) # for reproducibility 
wordcloud(words = df_words_diaries_sa$word, freq = df_words_diaries_sa$freq, min.freq = 1,           
          max.words=150, random.order=FALSE, rot.per=0.35,            
          colors=brewer.pal(8, "Dark2"))
```

### Age as moderator of trait change (f)

Does age moderate the extent to which participants in the intervention changed over time?  

#### Descriptives: Age & change goals

Some descriptives first:  

```{r}
#| echo: true
#| warning: false

# without the control group to make this similar to Study 1
df_sbsa2_age <- df_sbsa2 %>% filter(rando != "Waitlist-Control")

summary(df_sbsa2_age$age)
```

Correlation age & general improvement goal  
```{r}
#| echo: true
#| warning: false
cor.test(df_sbsa2_age$age, df_sbsa2_age$sb06_01)
```

::: {.callout-note appearance="minimal"}
Correlation not significant.
:::

Frequency of self-improvement behaviors  
- (1) I thought about the ways I would like to change  
- (2) I sought out environments that would help me be the kind of person I want to be  
- (3) I practiced new habits to achieve my change goals  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true
kable(
bind_rows(
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb04_01)) %>% mutate(item = "sb04_01"),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb04_02)) %>% mutate(item = "sb04_02"),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb04_03)) %>% mutate(item = "sb04_03")
) %>% select(item, estimate, conf.low, conf.high, p.value)
  , digits = 3)
```

Facet-level improvement goals  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true
kable(
bind_rows(
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_01)) %>% mutate(facet = names(b5_vars)[5 + 1]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_02)) %>% mutate(facet = names(b5_vars)[5 + 2]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_03)) %>% mutate(facet = names(b5_vars)[5 + 3]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_04)) %>% mutate(facet = names(b5_vars)[5 + 4]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_05)) %>% mutate(facet = names(b5_vars)[5 + 5]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_06)) %>% mutate(facet = names(b5_vars)[5 + 6]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_07)) %>% mutate(facet = names(b5_vars)[5 + 7]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_08)) %>% mutate(facet = names(b5_vars)[5 + 8]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_09)) %>% mutate(facet = names(b5_vars)[5 + 9]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_10)) %>% mutate(facet = names(b5_vars)[5 + 10]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_11)) %>% mutate(facet = names(b5_vars)[5 + 11]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_12)) %>% mutate(facet = names(b5_vars)[5 + 12]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_13)) %>% mutate(facet = names(b5_vars)[5 + 13]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_14)) %>% mutate(facet = names(b5_vars)[5 + 14]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sb07_15)) %>% mutate(facet = names(b5_vars)[5 + 15])
) %>% select(facet, estimate, conf.low, conf.high, p.value)
  , digits = 3)
```

::: {.callout-note appearance="minimal"}
Negative correlations for conscientiousness facets.
:::

Correlation age & general acceptance goal  
```{r}
#| echo: true
#| warning: false
cor.test(df_sbsa2_age$age, df_sbsa2_age$sa06_01)
```

::: {.callout-note appearance="minimal"}
Significant negative correlation.
:::

Frequency of self-acceptance behaviors  
- (1) I thought about how I could be less judgmental and more self-affirming  
- (2) I sought out environments that would help me accept who I am  
- (3) I practiced new self-acceptance habits to affirm who I am  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true
kable(
bind_rows(
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa04_01)) %>% mutate(item = "sa04_01"),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa04_02)) %>% mutate(item = "sa04_02"),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa04_03)) %>% mutate(item = "sa04_03")
) %>% select(item, estimate, conf.low, conf.high, p.value)
  , digits = 3)
```

Facet-level acceptance goals  
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true
kable(
bind_rows(
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_01)) %>% mutate(facet = names(b5_vars)[5 + 1]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_02)) %>% mutate(facet = names(b5_vars)[5 + 2]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_03)) %>% mutate(facet = names(b5_vars)[5 + 3]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_04)) %>% mutate(facet = names(b5_vars)[5 + 4]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_05)) %>% mutate(facet = names(b5_vars)[5 + 5]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_06)) %>% mutate(facet = names(b5_vars)[5 + 6]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_07)) %>% mutate(facet = names(b5_vars)[5 + 7]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_08)) %>% mutate(facet = names(b5_vars)[5 + 8]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_09)) %>% mutate(facet = names(b5_vars)[5 + 9]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_10)) %>% mutate(facet = names(b5_vars)[5 + 10]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_11)) %>% mutate(facet = names(b5_vars)[5 + 11]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_12)) %>% mutate(facet = names(b5_vars)[5 + 12]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_13)) %>% mutate(facet = names(b5_vars)[5 + 13]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_14)) %>% mutate(facet = names(b5_vars)[5 + 14]),
  tidy(cor.test(df_sbsa2_age$age, df_sbsa2_age$sa07_15)) %>% mutate(facet = names(b5_vars)[5 + 15])
) %>% select(facet, estimate, conf.low, conf.high, p.value)
  , digits = 3)
```

::: {.callout-note appearance="minimal"}
Negative correlations for conscientiousness facets.
:::

Correlation age & profile similarity (facet-level)   
```{r}
#| echo: true
#| warning: false
cor.test(df_sbsa2_age$age, df_sbsa2_age$profile_corr_facet_z)
```

Correlation age & profile similarity (item-level)   
```{r}
#| echo: true
#| warning: false
cor.test(df_sbsa2_age$age, df_sbsa2_age$profile_corr_item_z)
```

::: {.callout-note appearance="minimal"}
Significantly higher similarity between current- and ideal-personality with older age.
:::

#### Moderation analysis: linear age

Reshape and split data set by intervention group:
```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false

df_sbsa2_wide_pers_mod_age <- df_sbsa2 %>% 
  filter(rando != "Waitlist-Control") %>% 
  arrange(pid, time) %>% 
  mutate(age_z = (age - mean(age, na.rm=T)) / sd(age, na.rm=T)) %>% 
  group_by(pid) %>% slice_head(n=1) %>% ungroup() %>% 
  select(pid, age_z)

df_sbsa2_wide_pers_mod_age <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% filter(rando != "Waitlist-Control") %>% 
  left_join(df_sbsa2_wide_pers_mod_age)
```

##### Run models 

Adapt latent change score model from above (adding moderation by age) and add grouping factor in estimation (adding vectorized equality constraints to the model step by step):  

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates:

# configural invariance
trait_template_age_config <- '
trait_t1 =~ 1*ind01_t1 +  c("lamb2a", "lamb2b")*ind02_t1 + c("lamb3a", "lamb3b")*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 +  c("lamb2a", "lamb2b")*ind02_t2 + c("lamb3a", "lamb3b")*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ c("d_int_a", "d_int_b")*1              # This estimates the intercept of the change score 
trait_t1 ~ c("b5_int_a", "b5_int_b")*1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ c("d_var_a", "d_var_b")*d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ c("b5_var_a", "b5_var_b")*trait_t1         # This estimates the variance of trait_t1 
d_trait_1 ~~ c("fb_a", "fb_b")* trait_t1   # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score
trait_t1 ~ c("main_a", "main_b")*age_z           # This estimates the moderation effect on personality at T1
d_trait_1 ~ c("mod_a", "mod_b")*age_z          # This estimates the moderation effect on the change score

age_z ~ 0*1            # This fixes the intercept of the moderator to 0
age_z ~~ c("varmod_a", "varmod_b")*age_z         # This estimates the variance of the moderator

ind01_t1 ~~ c("cov1a", "cov1b")*ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ c("cov2a", "cov2b")*ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ c("cov3a", "cov3b")*ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ c("res1a", "res1b")*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ c("res2a", "res2b")*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ c("res3a", "res3b")*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ c("res1a", "res1b")*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ c("res2a", "res2b")*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ c("res3a", "res3b")*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

# weak invariance
trait_template_age_weak <- '
trait_t1 =~ 1*ind01_t1 +  c("lamb2", "lamb2")*ind02_t1 + c("lamb3", "lamb3")*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 +  c("lamb2", "lamb2")*ind02_t2 + c("lamb3", "lamb3")*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ c("d_int_a", "d_int_b")*1              # This estimates the intercept of the change score 
trait_t1 ~ c("b5_int_a", "b5_int_b")*1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ c("d_var_a", "d_var_b")*d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ c("b5_var_a", "b5_var_b")*trait_t1         # This estimates the variance of trait_t1 
d_trait_1 ~~ c("fb_a", "fb_b")* trait_t1   # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score
trait_t1 ~ c("main_a", "main_b")*age_z           # This estimates the moderation effect on personality at T1
d_trait_1 ~ c("mod_a", "mod_b")*age_z          # This estimates the moderation effect on the change score

age_z ~ 0*1            # This fixes the intercept of the moderator to 0
age_z ~~ c("varmod_a", "varmod_b")*age_z         # This estimates the variance of the moderator

ind01_t1 ~~ c("cov1a", "cov1b")*ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ c("cov2a", "cov2b")*ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ c("cov3a", "cov3b")*ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ c("res1a", "res1b")*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ c("res2a", "res2b")*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ c("res3a", "res3b")*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ c("res1a", "res1b")*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ c("res2a", "res2b")*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ c("res3a", "res3b")*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ c("m2a", "m2b")*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ c("m3a", "m3b")*1     # This estimates the intercept of X3 at T2
'

# strong invariance
trait_template_age_strong <- '
trait_t1 =~ 1*ind01_t1 +  c("lamb2", "lamb2")*ind02_t1 + c("lamb3", "lamb3")*ind03_t1 # This specifies the measurement model for trait_t1 
trait_t2 =~ 1*ind01_t2 +  c("lamb2", "lamb2")*ind02_t2 + c("lamb3", "lamb3")*ind03_t2 # This specifies the measurement model for trait_t2 with the equality constrained factor loadings

trait_t2 ~ 1*trait_t1     # This parameter regresses trait_t2 perfectly on trait_t1
d_trait_1 =~ 1*trait_t2   # This defines the latent change score factor as measured perfectly by scores on trait_t2
trait_t2 ~ 0*1            # This line constrains the intercept of trait_t2 to 0
trait_t2 ~~ 0*trait_t2    # This fixes the variance of trait_t2 to 0

d_trait_1 ~ c("d_int", "d_int")*1              # This estimates the intercept of the change score 
trait_t1 ~ c("b5_int", "b5_int")*1               # This estimates the intercept of trait_t1 
d_trait_1 ~~ c("d_var_a", "d_var_b")*d_trait_1     # This estimates the variance of the change scores 
trait_t1 ~~ c("b5_var_a", "b5_var_b")*trait_t1         # This estimates the variance of trait_t1 
d_trait_1 ~~ c("fb_a", "fb_b")* trait_t1   # This estimates the self-feedback parameter, as a covariance! -> therefore, the interpretation of the change score
trait_t1 ~ c("main", "main")*age_z         # This estimates the moderation effect on personality at T1
d_trait_1 ~ c("mod", "mod")*age_z          # This estimates the moderation effect on the change score

age_z ~ 0*1            # This fixes the intercept of the moderator to 0
age_z ~~ c("varmod_a", "varmod_b")*age_z         # This estimates the variance of the moderator

ind01_t1 ~~ c("cov1a", "cov1b")*ind01_t2   # This allows residual covariance on indicator X1 across T1 and T2
ind02_t1 ~~ c("cov2a", "cov2b")*ind02_t2   # This allows residual covariance on indicator X2 across T1 and T2
ind03_t1 ~~ c("cov3a", "cov3b")*ind03_t2   # This allows residual covariance on indicator X3 across T1 and T2

ind01_t1 ~~ c("res1a", "res1b")*ind01_t1   # This allows residual variance on indicator X1 at T1 
ind02_t1 ~~ c("res2a", "res2b")*ind02_t1   # This allows residual variance on indicator X2 at T1
ind03_t1 ~~ c("res3a", "res3b")*ind03_t1   # This allows residual variance on indicator X3 at T1

ind01_t2 ~~ c("res1a", "res1b")*ind01_t2  # This allows residual variance on indicator X1 at T2 
ind02_t2 ~~ c("res2a", "res2b")*ind02_t2  # This allows residual variance on indicator X2 at T2 
ind03_t2 ~~ c("res3a", "res3b")*ind03_t2  # This allows residual variance on indicator X3 at T2

ind01_t1 ~ 0*1      # This constrains the intercept of X1 to 0 at T1
ind02_t1 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T1
ind03_t1 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T1

ind01_t2 ~ 0*1      # This constrains the intercept of X1 to 0 at T2
ind02_t2 ~ c("m2", "m2")*1     # This estimates the intercept of X2 at T2
ind03_t2 ~ c("m3", "m3")*1     # This estimates the intercept of X3 at T2
'

# strict invariance -> not really needed for this analysis

# loop across 5 traits
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # configural - current
  template_filled_config_current <- str_replace_all(trait_template_age_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_age_fit_config_current <- lavaan(template_filled_config_current, 
                                          data = df_sbsa2_wide_pers_mod_age, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_age_config_current")), template_filled_config_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_age_config_current")), trait_age_fit_config_current))
  # configural - ideal
  template_filled_config_ideal <- str_replace_all(trait_template_age_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_age_fit_config_ideal <- lavaan(template_filled_config_ideal, 
                                        data = df_sbsa2_wide_pers_mod_age, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_age_config_ideal")), template_filled_config_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_age_config_ideal")), trait_age_fit_config_ideal))
  # weak - current
  template_filled_weak_current <- str_replace_all(trait_template_age_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_age_fit_weak_current <- lavaan(template_filled_weak_current, 
                                          data = df_sbsa2_wide_pers_mod_age, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_age_weak_current")), template_filled_weak_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_age_weak_current")), trait_age_fit_weak_current))
  # weak - ideal
  template_filled_weak_ideal <- str_replace_all(trait_template_age_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_age_fit_weak_ideal <- lavaan(template_filled_weak_ideal, 
                                        data = df_sbsa2_wide_pers_mod_age, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_age_weak_ideal")), template_filled_weak_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_age_weak_ideal")), trait_age_fit_weak_ideal))
  # strong - current
  template_filled_strong_current <- str_replace_all(trait_template_age_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_age_fit_strong_current <- lavaan(template_filled_strong_current, 
                                          data = df_sbsa2_wide_pers_mod_age, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_age_strong_current")), template_filled_strong_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_age_strong_current")), trait_age_fit_strong_current))
  # strong - ideal
  template_filled_strong_ideal <- str_replace_all(trait_template_age_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_age_fit_strong_ideal <- lavaan(template_filled_strong_ideal, 
                                        data = df_sbsa2_wide_pers_mod_age, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "rando", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_age_strong_ideal")), template_filled_strong_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_age_strong_ideal")), trait_age_fit_strong_ideal))
}
```

##### Current personality personality traits

Extraversion (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_age_config_current, fit_lcs_extra_age_weak_current, fit_lcs_extra_age_strong_current)

# show model with varying latent change parameters 
# -> change parameter is "d_extra_1 ~1"
# -> main effect of age on T1 trait is "extra_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_extra_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_extra_current <- broom::tidy(fit_lcs_extra_age_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ", "extra_t1 ~ age_z", "d_extra_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_extra_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_age_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ", "extra_t1 ~ age_z", "d_extra_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_age_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Slightly significant (at *p* < .05) moderation effect by age for extraversion but only in the constrained model. With older age, participants changed less in current-personality extraversion. No significant differences between intervention groups according to the LRTs.
:::

Agreeableness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_age_config_current, fit_lcs_agree_age_weak_current, fit_lcs_agree_age_strong_current)

# show model with varying latent change parameters 
# -> change parameter is "d_agree_1 ~1"
# -> main effect of age on T1 trait is "agree_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_agree_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_agree_current <- broom::tidy(fit_lcs_agree_age_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ", "agree_t1 ~ age_z", "d_agree_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_agree_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_age_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ", "agree_t1 ~ age_z", "d_agree_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_age_strong_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation by age for agreeableness (similar in both groups). However, slight "main effect" of age on agreeableness at T1. No significant differences between intervention groups according to the LRTs.
:::

Conscientiousness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_age_config_current, fit_lcs_consc_age_weak_current, fit_lcs_consc_age_strong_current)

# show model with varying latent change parameters 
# -> change parameter is "d_consc_1 ~1"
# -> main effect of age on T1 trait is "consc_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_consc_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_consc_current <- broom::tidy(fit_lcs_consc_age_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ", "consc_t1 ~ age_z", "d_consc_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_consc_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_age_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ", "consc_t1 ~ age_z", "d_consc_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_age_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation by age for conscientiousness (similar in both groups). Main effect of age on conscientiousness at T1. No significant differences according to the LRTs.
:::

Neuroticism (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_age_config_current, fit_lcs_neuro_age_weak_current, fit_lcs_neuro_age_strong_current)

# show model with varying latent change parameters 
# -> change parameter is "d_neuro_1 ~1"
# -> main effect of age on T1 trait is "neuro_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_neuro_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_neuro_current <- broom::tidy(fit_lcs_neuro_age_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ", "neuro_t1 ~ age_z", "d_neuro_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_neuro_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_age_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ", "neuro_t1 ~ age_z", "d_neuro_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_age_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation by age for neuroticism in both groups. Slight main effect of age on neuroticism at T1. No significant differences according to the LRTs.
:::

Openness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_age_config_current, fit_lcs_openn_age_weak_current, fit_lcs_openn_age_strong_current)

# show model with varying latent change parameters 
# -> change parameter is "d_openn_1 ~1"
# -> main effect of age on T1 trait is "openn_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_openn_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_openn_current <- broom::tidy(fit_lcs_openn_age_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ", "openn_t1 ~ age_z", "d_openn_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_openn_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_age_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ", "openn_t1 ~ age_z", "d_openn_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_age_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Very slight (but significant at p < .05) moderation by age for current-personality openness in the self-improvement group only. 
No significant differences according to the LRTs, though. No main effects of age.
:::

##### Ideal personality personality traits

Extraversion (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_age_config_ideal, fit_lcs_extra_age_weak_ideal, fit_lcs_extra_age_strong_ideal)

# show model with varying latent change parameters 
# -> change parameter is "d_extra_1 ~1"
# -> main effect of age on T1 trait is "extra_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_extra_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_extra_ideal <- broom::tidy(fit_lcs_extra_age_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ", "extra_t1 ~ age_z", "d_extra_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_extra_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_age_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ", "extra_t1 ~ age_z", "d_extra_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_age_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Very slight (but significant at p < .05) moderation by age for ideal-personality extraversion in the self-acceptance group and in the constrained model. However, no significant differences according to the LRTs. 
:::

Agreeableness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_age_config_ideal, fit_lcs_agree_age_weak_ideal, fit_lcs_agree_age_strong_ideal)

# show model with varying latent change parameters 
# -> change parameter is "d_agree_1 ~1"
# -> main effect of age on T1 trait is "agree_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_agree_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_agree_ideal <- broom::tidy(fit_lcs_agree_age_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ", "agree_t1 ~ age_z", "d_agree_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_agree_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_age_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ", "agree_t1 ~ age_z", "d_agree_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_age_strong_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation by age for ideal-personality agreeableness (similar in both groups). Main effect of age on agreeableness at T1. No significant group differences according to LRTs.  
:::

Conscientiousness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_age_config_ideal, fit_lcs_consc_age_weak_ideal, fit_lcs_consc_age_strong_ideal)

# show model with varying latent change parameters 
# -> change parameter is "d_consc_1 ~1"
# -> main effect of age on T1 trait is "consc_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_consc_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_consc_ideal <- broom::tidy(fit_lcs_consc_age_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ", "consc_t1 ~ age_z", "d_consc_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_consc_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_age_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ", "consc_t1 ~ age_z", "d_consc_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_age_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation by age for ideal-personality conscientiousness (similar in both groups). No significant differences according to the LRTs. 
:::

Neuroticism (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_age_config_ideal, fit_lcs_neuro_age_weak_ideal, fit_lcs_neuro_age_strong_ideal)

# show model with varying latent change parameters 
# -> change parameter is "d_neuro_1 ~1"
# -> main effect of age on T1 trait is "neuro_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_neuro_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_neuro_ideal <- broom::tidy(fit_lcs_neuro_age_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ", "neuro_t1 ~ age_z", "d_neuro_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_neuro_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_age_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ", "neuro_t1 ~ age_z", "d_neuro_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_age_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Slight moderation effect (significant at *p* < .05) by age for ideal-personality neuroticism. Only significant in the constrained model. No significant group differences according to the LRTs.
:::

Openness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_age_config_ideal, fit_lcs_openn_age_weak_ideal, fit_lcs_openn_age_strong_ideal)

# show model with varying latent change parameters 
# -> change parameter is "d_openn_1 ~1"
# -> main effect of age on T1 trait is "openn_t1 ~ age_z"
# -> moderation effect of age on change parameter is "d_openn_1 ~ age_z"
# labelled parameter as "d_int_a" & "d_int_b" (a = Self-Acceptance group, b = Self-Improvement group)
params_age_lcs_openn_ideal <- broom::tidy(fit_lcs_openn_age_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ", "openn_t1 ~ age_z", "d_openn_1 ~ age_z")) %>% arrange(label)
kable(params_age_lcs_openn_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_age_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ", "openn_t1 ~ age_z", "d_openn_1 ~ age_z")) %>% arrange(label), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_age_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
No significant moderation by age for ideal-personality openness (similar in both groups). No significant differences according to the LRTs.
:::

##### Summary of latent main and moderation effects of linear age

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true

params_age_summary <- bind_rows(
  params_age_lcs_extra_current %>% mutate(trait = names(b5_vars)[1], self = "current") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_extra_ideal %>% mutate(trait = names(b5_vars)[1], self = "ideal") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_agree_current %>% mutate(trait = names(b5_vars)[2], self = "current") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_agree_ideal %>% mutate(trait = names(b5_vars)[2], self = "ideal") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_consc_current %>% mutate(trait = names(b5_vars)[3], self = "current") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_consc_ideal %>% mutate(trait = names(b5_vars)[3], self = "ideal") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_neuro_current %>% mutate(trait = names(b5_vars)[4], self = "current") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_neuro_ideal %>% mutate(trait = names(b5_vars)[4], self = "ideal") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_openn_current %>% mutate(trait = names(b5_vars)[5], self = "current") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value),
  params_age_lcs_openn_ideal %>% mutate(trait = names(b5_vars)[5], self = "ideal") %>% filter(str_detect(label, "m")==T) %>% select(trait, self, group = label, beta = std.all, p.value)
) 

kable(params_age_summary, digits = 3)
```

::: {.callout-note appearance="minimal"}
Very few significant moderation effects (at *p* < .05): extraversion (ideal - acceptance group), neuroticism (ideal - in constrained model), openness (current - improvement group). Overall, not consistent with Study 1 results.  
Plus a few main effects of age (at T1) in either intervention group.  
:::

#### Moderation analysis: age group split

Now that we saw that the two intervention groups did not really differ in terms of linear moderation effects, let's see whether perhaps across the whole sample we can find differences in two age groups (-> in multigroup SEM of latent change score).

Split age by age 30: roughly the sample mean and consistent with findings by Miller on age differences
```{r}
#| echo: true
#| warning: false

df_sbsa2_wide_pers_mod_age_split <- df_sbsa2 %>% 
  arrange(pid, time) %>% 
  mutate(age_d = ifelse(age <= 30, "young", "old")) %>% 
  group_by(pid) %>% slice_head(n=1) %>% ungroup() %>% 
  select(pid, age_d)

df_sbsa2_wide_pers_mod_age_split <- df_sbsa2_wide_pers %>% left_join(group_assign) %>% 
  left_join(df_sbsa2_wide_pers_mod_age_split) %>% 
  filter(!is.na(age_d))
```

##### Run models 

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| output: false
#| cache: true

# create templates: we can use the same templates as above just with different group composition (split by age_d variable)

# loop across 5 traits
for (i in 1:5) {
  item_nrs = b5_vars[[i]][[1]]
  short_name = str_trunc(names(b5_vars)[i], 5, ellipsis = "")
  # configural - current
  template_filled_config_current <- str_replace_all(trait_template_main_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_agesplit_fit_config_current <- lavaan(template_filled_config_current, 
                                          data = df_sbsa2_wide_pers_mod_age_split, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "age_d")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_agesplit_config_current")), template_filled_config_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_agesplit_config_current")), trait_agesplit_fit_config_current))
  # configural - ideal
  template_filled_config_ideal <- str_replace_all(trait_template_main_config, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_agesplit_fit_config_ideal <- lavaan(template_filled_config_ideal, 
                                        data = df_sbsa2_wide_pers_mod_age_split, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "age_d")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_agesplit_config_ideal")), template_filled_config_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_agesplit_config_ideal")), trait_agesplit_fit_config_ideal))
  # weak - current
  template_filled_weak_current <- str_replace_all(trait_template_main_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_agesplit_fit_weak_current <- lavaan(template_filled_weak_current, 
                                          data = df_sbsa2_wide_pers_mod_age_split, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "age_d", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_agesplit_weak_current")), template_filled_weak_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_agesplit_weak_current")), trait_agesplit_fit_weak_current))
  # weak - ideal
  template_filled_weak_ideal <- str_replace_all(trait_template_main_weak, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_agesplit_fit_weak_ideal <- lavaan(template_filled_weak_ideal, 
                                        data = df_sbsa2_wide_pers_mod_age_split, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "age_d", group.equal = "loadings")
  eval(call("<-", as.name(paste0("lcs_", short_name, "_agesplit_weak_ideal")), template_filled_weak_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_agesplit_weak_ideal")), trait_agesplit_fit_weak_ideal))
  # strong - current
  template_filled_strong_current <- str_replace_all(trait_template_main_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_curr_par1"), 
                                         "ind02" = paste0(short_name, "_curr_par2"), 
                                         "ind03" = paste0(short_name, "_curr_par3")))
  trait_agesplit_fit_strong_current <- lavaan(template_filled_strong_current, 
                                          data = df_sbsa2_wide_pers_mod_age_split, 
                                          estimator='mlr', fixed.x=FALSE, missing='fiml', group = "age_d", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_agesplit_strong_current")), template_filled_strong_current))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_agesplit_strong_current")), trait_agesplit_fit_strong_current))
  # strong - ideal
  template_filled_strong_ideal <- str_replace_all(trait_template_main_strong, 
                                       c("trait" = short_name,
                                         "ind01" = paste0(short_name, "_ideal_par1"), 
                                         "ind02" = paste0(short_name, "_ideal_par2"), 
                                         "ind03" = paste0(short_name, "_ideal_par3")))
  trait_agesplit_fit_strong_ideal <- lavaan(template_filled_strong_ideal, 
                                        data = df_sbsa2_wide_pers_mod_age_split, 
                                        estimator='mlr', fixed.x=FALSE, missing='fiml', group = "age_d", group.equal = c("intercepts", "loadings"))
  eval(call("<-", as.name(paste0("lcs_", short_name, "_agesplit_strong_ideal")), template_filled_strong_ideal))
  eval(call("<-", as.name(paste0("fit_lcs_", short_name, "_agesplit_strong_ideal")), trait_agesplit_fit_strong_ideal))
}
```

##### Current personality personality traits

Extraversion (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_agesplit_config_current, fit_lcs_extra_agesplit_weak_current, fit_lcs_extra_agesplit_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_extra_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_extra_current <- broom::tidy(fit_lcs_extra_agesplit_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 "))
kable(params_agesplit_lcs_extra_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_agesplit_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_agesplit_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in extraversion in both groups (somewhat stronger in younger group!). No significant differences in latent change score according to the LRTs (2nd test).
:::

Agreeableness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_agesplit_config_current, fit_lcs_agree_agesplit_weak_current, fit_lcs_agree_agesplit_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_agree_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_agree_current <- broom::tidy(fit_lcs_agree_agesplit_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 "))
kable(params_agesplit_lcs_agree_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_agesplit_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_agesplit_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Very similar change in agreeableness in both groups. No significant differences according to the LRTs.
:::

Conscientiousness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_agesplit_config_current, fit_lcs_consc_agesplit_weak_current, fit_lcs_consc_agesplit_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_consc_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_consc_current <- broom::tidy(fit_lcs_consc_agesplit_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 "))
kable(params_agesplit_lcs_consc_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_agesplit_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_agesplit_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in conscientiousness in both groups (slightly stronger change in younger group). LRT indicates significant group differences in latent change score.
:::

Neuroticism (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_agesplit_config_current, fit_lcs_neuro_agesplit_weak_current, fit_lcs_neuro_agesplit_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_neuro_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_neuro_current <- broom::tidy(fit_lcs_neuro_agesplit_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 "))
kable(params_agesplit_lcs_neuro_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_agesplit_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_agesplit_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Relatively similar change in neuroticism in both groups (slightly stronger change in younger group). LRT indicates significant group differences in latent change score.
:::

Openness (current personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_agesplit_config_current, fit_lcs_openn_agesplit_weak_current, fit_lcs_openn_agesplit_strong_current)

# show model with varying latent change parameters 
# -> key parameter is "d_openn_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_openn_current <- broom::tidy(fit_lcs_openn_agesplit_weak_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 "))
kable(params_agesplit_lcs_openn_current, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_agesplit_strong_current, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_agesplit_weak_current) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Relatively similar change in openness in both groups (slightly stronger change in younger group). LRT indicates no significant group differences in latent change score, however.
:::

##### Ideal personality personality traits

Extraversion (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_extra_agesplit_config_ideal, fit_lcs_extra_agesplit_weak_ideal, fit_lcs_extra_agesplit_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_extra_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_extra_ideal <- broom::tidy(fit_lcs_extra_agesplit_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 "))
kable(params_agesplit_lcs_extra_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_extra_agesplit_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_extra_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_extra_agesplit_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
More pronounced change in ideal-personality extraversion in older group. Significant difference in latent change score according to LRT.
:::

Agreeableness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_agree_agesplit_config_ideal, fit_lcs_agree_agesplit_weak_ideal, fit_lcs_agree_agesplit_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_agree_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_agree_ideal <- broom::tidy(fit_lcs_agree_agesplit_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 "))
kable(params_agesplit_lcs_agree_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_agree_agesplit_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_agree_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_agree_agesplit_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Almost the same change in ideal-personality agreeableness in both groups. LRT indicates some significant difference but this must be because of another parameter (main effect?).
:::

Conscientiousness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_consc_agesplit_config_ideal, fit_lcs_consc_agesplit_weak_ideal, fit_lcs_consc_agesplit_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_consc_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_consc_ideal <- broom::tidy(fit_lcs_consc_agesplit_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 "))
kable(params_agesplit_lcs_consc_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_consc_agesplit_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_consc_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_consc_agesplit_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Very similar change in ideal-personality conscientiousness in both groups. No significant differences according to the LRTs.
:::

Neuroticism (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_neuro_agesplit_config_ideal, fit_lcs_neuro_agesplit_weak_ideal, fit_lcs_neuro_agesplit_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_neuro_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_neuro_ideal <- broom::tidy(fit_lcs_neuro_agesplit_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 "))
kable(params_agesplit_lcs_neuro_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_neuro_agesplit_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_neuro_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_neuro_agesplit_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
More pronounced change in ideal-personality neuroticism in older group (but also not significant on its own). Significant difference in latent change score according to LRT.
:::

Openness (ideal personality): results  
```{r}
#| echo: true
#| warning: false

# model comparison tests for measurement invariance
lavTestLRT(fit_lcs_openn_agesplit_config_ideal, fit_lcs_openn_agesplit_weak_ideal, fit_lcs_openn_agesplit_strong_ideal)

# show model with varying latent change parameters 
# -> key parameter is "d_openn_1 ~1"
# labelled parameter as "d_int_a" & "d_int_b" (a = old, b = young)
params_agesplit_lcs_openn_ideal <- broom::tidy(fit_lcs_openn_agesplit_weak_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 "))
kable(params_agesplit_lcs_openn_ideal, digits = 3) 

# constrained to be equal in the strong measurement invariance model:
kable(broom::tidy(fit_lcs_openn_agesplit_strong_ideal, conf.int = TRUE, conf.level = 0.999) %>% 
        select(term, label, estimate, std.all, statistic, p.value) %>% 
        filter(term %in% c("d_openn_1 ~1 ")), digits = 3) 

# model fit
kable(broom::glance(fit_lcs_openn_agesplit_weak_ideal) %>% 
        select(nobs, npar, AIC, BIC, cfi, rmsea, srmr), digits = 3)
```

::: {.callout-note appearance="minimal"}
Similar change in ideal-personality openness in both age groups (slightly stronger in younger group). LRT indicates significant difference (not sure why).
:::

##### Summary of latent main effects split by age group

```{r}
#| echo: true
#| warning: false
#| code-fold: true
#| code-summary: "Show the code"
#| cache: true

params_agesplit_summary <- bind_rows(
  params_agesplit_lcs_extra_current %>% mutate(trait = names(b5_vars)[1], self = "current") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_extra_ideal %>% mutate(trait = names(b5_vars)[1], self = "ideal") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_agree_current %>% mutate(trait = names(b5_vars)[2], self = "current") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_agree_ideal %>% mutate(trait = names(b5_vars)[2], self = "ideal") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_consc_current %>% mutate(trait = names(b5_vars)[3], self = "current") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_consc_ideal %>% mutate(trait = names(b5_vars)[3], self = "ideal") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_neuro_current %>% mutate(trait = names(b5_vars)[4], self = "current") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_neuro_ideal %>% mutate(trait = names(b5_vars)[4], self = "ideal") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_openn_current %>% mutate(trait = names(b5_vars)[5], self = "current") %>% select(trait, self, group = label, beta = std.all, p.value),
  params_agesplit_lcs_openn_ideal %>% mutate(trait = names(b5_vars)[5], self = "ideal") %>% select(trait, self, group = label, beta = std.all, p.value)
) %>% mutate(group = ifelse(group=="d_int_a", "old", "young"))

kable(params_agesplit_summary, digits = 3)
```

::: {.callout-note appearance="minimal"}
Somewhat more pronounced changes in current-personality personality in the younger age group, and more pronounced changes in ideal-personality personality in the older age group (see extraversion!). However, a lot of this is only suggestive evidence (at *p* < .05), is not consistent across all traits, and does not replicate findings from Study 1. Difficult to interpret overall...
:::

<!--
## References

::: {#refs}
:::
-->
